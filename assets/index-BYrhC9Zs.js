(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();/**
* @vue/shared v3.5.19
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Nm(n){const e=Object.create(null);for(const t of n.split(","))e[t]=1;return t=>t in e}const Ke={},Ro=[],dr=()=>{},Yb=()=>!1,Dh=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),Om=n=>n.startsWith("onUpdate:"),Pt=Object.assign,Dm=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},xk=Object.prototype.hasOwnProperty,Be=(n,e)=>xk.call(n,e),ye=Array.isArray,xo=n=>Lh(n)==="[object Map]",Xb=n=>Lh(n)==="[object Set]",be=n=>typeof n=="function",mt=n=>typeof n=="string",li=n=>typeof n=="symbol",rt=n=>n!==null&&typeof n=="object",Zb=n=>(rt(n)||be(n))&&be(n.then)&&be(n.catch),e1=Object.prototype.toString,Lh=n=>e1.call(n),Mk=n=>Lh(n).slice(8,-1),t1=n=>Lh(n)==="[object Object]",Lm=n=>mt(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,Ha=Nm(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Vh=n=>{const e=Object.create(null);return(t=>e[t]||(e[t]=n(t)))},Pk=/-(\w)/g,$n=Vh(n=>n.replace(Pk,(e,t)=>t?t.toUpperCase():"")),Nk=/\B([A-Z])/g,Zi=Vh(n=>n.replace(Nk,"-$1").toLowerCase()),Fh=Vh(n=>n.charAt(0).toUpperCase()+n.slice(1)),sf=Vh(n=>n?`on${Fh(n)}`:""),Fs=(n,e)=>!Object.is(n,e),Qc=(n,...e)=>{for(let t=0;t<n.length;t++)n[t](...e)},n1=(n,e,t,r=!1)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,writable:r,value:t})},cp=n=>{const e=parseFloat(n);return isNaN(e)?n:e},Ok=n=>{const e=mt(n)?Number(n):NaN;return isNaN(e)?n:e};let R0;const Bh=()=>R0||(R0=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Vm(n){if(ye(n)){const e={};for(let t=0;t<n.length;t++){const r=n[t],s=mt(r)?Fk(r):Vm(r);if(s)for(const i in s)e[i]=s[i]}return e}else if(mt(n)||rt(n))return n}const Dk=/;(?![^(]*\))/g,Lk=/:([^]+)/,Vk=/\/\*[^]*?\*\//g;function Fk(n){const e={};return n.replace(Vk,"").split(Dk).forEach(t=>{if(t){const r=t.split(Lk);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function Ni(n){let e="";if(mt(n))e=n;else if(ye(n))for(let t=0;t<n.length;t++){const r=Ni(n[t]);r&&(e+=r+" ")}else if(rt(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}const Bk="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",$k=Nm(Bk);function r1(n){return!!n||n===""}const s1=n=>!!(n&&n.__v_isRef===!0),it=n=>mt(n)?n:n==null?"":ye(n)||rt(n)&&(n.toString===e1||!be(n.toString))?s1(n)?it(n.value):JSON.stringify(n,i1,2):String(n),i1=(n,e)=>s1(e)?i1(n,e.value):xo(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[r,s],i)=>(t[of(r,i)+" =>"]=s,t),{})}:Xb(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>of(t))}:li(e)?of(e):rt(e)&&!ye(e)&&!t1(e)?String(e):e,of=(n,e="")=>{var t;return li(n)?`Symbol(${(t=n.description)!=null?t:e})`:n};/**
* @vue/reactivity v3.5.19
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Gt;class o1{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Gt,!e&&Gt&&(this.index=(Gt.scopes||(Gt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=Gt;try{return Gt=this,e()}finally{Gt=t}}}on(){++this._on===1&&(this.prevScope=Gt,Gt=this)}off(){this._on>0&&--this._on===0&&(Gt=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let t,r;for(t=0,r=this.effects.length;t<r;t++)this.effects[t].stop();for(this.effects.length=0,t=0,r=this.cleanups.length;t<r;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function a1(n){return new o1(n)}function l1(){return Gt}function Uk(n,e=!1){Gt&&Gt.cleanups.push(n)}let Je;const af=new WeakSet;class c1{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Gt&&Gt.active&&Gt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,af.has(this)&&(af.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||h1(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,x0(this),d1(this);const e=Je,t=Gn;Je=this,Gn=!0;try{return this.fn()}finally{f1(this),Je=e,Gn=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)$m(e);this.deps=this.depsTail=void 0,x0(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?af.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){up(this)&&this.run()}get dirty(){return up(this)}}let u1=0,ja,Wa;function h1(n,e=!1){if(n.flags|=8,e){n.next=Wa,Wa=n;return}n.next=ja,ja=n}function Fm(){u1++}function Bm(){if(--u1>0)return;if(Wa){let e=Wa;for(Wa=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let n;for(;ja;){let e=ja;for(ja=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){n||(n=r)}e=t}}if(n)throw n}function d1(n){for(let e=n.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function f1(n){let e,t=n.depsTail,r=t;for(;r;){const s=r.prevDep;r.version===-1?(r===t&&(t=s),$m(r),zk(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=s}n.deps=e,n.depsTail=t}function up(n){for(let e=n.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(p1(e.dep.computed)||e.dep.version!==e.version))return!0;return!!n._dirty}function p1(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===gl)||(n.globalVersion=gl,!n.isSSR&&n.flags&128&&(!n.deps&&!n._dirty||!up(n))))return;n.flags|=2;const e=n.dep,t=Je,r=Gn;Je=n,Gn=!0;try{d1(n);const s=n.fn(n._value);(e.version===0||Fs(s,n._value))&&(n.flags|=128,n._value=s,e.version++)}catch(s){throw e.version++,s}finally{Je=t,Gn=r,f1(n),n.flags&=-3}}function $m(n,e=!1){const{dep:t,prevSub:r,nextSub:s}=n;if(r&&(r.nextSub=s,n.prevSub=void 0),s&&(s.prevSub=r,n.nextSub=void 0),t.subs===n&&(t.subs=r,!r&&t.computed)){t.computed.flags&=-5;for(let i=t.computed.deps;i;i=i.nextDep)$m(i,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function zk(n){const{prevDep:e,nextDep:t}=n;e&&(e.nextDep=t,n.prevDep=void 0),t&&(t.prevDep=e,n.nextDep=void 0)}let Gn=!0;const m1=[];function Yr(){m1.push(Gn),Gn=!1}function Xr(){const n=m1.pop();Gn=n===void 0?!0:n}function x0(n){const{cleanup:e}=n;if(n.cleanup=void 0,e){const t=Je;Je=void 0;try{e()}finally{Je=t}}}let gl=0,Hk=class{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}};class $h{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!Je||!Gn||Je===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==Je)t=this.activeLink=new Hk(Je,this),Je.deps?(t.prevDep=Je.depsTail,Je.depsTail.nextDep=t,Je.depsTail=t):Je.deps=Je.depsTail=t,g1(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const r=t.nextDep;r.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=r),t.prevDep=Je.depsTail,t.nextDep=void 0,Je.depsTail.nextDep=t,Je.depsTail=t,Je.deps===t&&(Je.deps=r)}return t}trigger(e){this.version++,gl++,this.notify(e)}notify(e){Fm();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{Bm()}}}function g1(n){if(n.dep.sc++,n.sub.flags&4){const e=n.dep.computed;if(e&&!n.dep.subs){e.flags|=20;for(let r=e.deps;r;r=r.nextDep)g1(r)}const t=n.dep.subs;t!==n&&(n.prevSub=t,t&&(t.nextSub=n)),n.dep.subs=n}}const _u=new WeakMap,Oi=Symbol(""),hp=Symbol(""),yl=Symbol("");function Yt(n,e,t){if(Gn&&Je){let r=_u.get(n);r||_u.set(n,r=new Map);let s=r.get(t);s||(r.set(t,s=new $h),s.map=r,s.key=t),s.track()}}function zr(n,e,t,r,s,i){const o=_u.get(n);if(!o){gl++;return}const a=l=>{l&&l.trigger()};if(Fm(),e==="clear")o.forEach(a);else{const l=ye(n),c=l&&Lm(t);if(l&&t==="length"){const u=Number(r);o.forEach((h,f)=>{(f==="length"||f===yl||!li(f)&&f>=u)&&a(h)})}else switch((t!==void 0||o.has(void 0))&&a(o.get(t)),c&&a(o.get(yl)),e){case"add":l?c&&a(o.get("length")):(a(o.get(Oi)),xo(n)&&a(o.get(hp)));break;case"delete":l||(a(o.get(Oi)),xo(n)&&a(o.get(hp)));break;case"set":xo(n)&&a(o.get(Oi));break}}Bm()}function jk(n,e){const t=_u.get(n);return t&&t.get(e)}function ho(n){const e=Le(n);return e===n?e:(Yt(e,"iterate",yl),Ln(n)?e:e.map(Vt))}function Uh(n){return Yt(n=Le(n),"iterate",yl),n}const Wk={__proto__:null,[Symbol.iterator](){return lf(this,Symbol.iterator,Vt)},concat(...n){return ho(this).concat(...n.map(e=>ye(e)?ho(e):e))},entries(){return lf(this,"entries",n=>(n[1]=Vt(n[1]),n))},every(n,e){return Mr(this,"every",n,e,void 0,arguments)},filter(n,e){return Mr(this,"filter",n,e,t=>t.map(Vt),arguments)},find(n,e){return Mr(this,"find",n,e,Vt,arguments)},findIndex(n,e){return Mr(this,"findIndex",n,e,void 0,arguments)},findLast(n,e){return Mr(this,"findLast",n,e,Vt,arguments)},findLastIndex(n,e){return Mr(this,"findLastIndex",n,e,void 0,arguments)},forEach(n,e){return Mr(this,"forEach",n,e,void 0,arguments)},includes(...n){return cf(this,"includes",n)},indexOf(...n){return cf(this,"indexOf",n)},join(n){return ho(this).join(n)},lastIndexOf(...n){return cf(this,"lastIndexOf",n)},map(n,e){return Mr(this,"map",n,e,void 0,arguments)},pop(){return Aa(this,"pop")},push(...n){return Aa(this,"push",n)},reduce(n,...e){return M0(this,"reduce",n,e)},reduceRight(n,...e){return M0(this,"reduceRight",n,e)},shift(){return Aa(this,"shift")},some(n,e){return Mr(this,"some",n,e,void 0,arguments)},splice(...n){return Aa(this,"splice",n)},toReversed(){return ho(this).toReversed()},toSorted(n){return ho(this).toSorted(n)},toSpliced(...n){return ho(this).toSpliced(...n)},unshift(...n){return Aa(this,"unshift",n)},values(){return lf(this,"values",Vt)}};function lf(n,e,t){const r=Uh(n),s=r[e]();return r!==n&&!Ln(n)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.value&&(i.value=t(i.value)),i}),s}const qk=Array.prototype;function Mr(n,e,t,r,s,i){const o=Uh(n),a=o!==n&&!Ln(n),l=o[e];if(l!==qk[e]){const h=l.apply(n,i);return a?Vt(h):h}let c=t;o!==n&&(a?c=function(h,f){return t.call(this,Vt(h),f,n)}:t.length>2&&(c=function(h,f){return t.call(this,h,f,n)}));const u=l.call(o,c,r);return a&&s?s(u):u}function M0(n,e,t,r){const s=Uh(n);let i=t;return s!==n&&(Ln(n)?t.length>3&&(i=function(o,a,l){return t.call(this,o,a,l,n)}):i=function(o,a,l){return t.call(this,o,Vt(a),l,n)}),s[e](i,...r)}function cf(n,e,t){const r=Le(n);Yt(r,"iterate",yl);const s=r[e](...t);return(s===-1||s===!1)&&Hm(t[0])?(t[0]=Le(t[0]),r[e](...t)):s}function Aa(n,e,t=[]){Yr(),Fm();const r=Le(n)[e].apply(n,t);return Bm(),Xr(),r}const Kk=Nm("__proto__,__v_isRef,__isVue"),y1=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(li));function Gk(n){li(n)||(n=String(n));const e=Le(this);return Yt(e,"has",n),e.hasOwnProperty(n)}class _1{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,r){if(t==="__v_skip")return e.__v_skip;const s=this._isReadonly,i=this._isShallow;if(t==="__v_isReactive")return!s;if(t==="__v_isReadonly")return s;if(t==="__v_isShallow")return i;if(t==="__v_raw")return r===(s?i?sR:E1:i?b1:w1).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const o=ye(e);if(!s){let l;if(o&&(l=Wk[t]))return l;if(t==="hasOwnProperty")return Gk}const a=Reflect.get(e,t,ot(e)?e:r);return(li(t)?y1.has(t):Kk(t))||(s||Yt(e,"get",t),i)?a:ot(a)?o&&Lm(t)?a:a.value:rt(a)?s?S1(a):Gl(a):a}}class v1 extends _1{constructor(e=!1){super(!1,e)}set(e,t,r,s){let i=e[t];if(!this._isShallow){const l=Qs(i);if(!Ln(r)&&!Qs(r)&&(i=Le(i),r=Le(r)),!ye(e)&&ot(i)&&!ot(r))return l||(i.value=r),!0}const o=ye(e)&&Lm(t)?Number(t)<e.length:Be(e,t),a=Reflect.set(e,t,r,ot(e)?e:s);return e===Le(s)&&(o?Fs(r,i)&&zr(e,"set",t,r):zr(e,"add",t,r)),a}deleteProperty(e,t){const r=Be(e,t);e[t];const s=Reflect.deleteProperty(e,t);return s&&r&&zr(e,"delete",t,void 0),s}has(e,t){const r=Reflect.has(e,t);return(!li(t)||!y1.has(t))&&Yt(e,"has",t),r}ownKeys(e){return Yt(e,"iterate",ye(e)?"length":Oi),Reflect.ownKeys(e)}}class Jk extends _1{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const Qk=new v1,Yk=new Jk,Xk=new v1(!0);const dp=n=>n,Sc=n=>Reflect.getPrototypeOf(n);function Zk(n,e,t){return function(...r){const s=this.__v_raw,i=Le(s),o=xo(i),a=n==="entries"||n===Symbol.iterator&&o,l=n==="keys"&&o,c=s[n](...r),u=t?dp:e?vu:Vt;return!e&&Yt(i,"iterate",l?hp:Oi),{next(){const{value:h,done:f}=c.next();return f?{value:h,done:f}:{value:a?[u(h[0]),u(h[1])]:u(h),done:f}},[Symbol.iterator](){return this}}}}function Cc(n){return function(...e){return n==="delete"?!1:n==="clear"?void 0:this}}function eR(n,e){const t={get(s){const i=this.__v_raw,o=Le(i),a=Le(s);n||(Fs(s,a)&&Yt(o,"get",s),Yt(o,"get",a));const{has:l}=Sc(o),c=e?dp:n?vu:Vt;if(l.call(o,s))return c(i.get(s));if(l.call(o,a))return c(i.get(a));i!==o&&i.get(s)},get size(){const s=this.__v_raw;return!n&&Yt(Le(s),"iterate",Oi),Reflect.get(s,"size",s)},has(s){const i=this.__v_raw,o=Le(i),a=Le(s);return n||(Fs(s,a)&&Yt(o,"has",s),Yt(o,"has",a)),s===a?i.has(s):i.has(s)||i.has(a)},forEach(s,i){const o=this,a=o.__v_raw,l=Le(a),c=e?dp:n?vu:Vt;return!n&&Yt(l,"iterate",Oi),a.forEach((u,h)=>s.call(i,c(u),c(h),o))}};return Pt(t,n?{add:Cc("add"),set:Cc("set"),delete:Cc("delete"),clear:Cc("clear")}:{add(s){!e&&!Ln(s)&&!Qs(s)&&(s=Le(s));const i=Le(this);return Sc(i).has.call(i,s)||(i.add(s),zr(i,"add",s,s)),this},set(s,i){!e&&!Ln(i)&&!Qs(i)&&(i=Le(i));const o=Le(this),{has:a,get:l}=Sc(o);let c=a.call(o,s);c||(s=Le(s),c=a.call(o,s));const u=l.call(o,s);return o.set(s,i),c?Fs(i,u)&&zr(o,"set",s,i):zr(o,"add",s,i),this},delete(s){const i=Le(this),{has:o,get:a}=Sc(i);let l=o.call(i,s);l||(s=Le(s),l=o.call(i,s)),a&&a.call(i,s);const c=i.delete(s);return l&&zr(i,"delete",s,void 0),c},clear(){const s=Le(this),i=s.size!==0,o=s.clear();return i&&zr(s,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=Zk(s,n,e)}),t}function Um(n,e){const t=eR(n,e);return(r,s,i)=>s==="__v_isReactive"?!n:s==="__v_isReadonly"?n:s==="__v_raw"?r:Reflect.get(Be(t,s)&&s in r?t:r,s,i)}const tR={get:Um(!1,!1)},nR={get:Um(!1,!0)},rR={get:Um(!0,!1)};const w1=new WeakMap,b1=new WeakMap,E1=new WeakMap,sR=new WeakMap;function iR(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function oR(n){return n.__v_skip||!Object.isExtensible(n)?0:iR(Mk(n))}function Gl(n){return Qs(n)?n:zm(n,!1,Qk,tR,w1)}function T1(n){return zm(n,!1,Xk,nR,b1)}function S1(n){return zm(n,!0,Yk,rR,E1)}function zm(n,e,t,r,s){if(!rt(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const i=oR(n);if(i===0)return n;const o=s.get(n);if(o)return o;const a=new Proxy(n,i===2?r:t);return s.set(n,a),a}function Bs(n){return Qs(n)?Bs(n.__v_raw):!!(n&&n.__v_isReactive)}function Qs(n){return!!(n&&n.__v_isReadonly)}function Ln(n){return!!(n&&n.__v_isShallow)}function Hm(n){return n?!!n.__v_raw:!1}function Le(n){const e=n&&n.__v_raw;return e?Le(e):n}function zh(n){return!Be(n,"__v_skip")&&Object.isExtensible(n)&&n1(n,"__v_skip",!0),n}const Vt=n=>rt(n)?Gl(n):n,vu=n=>rt(n)?S1(n):n;function ot(n){return n?n.__v_isRef===!0:!1}function $e(n){return A1(n,!1)}function C1(n){return A1(n,!0)}function A1(n,e){return ot(n)?n:new aR(n,e)}class aR{constructor(e,t){this.dep=new $h,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:Le(e),this._value=t?e:Vt(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,r=this.__v_isShallow||Ln(e)||Qs(e);e=r?e:Le(e),Fs(e,t)&&(this._rawValue=e,this._value=r?e:Vt(e),this.dep.trigger())}}function qe(n){return ot(n)?n.value:n}const lR={get:(n,e,t)=>e==="__v_raw"?n:qe(Reflect.get(n,e,t)),set:(n,e,t,r)=>{const s=n[e];return ot(s)&&!ot(t)?(s.value=t,!0):Reflect.set(n,e,t,r)}};function I1(n){return Bs(n)?n:new Proxy(n,lR)}class cR{constructor(e){this.__v_isRef=!0,this._value=void 0;const t=this.dep=new $h,{get:r,set:s}=e(t.track.bind(t),t.trigger.bind(t));this._get=r,this._set=s}get value(){return this._value=this._get()}set value(e){this._set(e)}}function uR(n){return new cR(n)}function hR(n){const e=ye(n)?new Array(n.length):{};for(const t in n)e[t]=fR(n,t);return e}class dR{constructor(e,t,r){this._object=e,this._key=t,this._defaultValue=r,this.__v_isRef=!0,this._value=void 0}get value(){const e=this._object[this._key];return this._value=e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return jk(Le(this._object),this._key)}}function fR(n,e,t){const r=n[e];return ot(r)?r:new dR(n,e,t)}class pR{constructor(e,t,r){this.fn=e,this.setter=t,this._value=void 0,this.dep=new $h(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=gl-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&Je!==this)return h1(this,!0),!0}get value(){const e=this.dep.track();return p1(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function mR(n,e,t=!1){let r,s;return be(n)?r=n:(r=n.get,s=n.set),new pR(r,s,t)}const Ac={},wu=new WeakMap;let Si;function gR(n,e=!1,t=Si){if(t){let r=wu.get(t);r||wu.set(t,r=[]),r.push(n)}}function yR(n,e,t=Ke){const{immediate:r,deep:s,once:i,scheduler:o,augmentJob:a,call:l}=t,c=D=>s?D:Ln(D)||s===!1||s===0?Hr(D,1):Hr(D);let u,h,f,p,m=!1,y=!1;if(ot(n)?(h=()=>n.value,m=Ln(n)):Bs(n)?(h=()=>c(n),m=!0):ye(n)?(y=!0,m=n.some(D=>Bs(D)||Ln(D)),h=()=>n.map(D=>{if(ot(D))return D.value;if(Bs(D))return c(D);if(be(D))return l?l(D,2):D()})):be(n)?e?h=l?()=>l(n,2):n:h=()=>{if(f){Yr();try{f()}finally{Xr()}}const D=Si;Si=u;try{return l?l(n,3,[p]):n(p)}finally{Si=D}}:h=dr,e&&s){const D=h,L=s===!0?1/0:s;h=()=>Hr(D(),L)}const v=l1(),T=()=>{u.stop(),v&&v.active&&Dm(v.effects,u)};if(i&&e){const D=e;e=(...L)=>{D(...L),T()}}let M=y?new Array(n.length).fill(Ac):Ac;const P=D=>{if(!(!(u.flags&1)||!u.dirty&&!D))if(e){const L=u.run();if(s||m||(y?L.some((q,S)=>Fs(q,M[S])):Fs(L,M))){f&&f();const q=Si;Si=u;try{const S=[L,M===Ac?void 0:y&&M[0]===Ac?[]:M,p];M=L,l?l(e,3,S):e(...S)}finally{Si=q}}}else u.run()};return a&&a(P),u=new c1(h),u.scheduler=o?()=>o(P,!1):P,p=D=>gR(D,!1,u),f=u.onStop=()=>{const D=wu.get(u);if(D){if(l)l(D,4);else for(const L of D)L();wu.delete(u)}},e?r?P(!0):M=u.run():o?o(P.bind(null,!0),!0):u.run(),T.pause=u.pause.bind(u),T.resume=u.resume.bind(u),T.stop=T,T}function Hr(n,e=1/0,t){if(e<=0||!rt(n)||n.__v_skip||(t=t||new Set,t.has(n)))return n;if(t.add(n),e--,ot(n))Hr(n.value,e,t);else if(ye(n))for(let r=0;r<n.length;r++)Hr(n[r],e,t);else if(Xb(n)||xo(n))n.forEach(r=>{Hr(r,e,t)});else if(t1(n)){for(const r in n)Hr(n[r],e,t);for(const r of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,r)&&Hr(n[r],e,t)}return n}/**
* @vue/runtime-core v3.5.19
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Jl(n,e,t,r){try{return r?n(...r):n()}catch(s){Hh(s,e,t)}}function Qn(n,e,t,r){if(be(n)){const s=Jl(n,e,t,r);return s&&Zb(s)&&s.catch(i=>{Hh(i,e,t)}),s}if(ye(n)){const s=[];for(let i=0;i<n.length;i++)s.push(Qn(n[i],e,t,r));return s}}function Hh(n,e,t,r=!0){const s=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||Ke;if(e){let a=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${t}`;for(;a;){const u=a.ec;if(u){for(let h=0;h<u.length;h++)if(u[h](n,l,c)===!1)return}a=a.parent}if(i){Yr(),Jl(i,null,10,[n,l,c]),Xr();return}}_R(n,t,s,r,o)}function _R(n,e,t,r=!0,s=!1){if(s)throw n;console.error(n)}const ln=[];let ir=-1;const Mo=[];let ws=null,go=0;const k1=Promise.resolve();let bu=null;function jh(n){const e=bu||k1;return n?e.then(this?n.bind(this):n):e}function vR(n){let e=ir+1,t=ln.length;for(;e<t;){const r=e+t>>>1,s=ln[r],i=_l(s);i<n||i===n&&s.flags&2?e=r+1:t=r}return e}function jm(n){if(!(n.flags&1)){const e=_l(n),t=ln[ln.length-1];!t||!(n.flags&2)&&e>=_l(t)?ln.push(n):ln.splice(vR(e),0,n),n.flags|=1,R1()}}function R1(){bu||(bu=k1.then(M1))}function wR(n){ye(n)?Mo.push(...n):ws&&n.id===-1?ws.splice(go+1,0,n):n.flags&1||(Mo.push(n),n.flags|=1),R1()}function P0(n,e,t=ir+1){for(;t<ln.length;t++){const r=ln[t];if(r&&r.flags&2){if(n&&r.id!==n.uid)continue;ln.splice(t,1),t--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function x1(n){if(Mo.length){const e=[...new Set(Mo)].sort((t,r)=>_l(t)-_l(r));if(Mo.length=0,ws){ws.push(...e);return}for(ws=e,go=0;go<ws.length;go++){const t=ws[go];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}ws=null,go=0}}const _l=n=>n.id==null?n.flags&2?-1:1/0:n.id;function M1(n){try{for(ir=0;ir<ln.length;ir++){const e=ln[ir];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Jl(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;ir<ln.length;ir++){const e=ln[ir];e&&(e.flags&=-2)}ir=-1,ln.length=0,x1(),bu=null,(ln.length||Mo.length)&&M1()}}let Cn=null,P1=null;function Eu(n){const e=Cn;return Cn=n,P1=n&&n.type.__scopeId||null,e}function Ns(n,e=Cn,t){if(!e||n._n)return n;const r=(...s)=>{r._d&&H0(-1);const i=Eu(e);let o;try{o=n(...s)}finally{Eu(i),r._d&&H0(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function Hn(n,e){if(Cn===null)return n;const t=Zh(Cn),r=n.dirs||(n.dirs=[]);for(let s=0;s<e.length;s++){let[i,o,a,l=Ke]=e[s];i&&(be(i)&&(i={mounted:i,updated:i}),i.deep&&Hr(o),r.push({dir:i,instance:t,value:o,oldValue:void 0,arg:a,modifiers:l}))}return n}function vi(n,e,t,r){const s=n.dirs,i=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];i&&(a.oldValue=i[o].value);let l=a.dir[r];l&&(Yr(),Qn(l,t,8,[n.el,a,n,e]),Xr())}}const bR=Symbol("_vte"),N1=n=>n.__isTeleport,Ur=Symbol("_leaveCb"),Ic=Symbol("_enterCb");function ER(){const n={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Ar(()=>{n.isMounted=!0}),Kh(()=>{n.isUnmounting=!0}),n}const Rn=[Function,Array],O1={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Rn,onEnter:Rn,onAfterEnter:Rn,onEnterCancelled:Rn,onBeforeLeave:Rn,onLeave:Rn,onAfterLeave:Rn,onLeaveCancelled:Rn,onBeforeAppear:Rn,onAppear:Rn,onAfterAppear:Rn,onAppearCancelled:Rn},D1=n=>{const e=n.subTree;return e.component?D1(e.component):e},TR={name:"BaseTransition",props:O1,setup(n,{slots:e}){const t=Xh(),r=ER();return()=>{const s=e.default&&F1(e.default(),!0);if(!s||!s.length)return;const i=L1(s),o=Le(n),{mode:a}=o;if(r.isLeaving)return uf(i);const l=N0(i);if(!l)return uf(i);let c=fp(l,o,r,t,h=>c=h);l.type!==cn&&vl(l,c);let u=t.subTree&&N0(t.subTree);if(u&&u.type!==cn&&!Ai(l,u)&&D1(t).type!==cn){let h=fp(u,o,r,t);if(vl(u,h),a==="out-in"&&l.type!==cn)return r.isLeaving=!0,h.afterLeave=()=>{r.isLeaving=!1,t.job.flags&8||t.update(),delete h.afterLeave,u=void 0},uf(i);a==="in-out"&&l.type!==cn?h.delayLeave=(f,p,m)=>{const y=V1(r,u);y[String(u.key)]=u,f[Ur]=()=>{p(),f[Ur]=void 0,delete c.delayedLeave,u=void 0},c.delayedLeave=()=>{m(),delete c.delayedLeave,u=void 0}}:u=void 0}else u&&(u=void 0);return i}}};function L1(n){let e=n[0];if(n.length>1){for(const t of n)if(t.type!==cn){e=t;break}}return e}const SR=TR;function V1(n,e){const{leavingVNodes:t}=n;let r=t.get(e.type);return r||(r=Object.create(null),t.set(e.type,r)),r}function fp(n,e,t,r,s){const{appear:i,mode:o,persisted:a=!1,onBeforeEnter:l,onEnter:c,onAfterEnter:u,onEnterCancelled:h,onBeforeLeave:f,onLeave:p,onAfterLeave:m,onLeaveCancelled:y,onBeforeAppear:v,onAppear:T,onAfterAppear:M,onAppearCancelled:P}=e,D=String(n.key),L=V1(t,n),q=(b,I)=>{b&&Qn(b,r,9,I)},S=(b,I)=>{const R=I[1];q(b,I),ye(b)?b.every(k=>k.length<=1)&&R():b.length<=1&&R()},w={mode:o,persisted:a,beforeEnter(b){let I=l;if(!t.isMounted)if(i)I=v||l;else return;b[Ur]&&b[Ur](!0);const R=L[D];R&&Ai(n,R)&&R.el[Ur]&&R.el[Ur](),q(I,[b])},enter(b){let I=c,R=u,k=h;if(!t.isMounted)if(i)I=T||c,R=M||u,k=P||h;else return;let C=!1;const _e=b[Ic]=Ae=>{C||(C=!0,Ae?q(k,[b]):q(R,[b]),w.delayedLeave&&w.delayedLeave(),b[Ic]=void 0)};I?S(I,[b,_e]):_e()},leave(b,I){const R=String(n.key);if(b[Ic]&&b[Ic](!0),t.isUnmounting)return I();q(f,[b]);let k=!1;const C=b[Ur]=_e=>{k||(k=!0,I(),_e?q(y,[b]):q(m,[b]),b[Ur]=void 0,L[R]===n&&delete L[R])};L[R]=n,p?S(p,[b,C]):C()},clone(b){const I=fp(b,e,t,r,s);return s&&s(I),I}};return w}function uf(n){if(Wh(n))return n=Ys(n),n.children=null,n}function N0(n){if(!Wh(n))return N1(n.type)&&n.children?L1(n.children):n;if(n.component)return n.component.subTree;const{shapeFlag:e,children:t}=n;if(t){if(e&16)return t[0];if(e&32&&be(t.default))return t.default()}}function vl(n,e){n.shapeFlag&6&&n.component?(n.transition=e,vl(n.component.subTree,e)):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}function F1(n,e=!1,t){let r=[],s=0;for(let i=0;i<n.length;i++){let o=n[i];const a=t==null?o.key:String(t)+String(o.key!=null?o.key:i);o.type===Xt?(o.patchFlag&128&&s++,r=r.concat(F1(o.children,e,a))):(e||o.type!==cn)&&r.push(a!=null?Ys(o,{key:a}):o)}if(s>1)for(let i=0;i<r.length;i++)r[i].patchFlag=-2;return r}/*! #__NO_SIDE_EFFECTS__ */function Wm(n,e){return be(n)?Pt({name:n.name},e,{setup:n}):n}function B1(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}function qa(n,e,t,r,s=!1){if(ye(n)){n.forEach((m,y)=>qa(m,e&&(ye(e)?e[y]:e),t,r,s));return}if(Ka(r)&&!s){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&qa(n,e,t,r.component.subTree);return}const i=r.shapeFlag&4?Zh(r.component):r.el,o=s?null:i,{i:a,r:l}=n,c=e&&e.r,u=a.refs===Ke?a.refs={}:a.refs,h=a.setupState,f=Le(h),p=h===Ke?Yb:m=>Be(f,m);if(c!=null&&c!==l){if(mt(c))u[c]=null,p(c)&&(h[c]=null);else if(ot(c)){c.value=null;const m=e;m.k&&(u[m.k]=null)}}if(be(l))Jl(l,a,12,[o,u]);else{const m=mt(l),y=ot(l);if(m||y){const v=()=>{if(n.f){const T=m?p(l)?h[l]:u[l]:l.value;if(s)ye(T)&&Dm(T,i);else if(ye(T))T.includes(i)||T.push(i);else if(m)u[l]=[i],p(l)&&(h[l]=u[l]);else{const M=[i];l.value=M,n.k&&(u[n.k]=M)}}else m?(u[l]=o,p(l)&&(h[l]=o)):y&&(l.value=o,n.k&&(u[n.k]=o))};o?(v.id=-1,En(v,t)):v()}}}Bh().requestIdleCallback;Bh().cancelIdleCallback;const Ka=n=>!!n.type.__asyncLoader,Wh=n=>n.type.__isKeepAlive;function CR(n,e){$1(n,"a",e)}function AR(n,e){$1(n,"da",e)}function $1(n,e,t=en){const r=n.__wdc||(n.__wdc=()=>{let s=t;for(;s;){if(s.isDeactivated)return;s=s.parent}return n()});if(qh(e,r,t),t){let s=t.parent;for(;s&&s.parent;)Wh(s.parent.vnode)&&IR(r,e,t,s),s=s.parent}}function IR(n,e,t,r){const s=qh(e,n,r,!0);Gh(()=>{Dm(r[e],s)},t)}function qh(n,e,t=en,r=!1){if(t){const s=t[n]||(t[n]=[]),i=e.__weh||(e.__weh=(...o)=>{Yr();const a=Ql(t),l=Qn(e,t,n,o);return a(),Xr(),l});return r?s.unshift(i):s.push(i),i}}const rs=n=>(e,t=en)=>{(!bl||n==="sp")&&qh(n,(...r)=>e(...r),t)},kR=rs("bm"),Ar=rs("m"),RR=rs("bu"),xR=rs("u"),Kh=rs("bum"),Gh=rs("um"),MR=rs("sp"),PR=rs("rtg"),NR=rs("rtc");function OR(n,e=en){qh("ec",n,e)}const DR="components";function Tu(n,e){return VR(DR,n,!0,e)||n}const LR=Symbol.for("v-ndc");function VR(n,e,t=!0,r=!1){const s=Cn||en;if(s){const i=s.type;{const a=Cx(i,!1);if(a&&(a===e||a===$n(e)||a===Fh($n(e))))return i}const o=O0(s[n]||i[n],e)||O0(s.appContext[n],e);return!o&&r?i:o}}function O0(n,e){return n&&(n[e]||n[$n(e)]||n[Fh($n(e))])}function Ga(n,e,t,r){let s;const i=t,o=ye(n);if(o||mt(n)){const a=o&&Bs(n);let l=!1,c=!1;a&&(l=!Ln(n),c=Qs(n),n=Uh(n)),s=new Array(n.length);for(let u=0,h=n.length;u<h;u++)s[u]=e(l?c?vu(Vt(n[u])):Vt(n[u]):n[u],u,void 0,i)}else if(typeof n=="number"){s=new Array(n);for(let a=0;a<n;a++)s[a]=e(a+1,a,void 0,i)}else if(rt(n))if(n[Symbol.iterator])s=Array.from(n,(a,l)=>e(a,l,void 0,i));else{const a=Object.keys(n);s=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const u=a[l];s[l]=e(n[u],u,l,i)}}else s=[];return s}const pp=n=>n?oE(n)?Zh(n):pp(n.parent):null,Ja=Pt(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>pp(n.parent),$root:n=>pp(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>z1(n),$forceUpdate:n=>n.f||(n.f=()=>{jm(n.update)}),$nextTick:n=>n.n||(n.n=jh.bind(n.proxy)),$watch:n=>ox.bind(n)}),hf=(n,e)=>n!==Ke&&!n.__isScriptSetup&&Be(n,e),FR={get({_:n},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:r,data:s,props:i,accessCache:o,type:a,appContext:l}=n;let c;if(e[0]!=="$"){const p=o[e];if(p!==void 0)switch(p){case 1:return r[e];case 2:return s[e];case 4:return t[e];case 3:return i[e]}else{if(hf(r,e))return o[e]=1,r[e];if(s!==Ke&&Be(s,e))return o[e]=2,s[e];if((c=n.propsOptions[0])&&Be(c,e))return o[e]=3,i[e];if(t!==Ke&&Be(t,e))return o[e]=4,t[e];mp&&(o[e]=0)}}const u=Ja[e];let h,f;if(u)return e==="$attrs"&&Yt(n.attrs,"get",""),u(n);if((h=a.__cssModules)&&(h=h[e]))return h;if(t!==Ke&&Be(t,e))return o[e]=4,t[e];if(f=l.config.globalProperties,Be(f,e))return f[e]},set({_:n},e,t){const{data:r,setupState:s,ctx:i}=n;return hf(s,e)?(s[e]=t,!0):r!==Ke&&Be(r,e)?(r[e]=t,!0):Be(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(i[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:r,appContext:s,propsOptions:i,type:o}},a){let l,c;return!!(t[a]||n!==Ke&&a[0]!=="$"&&Be(n,a)||hf(e,a)||(l=i[0])&&Be(l,a)||Be(r,a)||Be(Ja,a)||Be(s.config.globalProperties,a)||(c=o.__cssModules)&&c[a])},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:Be(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};function D0(n){return ye(n)?n.reduce((e,t)=>(e[t]=null,e),{}):n}let mp=!0;function BR(n){const e=z1(n),t=n.proxy,r=n.ctx;mp=!1,e.beforeCreate&&L0(e.beforeCreate,n,"bc");const{data:s,computed:i,methods:o,watch:a,provide:l,inject:c,created:u,beforeMount:h,mounted:f,beforeUpdate:p,updated:m,activated:y,deactivated:v,beforeDestroy:T,beforeUnmount:M,destroyed:P,unmounted:D,render:L,renderTracked:q,renderTriggered:S,errorCaptured:w,serverPrefetch:b,expose:I,inheritAttrs:R,components:k,directives:C,filters:_e}=e;if(c&&$R(c,r,null),o)for(const fe in o){const Ne=o[fe];be(Ne)&&(r[fe]=Ne.bind(t))}if(s){const fe=s.call(t,t);rt(fe)&&(n.data=Gl(fe))}if(mp=!0,i)for(const fe in i){const Ne=i[fe],fn=be(Ne)?Ne.bind(t,t):be(Ne.get)?Ne.get.bind(t,t):dr,tr=!be(Ne)&&be(Ne.set)?Ne.set.bind(t):dr,_n=un({get:fn,set:tr});Object.defineProperty(r,fe,{enumerable:!0,configurable:!0,get:()=>_n.value,set:Nt=>_n.value=Nt})}if(a)for(const fe in a)U1(a[fe],r,t,fe);if(l){const fe=be(l)?l.call(t):l;Reflect.ownKeys(fe).forEach(Ne=>{Yc(Ne,fe[Ne])})}u&&L0(u,n,"c");function Re(fe,Ne){ye(Ne)?Ne.forEach(fn=>fe(fn.bind(t))):Ne&&fe(Ne.bind(t))}if(Re(kR,h),Re(Ar,f),Re(RR,p),Re(xR,m),Re(CR,y),Re(AR,v),Re(OR,w),Re(NR,q),Re(PR,S),Re(Kh,M),Re(Gh,D),Re(MR,b),ye(I))if(I.length){const fe=n.exposed||(n.exposed={});I.forEach(Ne=>{Object.defineProperty(fe,Ne,{get:()=>t[Ne],set:fn=>t[Ne]=fn,enumerable:!0})})}else n.exposed||(n.exposed={});L&&n.render===dr&&(n.render=L),R!=null&&(n.inheritAttrs=R),k&&(n.components=k),C&&(n.directives=C),b&&B1(n)}function $R(n,e,t=dr){ye(n)&&(n=gp(n));for(const r in n){const s=n[r];let i;rt(s)?"default"in s?i=Vn(s.from||r,s.default,!0):i=Vn(s.from||r):i=Vn(s),ot(i)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[r]=i}}function L0(n,e,t){Qn(ye(n)?n.map(r=>r.bind(e.proxy)):n.bind(e.proxy),e,t)}function U1(n,e,t,r){let s=r.includes(".")?eE(t,r):()=>t[r];if(mt(n)){const i=e[n];be(i)&&Po(s,i)}else if(be(n))Po(s,n.bind(t));else if(rt(n))if(ye(n))n.forEach(i=>U1(i,e,t,r));else{const i=be(n.handler)?n.handler.bind(t):e[n.handler];be(i)&&Po(s,i,n)}}function z1(n){const e=n.type,{mixins:t,extends:r}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=n.appContext,a=i.get(e);let l;return a?l=a:!s.length&&!t&&!r?l=e:(l={},s.length&&s.forEach(c=>Su(l,c,o,!0)),Su(l,e,o)),rt(e)&&i.set(e,l),l}function Su(n,e,t,r=!1){const{mixins:s,extends:i}=e;i&&Su(n,i,t,!0),s&&s.forEach(o=>Su(n,o,t,!0));for(const o in e)if(!(r&&o==="expose")){const a=UR[o]||t&&t[o];n[o]=a?a(n[o],e[o]):e[o]}return n}const UR={data:V0,props:F0,emits:F0,methods:Pa,computed:Pa,beforeCreate:an,created:an,beforeMount:an,mounted:an,beforeUpdate:an,updated:an,beforeDestroy:an,beforeUnmount:an,destroyed:an,unmounted:an,activated:an,deactivated:an,errorCaptured:an,serverPrefetch:an,components:Pa,directives:Pa,watch:HR,provide:V0,inject:zR};function V0(n,e){return e?n?function(){return Pt(be(n)?n.call(this,this):n,be(e)?e.call(this,this):e)}:e:n}function zR(n,e){return Pa(gp(n),gp(e))}function gp(n){if(ye(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function an(n,e){return n?[...new Set([].concat(n,e))]:e}function Pa(n,e){return n?Pt(Object.create(null),n,e):e}function F0(n,e){return n?ye(n)&&ye(e)?[...new Set([...n,...e])]:Pt(Object.create(null),D0(n),D0(e??{})):e}function HR(n,e){if(!n)return e;if(!e)return n;const t=Pt(Object.create(null),n);for(const r in e)t[r]=an(n[r],e[r]);return t}function H1(){return{app:null,config:{isNativeTag:Yb,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let jR=0;function WR(n,e){return function(r,s=null){be(r)||(r=Pt({},r)),s!=null&&!rt(s)&&(s=null);const i=H1(),o=new WeakSet,a=[];let l=!1;const c=i.app={_uid:jR++,_component:r,_props:s,_container:null,_context:i,_instance:null,version:Ix,get config(){return i.config},set config(u){},use(u,...h){return o.has(u)||(u&&be(u.install)?(o.add(u),u.install(c,...h)):be(u)&&(o.add(u),u(c,...h))),c},mixin(u){return i.mixins.includes(u)||i.mixins.push(u),c},component(u,h){return h?(i.components[u]=h,c):i.components[u]},directive(u,h){return h?(i.directives[u]=h,c):i.directives[u]},mount(u,h,f){if(!l){const p=c._ceVNode||ke(r,s);return p.appContext=i,f===!0?f="svg":f===!1&&(f=void 0),n(p,u,f),l=!0,c._container=u,u.__vue_app__=c,Zh(p.component)}},onUnmount(u){a.push(u)},unmount(){l&&(Qn(a,c._instance,16),n(null,c._container),delete c._container.__vue_app__)},provide(u,h){return i.provides[u]=h,c},runWithContext(u){const h=Di;Di=c;try{return u()}finally{Di=h}}};return c}}let Di=null;function Yc(n,e){if(en){let t=en.provides;const r=en.parent&&en.parent.provides;r===t&&(t=en.provides=Object.create(r)),t[n]=e}}function Vn(n,e,t=!1){const r=Xh();if(r||Di){let s=Di?Di._context.provides:r?r.parent==null||r.ce?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(s&&n in s)return s[n];if(arguments.length>1)return t&&be(e)?e.call(r&&r.proxy):e}}function qR(){return!!(Xh()||Di)}const j1={},W1=()=>Object.create(j1),q1=n=>Object.getPrototypeOf(n)===j1;function KR(n,e,t,r=!1){const s={},i=W1();n.propsDefaults=Object.create(null),K1(n,e,s,i);for(const o in n.propsOptions[0])o in s||(s[o]=void 0);t?n.props=r?s:T1(s):n.type.props?n.props=s:n.props=i,n.attrs=i}function GR(n,e,t,r){const{props:s,attrs:i,vnode:{patchFlag:o}}=n,a=Le(s),[l]=n.propsOptions;let c=!1;if((r||o>0)&&!(o&16)){if(o&8){const u=n.vnode.dynamicProps;for(let h=0;h<u.length;h++){let f=u[h];if(Jh(n.emitsOptions,f))continue;const p=e[f];if(l)if(Be(i,f))p!==i[f]&&(i[f]=p,c=!0);else{const m=$n(f);s[m]=yp(l,a,m,p,n,!1)}else p!==i[f]&&(i[f]=p,c=!0)}}}else{K1(n,e,s,i)&&(c=!0);let u;for(const h in a)(!e||!Be(e,h)&&((u=Zi(h))===h||!Be(e,u)))&&(l?t&&(t[h]!==void 0||t[u]!==void 0)&&(s[h]=yp(l,a,h,void 0,n,!0)):delete s[h]);if(i!==a)for(const h in i)(!e||!Be(e,h))&&(delete i[h],c=!0)}c&&zr(n.attrs,"set","")}function K1(n,e,t,r){const[s,i]=n.propsOptions;let o=!1,a;if(e)for(let l in e){if(Ha(l))continue;const c=e[l];let u;s&&Be(s,u=$n(l))?!i||!i.includes(u)?t[u]=c:(a||(a={}))[u]=c:Jh(n.emitsOptions,l)||(!(l in r)||c!==r[l])&&(r[l]=c,o=!0)}if(i){const l=Le(t),c=a||Ke;for(let u=0;u<i.length;u++){const h=i[u];t[h]=yp(s,l,h,c[h],n,!Be(c,h))}}return o}function yp(n,e,t,r,s,i){const o=n[t];if(o!=null){const a=Be(o,"default");if(a&&r===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&be(l)){const{propsDefaults:c}=s;if(t in c)r=c[t];else{const u=Ql(s);r=c[t]=l.call(null,e),u()}}else r=l;s.ce&&s.ce._setProp(t,r)}o[0]&&(i&&!a?r=!1:o[1]&&(r===""||r===Zi(t))&&(r=!0))}return r}const JR=new WeakMap;function G1(n,e,t=!1){const r=t?JR:e.propsCache,s=r.get(n);if(s)return s;const i=n.props,o={},a=[];let l=!1;if(!be(n)){const u=h=>{l=!0;const[f,p]=G1(h,e,!0);Pt(o,f),p&&a.push(...p)};!t&&e.mixins.length&&e.mixins.forEach(u),n.extends&&u(n.extends),n.mixins&&n.mixins.forEach(u)}if(!i&&!l)return rt(n)&&r.set(n,Ro),Ro;if(ye(i))for(let u=0;u<i.length;u++){const h=$n(i[u]);B0(h)&&(o[h]=Ke)}else if(i)for(const u in i){const h=$n(u);if(B0(h)){const f=i[u],p=o[h]=ye(f)||be(f)?{type:f}:Pt({},f),m=p.type;let y=!1,v=!0;if(ye(m))for(let T=0;T<m.length;++T){const M=m[T],P=be(M)&&M.name;if(P==="Boolean"){y=!0;break}else P==="String"&&(v=!1)}else y=be(m)&&m.name==="Boolean";p[0]=y,p[1]=v,(y||Be(p,"default"))&&a.push(h)}}const c=[o,a];return rt(n)&&r.set(n,c),c}function B0(n){return n[0]!=="$"&&!Ha(n)}const qm=n=>n==="_"||n==="_ctx"||n==="$stable",Km=n=>ye(n)?n.map(ur):[ur(n)],QR=(n,e,t)=>{if(e._n)return e;const r=Ns((...s)=>Km(e(...s)),t);return r._c=!1,r},J1=(n,e,t)=>{const r=n._ctx;for(const s in n){if(qm(s))continue;const i=n[s];if(be(i))e[s]=QR(s,i,r);else if(i!=null){const o=Km(i);e[s]=()=>o}}},Q1=(n,e)=>{const t=Km(e);n.slots.default=()=>t},Y1=(n,e,t)=>{for(const r in e)(t||!qm(r))&&(n[r]=e[r])},YR=(n,e,t)=>{const r=n.slots=W1();if(n.vnode.shapeFlag&32){const s=e._;s?(Y1(r,e,t),t&&n1(r,"_",s,!0)):J1(e,r)}else e&&Q1(n,e)},XR=(n,e,t)=>{const{vnode:r,slots:s}=n;let i=!0,o=Ke;if(r.shapeFlag&32){const a=e._;a?t&&a===1?i=!1:Y1(s,e,t):(i=!e.$stable,J1(e,s)),o=e}else e&&(Q1(n,e),o={default:1});if(i)for(const a in s)!qm(a)&&o[a]==null&&delete s[a]},En=fx;function ZR(n){return ex(n)}function ex(n,e){const t=Bh();t.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:o,createText:a,createComment:l,setText:c,setElementText:u,parentNode:h,nextSibling:f,setScopeId:p=dr,insertStaticContent:m}=n,y=(A,x,N,U=null,j=null,F=null,Z=void 0,J=null,K=!!x.dynamicChildren)=>{if(A===x)return;A&&!Ai(A,x)&&(U=$(A),Nt(A,j,F,!0),A=null),x.patchFlag===-2&&(K=!1,x.dynamicChildren=null);const{type:G,ref:he,shapeFlag:te}=x;switch(G){case Qh:v(A,x,N,U);break;case cn:T(A,x,N,U);break;case Xc:A==null&&M(x,N,U,Z);break;case Xt:k(A,x,N,U,j,F,Z,J,K);break;default:te&1?L(A,x,N,U,j,F,Z,J,K):te&6?C(A,x,N,U,j,F,Z,J,K):(te&64||te&128)&&G.process(A,x,N,U,j,F,Z,J,K,ie)}he!=null&&j?qa(he,A&&A.ref,F,x||A,!x):he==null&&A&&A.ref!=null&&qa(A.ref,null,F,A,!0)},v=(A,x,N,U)=>{if(A==null)r(x.el=a(x.children),N,U);else{const j=x.el=A.el;x.children!==A.children&&c(j,x.children)}},T=(A,x,N,U)=>{A==null?r(x.el=l(x.children||""),N,U):x.el=A.el},M=(A,x,N,U)=>{[A.el,A.anchor]=m(A.children,x,N,U,A.el,A.anchor)},P=({el:A,anchor:x},N,U)=>{let j;for(;A&&A!==x;)j=f(A),r(A,N,U),A=j;r(x,N,U)},D=({el:A,anchor:x})=>{let N;for(;A&&A!==x;)N=f(A),s(A),A=N;s(x)},L=(A,x,N,U,j,F,Z,J,K)=>{x.type==="svg"?Z="svg":x.type==="math"&&(Z="mathml"),A==null?q(x,N,U,j,F,Z,J,K):b(A,x,j,F,Z,J,K)},q=(A,x,N,U,j,F,Z,J)=>{let K,G;const{props:he,shapeFlag:te,transition:ce,dirs:de}=A;if(K=A.el=o(A.type,F,he&&he.is,he),te&8?u(K,A.children):te&16&&w(A.children,K,null,U,j,df(A,F),Z,J),de&&vi(A,null,U,"created"),S(K,A,A.scopeId,Z,U),he){for(const He in he)He!=="value"&&!Ha(He)&&i(K,He,null,he[He],F,U);"value"in he&&i(K,"value",null,he.value,F),(G=he.onVnodeBeforeMount)&&sr(G,U,A)}de&&vi(A,null,U,"beforeMount");const Ie=tx(j,ce);Ie&&ce.beforeEnter(K),r(K,x,N),((G=he&&he.onVnodeMounted)||Ie||de)&&En(()=>{G&&sr(G,U,A),Ie&&ce.enter(K),de&&vi(A,null,U,"mounted")},j)},S=(A,x,N,U,j)=>{if(N&&p(A,N),U)for(let F=0;F<U.length;F++)p(A,U[F]);if(j){let F=j.subTree;if(x===F||nE(F.type)&&(F.ssContent===x||F.ssFallback===x)){const Z=j.vnode;S(A,Z,Z.scopeId,Z.slotScopeIds,j.parent)}}},w=(A,x,N,U,j,F,Z,J,K=0)=>{for(let G=K;G<A.length;G++){const he=A[G]=J?bs(A[G]):ur(A[G]);y(null,he,x,N,U,j,F,Z,J)}},b=(A,x,N,U,j,F,Z)=>{const J=x.el=A.el;let{patchFlag:K,dynamicChildren:G,dirs:he}=x;K|=A.patchFlag&16;const te=A.props||Ke,ce=x.props||Ke;let de;if(N&&wi(N,!1),(de=ce.onVnodeBeforeUpdate)&&sr(de,N,x,A),he&&vi(x,A,N,"beforeUpdate"),N&&wi(N,!0),(te.innerHTML&&ce.innerHTML==null||te.textContent&&ce.textContent==null)&&u(J,""),G?I(A.dynamicChildren,G,J,N,U,df(x,j),F):Z||Ne(A,x,J,null,N,U,df(x,j),F,!1),K>0){if(K&16)R(J,te,ce,N,j);else if(K&2&&te.class!==ce.class&&i(J,"class",null,ce.class,j),K&4&&i(J,"style",te.style,ce.style,j),K&8){const Ie=x.dynamicProps;for(let He=0;He<Ie.length;He++){const De=Ie[He],Wt=te[De],qt=ce[De];(qt!==Wt||De==="value")&&i(J,De,Wt,qt,j,N)}}K&1&&A.children!==x.children&&u(J,x.children)}else!Z&&G==null&&R(J,te,ce,N,j);((de=ce.onVnodeUpdated)||he)&&En(()=>{de&&sr(de,N,x,A),he&&vi(x,A,N,"updated")},U)},I=(A,x,N,U,j,F,Z)=>{for(let J=0;J<x.length;J++){const K=A[J],G=x[J],he=K.el&&(K.type===Xt||!Ai(K,G)||K.shapeFlag&198)?h(K.el):N;y(K,G,he,null,U,j,F,Z,!0)}},R=(A,x,N,U,j)=>{if(x!==N){if(x!==Ke)for(const F in x)!Ha(F)&&!(F in N)&&i(A,F,x[F],null,j,U);for(const F in N){if(Ha(F))continue;const Z=N[F],J=x[F];Z!==J&&F!=="value"&&i(A,F,J,Z,j,U)}"value"in N&&i(A,"value",x.value,N.value,j)}},k=(A,x,N,U,j,F,Z,J,K)=>{const G=x.el=A?A.el:a(""),he=x.anchor=A?A.anchor:a("");let{patchFlag:te,dynamicChildren:ce,slotScopeIds:de}=x;de&&(J=J?J.concat(de):de),A==null?(r(G,N,U),r(he,N,U),w(x.children||[],N,he,j,F,Z,J,K)):te>0&&te&64&&ce&&A.dynamicChildren?(I(A.dynamicChildren,ce,N,j,F,Z,J),(x.key!=null||j&&x===j.subTree)&&X1(A,x,!0)):Ne(A,x,N,he,j,F,Z,J,K)},C=(A,x,N,U,j,F,Z,J,K)=>{x.slotScopeIds=J,A==null?x.shapeFlag&512?j.ctx.activate(x,N,U,Z,K):_e(x,N,U,j,F,Z,K):Ae(A,x,K)},_e=(A,x,N,U,j,F,Z)=>{const J=A.component=wx(A,U,j);if(Wh(A)&&(J.ctx.renderer=ie),bx(J,!1,Z),J.asyncDep){if(j&&j.registerDep(J,Re,Z),!A.el){const K=J.subTree=ke(cn);T(null,K,x,N),A.placeholder=K.el}}else Re(J,A,x,N,j,F,Z)},Ae=(A,x,N)=>{const U=x.component=A.component;if(hx(A,x,N))if(U.asyncDep&&!U.asyncResolved){fe(U,x,N);return}else U.next=x,U.update();else x.el=A.el,U.vnode=x},Re=(A,x,N,U,j,F,Z)=>{const J=()=>{if(A.isMounted){let{next:te,bu:ce,u:de,parent:Ie,vnode:He}=A;{const wn=Z1(A);if(wn){te&&(te.el=He.el,fe(A,te,Z)),wn.asyncDep.then(()=>{A.isUnmounted||J()});return}}let De=te,Wt;wi(A,!1),te?(te.el=He.el,fe(A,te,Z)):te=He,ce&&Qc(ce),(Wt=te.props&&te.props.onVnodeBeforeUpdate)&&sr(Wt,Ie,te,He),wi(A,!0);const qt=U0(A),vn=A.subTree;A.subTree=qt,y(vn,qt,h(vn.el),$(vn),A,j,F),te.el=qt.el,De===null&&dx(A,qt.el),de&&En(de,j),(Wt=te.props&&te.props.onVnodeUpdated)&&En(()=>sr(Wt,Ie,te,He),j)}else{let te;const{el:ce,props:de}=x,{bm:Ie,m:He,parent:De,root:Wt,type:qt}=A,vn=Ka(x);wi(A,!1),Ie&&Qc(Ie),!vn&&(te=de&&de.onVnodeBeforeMount)&&sr(te,De,x),wi(A,!0);{Wt.ce&&Wt.ce._def.shadowRoot!==!1&&Wt.ce._injectChildStyle(qt);const wn=A.subTree=U0(A);y(null,wn,N,U,A,j,F),x.el=wn.el}if(He&&En(He,j),!vn&&(te=de&&de.onVnodeMounted)){const wn=x;En(()=>sr(te,De,wn),j)}(x.shapeFlag&256||De&&Ka(De.vnode)&&De.vnode.shapeFlag&256)&&A.a&&En(A.a,j),A.isMounted=!0,x=N=U=null}};A.scope.on();const K=A.effect=new c1(J);A.scope.off();const G=A.update=K.run.bind(K),he=A.job=K.runIfDirty.bind(K);he.i=A,he.id=A.uid,K.scheduler=()=>jm(he),wi(A,!0),G()},fe=(A,x,N)=>{x.component=A;const U=A.vnode.props;A.vnode=x,A.next=null,GR(A,x.props,U,N),XR(A,x.children,N),Yr(),P0(A),Xr()},Ne=(A,x,N,U,j,F,Z,J,K=!1)=>{const G=A&&A.children,he=A?A.shapeFlag:0,te=x.children,{patchFlag:ce,shapeFlag:de}=x;if(ce>0){if(ce&128){tr(G,te,N,U,j,F,Z,J,K);return}else if(ce&256){fn(G,te,N,U,j,F,Z,J,K);return}}de&8?(he&16&&jt(G,j,F),te!==G&&u(N,te)):he&16?de&16?tr(G,te,N,U,j,F,Z,J,K):jt(G,j,F,!0):(he&8&&u(N,""),de&16&&w(te,N,U,j,F,Z,J,K))},fn=(A,x,N,U,j,F,Z,J,K)=>{A=A||Ro,x=x||Ro;const G=A.length,he=x.length,te=Math.min(G,he);let ce;for(ce=0;ce<te;ce++){const de=x[ce]=K?bs(x[ce]):ur(x[ce]);y(A[ce],de,N,null,j,F,Z,J,K)}G>he?jt(A,j,F,!0,!1,te):w(x,N,U,j,F,Z,J,K,te)},tr=(A,x,N,U,j,F,Z,J,K)=>{let G=0;const he=x.length;let te=A.length-1,ce=he-1;for(;G<=te&&G<=ce;){const de=A[G],Ie=x[G]=K?bs(x[G]):ur(x[G]);if(Ai(de,Ie))y(de,Ie,N,null,j,F,Z,J,K);else break;G++}for(;G<=te&&G<=ce;){const de=A[te],Ie=x[ce]=K?bs(x[ce]):ur(x[ce]);if(Ai(de,Ie))y(de,Ie,N,null,j,F,Z,J,K);else break;te--,ce--}if(G>te){if(G<=ce){const de=ce+1,Ie=de<he?x[de].el:U;for(;G<=ce;)y(null,x[G]=K?bs(x[G]):ur(x[G]),N,Ie,j,F,Z,J,K),G++}}else if(G>ce)for(;G<=te;)Nt(A[G],j,F,!0),G++;else{const de=G,Ie=G,He=new Map;for(G=Ie;G<=ce;G++){const Ot=x[G]=K?bs(x[G]):ur(x[G]);Ot.key!=null&&He.set(Ot.key,G)}let De,Wt=0;const qt=ce-Ie+1;let vn=!1,wn=0;const zn=new Array(qt);for(G=0;G<qt;G++)zn[G]=0;for(G=de;G<=te;G++){const Ot=A[G];if(Wt>=qt){Nt(Ot,j,F,!0);continue}let St;if(Ot.key!=null)St=He.get(Ot.key);else for(De=Ie;De<=ce;De++)if(zn[De-Ie]===0&&Ai(Ot,x[De])){St=De;break}St===void 0?Nt(Ot,j,F,!0):(zn[St-Ie]=G+1,St>=wn?wn=St:vn=!0,y(Ot,x[St],N,null,j,F,Z,J,K),Wt++)}const ao=vn?nx(zn):Ro;for(De=ao.length-1,G=qt-1;G>=0;G--){const Ot=Ie+G,St=x[Ot],ha=x[Ot+1],pi=Ot+1<he?ha.el||ha.placeholder:U;zn[G]===0?y(null,St,N,pi,j,F,Z,J,K):vn&&(De<0||G!==ao[De]?_n(St,N,pi,2):De--)}}},_n=(A,x,N,U,j=null)=>{const{el:F,type:Z,transition:J,children:K,shapeFlag:G}=A;if(G&6){_n(A.component.subTree,x,N,U);return}if(G&128){A.suspense.move(x,N,U);return}if(G&64){Z.move(A,x,N,ie);return}if(Z===Xt){r(F,x,N);for(let te=0;te<K.length;te++)_n(K[te],x,N,U);r(A.anchor,x,N);return}if(Z===Xc){P(A,x,N);return}if(U!==2&&G&1&&J)if(U===0)J.beforeEnter(F),r(F,x,N),En(()=>J.enter(F),j);else{const{leave:te,delayLeave:ce,afterLeave:de}=J,Ie=()=>{A.ctx.isUnmounted?s(F):r(F,x,N)},He=()=>{F._isLeaving&&F[Ur](!0),te(F,()=>{Ie(),de&&de()})};ce?ce(F,Ie,He):He()}else r(F,x,N)},Nt=(A,x,N,U=!1,j=!1)=>{const{type:F,props:Z,ref:J,children:K,dynamicChildren:G,shapeFlag:he,patchFlag:te,dirs:ce,cacheIndex:de}=A;if(te===-2&&(j=!1),J!=null&&(Yr(),qa(J,null,N,A,!0),Xr()),de!=null&&(x.renderCache[de]=void 0),he&256){x.ctx.deactivate(A);return}const Ie=he&1&&ce,He=!Ka(A);let De;if(He&&(De=Z&&Z.onVnodeBeforeUnmount)&&sr(De,x,A),he&6)as(A.component,N,U);else{if(he&128){A.suspense.unmount(N,U);return}Ie&&vi(A,null,x,"beforeUnmount"),he&64?A.type.remove(A,x,N,ie,U):G&&!G.hasOnce&&(F!==Xt||te>0&&te&64)?jt(G,x,N,!1,!0):(F===Xt&&te&384||!j&&he&16)&&jt(K,x,N),U&&xr(A)}(He&&(De=Z&&Z.onVnodeUnmounted)||Ie)&&En(()=>{De&&sr(De,x,A),Ie&&vi(A,null,x,"unmounted")},N)},xr=A=>{const{type:x,el:N,anchor:U,transition:j}=A;if(x===Xt){Un(N,U);return}if(x===Xc){D(A);return}const F=()=>{s(N),j&&!j.persisted&&j.afterLeave&&j.afterLeave()};if(A.shapeFlag&1&&j&&!j.persisted){const{leave:Z,delayLeave:J}=j,K=()=>Z(N,F);J?J(A.el,F,K):K()}else F()},Un=(A,x)=>{let N;for(;A!==x;)N=f(A),s(A),A=N;s(x)},as=(A,x,N)=>{const{bum:U,scope:j,job:F,subTree:Z,um:J,m:K,a:G}=A;$0(K),$0(G),U&&Qc(U),j.stop(),F&&(F.flags|=8,Nt(Z,A,x,N)),J&&En(J,x),En(()=>{A.isUnmounted=!0},x)},jt=(A,x,N,U=!1,j=!1,F=0)=>{for(let Z=F;Z<A.length;Z++)Nt(A[Z],x,N,U,j)},$=A=>{if(A.shapeFlag&6)return $(A.component.subTree);if(A.shapeFlag&128)return A.suspense.next();const x=f(A.anchor||A.el),N=x&&x[bR];return N?f(N):x};let re=!1;const ee=(A,x,N)=>{A==null?x._vnode&&Nt(x._vnode,null,null,!0):y(x._vnode||null,A,x,null,null,null,N),x._vnode=A,re||(re=!0,P0(),x1(),re=!1)},ie={p:y,um:Nt,m:_n,r:xr,mt:_e,mc:w,pc:Ne,pbc:I,n:$,o:n};return{render:ee,hydrate:void 0,createApp:WR(ee)}}function df({type:n,props:e},t){return t==="svg"&&n==="foreignObject"||t==="mathml"&&n==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function wi({effect:n,job:e},t){t?(n.flags|=32,e.flags|=4):(n.flags&=-33,e.flags&=-5)}function tx(n,e){return(!n||n&&!n.pendingBranch)&&e&&!e.persisted}function X1(n,e,t=!1){const r=n.children,s=e.children;if(ye(r)&&ye(s))for(let i=0;i<r.length;i++){const o=r[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=bs(s[i]),a.el=o.el),!t&&a.patchFlag!==-2&&X1(o,a)),a.type===Qh&&a.patchFlag!==-1&&(a.el=o.el),a.type===cn&&!a.el&&(a.el=o.el)}}function nx(n){const e=n.slice(),t=[0];let r,s,i,o,a;const l=n.length;for(r=0;r<l;r++){const c=n[r];if(c!==0){if(s=t[t.length-1],n[s]<c){e[r]=s,t.push(r);continue}for(i=0,o=t.length-1;i<o;)a=i+o>>1,n[t[a]]<c?i=a+1:o=a;c<n[t[i]]&&(i>0&&(e[r]=t[i-1]),t[i]=r)}}for(i=t.length,o=t[i-1];i-- >0;)t[i]=o,o=e[o];return t}function Z1(n){const e=n.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Z1(e)}function $0(n){if(n)for(let e=0;e<n.length;e++)n[e].flags|=8}const rx=Symbol.for("v-scx"),sx=()=>Vn(rx);function ix(n,e){return Gm(n,null,e)}function Po(n,e,t){return Gm(n,e,t)}function Gm(n,e,t=Ke){const{immediate:r,deep:s,flush:i,once:o}=t,a=Pt({},t),l=e&&r||!e&&i!=="post";let c;if(bl){if(i==="sync"){const p=sx();c=p.__watcherHandles||(p.__watcherHandles=[])}else if(!l){const p=()=>{};return p.stop=dr,p.resume=dr,p.pause=dr,p}}const u=en;a.call=(p,m,y)=>Qn(p,u,m,y);let h=!1;i==="post"?a.scheduler=p=>{En(p,u&&u.suspense)}:i!=="sync"&&(h=!0,a.scheduler=(p,m)=>{m?p():jm(p)}),a.augmentJob=p=>{e&&(p.flags|=4),h&&(p.flags|=2,u&&(p.id=u.uid,p.i=u))};const f=yR(n,e,a);return bl&&(c?c.push(f):l&&f()),f}function ox(n,e,t){const r=this.proxy,s=mt(n)?n.includes(".")?eE(r,n):()=>r[n]:n.bind(r,r);let i;be(e)?i=e:(i=e.handler,t=e);const o=Ql(this),a=Gm(s,i.bind(r),t);return o(),a}function eE(n,e){const t=e.split(".");return()=>{let r=n;for(let s=0;s<t.length&&r;s++)r=r[t[s]];return r}}const ax=(n,e)=>e==="modelValue"||e==="model-value"?n.modelModifiers:n[`${e}Modifiers`]||n[`${$n(e)}Modifiers`]||n[`${Zi(e)}Modifiers`];function lx(n,e,...t){if(n.isUnmounted)return;const r=n.vnode.props||Ke;let s=t;const i=e.startsWith("update:"),o=i&&ax(r,e.slice(7));o&&(o.trim&&(s=t.map(u=>mt(u)?u.trim():u)),o.number&&(s=t.map(cp)));let a,l=r[a=sf(e)]||r[a=sf($n(e))];!l&&i&&(l=r[a=sf(Zi(e))]),l&&Qn(l,n,6,s);const c=r[a+"Once"];if(c){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,Qn(c,n,6,s)}}function tE(n,e,t=!1){const r=e.emitsCache,s=r.get(n);if(s!==void 0)return s;const i=n.emits;let o={},a=!1;if(!be(n)){const l=c=>{const u=tE(c,e,!0);u&&(a=!0,Pt(o,u))};!t&&e.mixins.length&&e.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!i&&!a?(rt(n)&&r.set(n,null),null):(ye(i)?i.forEach(l=>o[l]=null):Pt(o,i),rt(n)&&r.set(n,o),o)}function Jh(n,e){return!n||!Dh(e)?!1:(e=e.slice(2).replace(/Once$/,""),Be(n,e[0].toLowerCase()+e.slice(1))||Be(n,Zi(e))||Be(n,e))}function U0(n){const{type:e,vnode:t,proxy:r,withProxy:s,propsOptions:[i],slots:o,attrs:a,emit:l,render:c,renderCache:u,props:h,data:f,setupState:p,ctx:m,inheritAttrs:y}=n,v=Eu(n);let T,M;try{if(t.shapeFlag&4){const D=s||r,L=D;T=ur(c.call(L,D,u,h,p,f,m)),M=a}else{const D=e;T=ur(D.length>1?D(h,{attrs:a,slots:o,emit:l}):D(h,null)),M=e.props?a:cx(a)}}catch(D){Qa.length=0,Hh(D,n,1),T=ke(cn)}let P=T;if(M&&y!==!1){const D=Object.keys(M),{shapeFlag:L}=P;D.length&&L&7&&(i&&D.some(Om)&&(M=ux(M,i)),P=Ys(P,M,!1,!0))}return t.dirs&&(P=Ys(P,null,!1,!0),P.dirs=P.dirs?P.dirs.concat(t.dirs):t.dirs),t.transition&&vl(P,t.transition),T=P,Eu(v),T}const cx=n=>{let e;for(const t in n)(t==="class"||t==="style"||Dh(t))&&((e||(e={}))[t]=n[t]);return e},ux=(n,e)=>{const t={};for(const r in n)(!Om(r)||!(r.slice(9)in e))&&(t[r]=n[r]);return t};function hx(n,e,t){const{props:r,children:s,component:i}=n,{props:o,children:a,patchFlag:l}=e,c=i.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return r?z0(r,o,c):!!o;if(l&8){const u=e.dynamicProps;for(let h=0;h<u.length;h++){const f=u[h];if(o[f]!==r[f]&&!Jh(c,f))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?z0(r,o,c):!0:!!o;return!1}function z0(n,e,t){const r=Object.keys(e);if(r.length!==Object.keys(n).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(e[i]!==n[i]&&!Jh(t,i))return!0}return!1}function dx({vnode:n,parent:e},t){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===n&&(r.el=n.el),r===n)(n=e.vnode).el=t,e=e.parent;else break}}const nE=n=>n.__isSuspense;function fx(n,e){e&&e.pendingBranch?ye(n)?e.effects.push(...n):e.effects.push(n):wR(n)}const Xt=Symbol.for("v-fgt"),Qh=Symbol.for("v-txt"),cn=Symbol.for("v-cmt"),Xc=Symbol.for("v-stc"),Qa=[];let An=null;function we(n=!1){Qa.push(An=n?null:[])}function px(){Qa.pop(),An=Qa[Qa.length-1]||null}let wl=1;function H0(n,e=!1){wl+=n,n<0&&An&&e&&(An.hasOnce=!0)}function rE(n){return n.dynamicChildren=wl>0?An||Ro:null,px(),wl>0&&An&&An.push(n),n}function Ce(n,e,t,r,s,i){return rE(W(n,e,t,r,s,i,!0))}function Yh(n,e,t,r,s){return rE(ke(n,e,t,r,s,!0))}function Cu(n){return n?n.__v_isVNode===!0:!1}function Ai(n,e){return n.type===e.type&&n.key===e.key}const sE=({key:n})=>n??null,Zc=({ref:n,ref_key:e,ref_for:t})=>(typeof n=="number"&&(n=""+n),n!=null?mt(n)||ot(n)||be(n)?{i:Cn,r:n,k:e,f:!!t}:n:null);function W(n,e=null,t=null,r=0,s=null,i=n===Xt?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&sE(e),ref:e&&Zc(e),scopeId:P1,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:Cn};return a?(Jm(l,t),i&128&&n.normalize(l)):t&&(l.shapeFlag|=mt(t)?8:16),wl>0&&!o&&An&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&An.push(l),l}const ke=mx;function mx(n,e=null,t=null,r=0,s=null,i=!1){if((!n||n===LR)&&(n=cn),Cu(n)){const a=Ys(n,e,!0);return t&&Jm(a,t),wl>0&&!i&&An&&(a.shapeFlag&6?An[An.indexOf(n)]=a:An.push(a)),a.patchFlag=-2,a}if(Ax(n)&&(n=n.__vccOpts),e){e=gx(e);let{class:a,style:l}=e;a&&!mt(a)&&(e.class=Ni(a)),rt(l)&&(Hm(l)&&!ye(l)&&(l=Pt({},l)),e.style=Vm(l))}const o=mt(n)?1:nE(n)?128:N1(n)?64:rt(n)?4:be(n)?2:0;return W(n,e,t,r,s,o,i,!0)}function gx(n){return n?Hm(n)||q1(n)?Pt({},n):n:null}function Ys(n,e,t=!1,r=!1){const{props:s,ref:i,patchFlag:o,children:a,transition:l}=n,c=e?yx(s||{},e):s,u={__v_isVNode:!0,__v_skip:!0,type:n.type,props:c,key:c&&sE(c),ref:e&&e.ref?t&&i?ye(i)?i.concat(Zc(e)):[i,Zc(e)]:Zc(e):i,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:a,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==Xt?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:l,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&Ys(n.ssContent),ssFallback:n.ssFallback&&Ys(n.ssFallback),placeholder:n.placeholder,el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return l&&r&&vl(u,l.clone(u)),u}function hr(n=" ",e=0){return ke(Qh,null,n,e)}function iE(n,e){const t=ke(Xc,null,n);return t.staticCount=e,t}function br(n="",e=!1){return e?(we(),Yh(cn,null,n)):ke(cn,null,n)}function ur(n){return n==null||typeof n=="boolean"?ke(cn):ye(n)?ke(Xt,null,n.slice()):Cu(n)?bs(n):ke(Qh,null,String(n))}function bs(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:Ys(n)}function Jm(n,e){let t=0;const{shapeFlag:r}=n;if(e==null)e=null;else if(ye(e))t=16;else if(typeof e=="object")if(r&65){const s=e.default;s&&(s._c&&(s._d=!1),Jm(n,s()),s._c&&(s._d=!0));return}else{t=32;const s=e._;!s&&!q1(e)?e._ctx=Cn:s===3&&Cn&&(Cn.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else be(e)?(e={default:e,_ctx:Cn},t=32):(e=String(e),r&64?(t=16,e=[hr(e)]):t=8);n.children=e,n.shapeFlag|=t}function yx(...n){const e={};for(let t=0;t<n.length;t++){const r=n[t];for(const s in r)if(s==="class")e.class!==r.class&&(e.class=Ni([e.class,r.class]));else if(s==="style")e.style=Vm([e.style,r.style]);else if(Dh(s)){const i=e[s],o=r[s];o&&i!==o&&!(ye(i)&&i.includes(o))&&(e[s]=i?[].concat(i,o):o)}else s!==""&&(e[s]=r[s])}return e}function sr(n,e,t,r=null){Qn(n,e,7,[t,r])}const _x=H1();let vx=0;function wx(n,e,t){const r=n.type,s=(e?e.appContext:n.appContext)||_x,i={uid:vx++,vnode:n,type:r,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new o1(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:G1(r,s),emitsOptions:tE(r,s),emit:null,emitted:null,propsDefaults:Ke,inheritAttrs:r.inheritAttrs,ctx:Ke,data:Ke,props:Ke,attrs:Ke,slots:Ke,refs:Ke,setupState:Ke,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=lx.bind(null,i),n.ce&&n.ce(i),i}let en=null;const Xh=()=>en||Cn;let Au,_p;{const n=Bh(),e=(t,r)=>{let s;return(s=n[t])||(s=n[t]=[]),s.push(r),i=>{s.length>1?s.forEach(o=>o(i)):s[0](i)}};Au=e("__VUE_INSTANCE_SETTERS__",t=>en=t),_p=e("__VUE_SSR_SETTERS__",t=>bl=t)}const Ql=n=>{const e=en;return Au(n),n.scope.on(),()=>{n.scope.off(),Au(e)}},j0=()=>{en&&en.scope.off(),Au(null)};function oE(n){return n.vnode.shapeFlag&4}let bl=!1;function bx(n,e=!1,t=!1){e&&_p(e);const{props:r,children:s}=n.vnode,i=oE(n);KR(n,r,i,e),YR(n,s,t||e);const o=i?Ex(n,e):void 0;return e&&_p(!1),o}function Ex(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,FR);const{setup:r}=t;if(r){Yr();const s=n.setupContext=r.length>1?Sx(n):null,i=Ql(n),o=Jl(r,n,0,[n.props,s]),a=Zb(o);if(Xr(),i(),(a||n.sp)&&!Ka(n)&&B1(n),a){if(o.then(j0,j0),e)return o.then(l=>{W0(n,l)}).catch(l=>{Hh(l,n,0)});n.asyncDep=o}else W0(n,o)}else aE(n)}function W0(n,e,t){be(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:rt(e)&&(n.setupState=I1(e)),aE(n)}function aE(n,e,t){const r=n.type;n.render||(n.render=r.render||dr);{const s=Ql(n);Yr();try{BR(n)}finally{Xr(),s()}}}const Tx={get(n,e){return Yt(n,"get",""),n[e]}};function Sx(n){const e=t=>{n.exposed=t||{}};return{attrs:new Proxy(n.attrs,Tx),slots:n.slots,emit:n.emit,expose:e}}function Zh(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(I1(zh(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in Ja)return Ja[t](n)},has(e,t){return t in e||t in Ja}})):n.proxy}function Cx(n,e=!0){return be(n)?n.displayName||n.name:n.name||e&&n.__name}function Ax(n){return be(n)&&"__vccOpts"in n}const un=(n,e)=>mR(n,e,bl);function ed(n,e,t){const r=arguments.length;return r===2?rt(e)&&!ye(e)?Cu(e)?ke(n,null,[e]):ke(n,e):ke(n,null,e):(r>3?t=Array.prototype.slice.call(arguments,2):r===3&&Cu(t)&&(t=[t]),ke(n,e,t))}const Ix="3.5.19";/**
* @vue/runtime-dom v3.5.19
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let vp;const q0=typeof window<"u"&&window.trustedTypes;if(q0)try{vp=q0.createPolicy("vue",{createHTML:n=>n})}catch{}const lE=vp?n=>vp.createHTML(n):n=>n,kx="http://www.w3.org/2000/svg",Rx="http://www.w3.org/1998/Math/MathML",Br=typeof document<"u"?document:null,K0=Br&&Br.createElement("template"),xx={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,r)=>{const s=e==="svg"?Br.createElementNS(kx,n):e==="mathml"?Br.createElementNS(Rx,n):t?Br.createElement(n,{is:t}):Br.createElement(n);return n==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:n=>Br.createTextNode(n),createComment:n=>Br.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>Br.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,r,s,i){const o=t?t.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),t),!(s===i||!(s=s.nextSibling)););else{K0.innerHTML=lE(r==="svg"?`<svg>${n}</svg>`:r==="mathml"?`<math>${n}</math>`:n);const a=K0.content;if(r==="svg"||r==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},ps="transition",Ia="animation",El=Symbol("_vtc"),cE={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Mx=Pt({},O1,cE),Px=n=>(n.displayName="Transition",n.props=Mx,n),uE=Px((n,{slots:e})=>ed(SR,Nx(n),e)),bi=(n,e=[])=>{ye(n)?n.forEach(t=>t(...e)):n&&n(...e)},G0=n=>n?ye(n)?n.some(e=>e.length>1):n.length>1:!1;function Nx(n){const e={};for(const k in n)k in cE||(e[k]=n[k]);if(n.css===!1)return e;const{name:t="v",type:r,duration:s,enterFromClass:i=`${t}-enter-from`,enterActiveClass:o=`${t}-enter-active`,enterToClass:a=`${t}-enter-to`,appearFromClass:l=i,appearActiveClass:c=o,appearToClass:u=a,leaveFromClass:h=`${t}-leave-from`,leaveActiveClass:f=`${t}-leave-active`,leaveToClass:p=`${t}-leave-to`}=n,m=Ox(s),y=m&&m[0],v=m&&m[1],{onBeforeEnter:T,onEnter:M,onEnterCancelled:P,onLeave:D,onLeaveCancelled:L,onBeforeAppear:q=T,onAppear:S=M,onAppearCancelled:w=P}=e,b=(k,C,_e,Ae)=>{k._enterCancelled=Ae,Ei(k,C?u:a),Ei(k,C?c:o),_e&&_e()},I=(k,C)=>{k._isLeaving=!1,Ei(k,h),Ei(k,p),Ei(k,f),C&&C()},R=k=>(C,_e)=>{const Ae=k?S:M,Re=()=>b(C,k,_e);bi(Ae,[C,Re]),J0(()=>{Ei(C,k?l:i),Pr(C,k?u:a),G0(Ae)||Q0(C,r,y,Re)})};return Pt(e,{onBeforeEnter(k){bi(T,[k]),Pr(k,i),Pr(k,o)},onBeforeAppear(k){bi(q,[k]),Pr(k,l),Pr(k,c)},onEnter:R(!1),onAppear:R(!0),onLeave(k,C){k._isLeaving=!0;const _e=()=>I(k,C);Pr(k,h),k._enterCancelled?(Pr(k,f),Z0()):(Z0(),Pr(k,f)),J0(()=>{k._isLeaving&&(Ei(k,h),Pr(k,p),G0(D)||Q0(k,r,v,_e))}),bi(D,[k,_e])},onEnterCancelled(k){b(k,!1,void 0,!0),bi(P,[k])},onAppearCancelled(k){b(k,!0,void 0,!0),bi(w,[k])},onLeaveCancelled(k){I(k),bi(L,[k])}})}function Ox(n){if(n==null)return null;if(rt(n))return[ff(n.enter),ff(n.leave)];{const e=ff(n);return[e,e]}}function ff(n){return Ok(n)}function Pr(n,e){e.split(/\s+/).forEach(t=>t&&n.classList.add(t)),(n[El]||(n[El]=new Set)).add(e)}function Ei(n,e){e.split(/\s+/).forEach(r=>r&&n.classList.remove(r));const t=n[El];t&&(t.delete(e),t.size||(n[El]=void 0))}function J0(n){requestAnimationFrame(()=>{requestAnimationFrame(n)})}let Dx=0;function Q0(n,e,t,r){const s=n._endId=++Dx,i=()=>{s===n._endId&&r()};if(t!=null)return setTimeout(i,t);const{type:o,timeout:a,propCount:l}=Lx(n,e);if(!o)return r();const c=o+"end";let u=0;const h=()=>{n.removeEventListener(c,f),i()},f=p=>{p.target===n&&++u>=l&&h()};setTimeout(()=>{u<l&&h()},a+1),n.addEventListener(c,f)}function Lx(n,e){const t=window.getComputedStyle(n),r=m=>(t[m]||"").split(", "),s=r(`${ps}Delay`),i=r(`${ps}Duration`),o=Y0(s,i),a=r(`${Ia}Delay`),l=r(`${Ia}Duration`),c=Y0(a,l);let u=null,h=0,f=0;e===ps?o>0&&(u=ps,h=o,f=i.length):e===Ia?c>0&&(u=Ia,h=c,f=l.length):(h=Math.max(o,c),u=h>0?o>c?ps:Ia:null,f=u?u===ps?i.length:l.length:0);const p=u===ps&&/\b(transform|all)(,|$)/.test(r(`${ps}Property`).toString());return{type:u,timeout:h,propCount:f,hasTransform:p}}function Y0(n,e){for(;n.length<e.length;)n=n.concat(n);return Math.max(...e.map((t,r)=>X0(t)+X0(n[r])))}function X0(n){return n==="auto"?0:Number(n.slice(0,-1).replace(",","."))*1e3}function Z0(){return document.body.offsetHeight}function Vx(n,e,t){const r=n[El];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}const Iu=Symbol("_vod"),hE=Symbol("_vsh"),dE={beforeMount(n,{value:e},{transition:t}){n[Iu]=n.style.display==="none"?"":n.style.display,t&&e?t.beforeEnter(n):ka(n,e)},mounted(n,{value:e},{transition:t}){t&&e&&t.enter(n)},updated(n,{value:e,oldValue:t},{transition:r}){!e!=!t&&(r?e?(r.beforeEnter(n),ka(n,!0),r.enter(n)):r.leave(n,()=>{ka(n,!1)}):ka(n,e))},beforeUnmount(n,{value:e}){ka(n,e)}};function ka(n,e){n.style.display=e?n[Iu]:"none",n[hE]=!e}const Fx=Symbol(""),Bx=/(^|;)\s*display\s*:/;function $x(n,e,t){const r=n.style,s=mt(t);let i=!1;if(t&&!s){if(e)if(mt(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();t[a]==null&&eu(r,a,"")}else for(const o in e)t[o]==null&&eu(r,o,"");for(const o in t)o==="display"&&(i=!0),eu(r,o,t[o])}else if(s){if(e!==t){const o=r[Fx];o&&(t+=";"+o),r.cssText=t,i=Bx.test(t)}}else e&&n.removeAttribute("style");Iu in n&&(n[Iu]=i?r.display:"",n[hE]&&(r.display="none"))}const e_=/\s*!important$/;function eu(n,e,t){if(ye(t))t.forEach(r=>eu(n,e,r));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const r=Ux(n,e);e_.test(t)?n.setProperty(Zi(r),t.replace(e_,""),"important"):n[r]=t}}const t_=["Webkit","Moz","ms"],pf={};function Ux(n,e){const t=pf[e];if(t)return t;let r=$n(e);if(r!=="filter"&&r in n)return pf[e]=r;r=Fh(r);for(let s=0;s<t_.length;s++){const i=t_[s]+r;if(i in n)return pf[e]=i}return e}const n_="http://www.w3.org/1999/xlink";function r_(n,e,t,r,s,i=$k(e)){r&&e.startsWith("xlink:")?t==null?n.removeAttributeNS(n_,e.slice(6,e.length)):n.setAttributeNS(n_,e,t):t==null||i&&!r1(t)?n.removeAttribute(e):n.setAttribute(e,i?"":li(t)?String(t):t)}function s_(n,e,t,r,s){if(e==="innerHTML"||e==="textContent"){t!=null&&(n[e]=e==="innerHTML"?lE(t):t);return}const i=n.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const a=i==="OPTION"?n.getAttribute("value")||"":n.value,l=t==null?n.type==="checkbox"?"on":"":String(t);(a!==l||!("_value"in n))&&(n.value=l),t==null&&n.removeAttribute(e),n._value=t;return}let o=!1;if(t===""||t==null){const a=typeof n[e];a==="boolean"?t=r1(t):t==null&&a==="string"?(t="",o=!0):a==="number"&&(t=0,o=!0)}try{n[e]=t}catch{}o&&n.removeAttribute(s||e)}function yo(n,e,t,r){n.addEventListener(e,t,r)}function zx(n,e,t,r){n.removeEventListener(e,t,r)}const i_=Symbol("_vei");function Hx(n,e,t,r,s=null){const i=n[i_]||(n[i_]={}),o=i[e];if(r&&o)o.value=r;else{const[a,l]=jx(e);if(r){const c=i[e]=Kx(r,s);yo(n,a,c,l)}else o&&(zx(n,a,o,l),i[e]=void 0)}}const o_=/(?:Once|Passive|Capture)$/;function jx(n){let e;if(o_.test(n)){e={};let r;for(;r=n.match(o_);)n=n.slice(0,n.length-r[0].length),e[r[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):Zi(n.slice(2)),e]}let mf=0;const Wx=Promise.resolve(),qx=()=>mf||(Wx.then(()=>mf=0),mf=Date.now());function Kx(n,e){const t=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=t.attached)return;Qn(Gx(r,t.value),e,5,[r])};return t.value=n,t.attached=qx(),t}function Gx(n,e){if(ye(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(r=>s=>!s._stopped&&r&&r(s))}else return e}const a_=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,Jx=(n,e,t,r,s,i)=>{const o=s==="svg";e==="class"?Vx(n,r,o):e==="style"?$x(n,t,r):Dh(e)?Om(e)||Hx(n,e,t,r,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Qx(n,e,r,o))?(s_(n,e,r),!n.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&r_(n,e,r,o,i,e!=="value")):n._isVueCE&&(/[A-Z]/.test(e)||!mt(r))?s_(n,$n(e),r,i,e):(e==="true-value"?n._trueValue=r:e==="false-value"&&(n._falseValue=r),r_(n,e,r,o))};function Qx(n,e,t,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in n&&a_(e)&&be(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=n.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return a_(e)&&mt(t)?!1:e in n}const l_=n=>{const e=n.props["onUpdate:modelValue"]||!1;return ye(e)?t=>Qc(e,t):e};function Yx(n){n.target.composing=!0}function c_(n){const e=n.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const gf=Symbol("_assign"),jr={created(n,{modifiers:{lazy:e,trim:t,number:r}},s){n[gf]=l_(s);const i=r||s.props&&s.props.type==="number";yo(n,e?"change":"input",o=>{if(o.target.composing)return;let a=n.value;t&&(a=a.trim()),i&&(a=cp(a)),n[gf](a)}),t&&yo(n,"change",()=>{n.value=n.value.trim()}),e||(yo(n,"compositionstart",Yx),yo(n,"compositionend",c_),yo(n,"change",c_))},mounted(n,{value:e}){n.value=e??""},beforeUpdate(n,{value:e,oldValue:t,modifiers:{lazy:r,trim:s,number:i}},o){if(n[gf]=l_(o),n.composing)return;const a=(i||n.type==="number")&&!/^0\d/.test(n.value)?cp(n.value):n.value,l=e??"";a!==l&&(document.activeElement===n&&n.type!=="range"&&(r&&e===t||s&&n.value.trim()===l)||(n.value=l))}},Xx=Pt({patchProp:Jx},xx);let u_;function Zx(){return u_||(u_=ZR(Xx))}const eM=((...n)=>{const e=Zx().createApp(...n),{mount:t}=e;return e.mount=r=>{const s=nM(r);if(!s)return;const i=e._component;!be(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=t(s,!1,tM(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e});function tM(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function nM(n){return mt(n)?document.querySelector(n):n}const fE="/accounting-site/assets/logo-DMpoolbu.png",zt=(n,e)=>{const t=n.__vccOpts||n;for(const[r,s]of e)t[r]=s;return t},rM={class:"navbar"},sM={class:"nav-links"},iM={class:"main"},oM={__name:"App",setup(n){const e=$e(!1),t=$e(window.innerWidth>=769),r=()=>{t.value=window.innerWidth>=769,t.value&&(e.value=!1)},s=()=>{e.value=!e.value};Ar(()=>{window.addEventListener("resize",r),localStorage.getItem("theme")==="dark"&&(i.value=!0,document.documentElement.classList.add("dark"))}),Gh(()=>{window.removeEventListener("resize",r)});const i=$e(!1);return(o,a)=>{const l=Tu("router-link"),c=Tu("router-view");return we(),Ce(Xt,null,[W("header",rM,[ke(l,{to:"/",class:"logo"},{default:Ns(()=>[...a[3]||(a[3]=[W("img",{class:"img",src:fE},null,-1)])]),_:1}),W("button",{class:"hamburger",onClick:s},[...a[4]||(a[4]=[W("span",null,null,-1),W("span",null,null,-1),W("span",null,null,-1)])]),qe(e)?(we(),Ce("div",{key:0,class:"overlay",onClick:a[0]||(a[0]=u=>e.value=!1)})):br("",!0),ke(uE,{name:"slide"},{default:Ns(()=>[Hn(W("nav",sM,[ke(l,{to:"/",onClick:a[1]||(a[1]=u=>e.value=!1)},{default:Ns(()=>[...a[5]||(a[5]=[hr("",-1)])]),_:1}),ke(l,{to:"/articleList",onClick:a[2]||(a[2]=u=>e.value=!1)},{default:Ns(()=>[...a[6]||(a[6]=[hr("",-1)])]),_:1})],512),[[dE,qe(e)||qe(t)]])]),_:1})]),W("main",iM,[ke(c)])],64)}}},aM=zt(oM,[["__scopeId","data-v-65c44cfa"]]);/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const _o=typeof document<"u";function pE(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function lM(n){return n.__esModule||n[Symbol.toStringTag]==="Module"||n.default&&pE(n.default)}const Fe=Object.assign;function yf(n,e){const t={};for(const r in e){const s=e[r];t[r]=Yn(s)?s.map(n):n(s)}return t}const Ya=()=>{},Yn=Array.isArray,mE=/#/g,cM=/&/g,uM=/\//g,hM=/=/g,dM=/\?/g,gE=/\+/g,fM=/%5B/g,pM=/%5D/g,yE=/%5E/g,mM=/%60/g,_E=/%7B/g,gM=/%7C/g,vE=/%7D/g,yM=/%20/g;function Qm(n){return encodeURI(""+n).replace(gM,"|").replace(fM,"[").replace(pM,"]")}function _M(n){return Qm(n).replace(_E,"{").replace(vE,"}").replace(yE,"^")}function wp(n){return Qm(n).replace(gE,"%2B").replace(yM,"+").replace(mE,"%23").replace(cM,"%26").replace(mM,"`").replace(_E,"{").replace(vE,"}").replace(yE,"^")}function vM(n){return wp(n).replace(hM,"%3D")}function wM(n){return Qm(n).replace(mE,"%23").replace(dM,"%3F")}function bM(n){return n==null?"":wM(n).replace(uM,"%2F")}function Tl(n){try{return decodeURIComponent(""+n)}catch{}return""+n}const EM=/\/$/,TM=n=>n.replace(EM,"");function _f(n,e,t="/"){let r,s={},i="",o="";const a=e.indexOf("#");let l=e.indexOf("?");return a<l&&a>=0&&(l=-1),l>-1&&(r=e.slice(0,l),i=e.slice(l+1,a>-1?a:e.length),s=n(i)),a>-1&&(r=r||e.slice(0,a),o=e.slice(a,e.length)),r=IM(r??e,t),{fullPath:r+(i&&"?")+i+o,path:r,query:s,hash:Tl(o)}}function SM(n,e){const t=e.query?n(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function h_(n,e){return!e||!n.toLowerCase().startsWith(e.toLowerCase())?n:n.slice(e.length)||"/"}function CM(n,e,t){const r=e.matched.length-1,s=t.matched.length-1;return r>-1&&r===s&&$o(e.matched[r],t.matched[s])&&wE(e.params,t.params)&&n(e.query)===n(t.query)&&e.hash===t.hash}function $o(n,e){return(n.aliasOf||n)===(e.aliasOf||e)}function wE(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in n)if(!AM(n[t],e[t]))return!1;return!0}function AM(n,e){return Yn(n)?d_(n,e):Yn(e)?d_(e,n):n===e}function d_(n,e){return Yn(e)?n.length===e.length&&n.every((t,r)=>t===e[r]):n.length===1&&n[0]===e}function IM(n,e){if(n.startsWith("/"))return n;if(!n)return e;const t=e.split("/"),r=n.split("/"),s=r[r.length-1];(s===".."||s===".")&&r.push("");let i=t.length-1,o,a;for(o=0;o<r.length;o++)if(a=r[o],a!==".")if(a==="..")i>1&&i--;else break;return t.slice(0,i).join("/")+"/"+r.slice(o).join("/")}const ms={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Sl;(function(n){n.pop="pop",n.push="push"})(Sl||(Sl={}));var Xa;(function(n){n.back="back",n.forward="forward",n.unknown=""})(Xa||(Xa={}));function kM(n){if(!n)if(_o){const e=document.querySelector("base");n=e&&e.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),TM(n)}const RM=/^[^#]+#/;function xM(n,e){return n.replace(RM,"#")+e}function MM(n,e){const t=document.documentElement.getBoundingClientRect(),r=n.getBoundingClientRect();return{behavior:e.behavior,left:r.left-t.left-(e.left||0),top:r.top-t.top-(e.top||0)}}const td=()=>({left:window.scrollX,top:window.scrollY});function PM(n){let e;if("el"in n){const t=n.el,r=typeof t=="string"&&t.startsWith("#"),s=typeof t=="string"?r?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!s)return;e=MM(s,n)}else e=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function f_(n,e){return(history.state?history.state.position-e:-1)+n}const bp=new Map;function NM(n,e){bp.set(n,e)}function OM(n){const e=bp.get(n);return bp.delete(n),e}let DM=()=>location.protocol+"//"+location.host;function bE(n,e){const{pathname:t,search:r,hash:s}=e,i=n.indexOf("#");if(i>-1){let a=s.includes(n.slice(i))?n.slice(i).length:1,l=s.slice(a);return l[0]!=="/"&&(l="/"+l),h_(l,"")}return h_(t,n)+r+s}function LM(n,e,t,r){let s=[],i=[],o=null;const a=({state:f})=>{const p=bE(n,location),m=t.value,y=e.value;let v=0;if(f){if(t.value=p,e.value=f,o&&o===m){o=null;return}v=y?f.position-y.position:0}else r(p);s.forEach(T=>{T(t.value,m,{delta:v,type:Sl.pop,direction:v?v>0?Xa.forward:Xa.back:Xa.unknown})})};function l(){o=t.value}function c(f){s.push(f);const p=()=>{const m=s.indexOf(f);m>-1&&s.splice(m,1)};return i.push(p),p}function u(){const{history:f}=window;f.state&&f.replaceState(Fe({},f.state,{scroll:td()}),"")}function h(){for(const f of i)f();i=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",u,{passive:!0}),{pauseListeners:l,listen:c,destroy:h}}function p_(n,e,t,r=!1,s=!1){return{back:n,current:e,forward:t,replaced:r,position:window.history.length,scroll:s?td():null}}function VM(n){const{history:e,location:t}=window,r={value:bE(n,t)},s={value:e.state};s.value||i(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(l,c,u){const h=n.indexOf("#"),f=h>-1?(t.host&&document.querySelector("base")?n:n.slice(h))+l:DM()+n+l;try{e[u?"replaceState":"pushState"](c,"",f),s.value=c}catch(p){console.error(p),t[u?"replace":"assign"](f)}}function o(l,c){const u=Fe({},e.state,p_(s.value.back,l,s.value.forward,!0),c,{position:s.value.position});i(l,u,!0),r.value=l}function a(l,c){const u=Fe({},s.value,e.state,{forward:l,scroll:td()});i(u.current,u,!0);const h=Fe({},p_(r.value,l,null),{position:u.position+1},c);i(l,h,!1),r.value=l}return{location:r,state:s,push:a,replace:o}}function FM(n){n=kM(n);const e=VM(n),t=LM(n,e.state,e.location,e.replace);function r(i,o=!0){o||t.pauseListeners(),history.go(i)}const s=Fe({location:"",base:n,go:r,createHref:xM.bind(null,n)},e,t);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}function BM(n){return n=location.host?n||location.pathname+location.search:"",n.includes("#")||(n+="#"),FM(n)}function $M(n){return typeof n=="string"||n&&typeof n=="object"}function EE(n){return typeof n=="string"||typeof n=="symbol"}const TE=Symbol("");var m_;(function(n){n[n.aborted=4]="aborted",n[n.cancelled=8]="cancelled",n[n.duplicated=16]="duplicated"})(m_||(m_={}));function Uo(n,e){return Fe(new Error,{type:n,[TE]:!0},e)}function Nr(n,e){return n instanceof Error&&TE in n&&(e==null||!!(n.type&e))}const g_="[^/]+?",UM={sensitive:!1,strict:!1,start:!0,end:!0},zM=/[.+*?^${}()[\]/\\]/g;function HM(n,e){const t=Fe({},UM,e),r=[];let s=t.start?"^":"";const i=[];for(const c of n){const u=c.length?[]:[90];t.strict&&!c.length&&(s+="/");for(let h=0;h<c.length;h++){const f=c[h];let p=40+(t.sensitive?.25:0);if(f.type===0)h||(s+="/"),s+=f.value.replace(zM,"\\$&"),p+=40;else if(f.type===1){const{value:m,repeatable:y,optional:v,regexp:T}=f;i.push({name:m,repeatable:y,optional:v});const M=T||g_;if(M!==g_){p+=10;try{new RegExp(`(${M})`)}catch(D){throw new Error(`Invalid custom RegExp for param "${m}" (${M}): `+D.message)}}let P=y?`((?:${M})(?:/(?:${M}))*)`:`(${M})`;h||(P=v&&c.length<2?`(?:/${P})`:"/"+P),v&&(P+="?"),s+=P,p+=20,v&&(p+=-8),y&&(p+=-20),M===".*"&&(p+=-50)}u.push(p)}r.push(u)}if(t.strict&&t.end){const c=r.length-1;r[c][r[c].length-1]+=.7000000000000001}t.strict||(s+="/?"),t.end?s+="$":t.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const o=new RegExp(s,t.sensitive?"":"i");function a(c){const u=c.match(o),h={};if(!u)return null;for(let f=1;f<u.length;f++){const p=u[f]||"",m=i[f-1];h[m.name]=p&&m.repeatable?p.split("/"):p}return h}function l(c){let u="",h=!1;for(const f of n){(!h||!u.endsWith("/"))&&(u+="/"),h=!1;for(const p of f)if(p.type===0)u+=p.value;else if(p.type===1){const{value:m,repeatable:y,optional:v}=p,T=m in c?c[m]:"";if(Yn(T)&&!y)throw new Error(`Provided param "${m}" is an array but it is not repeatable (* or + modifiers)`);const M=Yn(T)?T.join("/"):T;if(!M)if(v)f.length<2&&(u.endsWith("/")?u=u.slice(0,-1):h=!0);else throw new Error(`Missing required param "${m}"`);u+=M}}return u||"/"}return{re:o,score:r,keys:i,parse:a,stringify:l}}function jM(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=e[t]-n[t];if(r)return r;t++}return n.length<e.length?n.length===1&&n[0]===80?-1:1:n.length>e.length?e.length===1&&e[0]===80?1:-1:0}function SE(n,e){let t=0;const r=n.score,s=e.score;for(;t<r.length&&t<s.length;){const i=jM(r[t],s[t]);if(i)return i;t++}if(Math.abs(s.length-r.length)===1){if(y_(r))return 1;if(y_(s))return-1}return s.length-r.length}function y_(n){const e=n[n.length-1];return n.length>0&&e[e.length-1]<0}const WM={type:0,value:""},qM=/[a-zA-Z0-9_]/;function KM(n){if(!n)return[[]];if(n==="/")return[[WM]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function e(p){throw new Error(`ERR (${t})/"${c}": ${p}`)}let t=0,r=t;const s=[];let i;function o(){i&&s.push(i),i=[]}let a=0,l,c="",u="";function h(){c&&(t===0?i.push({type:0,value:c}):t===1||t===2||t===3?(i.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:c,regexp:u,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),c="")}function f(){c+=l}for(;a<n.length;){if(l=n[a++],l==="\\"&&t!==2){r=t,t=4;continue}switch(t){case 0:l==="/"?(c&&h(),o()):l===":"?(h(),t=1):f();break;case 4:f(),t=r;break;case 1:l==="("?t=2:qM.test(l)?f():(h(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case 2:l===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+l:t=3:u+=l;break;case 3:h(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--,u="";break;default:e("Unknown state");break}}return t===2&&e(`Unfinished custom RegExp for param "${c}"`),h(),o(),s}function GM(n,e,t){const r=HM(KM(n.path),t),s=Fe(r,{record:n,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function JM(n,e){const t=[],r=new Map;e=b_({strict:!1,end:!0,sensitive:!1},e);function s(h){return r.get(h)}function i(h,f,p){const m=!p,y=v_(h);y.aliasOf=p&&p.record;const v=b_(e,h),T=[y];if("alias"in h){const D=typeof h.alias=="string"?[h.alias]:h.alias;for(const L of D)T.push(v_(Fe({},y,{components:p?p.record.components:y.components,path:L,aliasOf:p?p.record:y})))}let M,P;for(const D of T){const{path:L}=D;if(f&&L[0]!=="/"){const q=f.record.path,S=q[q.length-1]==="/"?"":"/";D.path=f.record.path+(L&&S+L)}if(M=GM(D,f,v),p?p.alias.push(M):(P=P||M,P!==M&&P.alias.push(M),m&&h.name&&!w_(M)&&o(h.name)),CE(M)&&l(M),y.children){const q=y.children;for(let S=0;S<q.length;S++)i(q[S],M,p&&p.children[S])}p=p||M}return P?()=>{o(P)}:Ya}function o(h){if(EE(h)){const f=r.get(h);f&&(r.delete(h),t.splice(t.indexOf(f),1),f.children.forEach(o),f.alias.forEach(o))}else{const f=t.indexOf(h);f>-1&&(t.splice(f,1),h.record.name&&r.delete(h.record.name),h.children.forEach(o),h.alias.forEach(o))}}function a(){return t}function l(h){const f=XM(h,t);t.splice(f,0,h),h.record.name&&!w_(h)&&r.set(h.record.name,h)}function c(h,f){let p,m={},y,v;if("name"in h&&h.name){if(p=r.get(h.name),!p)throw Uo(1,{location:h});v=p.record.name,m=Fe(__(f.params,p.keys.filter(P=>!P.optional).concat(p.parent?p.parent.keys.filter(P=>P.optional):[]).map(P=>P.name)),h.params&&__(h.params,p.keys.map(P=>P.name))),y=p.stringify(m)}else if(h.path!=null)y=h.path,p=t.find(P=>P.re.test(y)),p&&(m=p.parse(y),v=p.record.name);else{if(p=f.name?r.get(f.name):t.find(P=>P.re.test(f.path)),!p)throw Uo(1,{location:h,currentLocation:f});v=p.record.name,m=Fe({},f.params,h.params),y=p.stringify(m)}const T=[];let M=p;for(;M;)T.unshift(M.record),M=M.parent;return{name:v,path:y,params:m,matched:T,meta:YM(T)}}n.forEach(h=>i(h));function u(){t.length=0,r.clear()}return{addRoute:i,resolve:c,removeRoute:o,clearRoutes:u,getRoutes:a,getRecordMatcher:s}}function __(n,e){const t={};for(const r of e)r in n&&(t[r]=n[r]);return t}function v_(n){const e={path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:n.aliasOf,beforeEnter:n.beforeEnter,props:QM(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function QM(n){const e={},t=n.props||!1;if("component"in n)e.default=t;else for(const r in n.components)e[r]=typeof t=="object"?t[r]:t;return e}function w_(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function YM(n){return n.reduce((e,t)=>Fe(e,t.meta),{})}function b_(n,e){const t={};for(const r in n)t[r]=r in e?e[r]:n[r];return t}function XM(n,e){let t=0,r=e.length;for(;t!==r;){const i=t+r>>1;SE(n,e[i])<0?r=i:t=i+1}const s=ZM(n);return s&&(r=e.lastIndexOf(s,r-1)),r}function ZM(n){let e=n;for(;e=e.parent;)if(CE(e)&&SE(n,e)===0)return e}function CE({record:n}){return!!(n.name||n.components&&Object.keys(n.components).length||n.redirect)}function eP(n){const e={};if(n===""||n==="?")return e;const r=(n[0]==="?"?n.slice(1):n).split("&");for(let s=0;s<r.length;++s){const i=r[s].replace(gE," "),o=i.indexOf("="),a=Tl(o<0?i:i.slice(0,o)),l=o<0?null:Tl(i.slice(o+1));if(a in e){let c=e[a];Yn(c)||(c=e[a]=[c]),c.push(l)}else e[a]=l}return e}function E_(n){let e="";for(let t in n){const r=n[t];if(t=vM(t),r==null){r!==void 0&&(e+=(e.length?"&":"")+t);continue}(Yn(r)?r.map(i=>i&&wp(i)):[r&&wp(r)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+t,i!=null&&(e+="="+i))})}return e}function tP(n){const e={};for(const t in n){const r=n[t];r!==void 0&&(e[t]=Yn(r)?r.map(s=>s==null?null:""+s):r==null?r:""+r)}return e}const nP=Symbol(""),T_=Symbol(""),nd=Symbol(""),Ym=Symbol(""),Ep=Symbol("");function Ra(){let n=[];function e(r){return n.push(r),()=>{const s=n.indexOf(r);s>-1&&n.splice(s,1)}}function t(){n=[]}return{add:e,list:()=>n.slice(),reset:t}}function Es(n,e,t,r,s,i=o=>o()){const o=r&&(r.enterCallbacks[s]=r.enterCallbacks[s]||[]);return()=>new Promise((a,l)=>{const c=f=>{f===!1?l(Uo(4,{from:t,to:e})):f instanceof Error?l(f):$M(f)?l(Uo(2,{from:e,to:f})):(o&&r.enterCallbacks[s]===o&&typeof f=="function"&&o.push(f),a())},u=i(()=>n.call(r&&r.instances[s],e,t,c));let h=Promise.resolve(u);n.length<3&&(h=h.then(c)),h.catch(f=>l(f))})}function vf(n,e,t,r,s=i=>i()){const i=[];for(const o of n)for(const a in o.components){let l=o.components[a];if(!(e!=="beforeRouteEnter"&&!o.instances[a]))if(pE(l)){const u=(l.__vccOpts||l)[e];u&&i.push(Es(u,t,r,o,a,s))}else{let c=l();i.push(()=>c.then(u=>{if(!u)throw new Error(`Couldn't resolve component "${a}" at "${o.path}"`);const h=lM(u)?u.default:u;o.mods[a]=u,o.components[a]=h;const p=(h.__vccOpts||h)[e];return p&&Es(p,t,r,o,a,s)()}))}}return i}function S_(n){const e=Vn(nd),t=Vn(Ym),r=un(()=>{const l=qe(n.to);return e.resolve(l)}),s=un(()=>{const{matched:l}=r.value,{length:c}=l,u=l[c-1],h=t.matched;if(!u||!h.length)return-1;const f=h.findIndex($o.bind(null,u));if(f>-1)return f;const p=C_(l[c-2]);return c>1&&C_(u)===p&&h[h.length-1].path!==p?h.findIndex($o.bind(null,l[c-2])):f}),i=un(()=>s.value>-1&&aP(t.params,r.value.params)),o=un(()=>s.value>-1&&s.value===t.matched.length-1&&wE(t.params,r.value.params));function a(l={}){if(oP(l)){const c=e[qe(n.replace)?"replace":"push"](qe(n.to)).catch(Ya);return n.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>c),c}return Promise.resolve()}return{route:r,href:un(()=>r.value.href),isActive:i,isExactActive:o,navigate:a}}function rP(n){return n.length===1?n[0]:n}const sP=Wm({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:S_,setup(n,{slots:e}){const t=Gl(S_(n)),{options:r}=Vn(nd),s=un(()=>({[A_(n.activeClass,r.linkActiveClass,"router-link-active")]:t.isActive,[A_(n.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const i=e.default&&rP(e.default(t));return n.custom?i:ed("a",{"aria-current":t.isExactActive?n.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:s.value},i)}}}),iP=sP;function oP(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}function aP(n,e){for(const t in e){const r=e[t],s=n[t];if(typeof r=="string"){if(r!==s)return!1}else if(!Yn(s)||s.length!==r.length||r.some((i,o)=>i!==s[o]))return!1}return!0}function C_(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const A_=(n,e,t)=>n??e??t,lP=Wm({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:e,slots:t}){const r=Vn(Ep),s=un(()=>n.route||r.value),i=Vn(T_,0),o=un(()=>{let c=qe(i);const{matched:u}=s.value;let h;for(;(h=u[c])&&!h.components;)c++;return c}),a=un(()=>s.value.matched[o.value]);Yc(T_,un(()=>o.value+1)),Yc(nP,a),Yc(Ep,s);const l=$e();return Po(()=>[l.value,a.value,n.name],([c,u,h],[f,p,m])=>{u&&(u.instances[h]=c,p&&p!==u&&c&&c===f&&(u.leaveGuards.size||(u.leaveGuards=p.leaveGuards),u.updateGuards.size||(u.updateGuards=p.updateGuards))),c&&u&&(!p||!$o(u,p)||!f)&&(u.enterCallbacks[h]||[]).forEach(y=>y(c))},{flush:"post"}),()=>{const c=s.value,u=n.name,h=a.value,f=h&&h.components[u];if(!f)return I_(t.default,{Component:f,route:c});const p=h.props[u],m=p?p===!0?c.params:typeof p=="function"?p(c):p:null,v=ed(f,Fe({},m,e,{onVnodeUnmounted:T=>{T.component.isUnmounted&&(h.instances[u]=null)},ref:l}));return I_(t.default,{Component:v,route:c})||v}}});function I_(n,e){if(!n)return null;const t=n(e);return t.length===1?t[0]:t}const cP=lP;function uP(n){const e=JM(n.routes,n),t=n.parseQuery||eP,r=n.stringifyQuery||E_,s=n.history,i=Ra(),o=Ra(),a=Ra(),l=C1(ms);let c=ms;_o&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=yf.bind(null,$=>""+$),h=yf.bind(null,bM),f=yf.bind(null,Tl);function p($,re){let ee,ie;return EE($)?(ee=e.getRecordMatcher($),ie=re):ie=$,e.addRoute(ie,ee)}function m($){const re=e.getRecordMatcher($);re&&e.removeRoute(re)}function y(){return e.getRoutes().map($=>$.record)}function v($){return!!e.getRecordMatcher($)}function T($,re){if(re=Fe({},re||l.value),typeof $=="string"){const N=_f(t,$,re.path),U=e.resolve({path:N.path},re),j=s.createHref(N.fullPath);return Fe(N,U,{params:f(U.params),hash:Tl(N.hash),redirectedFrom:void 0,href:j})}let ee;if($.path!=null)ee=Fe({},$,{path:_f(t,$.path,re.path).path});else{const N=Fe({},$.params);for(const U in N)N[U]==null&&delete N[U];ee=Fe({},$,{params:h(N)}),re.params=h(re.params)}const ie=e.resolve(ee,re),ze=$.hash||"";ie.params=u(f(ie.params));const A=SM(r,Fe({},$,{hash:_M(ze),path:ie.path})),x=s.createHref(A);return Fe({fullPath:A,hash:ze,query:r===E_?tP($.query):$.query||{}},ie,{redirectedFrom:void 0,href:x})}function M($){return typeof $=="string"?_f(t,$,l.value.path):Fe({},$)}function P($,re){if(c!==$)return Uo(8,{from:re,to:$})}function D($){return S($)}function L($){return D(Fe(M($),{replace:!0}))}function q($){const re=$.matched[$.matched.length-1];if(re&&re.redirect){const{redirect:ee}=re;let ie=typeof ee=="function"?ee($):ee;return typeof ie=="string"&&(ie=ie.includes("?")||ie.includes("#")?ie=M(ie):{path:ie},ie.params={}),Fe({query:$.query,hash:$.hash,params:ie.path!=null?{}:$.params},ie)}}function S($,re){const ee=c=T($),ie=l.value,ze=$.state,A=$.force,x=$.replace===!0,N=q(ee);if(N)return S(Fe(M(N),{state:typeof N=="object"?Fe({},ze,N.state):ze,force:A,replace:x}),re||ee);const U=ee;U.redirectedFrom=re;let j;return!A&&CM(r,ie,ee)&&(j=Uo(16,{to:U,from:ie}),_n(ie,ie,!0,!1)),(j?Promise.resolve(j):I(U,ie)).catch(F=>Nr(F)?Nr(F,2)?F:tr(F):Ne(F,U,ie)).then(F=>{if(F){if(Nr(F,2))return S(Fe({replace:x},M(F.to),{state:typeof F.to=="object"?Fe({},ze,F.to.state):ze,force:A}),re||U)}else F=k(U,ie,!0,x,ze);return R(U,ie,F),F})}function w($,re){const ee=P($,re);return ee?Promise.reject(ee):Promise.resolve()}function b($){const re=Un.values().next().value;return re&&typeof re.runWithContext=="function"?re.runWithContext($):$()}function I($,re){let ee;const[ie,ze,A]=hP($,re);ee=vf(ie.reverse(),"beforeRouteLeave",$,re);for(const N of ie)N.leaveGuards.forEach(U=>{ee.push(Es(U,$,re))});const x=w.bind(null,$,re);return ee.push(x),jt(ee).then(()=>{ee=[];for(const N of i.list())ee.push(Es(N,$,re));return ee.push(x),jt(ee)}).then(()=>{ee=vf(ze,"beforeRouteUpdate",$,re);for(const N of ze)N.updateGuards.forEach(U=>{ee.push(Es(U,$,re))});return ee.push(x),jt(ee)}).then(()=>{ee=[];for(const N of A)if(N.beforeEnter)if(Yn(N.beforeEnter))for(const U of N.beforeEnter)ee.push(Es(U,$,re));else ee.push(Es(N.beforeEnter,$,re));return ee.push(x),jt(ee)}).then(()=>($.matched.forEach(N=>N.enterCallbacks={}),ee=vf(A,"beforeRouteEnter",$,re,b),ee.push(x),jt(ee))).then(()=>{ee=[];for(const N of o.list())ee.push(Es(N,$,re));return ee.push(x),jt(ee)}).catch(N=>Nr(N,8)?N:Promise.reject(N))}function R($,re,ee){a.list().forEach(ie=>b(()=>ie($,re,ee)))}function k($,re,ee,ie,ze){const A=P($,re);if(A)return A;const x=re===ms,N=_o?history.state:{};ee&&(ie||x?s.replace($.fullPath,Fe({scroll:x&&N&&N.scroll},ze)):s.push($.fullPath,ze)),l.value=$,_n($,re,ee,x),tr()}let C;function _e(){C||(C=s.listen(($,re,ee)=>{if(!as.listening)return;const ie=T($),ze=q(ie);if(ze){S(Fe(ze,{replace:!0,force:!0}),ie).catch(Ya);return}c=ie;const A=l.value;_o&&NM(f_(A.fullPath,ee.delta),td()),I(ie,A).catch(x=>Nr(x,12)?x:Nr(x,2)?(S(Fe(M(x.to),{force:!0}),ie).then(N=>{Nr(N,20)&&!ee.delta&&ee.type===Sl.pop&&s.go(-1,!1)}).catch(Ya),Promise.reject()):(ee.delta&&s.go(-ee.delta,!1),Ne(x,ie,A))).then(x=>{x=x||k(ie,A,!1),x&&(ee.delta&&!Nr(x,8)?s.go(-ee.delta,!1):ee.type===Sl.pop&&Nr(x,20)&&s.go(-1,!1)),R(ie,A,x)}).catch(Ya)}))}let Ae=Ra(),Re=Ra(),fe;function Ne($,re,ee){tr($);const ie=Re.list();return ie.length?ie.forEach(ze=>ze($,re,ee)):console.error($),Promise.reject($)}function fn(){return fe&&l.value!==ms?Promise.resolve():new Promise(($,re)=>{Ae.add([$,re])})}function tr($){return fe||(fe=!$,_e(),Ae.list().forEach(([re,ee])=>$?ee($):re()),Ae.reset()),$}function _n($,re,ee,ie){const{scrollBehavior:ze}=n;if(!_o||!ze)return Promise.resolve();const A=!ee&&OM(f_($.fullPath,0))||(ie||!ee)&&history.state&&history.state.scroll||null;return jh().then(()=>ze($,re,A)).then(x=>x&&PM(x)).catch(x=>Ne(x,$,re))}const Nt=$=>s.go($);let xr;const Un=new Set,as={currentRoute:l,listening:!0,addRoute:p,removeRoute:m,clearRoutes:e.clearRoutes,hasRoute:v,getRoutes:y,resolve:T,options:n,push:D,replace:L,go:Nt,back:()=>Nt(-1),forward:()=>Nt(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:Re.add,isReady:fn,install($){const re=this;$.component("RouterLink",iP),$.component("RouterView",cP),$.config.globalProperties.$router=re,Object.defineProperty($.config.globalProperties,"$route",{enumerable:!0,get:()=>qe(l)}),_o&&!xr&&l.value===ms&&(xr=!0,D(s.location).catch(ze=>{}));const ee={};for(const ze in ms)Object.defineProperty(ee,ze,{get:()=>l.value[ze],enumerable:!0});$.provide(nd,re),$.provide(Ym,T1(ee)),$.provide(Ep,l);const ie=$.unmount;Un.add($),$.unmount=function(){Un.delete($),Un.size<1&&(c=ms,C&&C(),C=null,l.value=ms,xr=!1,fe=!1),ie()}}};function jt($){return $.reduce((re,ee)=>re.then(()=>b(ee)),Promise.resolve())}return as}function hP(n,e){const t=[],r=[],s=[],i=Math.max(e.matched.length,n.matched.length);for(let o=0;o<i;o++){const a=e.matched[o];a&&(n.matched.find(c=>$o(c,a))?r.push(a):t.push(a));const l=n.matched[o];l&&(e.matched.find(c=>$o(c,l))||s.push(l))}return[t,r,s]}function rd(){return Vn(nd)}function Xm(n){return Vn(Ym)}const dP="/accounting-site/assets/logo-name-DKMeXibA.png",fP={class:"title"},pP={__name:"Title",props:{title:{type:String,required:!0}},setup(n){return(e,t)=>(we(),Ce("div",fP,[W("h3",null,it(n.title),1)]))}},AE=zt(pP,[["__scopeId","data-v-201c176b"]]),mP={class:"service-target"},gP={__name:"ServiceTarget",props:{target:{type:String,required:!0}},setup(n){return(e,t)=>(we(),Ce("div",mP,it(n.target),1))}},yP=zt(gP,[["__scopeId","data-v-d5757030"]]),_P={class:"info-section"},vP={class:"container"},wP={class:"card-inside"},bP={__name:"InfoSection",props:{title:{type:String,required:!0},infoList:{type:Array,required:!0},twoCol:{type:Boolean}},setup(n){return(e,t)=>(we(),Ce("section",_P,[W("div",vP,[ke(AE,{title:n.title},null,8,["title"]),(we(!0),Ce(Xt,null,Ga(n.infoList,(r,s)=>(we(),Ce("div",{key:s,class:"card-container"},[r.target?(we(),Yh(yP,{key:0,target:r.target},null,8,["target"])):br("",!0),W("div",wP,[(we(!0),Ce(Xt,null,Ga(r.categories,(i,o)=>(we(),Ce("div",{key:o,class:Ni([{twoCard:n.twoCol},"card"])},[W("h3",null,it(i.name||i.title),1),W("p",null,it(i.desc),1),W("ul",null,[(we(!0),Ce(Xt,null,Ga(i.items,(a,l)=>(we(),Ce("li",{key:l},it(a),1))),128))])],2))),128))])]))),128))])]))}},k_=zt(bP,[["__scopeId","data-v-da89fcd3"]]),EP="/accounting-site/assets/james-CDFwbDAa.png",TP={},SP={class:"about-us"};function CP(n,e){return we(),Ce("section",SP,[...e[0]||(e[0]=[iE('<div class="img-inside" data-v-3743b053><img src="'+EP+'" alt="" data-v-3743b053></div><div class="introduce" data-v-3743b053><h4 class="title" data-v-3743b053>James</h4><p class="title-desc" data-v-3743b053></p><h5 class="sub-title" data-v-3743b053></h5><ul data-v-3743b053><li data-v-3743b053>()</li><li data-v-3743b053></li><li data-v-3743b053></li><li data-v-3743b053> (DY)</li></ul><h5 class="sub-title" data-v-3743b053></h5><ul data-v-3743b053><li data-v-3743b053></li><li data-v-3743b053></li><li data-v-3743b053></li><li data-v-3743b053></li><li data-v-3743b053> </li></ul></div>',2)])])}const AP=zt(TP,[["render",CP],["__scopeId","data-v-3743b053"]]),IP="/accounting-site/assets/line-Bf_xZ2G0.jpg",kP="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20x='0px'%20y='0px'%20width='100'%20height='100'%20viewBox='0%200%2048%2048'%3e%3cpath%20fill='%2300c300'%20d='M12.5,42h23c3.59,0,6.5-2.91,6.5-6.5v-23C42,8.91,39.09,6,35.5,6h-23C8.91,6,6,8.91,6,12.5v23C6,39.09,8.91,42,12.5,42z'%3e%3c/path%3e%3cpath%20fill='%23fff'%20d='M37.113,22.417c0-5.865-5.88-10.637-13.107-10.637s-13.108,4.772-13.108,10.637c0,5.258,4.663,9.662,10.962,10.495c0.427,0.092,1.008,0.282,1.155,0.646c0.132,0.331,0.086,0.85,0.042,1.185c0,0-0.153,0.925-0.187,1.122c-0.057,0.331-0.263,1.296,1.135,0.707c1.399-0.589,7.548-4.445,10.298-7.611h-0.001C36.203,26.879,37.113,24.764,37.113,22.417z%20M18.875,25.907h-2.604c-0.379,0-0.687-0.308-0.687-0.688V20.01c0-0.379,0.308-0.687,0.687-0.687c0.379,0,0.687,0.308,0.687,0.687v4.521h1.917c0.379,0,0.687,0.308,0.687,0.687C19.562,25.598,19.254,25.907,18.875,25.907z%20M21.568,25.219c0,0.379-0.308,0.688-0.687,0.688s-0.687-0.308-0.687-0.688V20.01c0-0.379,0.308-0.687,0.687-0.687s0.687,0.308,0.687,0.687V25.219z%20M27.838,25.219c0,0.297-0.188,0.559-0.47,0.652c-0.071,0.024-0.145,0.036-0.218,0.036c-0.215,0-0.42-0.103-0.549-0.275l-2.669-3.635v3.222c0,0.379-0.308,0.688-0.688,0.688c-0.379,0-0.688-0.308-0.688-0.688V20.01c0-0.296,0.189-0.558,0.47-0.652c0.071-0.024,0.144-0.035,0.218-0.035c0.214,0,0.42,0.103,0.549,0.275l2.67,3.635V20.01c0-0.379,0.309-0.687,0.688-0.687c0.379,0,0.687,0.308,0.687,0.687V25.219z%20M32.052,21.927c0.379,0,0.688,0.308,0.688,0.688c0,0.379-0.308,0.687-0.688,0.687h-1.917v1.23h1.917c0.379,0,0.688,0.308,0.688,0.687c0,0.379-0.309,0.688-0.688,0.688h-2.604c-0.378,0-0.687-0.308-0.687-0.688v-2.603c0-0.001,0-0.001,0-0.001c0,0,0-0.001,0-0.001v-2.601c0-0.001,0-0.001,0-0.002c0-0.379,0.308-0.687,0.687-0.687h2.604c0.379,0,0.688,0.308,0.688,0.687s-0.308,0.687-0.688,0.687h-1.917v1.23H32.052z'%3e%3c/path%3e%3c/svg%3e",RP="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20x='0px'%20y='0px'%20width='100'%20height='100'%20viewBox='0%200%2048%2048'%3e%3clinearGradient%20id='Ld6sqrtcxMyckEl6xeDdMa_uLWV5A9vXIPu_gr1'%20x1='9.993'%20x2='40.615'%20y1='9.993'%20y2='40.615'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0'%20stop-color='%232aa4f4'%3e%3c/stop%3e%3cstop%20offset='1'%20stop-color='%23007ad9'%3e%3c/stop%3e%3c/linearGradient%3e%3cpath%20fill='url(%23Ld6sqrtcxMyckEl6xeDdMa_uLWV5A9vXIPu_gr1)'%20d='M24,4C12.954,4,4,12.954,4,24s8.954,20,20,20s20-8.954,20-20S35.046,4,24,4z'%3e%3c/path%3e%3cpath%20fill='%23fff'%20d='M26.707,29.301h5.176l0.813-5.258h-5.989v-2.874c0-2.184,0.714-4.121,2.757-4.121h3.283V12.46%20c-0.577-0.078-1.797-0.248-4.102-0.248c-4.814,0-7.636,2.542-7.636,8.334v3.498H16.06v5.258h4.948v14.452%20C21.988,43.9,22.981,44,24,44c0.921,0,1.82-0.084,2.707-0.204V29.301z'%3e%3c/path%3e%3c/svg%3e",xP="/accounting-site/assets/instagram-DG-fKQy-.svg",MP="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20x='0px'%20y='0px'%20width='100'%20height='100'%20viewBox='0%200%2048%2048'%3e%3cpath%20fill='%238BC34A'%20d='M18,6C9.2,6,2,12,2,19.5c0,4.3,2.3,8,6,10.5l-2,6l6.3-3.9C14,32.7,16,33,18,33c8.8,0,16-6,16-13.5C34,12,26.8,6,18,6z'%3e%3c/path%3e%3cpath%20fill='%237CB342'%20d='M20,29c0-6.1,5.8-11,13-11c0.3,0,0.6,0,0.9,0c-0.1-0.7-0.3-1.4-0.5-2c-0.1,0-0.3,0-0.4,0c-8.3,0-15,5.8-15,13c0,1.4,0.3,2.7,0.7,4c0.7,0,1.4-0.1,2.1-0.2C20.3,31.6,20,30.3,20,29z'%3e%3c/path%3e%3cpath%20fill='%23CFD8DC'%20d='M46,29c0-6.1-5.8-11-13-11c-7.2,0-13,4.9-13,11s5.8,11,13,11c1.8,0,3.5-0.3,5-0.8l5,2.8l-1.4-4.8C44.3,35.2,46,32.3,46,29z'%3e%3c/path%3e%3cpath%20fill='%2333691E'%20d='M14,15c0,1.1-0.9,2-2,2s-2-0.9-2-2s0.9-2,2-2S14,13.9,14,15z%20M24,13c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S25.1,13,24,13z'%3e%3c/path%3e%3cpath%20fill='%23546E7A'%20d='M30,26.5c0,0.8-0.7,1.5-1.5,1.5S27,27.3,27,26.5s0.7-1.5,1.5-1.5S30,25.7,30,26.5z%20M37.5,25c-0.8,0-1.5,0.7-1.5,1.5s0.7,1.5,1.5,1.5s1.5-0.7,1.5-1.5S38.3,25,37.5,25z'%3e%3c/path%3e%3c/svg%3e",PP="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20x='0px'%20y='0px'%20width='100'%20height='100'%20viewBox='0%200%2048%2048'%3e%3cpath%20fill='%230288D1'%20d='M42,37c0,2.762-2.238,5-5,5H11c-2.761,0-5-2.238-5-5V11c0-2.762,2.239-5,5-5h26c2.762,0,5,2.238,5,5V37z'%3e%3c/path%3e%3cpath%20fill='%23FFF'%20d='M12%2019H17V36H12zM14.485%2017h-.028C12.965%2017%2012%2015.888%2012%2014.499%2012%2013.08%2012.995%2012%2014.514%2012c1.521%200%202.458%201.08%202.486%202.499C17%2015.887%2016.035%2017%2014.485%2017zM36%2036h-5v-9.099c0-2.198-1.225-3.698-3.192-3.698-1.501%200-2.313%201.012-2.707%201.99C24.957%2025.543%2025%2026.511%2025%2027v9h-5V19h5v2.616C25.721%2020.5%2026.85%2019%2029.738%2019c3.578%200%206.261%202.25%206.261%207.274L36%2036%2036%2036z'%3e%3c/path%3e%3c/svg%3e",NP="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20x='0px'%20y='0px'%20width='100'%20height='100'%20viewBox='0%200%2050%2050'%3e%3cpath%20d='M46,9v32c0,2.757-2.243,5-5,5H9c-2.757,0-5-2.243-5-5V9c0-2.757,2.243-5,5-5h32C43.757,4,46,6.243,46,9z%20M33.544,35.913%20c2.711-2.708,2.635-6.093,1.746-8.17c-0.54-1.255-1.508-2.33-2.798-3.108l-0.223-0.138c-0.33-0.208-0.609-0.375-1.046-0.542%20c-0.008-0.278-0.025-0.556-0.058-0.807c-0.59-4.561-3.551-5.535-5.938-5.55c-2.154,0-3.946,0.92-5.044,2.592l1.672,1.098%20c0.736-1.121,1.871-1.689,3.366-1.689c2.367,0.015,3.625,1.223,3.96,3.801c-1.141-0.231-2.426-0.314-3.807-0.233%20c-3.924,0.226-5.561,2.591-5.442,4.836c0.134,2.486,2.278,4.222,5.216,4.222c0.13,0,0.259-0.003,0.384-0.011%20c2.297-0.126,5.105-1.29,5.61-6.063c0.021,0.013,0.041,0.026,0.062,0.039l0.253,0.157c0.932,0.562,1.621,1.317,1.994,2.185%20c0.643,1.501,0.682,3.964-1.322,5.966c-1.732,1.73-3.812,2.479-6.936,2.502c-3.47-0.026-6.099-1.145-7.812-3.325%20c-1.596-2.028-2.42-4.953-2.451-8.677c0.031-3.728,0.855-6.646,2.451-8.673c1.714-2.181,4.349-3.299,7.814-3.325%20c3.492,0.026,6.165,1.149,7.944,3.338c0.864,1.063,1.525,2.409,1.965,3.998l1.928-0.532c-0.514-1.858-1.301-3.449-2.341-4.728%20c-2.174-2.674-5.363-4.045-9.496-4.076c-4.12,0.031-7.278,1.406-9.387,4.089c-1.875,2.383-2.844,5.712-2.879,9.91%20c0.035,4.193,1.004,7.529,2.879,9.913c2.109,2.682,5.262,4.058,9.385,4.088C28.857,38.973,31.433,38.021,33.544,35.913z%20M28.993,25.405c0.07,0.016,0.138,0.031,0.202,0.046c-0.005,0.078-0.01,0.146-0.015,0.198c-0.314,3.928-2.295,4.489-3.761,4.569%20c-0.091,0.005-0.181,0.008-0.271,0.008c-1.851,0-3.144-0.936-3.218-2.329c-0.065-1.218,0.836-2.576,3.561-2.732%20c0.297-0.018,0.589-0.027,0.875-0.027C27.325,25.137,28.209,25.227,28.993,25.405z'%3e%3c/path%3e%3c/svg%3e",OP="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20x='0px'%20y='0px'%20width='100'%20height='100'%20viewBox='0%200%2050%2050'%3e%3cpath%20d='M35,22v2h1v-2H35z%20M35,22v2h1v-2H35z%20M44,4H6C4.91,4,4,4.91,4,6v38c0,1.09,0.91,2,2,2h38c1.09,0,2-0.91,2-2V6%20C46,4.91,45.09,4,44,4z%20M12,24c0,1.38-0.19,5.89-2.61,6.24l-0.28-1.98C9.5,28.07,10,26.12,10,24v-2h2V24z%20M15,30h-2V19h2V30z%20M17.29,29.71c-1.2-1.2-1.29-4.73-1.29-5.78V22h2v1.93c0,1.91,0.34,3.99,0.71,4.36L17.29,29.71z%20M22,31h-3l1-2h3L22,31z%20M31,31h-7%20l1-2h2v-7h-2l-2.1,4.38h1.72l-1,2H21c-0.8,0-1.28-0.91-0.82-1.57L22,24h-2c-0.78,0-1.26-0.85-0.86-1.51l3-5l1.72,1.02L21.77,22H25%20v-2h6v2h-2v7h2V31z%20M40,28.5c0,1.38-1.12,2.5-2.5,2.5c-1.21,0-1.22-0.86-1.45-2H38v-3h-3v5h-2v-5h-2v-2h2v-2h-1v-2h1v-1h2v1h1%20c1.1,0,2,0.9,2,2v2c1.1,0,2,0.9,2,2V28.5z%20M40,22h-1v-1c0-0.55,0.45-1,1-1s1,0.45,1,1S40.55,22,40,22z%20M35,24h1v-2h-1V24z%20M35,22%20v2h1v-2H35z'%3e%3c/path%3e%3c/svg%3e",DP="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20x='0px'%20y='0px'%20width='100'%20height='100'%20viewBox='0%200%2050%2050'%3e%3cpath%20d='M41,4H9C6.243,4,4,6.243,4,9v32c0,2.757,2.243,5,5,5h32c2.757,0,5-2.243,5-5V9C46,6.243,43.757,4,41,4z%20M37.006,22.323%20c-0.227,0.021-0.457,0.035-0.69,0.035c-2.623,0-4.928-1.349-6.269-3.388c0,5.349,0,11.435,0,11.537c0,4.709-3.818,8.527-8.527,8.527%20s-8.527-3.818-8.527-8.527s3.818-8.527,8.527-8.527c0.178,0,0.352,0.016,0.527,0.027v4.202c-0.175-0.021-0.347-0.053-0.527-0.053%20c-2.404,0-4.352,1.948-4.352,4.352s1.948,4.352,4.352,4.352s4.527-1.894,4.527-4.298c0-0.095,0.042-19.594,0.042-19.594h4.016%20c0.378,3.591,3.277,6.425,6.901,6.685V22.323z'%3e%3c/path%3e%3c/svg%3e",LP={class:"contact"},VP={__name:"Contact",props:{title:{type:String,required:!0}},setup(n){return(e,t)=>(we(),Ce("section",LP,[ke(AE,{title:""}),t[0]||(t[0]=iE('<div class="contact-phone" data-v-35d3f4aa><div class="img-inside" data-v-35d3f4aa><img class="img" src="'+fE+'" data-v-35d3f4aa></div><div class="img-inside" data-v-35d3f4aa><img class="img" src="'+IP+'" width="275" height="275" data-v-35d3f4aa></div><div class="phone" data-v-35d3f4aa><div data-v-35d3f4aa><h3 data-v-35d3f4aa></h3><p data-v-35d3f4aa>02-29730059</p><p data-v-35d3f4aa>0916973296</p><p data-v-35d3f4aa>hedecpa@gmail.com</p></div></div></div><div class="social-media" data-v-35d3f4aa><div data-v-35d3f4aa><a href="https://line.me/ti/p/U_4YvEWa63" target="_blank" aria-label="Line" data-v-35d3f4aa><img src="'+kP+'" data-v-35d3f4aa></a><a href="https://www.facebook.com/share/1CJqK21w1v/" target="_blank" aria-label="Facebook" data-v-35d3f4aa><img src="'+RP+'" data-v-35d3f4aa></a><a href="https://www.instagram.com/cpa__james?igsh=dzl0OHY1ZzRxa2Zr" target="_blank" aria-label="Instagram" data-v-35d3f4aa><img src="'+xP+'" data-v-35d3f4aa></a><a href="" target="_blank" aria-label="Wechat" data-v-35d3f4aa><img src="'+MP+'" data-v-35d3f4aa></a></div><div data-v-35d3f4aa><a href="https://www.linkedin.com/in/james-%E5%92%8C%E5%BE%97%E6%9C%83%E8%A8%88%E5%B8%AB%E4%BA%8B%E5%8B%99%E6%89%80-81bb8b380?utm_source=share&amp;utm_campaign=share_via&amp;utm_content=profile&amp;utm_medium=android_app" target="_blank" aria-label="Linkedin" data-v-35d3f4aa><img src="'+PP+'" data-v-35d3f4aa></a><a href="https://www.threads.com/@cpa__james" target="_blank" aria-label="Threads" data-v-35d3f4aa><img src="'+NP+'" data-v-35d3f4aa></a><a href="https://www.xiaohongshu.com/user/profile/68b56b10000000001901070c?xsec_token=YBHIv8tlNZgFU5imoeubB_mxqexQACEO2sAACXE77OM1o%3D&amp;xsec_source=app_share&amp;xhsshare=CopyLink&amp;appuid=68b56b10000000001901070c&amp;apptime=1757127950&amp;share_id=1e16c269fcb6448aad85c918189465ba&amp;share_channel=copy_link" target="_blank" aria-label="" data-v-35d3f4aa><img src="'+OP+'" data-v-35d3f4aa></a><a href="https://www.tiktok.com/@user731550344?_t=ZS-8zUSJmLjIwB&amp;_r=1" target="_blank" aria-label="Tiktok" data-v-35d3f4aa><img src="'+DP+'" data-v-35d3f4aa></a></div></div>',2)),t[1]||(t[1]=W("div",{class:"map"},[W("div",null,[W("p",null,"632"),W("iframe",{src:"https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3614.0715399841774!2d121.49964077557456!3d25.06556427779594!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3442a93408f1c6cb%3A0x5bd6d9fafbbf6c8a!2z5ZKM5b6X5pyD6KiI5bir5LqL5YuZ5omA!5e0!3m2!1szh-TW!2stw!4v1756027824509!5m2!1szh-TW!2stw",width:"600",height:"450",style:{border:"0"},allowfullscreen:"",loading:"lazy",referrerpolicy:"no-referrer-when-downgrade"})]),W("div",null,[W("p",null,""),W("iframe",{src:"https://www.google.com/maps/embed?pb=!1m16!1m12!1m3!1d1379.626138302121!2d121.3100801219292!3d25.010171883055904!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!2m1!1z5qGD5ZyS5biC5qGD5ZyS5Y2A5pil5pel6Lev5r2k5rOw5aSn5a62!5e0!3m2!1szh-TW!2stw!4v1757162027599!5m2!1szh-TW!2stw",width:"600",height:"450",style:{border:"0"},allowfullscreen:"",loading:"lazy",referrerpolicy:"no-referrer-when-downgrade"})])],-1))]))}},FP=zt(VP,[["__scopeId","data-v-35d3f4aa"]]),BP=()=>{};var R_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IE=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},$P=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],o=n[t++],a=n[t++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],o=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},kE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,a=o?n[s+1]:0,l=s+2<n.length,c=l?n[s+2]:0,u=i>>2,h=(i&3)<<4|a>>4;let f=(a&15)<<2|c>>6,p=c&63;l||(p=64,o||(f=64)),r.push(t[u],t[h],t[f],t[p])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(IE(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):$P(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],a=s<n.length?t[n.charAt(s)]:0;++s;const c=s<n.length?t[n.charAt(s)]:64;++s;const h=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||a==null||c==null||h==null)throw new UP;const f=i<<2|a>>4;if(r.push(f),c!==64){const p=a<<4&240|c>>2;if(r.push(p),h!==64){const m=c<<6&192|h;r.push(m)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class UP extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const zP=function(n){const e=IE(n);return kE.encodeByteArray(e,!0)},ku=function(n){return zP(n).replace(/\./g,"")},RE=function(n){try{return kE.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HP(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jP=()=>HP().__FIREBASE_DEFAULTS__,WP=()=>{if(typeof process>"u"||typeof R_>"u")return;const n=R_.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},qP=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&RE(n[1]);return e&&JSON.parse(e)},sd=()=>{try{return BP()||jP()||WP()||qP()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},xE=n=>sd()?.emulatorHosts?.[n],ME=n=>{const e=xE(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},PE=()=>sd()?.config,NE=n=>sd()?.[`_${n}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KP{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eo(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Zm(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OE(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...n};return[ku(JSON.stringify(t)),ku(JSON.stringify(o)),""].join(".")}const Za={};function GP(){const n={prod:[],emulator:[]};for(const e of Object.keys(Za))Za[e]?n.emulator.push(e):n.prod.push(e);return n}function JP(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let x_=!1;function eg(n,e){if(typeof window>"u"||typeof document>"u"||!eo(window.location.host)||Za[n]===e||Za[n]||x_)return;Za[n]=e;function t(f){return`__firebase__banner__${f}`}const r="__firebase__banner",i=GP().prod.length>0;function o(){const f=document.getElementById(r);f&&f.remove()}function a(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function l(f,p){f.setAttribute("width","24"),f.setAttribute("id",p),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function c(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{x_=!0,o()},f}function u(f,p){f.setAttribute("id",p),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function h(){const f=JP(r),p=t("text"),m=document.getElementById(p)||document.createElement("span"),y=t("learnmore"),v=document.getElementById(y)||document.createElement("a"),T=t("preprendIcon"),M=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const P=f.element;a(P),u(v,y);const D=c();l(M,T),P.append(M,m,v,D),document.body.appendChild(P)}i?(m.innerText="Preview backend disconnected.",M.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(M.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,m.innerText="Preview backend running in this workspace."),m.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function QP(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(tn())}function YP(){const n=sd()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function XP(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function ZP(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function eN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function tN(){const n=tn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function nN(){return!YP()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function rN(){try{return typeof indexedDB=="object"}catch{return!1}}function sN(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iN="FirebaseError";class Ir extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=iN,Object.setPrototypeOf(this,Ir.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Yl.prototype.create)}}class Yl{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?oN(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Ir(s,a,r)}}function oN(n,e){return n.replace(aN,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const aN=/\{\$([^}]+)}/g;function lN(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function zi(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],o=e[s];if(M_(i)&&M_(o)){if(!zi(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function M_(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xl(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Na(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Oa(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function cN(n,e){const t=new uN(n,e);return t.subscribe.bind(t)}class uN{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");hN(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=wf),s.error===void 0&&(s.error=wf),s.complete===void 0&&(s.complete=wf);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function hN(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function wf(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wt(n){return n&&n._delegate?n._delegate:n}class Xs{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ci="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dN{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new KP;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(pN(e))try{this.getOrInitializeService({instanceIdentifier:Ci})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Ci){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ci){return this.instances.has(e)}getOptions(e=Ci){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:fN(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ci){return this.component?this.component.multipleInstances?e:Ci:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function fN(n){return n===Ci?void 0:n}function pN(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new dN(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xe;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(xe||(xe={}));const gN={debug:xe.DEBUG,verbose:xe.VERBOSE,info:xe.INFO,warn:xe.WARN,error:xe.ERROR,silent:xe.SILENT},yN=xe.INFO,_N={[xe.DEBUG]:"log",[xe.VERBOSE]:"log",[xe.INFO]:"info",[xe.WARN]:"warn",[xe.ERROR]:"error"},vN=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=_N[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class tg{constructor(e){this.name=e,this._logLevel=yN,this._logHandler=vN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in xe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?gN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,xe.DEBUG,...e),this._logHandler(this,xe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,xe.VERBOSE,...e),this._logHandler(this,xe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,xe.INFO,...e),this._logHandler(this,xe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,xe.WARN,...e),this._logHandler(this,xe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,xe.ERROR,...e),this._logHandler(this,xe.ERROR,...e)}}const wN=(n,e)=>e.some(t=>n instanceof t);let P_,N_;function bN(){return P_||(P_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function EN(){return N_||(N_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const DE=new WeakMap,Tp=new WeakMap,LE=new WeakMap,bf=new WeakMap,ng=new WeakMap;function TN(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t($s(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&DE.set(t,n)}).catch(()=>{}),ng.set(e,n),e}function SN(n){if(Tp.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});Tp.set(n,e)}let Sp={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Tp.get(n);if(e==="objectStoreNames")return n.objectStoreNames||LE.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return $s(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function CN(n){Sp=n(Sp)}function AN(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Ef(this),e,...t);return LE.set(r,e.sort?e.sort():[e]),$s(r)}:EN().includes(n)?function(...e){return n.apply(Ef(this),e),$s(DE.get(this))}:function(...e){return $s(n.apply(Ef(this),e))}}function IN(n){return typeof n=="function"?AN(n):(n instanceof IDBTransaction&&SN(n),wN(n,bN())?new Proxy(n,Sp):n)}function $s(n){if(n instanceof IDBRequest)return TN(n);if(bf.has(n))return bf.get(n);const e=IN(n);return e!==n&&(bf.set(n,e),ng.set(e,n)),e}const Ef=n=>ng.get(n);function kN(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,e),a=$s(o);return r&&o.addEventListener("upgradeneeded",l=>{r($s(o.result),l.oldVersion,l.newVersion,$s(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const RN=["get","getKey","getAll","getAllKeys","count"],xN=["put","add","delete","clear"],Tf=new Map;function O_(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Tf.get(e))return Tf.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=xN.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||RN.includes(t)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),s&&l.done]))[0]};return Tf.set(e,i),i}CN(n=>({...n,get:(e,t,r)=>O_(e,t)||n.get(e,t,r),has:(e,t)=>!!O_(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(PN(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function PN(n){return n.getComponent()?.type==="VERSION"}const Cp="@firebase/app",D_="0.14.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zr=new tg("@firebase/app"),NN="@firebase/app-compat",ON="@firebase/analytics-compat",DN="@firebase/analytics",LN="@firebase/app-check-compat",VN="@firebase/app-check",FN="@firebase/auth",BN="@firebase/auth-compat",$N="@firebase/database",UN="@firebase/data-connect",zN="@firebase/database-compat",HN="@firebase/functions",jN="@firebase/functions-compat",WN="@firebase/installations",qN="@firebase/installations-compat",KN="@firebase/messaging",GN="@firebase/messaging-compat",JN="@firebase/performance",QN="@firebase/performance-compat",YN="@firebase/remote-config",XN="@firebase/remote-config-compat",ZN="@firebase/storage",e2="@firebase/storage-compat",t2="@firebase/firestore",n2="@firebase/ai",r2="@firebase/firestore-compat",s2="firebase",i2="12.4.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ap="[DEFAULT]",o2={[Cp]:"fire-core",[NN]:"fire-core-compat",[DN]:"fire-analytics",[ON]:"fire-analytics-compat",[VN]:"fire-app-check",[LN]:"fire-app-check-compat",[FN]:"fire-auth",[BN]:"fire-auth-compat",[$N]:"fire-rtdb",[UN]:"fire-data-connect",[zN]:"fire-rtdb-compat",[HN]:"fire-fn",[jN]:"fire-fn-compat",[WN]:"fire-iid",[qN]:"fire-iid-compat",[KN]:"fire-fcm",[GN]:"fire-fcm-compat",[JN]:"fire-perf",[QN]:"fire-perf-compat",[YN]:"fire-rc",[XN]:"fire-rc-compat",[ZN]:"fire-gcs",[e2]:"fire-gcs-compat",[t2]:"fire-fst",[r2]:"fire-fst-compat",[n2]:"fire-vertex","fire-js":"fire-js",[s2]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ru=new Map,a2=new Map,Ip=new Map;function L_(n,e){try{n.container.addComponent(e)}catch(t){Zr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Hi(n){const e=n.name;if(Ip.has(e))return Zr.debug(`There were multiple attempts to register component ${e}.`),!1;Ip.set(e,n);for(const t of Ru.values())L_(t,n);for(const t of a2.values())L_(t,n);return!0}function id(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Nn(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l2={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Us=new Yl("app","Firebase",l2);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c2{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Xs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Us.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const to=i2;function VE(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Ap,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Us.create("bad-app-name",{appName:String(s)});if(t||(t=PE()),!t)throw Us.create("no-options");const i=Ru.get(s);if(i){if(zi(t,i.options)&&zi(r,i.config))return i;throw Us.create("duplicate-app",{appName:s})}const o=new mN(s);for(const l of Ip.values())o.addComponent(l);const a=new c2(t,r,o);return Ru.set(s,a),a}function rg(n=Ap){const e=Ru.get(n);if(!e&&n===Ap&&PE())return VE();if(!e)throw Us.create("no-app",{appName:n});return e}function fr(n,e,t){let r=o2[n]??n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Zr.warn(o.join(" "));return}Hi(new Xs(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u2="firebase-heartbeat-database",h2=1,Cl="firebase-heartbeat-store";let Sf=null;function FE(){return Sf||(Sf=kN(u2,h2,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Cl)}catch(t){console.warn(t)}}}}).catch(n=>{throw Us.create("idb-open",{originalErrorMessage:n.message})})),Sf}async function d2(n){try{const t=(await FE()).transaction(Cl),r=await t.objectStore(Cl).get(BE(n));return await t.done,r}catch(e){if(e instanceof Ir)Zr.warn(e.message);else{const t=Us.create("idb-get",{originalErrorMessage:e?.message});Zr.warn(t.message)}}}async function V_(n,e){try{const r=(await FE()).transaction(Cl,"readwrite");await r.objectStore(Cl).put(e,BE(n)),await r.done}catch(t){if(t instanceof Ir)Zr.warn(t.message);else{const r=Us.create("idb-set",{originalErrorMessage:t?.message});Zr.warn(r.message)}}}function BE(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f2=1024,p2=30;class m2{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new y2(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=F_();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>p2){const s=_2(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Zr.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=F_(),{heartbeatsToSend:t,unsentEntries:r}=g2(this._heartbeatsCache.heartbeats),s=ku(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return Zr.warn(e),""}}}function F_(){return new Date().toISOString().substring(0,10)}function g2(n,e=f2){const t=[];let r=n.slice();for(const s of n){const i=t.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),B_(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),B_(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class y2{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return rN()?sN().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await d2(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return V_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return V_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function B_(n){return ku(JSON.stringify({version:2,heartbeats:n})).length}function _2(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v2(n){Hi(new Xs("platform-logger",e=>new MN(e),"PRIVATE")),Hi(new Xs("heartbeat",e=>new m2(e),"PRIVATE")),fr(Cp,D_,n),fr(Cp,D_,"esm2020"),fr("fire-js","")}v2("");var $_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var zs,$E;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,w){function b(){}b.prototype=w.prototype,S.F=w.prototype,S.prototype=new b,S.prototype.constructor=S,S.D=function(I,R,k){for(var C=Array(arguments.length-2),_e=2;_e<arguments.length;_e++)C[_e-2]=arguments[_e];return w.prototype[R].apply(I,C)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(S,w,b){b||(b=0);const I=Array(16);if(typeof w=="string")for(var R=0;R<16;++R)I[R]=w.charCodeAt(b++)|w.charCodeAt(b++)<<8|w.charCodeAt(b++)<<16|w.charCodeAt(b++)<<24;else for(R=0;R<16;++R)I[R]=w[b++]|w[b++]<<8|w[b++]<<16|w[b++]<<24;w=S.g[0],b=S.g[1],R=S.g[2];let k=S.g[3],C;C=w+(k^b&(R^k))+I[0]+3614090360&4294967295,w=b+(C<<7&4294967295|C>>>25),C=k+(R^w&(b^R))+I[1]+3905402710&4294967295,k=w+(C<<12&4294967295|C>>>20),C=R+(b^k&(w^b))+I[2]+606105819&4294967295,R=k+(C<<17&4294967295|C>>>15),C=b+(w^R&(k^w))+I[3]+3250441966&4294967295,b=R+(C<<22&4294967295|C>>>10),C=w+(k^b&(R^k))+I[4]+4118548399&4294967295,w=b+(C<<7&4294967295|C>>>25),C=k+(R^w&(b^R))+I[5]+1200080426&4294967295,k=w+(C<<12&4294967295|C>>>20),C=R+(b^k&(w^b))+I[6]+2821735955&4294967295,R=k+(C<<17&4294967295|C>>>15),C=b+(w^R&(k^w))+I[7]+4249261313&4294967295,b=R+(C<<22&4294967295|C>>>10),C=w+(k^b&(R^k))+I[8]+1770035416&4294967295,w=b+(C<<7&4294967295|C>>>25),C=k+(R^w&(b^R))+I[9]+2336552879&4294967295,k=w+(C<<12&4294967295|C>>>20),C=R+(b^k&(w^b))+I[10]+4294925233&4294967295,R=k+(C<<17&4294967295|C>>>15),C=b+(w^R&(k^w))+I[11]+2304563134&4294967295,b=R+(C<<22&4294967295|C>>>10),C=w+(k^b&(R^k))+I[12]+1804603682&4294967295,w=b+(C<<7&4294967295|C>>>25),C=k+(R^w&(b^R))+I[13]+4254626195&4294967295,k=w+(C<<12&4294967295|C>>>20),C=R+(b^k&(w^b))+I[14]+2792965006&4294967295,R=k+(C<<17&4294967295|C>>>15),C=b+(w^R&(k^w))+I[15]+1236535329&4294967295,b=R+(C<<22&4294967295|C>>>10),C=w+(R^k&(b^R))+I[1]+4129170786&4294967295,w=b+(C<<5&4294967295|C>>>27),C=k+(b^R&(w^b))+I[6]+3225465664&4294967295,k=w+(C<<9&4294967295|C>>>23),C=R+(w^b&(k^w))+I[11]+643717713&4294967295,R=k+(C<<14&4294967295|C>>>18),C=b+(k^w&(R^k))+I[0]+3921069994&4294967295,b=R+(C<<20&4294967295|C>>>12),C=w+(R^k&(b^R))+I[5]+3593408605&4294967295,w=b+(C<<5&4294967295|C>>>27),C=k+(b^R&(w^b))+I[10]+38016083&4294967295,k=w+(C<<9&4294967295|C>>>23),C=R+(w^b&(k^w))+I[15]+3634488961&4294967295,R=k+(C<<14&4294967295|C>>>18),C=b+(k^w&(R^k))+I[4]+3889429448&4294967295,b=R+(C<<20&4294967295|C>>>12),C=w+(R^k&(b^R))+I[9]+568446438&4294967295,w=b+(C<<5&4294967295|C>>>27),C=k+(b^R&(w^b))+I[14]+3275163606&4294967295,k=w+(C<<9&4294967295|C>>>23),C=R+(w^b&(k^w))+I[3]+4107603335&4294967295,R=k+(C<<14&4294967295|C>>>18),C=b+(k^w&(R^k))+I[8]+1163531501&4294967295,b=R+(C<<20&4294967295|C>>>12),C=w+(R^k&(b^R))+I[13]+2850285829&4294967295,w=b+(C<<5&4294967295|C>>>27),C=k+(b^R&(w^b))+I[2]+4243563512&4294967295,k=w+(C<<9&4294967295|C>>>23),C=R+(w^b&(k^w))+I[7]+1735328473&4294967295,R=k+(C<<14&4294967295|C>>>18),C=b+(k^w&(R^k))+I[12]+2368359562&4294967295,b=R+(C<<20&4294967295|C>>>12),C=w+(b^R^k)+I[5]+4294588738&4294967295,w=b+(C<<4&4294967295|C>>>28),C=k+(w^b^R)+I[8]+2272392833&4294967295,k=w+(C<<11&4294967295|C>>>21),C=R+(k^w^b)+I[11]+1839030562&4294967295,R=k+(C<<16&4294967295|C>>>16),C=b+(R^k^w)+I[14]+4259657740&4294967295,b=R+(C<<23&4294967295|C>>>9),C=w+(b^R^k)+I[1]+2763975236&4294967295,w=b+(C<<4&4294967295|C>>>28),C=k+(w^b^R)+I[4]+1272893353&4294967295,k=w+(C<<11&4294967295|C>>>21),C=R+(k^w^b)+I[7]+4139469664&4294967295,R=k+(C<<16&4294967295|C>>>16),C=b+(R^k^w)+I[10]+3200236656&4294967295,b=R+(C<<23&4294967295|C>>>9),C=w+(b^R^k)+I[13]+681279174&4294967295,w=b+(C<<4&4294967295|C>>>28),C=k+(w^b^R)+I[0]+3936430074&4294967295,k=w+(C<<11&4294967295|C>>>21),C=R+(k^w^b)+I[3]+3572445317&4294967295,R=k+(C<<16&4294967295|C>>>16),C=b+(R^k^w)+I[6]+76029189&4294967295,b=R+(C<<23&4294967295|C>>>9),C=w+(b^R^k)+I[9]+3654602809&4294967295,w=b+(C<<4&4294967295|C>>>28),C=k+(w^b^R)+I[12]+3873151461&4294967295,k=w+(C<<11&4294967295|C>>>21),C=R+(k^w^b)+I[15]+530742520&4294967295,R=k+(C<<16&4294967295|C>>>16),C=b+(R^k^w)+I[2]+3299628645&4294967295,b=R+(C<<23&4294967295|C>>>9),C=w+(R^(b|~k))+I[0]+4096336452&4294967295,w=b+(C<<6&4294967295|C>>>26),C=k+(b^(w|~R))+I[7]+1126891415&4294967295,k=w+(C<<10&4294967295|C>>>22),C=R+(w^(k|~b))+I[14]+2878612391&4294967295,R=k+(C<<15&4294967295|C>>>17),C=b+(k^(R|~w))+I[5]+4237533241&4294967295,b=R+(C<<21&4294967295|C>>>11),C=w+(R^(b|~k))+I[12]+1700485571&4294967295,w=b+(C<<6&4294967295|C>>>26),C=k+(b^(w|~R))+I[3]+2399980690&4294967295,k=w+(C<<10&4294967295|C>>>22),C=R+(w^(k|~b))+I[10]+4293915773&4294967295,R=k+(C<<15&4294967295|C>>>17),C=b+(k^(R|~w))+I[1]+2240044497&4294967295,b=R+(C<<21&4294967295|C>>>11),C=w+(R^(b|~k))+I[8]+1873313359&4294967295,w=b+(C<<6&4294967295|C>>>26),C=k+(b^(w|~R))+I[15]+4264355552&4294967295,k=w+(C<<10&4294967295|C>>>22),C=R+(w^(k|~b))+I[6]+2734768916&4294967295,R=k+(C<<15&4294967295|C>>>17),C=b+(k^(R|~w))+I[13]+1309151649&4294967295,b=R+(C<<21&4294967295|C>>>11),C=w+(R^(b|~k))+I[4]+4149444226&4294967295,w=b+(C<<6&4294967295|C>>>26),C=k+(b^(w|~R))+I[11]+3174756917&4294967295,k=w+(C<<10&4294967295|C>>>22),C=R+(w^(k|~b))+I[2]+718787259&4294967295,R=k+(C<<15&4294967295|C>>>17),C=b+(k^(R|~w))+I[9]+3951481745&4294967295,S.g[0]=S.g[0]+w&4294967295,S.g[1]=S.g[1]+(R+(C<<21&4294967295|C>>>11))&4294967295,S.g[2]=S.g[2]+R&4294967295,S.g[3]=S.g[3]+k&4294967295}r.prototype.v=function(S,w){w===void 0&&(w=S.length);const b=w-this.blockSize,I=this.C;let R=this.h,k=0;for(;k<w;){if(R==0)for(;k<=b;)s(this,S,k),k+=this.blockSize;if(typeof S=="string"){for(;k<w;)if(I[R++]=S.charCodeAt(k++),R==this.blockSize){s(this,I),R=0;break}}else for(;k<w;)if(I[R++]=S[k++],R==this.blockSize){s(this,I),R=0;break}}this.h=R,this.o+=w},r.prototype.A=function(){var S=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);S[0]=128;for(var w=1;w<S.length-8;++w)S[w]=0;w=this.o*8;for(var b=S.length-8;b<S.length;++b)S[b]=w&255,w/=256;for(this.v(S),S=Array(16),w=0,b=0;b<4;++b)for(let I=0;I<32;I+=8)S[w++]=this.g[b]>>>I&255;return S};function i(S,w){var b=a;return Object.prototype.hasOwnProperty.call(b,S)?b[S]:b[S]=w(S)}function o(S,w){this.h=w;const b=[];let I=!0;for(let R=S.length-1;R>=0;R--){const k=S[R]|0;I&&k==w||(b[R]=k,I=!1)}this.g=b}var a={};function l(S){return-128<=S&&S<128?i(S,function(w){return new o([w|0],w<0?-1:0)}):new o([S|0],S<0?-1:0)}function c(S){if(isNaN(S)||!isFinite(S))return h;if(S<0)return v(c(-S));const w=[];let b=1;for(let I=0;S>=b;I++)w[I]=S/b|0,b*=4294967296;return new o(w,0)}function u(S,w){if(S.length==0)throw Error("number format error: empty string");if(w=w||10,w<2||36<w)throw Error("radix out of range: "+w);if(S.charAt(0)=="-")return v(u(S.substring(1),w));if(S.indexOf("-")>=0)throw Error('number format error: interior "-" character');const b=c(Math.pow(w,8));let I=h;for(let k=0;k<S.length;k+=8){var R=Math.min(8,S.length-k);const C=parseInt(S.substring(k,k+R),w);R<8?(R=c(Math.pow(w,R)),I=I.j(R).add(c(C))):(I=I.j(b),I=I.add(c(C)))}return I}var h=l(0),f=l(1),p=l(16777216);n=o.prototype,n.m=function(){if(y(this))return-v(this).m();let S=0,w=1;for(let b=0;b<this.g.length;b++){const I=this.i(b);S+=(I>=0?I:4294967296+I)*w,w*=4294967296}return S},n.toString=function(S){if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(m(this))return"0";if(y(this))return"-"+v(this).toString(S);const w=c(Math.pow(S,6));var b=this;let I="";for(;;){const R=D(b,w).g;b=T(b,R.j(w));let k=((b.g.length>0?b.g[0]:b.h)>>>0).toString(S);if(b=R,m(b))return k+I;for(;k.length<6;)k="0"+k;I=k+I}},n.i=function(S){return S<0?0:S<this.g.length?this.g[S]:this.h};function m(S){if(S.h!=0)return!1;for(let w=0;w<S.g.length;w++)if(S.g[w]!=0)return!1;return!0}function y(S){return S.h==-1}n.l=function(S){return S=T(this,S),y(S)?-1:m(S)?0:1};function v(S){const w=S.g.length,b=[];for(let I=0;I<w;I++)b[I]=~S.g[I];return new o(b,~S.h).add(f)}n.abs=function(){return y(this)?v(this):this},n.add=function(S){const w=Math.max(this.g.length,S.g.length),b=[];let I=0;for(let R=0;R<=w;R++){let k=I+(this.i(R)&65535)+(S.i(R)&65535),C=(k>>>16)+(this.i(R)>>>16)+(S.i(R)>>>16);I=C>>>16,k&=65535,C&=65535,b[R]=C<<16|k}return new o(b,b[b.length-1]&-2147483648?-1:0)};function T(S,w){return S.add(v(w))}n.j=function(S){if(m(this)||m(S))return h;if(y(this))return y(S)?v(this).j(v(S)):v(v(this).j(S));if(y(S))return v(this.j(v(S)));if(this.l(p)<0&&S.l(p)<0)return c(this.m()*S.m());const w=this.g.length+S.g.length,b=[];for(var I=0;I<2*w;I++)b[I]=0;for(I=0;I<this.g.length;I++)for(let R=0;R<S.g.length;R++){const k=this.i(I)>>>16,C=this.i(I)&65535,_e=S.i(R)>>>16,Ae=S.i(R)&65535;b[2*I+2*R]+=C*Ae,M(b,2*I+2*R),b[2*I+2*R+1]+=k*Ae,M(b,2*I+2*R+1),b[2*I+2*R+1]+=C*_e,M(b,2*I+2*R+1),b[2*I+2*R+2]+=k*_e,M(b,2*I+2*R+2)}for(S=0;S<w;S++)b[S]=b[2*S+1]<<16|b[2*S];for(S=w;S<2*w;S++)b[S]=0;return new o(b,0)};function M(S,w){for(;(S[w]&65535)!=S[w];)S[w+1]+=S[w]>>>16,S[w]&=65535,w++}function P(S,w){this.g=S,this.h=w}function D(S,w){if(m(w))throw Error("division by zero");if(m(S))return new P(h,h);if(y(S))return w=D(v(S),w),new P(v(w.g),v(w.h));if(y(w))return w=D(S,v(w)),new P(v(w.g),w.h);if(S.g.length>30){if(y(S)||y(w))throw Error("slowDivide_ only works with positive integers.");for(var b=f,I=w;I.l(S)<=0;)b=L(b),I=L(I);var R=q(b,1),k=q(I,1);for(I=q(I,2),b=q(b,2);!m(I);){var C=k.add(I);C.l(S)<=0&&(R=R.add(b),k=C),I=q(I,1),b=q(b,1)}return w=T(S,R.j(w)),new P(R,w)}for(R=h;S.l(w)>=0;){for(b=Math.max(1,Math.floor(S.m()/w.m())),I=Math.ceil(Math.log(b)/Math.LN2),I=I<=48?1:Math.pow(2,I-48),k=c(b),C=k.j(w);y(C)||C.l(S)>0;)b-=I,k=c(b),C=k.j(w);m(k)&&(k=f),R=R.add(k),S=T(S,C)}return new P(R,S)}n.B=function(S){return D(this,S).h},n.and=function(S){const w=Math.max(this.g.length,S.g.length),b=[];for(let I=0;I<w;I++)b[I]=this.i(I)&S.i(I);return new o(b,this.h&S.h)},n.or=function(S){const w=Math.max(this.g.length,S.g.length),b=[];for(let I=0;I<w;I++)b[I]=this.i(I)|S.i(I);return new o(b,this.h|S.h)},n.xor=function(S){const w=Math.max(this.g.length,S.g.length),b=[];for(let I=0;I<w;I++)b[I]=this.i(I)^S.i(I);return new o(b,this.h^S.h)};function L(S){const w=S.g.length+1,b=[];for(let I=0;I<w;I++)b[I]=S.i(I)<<1|S.i(I-1)>>>31;return new o(b,S.h)}function q(S,w){const b=w>>5;w%=32;const I=S.g.length-b,R=[];for(let k=0;k<I;k++)R[k]=w>0?S.i(k+b)>>>w|S.i(k+b+1)<<32-w:S.i(k+b);return new o(R,S.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,$E=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=u,zs=o}).apply(typeof $_<"u"?$_:typeof self<"u"?self:typeof window<"u"?window:{});var kc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var UE,Da,zE,tu,kp,HE,jE,WE;(function(){var n,e=Object.defineProperty;function t(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof kc=="object"&&kc];for(var g=0;g<d.length;++g){var _=d[g];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var r=t(this);function s(d,g){if(g)e:{var _=r;d=d.split(".");for(var E=0;E<d.length-1;E++){var O=d[E];if(!(O in _))break e;_=_[O]}d=d[d.length-1],E=_[d],g=g(E),g!=E&&g!=null&&e(_,d,{configurable:!0,writable:!0,value:g})}}s("Symbol.dispose",function(d){return d||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(d){return d||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(d){return d||function(g){var _=[],E;for(E in g)Object.prototype.hasOwnProperty.call(g,E)&&_.push([E,g[E]]);return _}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function a(d){var g=typeof d;return g=="object"&&d!=null||g=="function"}function l(d,g,_){return d.call.apply(d.bind,arguments)}function c(d,g,_){return c=l,c.apply(null,arguments)}function u(d,g){var _=Array.prototype.slice.call(arguments,1);return function(){var E=_.slice();return E.push.apply(E,arguments),d.apply(this,E)}}function h(d,g){function _(){}_.prototype=g.prototype,d.Z=g.prototype,d.prototype=new _,d.prototype.constructor=d,d.Ob=function(E,O,V){for(var Y=Array(arguments.length-2),Te=2;Te<arguments.length;Te++)Y[Te-2]=arguments[Te];return g.prototype[O].apply(E,Y)}}var f=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?d=>d&&AsyncContext.Snapshot.wrap(d):d=>d;function p(d){const g=d.length;if(g>0){const _=Array(g);for(let E=0;E<g;E++)_[E]=d[E];return _}return[]}function m(d,g){for(let E=1;E<arguments.length;E++){const O=arguments[E];var _=typeof O;if(_=_!="object"?_:O?Array.isArray(O)?"array":_:"null",_=="array"||_=="object"&&typeof O.length=="number"){_=d.length||0;const V=O.length||0;d.length=_+V;for(let Y=0;Y<V;Y++)d[_+Y]=O[Y]}else d.push(O)}}class y{constructor(g,_){this.i=g,this.j=_,this.h=0,this.g=null}get(){let g;return this.h>0?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function v(d){o.setTimeout(()=>{throw d},0)}function T(){var d=S;let g=null;return d.g&&(g=d.g,d.g=d.g.next,d.g||(d.h=null),g.next=null),g}class M{constructor(){this.h=this.g=null}add(g,_){const E=P.get();E.set(g,_),this.h?this.h.next=E:this.g=E,this.h=E}}var P=new y(()=>new D,d=>d.reset());class D{constructor(){this.next=this.g=this.h=null}set(g,_){this.h=g,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let L,q=!1,S=new M,w=()=>{const d=Promise.resolve(void 0);L=()=>{d.then(b)}};function b(){for(var d;d=T();){try{d.h.call(d.g)}catch(_){v(_)}var g=P;g.j(d),g.h<100&&(g.h++,d.next=g.g,g.g=d)}q=!1}function I(){this.u=this.u,this.C=this.C}I.prototype.u=!1,I.prototype.dispose=function(){this.u||(this.u=!0,this.N())},I.prototype[Symbol.dispose]=function(){this.dispose()},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function R(d,g){this.type=d,this.g=this.target=g,this.defaultPrevented=!1}R.prototype.h=function(){this.defaultPrevented=!0};var k=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var d=!1,g=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const _=()=>{};o.addEventListener("test",_,g),o.removeEventListener("test",_,g)}catch{}return d})();function C(d){return/^[\s\xa0]*$/.test(d)}function _e(d,g){R.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d&&this.init(d,g)}h(_e,R),_e.prototype.init=function(d,g){const _=this.type=d.type,E=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;this.target=d.target||d.srcElement,this.g=g,g=d.relatedTarget,g||(_=="mouseover"?g=d.fromElement:_=="mouseout"&&(g=d.toElement)),this.relatedTarget=g,E?(this.clientX=E.clientX!==void 0?E.clientX:E.pageX,this.clientY=E.clientY!==void 0?E.clientY:E.pageY,this.screenX=E.screenX||0,this.screenY=E.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=d.pointerType,this.state=d.state,this.i=d,d.defaultPrevented&&_e.Z.h.call(this)},_e.prototype.h=function(){_e.Z.h.call(this);const d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var Ae="closure_listenable_"+(Math.random()*1e6|0),Re=0;function fe(d,g,_,E,O){this.listener=d,this.proxy=null,this.src=g,this.type=_,this.capture=!!E,this.ha=O,this.key=++Re,this.da=this.fa=!1}function Ne(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function fn(d,g,_){for(const E in d)g.call(_,d[E],E,d)}function tr(d,g){for(const _ in d)g.call(void 0,d[_],_,d)}function _n(d){const g={};for(const _ in d)g[_]=d[_];return g}const Nt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function xr(d,g){let _,E;for(let O=1;O<arguments.length;O++){E=arguments[O];for(_ in E)d[_]=E[_];for(let V=0;V<Nt.length;V++)_=Nt[V],Object.prototype.hasOwnProperty.call(E,_)&&(d[_]=E[_])}}function Un(d){this.src=d,this.g={},this.h=0}Un.prototype.add=function(d,g,_,E,O){const V=d.toString();d=this.g[V],d||(d=this.g[V]=[],this.h++);const Y=jt(d,g,E,O);return Y>-1?(g=d[Y],_||(g.fa=!1)):(g=new fe(g,this.src,V,!!E,O),g.fa=_,d.push(g)),g};function as(d,g){const _=g.type;if(_ in d.g){var E=d.g[_],O=Array.prototype.indexOf.call(E,g,void 0),V;(V=O>=0)&&Array.prototype.splice.call(E,O,1),V&&(Ne(g),d.g[_].length==0&&(delete d.g[_],d.h--))}}function jt(d,g,_,E){for(let O=0;O<d.length;++O){const V=d[O];if(!V.da&&V.listener==g&&V.capture==!!_&&V.ha==E)return O}return-1}var $="closure_lm_"+(Math.random()*1e6|0),re={};function ee(d,g,_,E,O){if(Array.isArray(g)){for(let V=0;V<g.length;V++)ee(d,g[V],_,E,O);return null}return _=Z(_),d&&d[Ae]?d.J(g,_,a(E)?!!E.capture:!1,O):ie(d,g,_,!1,E,O)}function ie(d,g,_,E,O,V){if(!g)throw Error("Invalid event type");const Y=a(O)?!!O.capture:!!O;let Te=j(d);if(Te||(d[$]=Te=new Un(d)),_=Te.add(g,_,E,Y,V),_.proxy)return _;if(E=ze(),_.proxy=E,E.src=d,E.listener=_,d.addEventListener)k||(O=Y),O===void 0&&(O=!1),d.addEventListener(g.toString(),E,O);else if(d.attachEvent)d.attachEvent(N(g.toString()),E);else if(d.addListener&&d.removeListener)d.addListener(E);else throw Error("addEventListener and attachEvent are unavailable.");return _}function ze(){function d(_){return g.call(d.src,d.listener,_)}const g=U;return d}function A(d,g,_,E,O){if(Array.isArray(g))for(var V=0;V<g.length;V++)A(d,g[V],_,E,O);else E=a(E)?!!E.capture:!!E,_=Z(_),d&&d[Ae]?(d=d.i,V=String(g).toString(),V in d.g&&(g=d.g[V],_=jt(g,_,E,O),_>-1&&(Ne(g[_]),Array.prototype.splice.call(g,_,1),g.length==0&&(delete d.g[V],d.h--)))):d&&(d=j(d))&&(g=d.g[g.toString()],d=-1,g&&(d=jt(g,_,E,O)),(_=d>-1?g[d]:null)&&x(_))}function x(d){if(typeof d!="number"&&d&&!d.da){var g=d.src;if(g&&g[Ae])as(g.i,d);else{var _=d.type,E=d.proxy;g.removeEventListener?g.removeEventListener(_,E,d.capture):g.detachEvent?g.detachEvent(N(_),E):g.addListener&&g.removeListener&&g.removeListener(E),(_=j(g))?(as(_,d),_.h==0&&(_.src=null,g[$]=null)):Ne(d)}}}function N(d){return d in re?re[d]:re[d]="on"+d}function U(d,g){if(d.da)d=!0;else{g=new _e(g,this);const _=d.listener,E=d.ha||d.src;d.fa&&x(d),d=_.call(E,g)}return d}function j(d){return d=d[$],d instanceof Un?d:null}var F="__closure_events_fn_"+(Math.random()*1e9>>>0);function Z(d){return typeof d=="function"?d:(d[F]||(d[F]=function(g){return d.handleEvent(g)}),d[F])}function J(){I.call(this),this.i=new Un(this),this.M=this,this.G=null}h(J,I),J.prototype[Ae]=!0,J.prototype.removeEventListener=function(d,g,_,E){A(this,d,g,_,E)};function K(d,g){var _,E=d.G;if(E)for(_=[];E;E=E.G)_.push(E);if(d=d.M,E=g.type||g,typeof g=="string")g=new R(g,d);else if(g instanceof R)g.target=g.target||d;else{var O=g;g=new R(E,d),xr(g,O)}O=!0;let V,Y;if(_)for(Y=_.length-1;Y>=0;Y--)V=g.g=_[Y],O=G(V,E,!0,g)&&O;if(V=g.g=d,O=G(V,E,!0,g)&&O,O=G(V,E,!1,g)&&O,_)for(Y=0;Y<_.length;Y++)V=g.g=_[Y],O=G(V,E,!1,g)&&O}J.prototype.N=function(){if(J.Z.N.call(this),this.i){var d=this.i;for(const g in d.g){const _=d.g[g];for(let E=0;E<_.length;E++)Ne(_[E]);delete d.g[g],d.h--}}this.G=null},J.prototype.J=function(d,g,_,E){return this.i.add(String(d),g,!1,_,E)},J.prototype.K=function(d,g,_,E){return this.i.add(String(d),g,!0,_,E)};function G(d,g,_,E){if(g=d.i.g[String(g)],!g)return!0;g=g.concat();let O=!0;for(let V=0;V<g.length;++V){const Y=g[V];if(Y&&!Y.da&&Y.capture==_){const Te=Y.listener,Et=Y.ha||Y.src;Y.fa&&as(d.i,Y),O=Te.call(Et,E)!==!1&&O}}return O&&!E.defaultPrevented}function he(d,g){if(typeof d!="function")if(d&&typeof d.handleEvent=="function")d=c(d.handleEvent,d);else throw Error("Invalid listener argument");return Number(g)>2147483647?-1:o.setTimeout(d,g||0)}function te(d){d.g=he(()=>{d.g=null,d.i&&(d.i=!1,te(d))},d.l);const g=d.h;d.h=null,d.m.apply(null,g)}class ce extends I{constructor(g,_){super(),this.m=g,this.l=_,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:te(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function de(d){I.call(this),this.h=d,this.g={}}h(de,I);var Ie=[];function He(d){fn(d.g,function(g,_){this.g.hasOwnProperty(_)&&x(g)},d),d.g={}}de.prototype.N=function(){de.Z.N.call(this),He(this)},de.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var De=o.JSON.stringify,Wt=o.JSON.parse,qt=class{stringify(d){return o.JSON.stringify(d,void 0)}parse(d){return o.JSON.parse(d,void 0)}};function vn(){}function wn(){}var zn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ao(){R.call(this,"d")}h(ao,R);function Ot(){R.call(this,"c")}h(Ot,R);var St={},ha=null;function pi(){return ha=ha||new J}St.Ia="serverreachability";function Uy(d){R.call(this,St.Ia,d)}h(Uy,R);function da(d){const g=pi();K(g,new Uy(g))}St.STAT_EVENT="statevent";function zy(d,g){R.call(this,St.STAT_EVENT,d),this.stat=g}h(zy,R);function on(d){const g=pi();K(g,new zy(g,d))}St.Ja="timingevent";function Hy(d,g){R.call(this,St.Ja,d),this.size=g}h(Hy,R);function fa(d,g){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){d()},g)}function pa(){this.g=!0}pa.prototype.ua=function(){this.g=!1};function lk(d,g,_,E,O,V){d.info(function(){if(d.g)if(V){var Y="",Te=V.split("&");for(let We=0;We<Te.length;We++){var Et=Te[We].split("=");if(Et.length>1){const Ct=Et[0];Et=Et[1];const rr=Ct.split("_");Y=rr.length>=2&&rr[1]=="type"?Y+(Ct+"="+Et+"&"):Y+(Ct+"=redacted&")}}}else Y=null;else Y=V;return"XMLHTTP REQ ("+E+") [attempt "+O+"]: "+g+`
`+_+`
`+Y})}function ck(d,g,_,E,O,V,Y){d.info(function(){return"XMLHTTP RESP ("+E+") [ attempt "+O+"]: "+g+`
`+_+`
`+V+" "+Y})}function lo(d,g,_,E){d.info(function(){return"XMLHTTP TEXT ("+g+"): "+hk(d,_)+(E?" "+E:"")})}function uk(d,g){d.info(function(){return"TIMEOUT: "+g})}pa.prototype.info=function(){};function hk(d,g){if(!d.g)return g;if(!g)return null;try{const V=JSON.parse(g);if(V){for(d=0;d<V.length;d++)if(Array.isArray(V[d])){var _=V[d];if(!(_.length<2)){var E=_[1];if(Array.isArray(E)&&!(E.length<1)){var O=E[0];if(O!="noop"&&O!="stop"&&O!="close")for(let Y=1;Y<E.length;Y++)E[Y]=""}}}}return De(V)}catch{return g}}var pc={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},jy={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Wy;function jd(){}h(jd,vn),jd.prototype.g=function(){return new XMLHttpRequest},Wy=new jd;function ma(d){return encodeURIComponent(String(d))}function dk(d){var g=1;d=d.split(":");const _=[];for(;g>0&&d.length;)_.push(d.shift()),g--;return d.length&&_.push(d.join(":")),_}function ls(d,g,_,E){this.j=d,this.i=g,this.l=_,this.S=E||1,this.V=new de(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new qy}function qy(){this.i=null,this.g="",this.h=!1}var Ky={},Wd={};function qd(d,g,_){d.M=1,d.A=gc(nr(g)),d.u=_,d.R=!0,Gy(d,null)}function Gy(d,g){d.F=Date.now(),mc(d),d.B=nr(d.A);var _=d.B,E=d.S;Array.isArray(E)||(E=[String(E)]),a0(_.i,"t",E),d.C=0,_=d.j.L,d.h=new qy,d.g=C0(d.j,_?g:null,!d.u),d.P>0&&(d.O=new ce(c(d.Y,d,d.g),d.P)),g=d.V,_=d.g,E=d.ba;var O="readystatechange";Array.isArray(O)||(O&&(Ie[0]=O.toString()),O=Ie);for(let V=0;V<O.length;V++){const Y=ee(_,O[V],E||g.handleEvent,!1,g.h||g);if(!Y)break;g.g[Y.key]=Y}g=d.J?_n(d.J):{},d.u?(d.v||(d.v="POST"),g["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.B,d.v,d.u,g)):(d.v="GET",d.g.ea(d.B,d.v,null,g)),da(),lk(d.i,d.v,d.B,d.l,d.S,d.u)}ls.prototype.ba=function(d){d=d.target;const g=this.O;g&&hs(d)==3?g.j():this.Y(d)},ls.prototype.Y=function(d){try{if(d==this.g)e:{const Te=hs(this.g),Et=this.g.ya(),We=this.g.ca();if(!(Te<3)&&(Te!=3||this.g&&(this.h.h||this.g.la()||p0(this.g)))){this.K||Te!=4||Et==7||(Et==8||We<=0?da(3):da(2)),Kd(this);var g=this.g.ca();this.X=g;var _=fk(this);if(this.o=g==200,ck(this.i,this.v,this.B,this.l,this.S,Te,g),this.o){if(this.U&&!this.L){t:{if(this.g){var E,O=this.g;if((E=O.g?O.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(E)){var V=E;break t}}V=null}if(d=V)lo(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Gd(this,d);else{this.o=!1,this.m=3,on(12),mi(this),ga(this);break e}}if(this.R){d=!0;let Ct;for(;!this.K&&this.C<_.length;)if(Ct=pk(this,_),Ct==Wd){Te==4&&(this.m=4,on(14),d=!1),lo(this.i,this.l,null,"[Incomplete Response]");break}else if(Ct==Ky){this.m=4,on(15),lo(this.i,this.l,_,"[Invalid Chunk]"),d=!1;break}else lo(this.i,this.l,Ct,null),Gd(this,Ct);if(Jy(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Te!=4||_.length!=0||this.h.h||(this.m=1,on(16),d=!1),this.o=this.o&&d,!d)lo(this.i,this.l,_,"[Invalid Chunked Response]"),mi(this),ga(this);else if(_.length>0&&!this.W){this.W=!0;var Y=this.j;Y.g==this&&Y.aa&&!Y.P&&(Y.j.info("Great, no buffering proxy detected. Bytes received: "+_.length),nf(Y),Y.P=!0,on(11))}}else lo(this.i,this.l,_,null),Gd(this,_);Te==4&&mi(this),this.o&&!this.K&&(Te==4?b0(this.j,this):(this.o=!1,mc(this)))}else kk(this.g),g==400&&_.indexOf("Unknown SID")>0?(this.m=3,on(12)):(this.m=0,on(13)),mi(this),ga(this)}}}catch{}finally{}};function fk(d){if(!Jy(d))return d.g.la();const g=p0(d.g);if(g==="")return"";let _="";const E=g.length,O=hs(d.g)==4;if(!d.h.i){if(typeof TextDecoder>"u")return mi(d),ga(d),"";d.h.i=new o.TextDecoder}for(let V=0;V<E;V++)d.h.h=!0,_+=d.h.i.decode(g[V],{stream:!(O&&V==E-1)});return g.length=0,d.h.g+=_,d.C=0,d.h.g}function Jy(d){return d.g?d.v=="GET"&&d.M!=2&&d.j.Aa:!1}function pk(d,g){var _=d.C,E=g.indexOf(`
`,_);return E==-1?Wd:(_=Number(g.substring(_,E)),isNaN(_)?Ky:(E+=1,E+_>g.length?Wd:(g=g.slice(E,E+_),d.C=E+_,g)))}ls.prototype.cancel=function(){this.K=!0,mi(this)};function mc(d){d.T=Date.now()+d.H,Qy(d,d.H)}function Qy(d,g){if(d.D!=null)throw Error("WatchDog timer not null");d.D=fa(c(d.aa,d),g)}function Kd(d){d.D&&(o.clearTimeout(d.D),d.D=null)}ls.prototype.aa=function(){this.D=null;const d=Date.now();d-this.T>=0?(uk(this.i,this.B),this.M!=2&&(da(),on(17)),mi(this),this.m=2,ga(this)):Qy(this,this.T-d)};function ga(d){d.j.I==0||d.K||b0(d.j,d)}function mi(d){Kd(d);var g=d.O;g&&typeof g.dispose=="function"&&g.dispose(),d.O=null,He(d.V),d.g&&(g=d.g,d.g=null,g.abort(),g.dispose())}function Gd(d,g){try{var _=d.j;if(_.I!=0&&(_.g==d||Jd(_.h,d))){if(!d.L&&Jd(_.h,d)&&_.I==3){try{var E=_.Ba.g.parse(g)}catch{E=null}if(Array.isArray(E)&&E.length==3){var O=E;if(O[0]==0){e:if(!_.v){if(_.g)if(_.g.F+3e3<d.F)bc(_),vc(_);else break e;tf(_),on(18)}}else _.xa=O[1],0<_.xa-_.K&&O[2]<37500&&_.F&&_.A==0&&!_.C&&(_.C=fa(c(_.Va,_),6e3));Zy(_.h)<=1&&_.ta&&(_.ta=void 0)}else yi(_,11)}else if((d.L||_.g==d)&&bc(_),!C(g))for(O=_.Ba.g.parse(g),g=0;g<O.length;g++){let We=O[g];const Ct=We[0];if(!(Ct<=_.K))if(_.K=Ct,We=We[1],_.I==2)if(We[0]=="c"){_.M=We[1],_.ba=We[2];const rr=We[3];rr!=null&&(_.ka=rr,_.j.info("VER="+_.ka));const _i=We[4];_i!=null&&(_.za=_i,_.j.info("SVER="+_.za));const ds=We[5];ds!=null&&typeof ds=="number"&&ds>0&&(E=1.5*ds,_.O=E,_.j.info("backChannelRequestTimeoutMs_="+E)),E=_;const fs=d.g;if(fs){const Tc=fs.g?fs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Tc){var V=E.h;V.g||Tc.indexOf("spdy")==-1&&Tc.indexOf("quic")==-1&&Tc.indexOf("h2")==-1||(V.j=V.l,V.g=new Set,V.h&&(Qd(V,V.h),V.h=null))}if(E.G){const rf=fs.g?fs.g.getResponseHeader("X-HTTP-Session-Id"):null;rf&&(E.wa=rf,et(E.J,E.G,rf))}}_.I=3,_.l&&_.l.ra(),_.aa&&(_.T=Date.now()-d.F,_.j.info("Handshake RTT: "+_.T+"ms")),E=_;var Y=d;if(E.na=S0(E,E.L?E.ba:null,E.W),Y.L){e0(E.h,Y);var Te=Y,Et=E.O;Et&&(Te.H=Et),Te.D&&(Kd(Te),mc(Te)),E.g=Y}else v0(E);_.i.length>0&&wc(_)}else We[0]!="stop"&&We[0]!="close"||yi(_,7);else _.I==3&&(We[0]=="stop"||We[0]=="close"?We[0]=="stop"?yi(_,7):ef(_):We[0]!="noop"&&_.l&&_.l.qa(We),_.A=0)}}da(4)}catch{}}var mk=class{constructor(d,g){this.g=d,this.map=g}};function Yy(d){this.l=d||10,o.PerformanceNavigationTiming?(d=o.performance.getEntriesByType("navigation"),d=d.length>0&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Xy(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function Zy(d){return d.h?1:d.g?d.g.size:0}function Jd(d,g){return d.h?d.h==g:d.g?d.g.has(g):!1}function Qd(d,g){d.g?d.g.add(g):d.h=g}function e0(d,g){d.h&&d.h==g?d.h=null:d.g&&d.g.has(g)&&d.g.delete(g)}Yy.prototype.cancel=function(){if(this.i=t0(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function t0(d){if(d.h!=null)return d.i.concat(d.h.G);if(d.g!=null&&d.g.size!==0){let g=d.i;for(const _ of d.g.values())g=g.concat(_.G);return g}return p(d.i)}var n0=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function gk(d,g){if(d){d=d.split("&");for(let _=0;_<d.length;_++){const E=d[_].indexOf("=");let O,V=null;E>=0?(O=d[_].substring(0,E),V=d[_].substring(E+1)):O=d[_],g(O,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function cs(d){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let g;d instanceof cs?(this.l=d.l,ya(this,d.j),this.o=d.o,this.g=d.g,_a(this,d.u),this.h=d.h,Yd(this,l0(d.i)),this.m=d.m):d&&(g=String(d).match(n0))?(this.l=!1,ya(this,g[1]||"",!0),this.o=va(g[2]||""),this.g=va(g[3]||"",!0),_a(this,g[4]),this.h=va(g[5]||"",!0),Yd(this,g[6]||"",!0),this.m=va(g[7]||"")):(this.l=!1,this.i=new ba(null,this.l))}cs.prototype.toString=function(){const d=[];var g=this.j;g&&d.push(wa(g,r0,!0),":");var _=this.g;return(_||g=="file")&&(d.push("//"),(g=this.o)&&d.push(wa(g,r0,!0),"@"),d.push(ma(_).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.u,_!=null&&d.push(":",String(_))),(_=this.h)&&(this.g&&_.charAt(0)!="/"&&d.push("/"),d.push(wa(_,_.charAt(0)=="/"?vk:_k,!0))),(_=this.i.toString())&&d.push("?",_),(_=this.m)&&d.push("#",wa(_,bk)),d.join("")},cs.prototype.resolve=function(d){const g=nr(this);let _=!!d.j;_?ya(g,d.j):_=!!d.o,_?g.o=d.o:_=!!d.g,_?g.g=d.g:_=d.u!=null;var E=d.h;if(_)_a(g,d.u);else if(_=!!d.h){if(E.charAt(0)!="/")if(this.g&&!this.h)E="/"+E;else{var O=g.h.lastIndexOf("/");O!=-1&&(E=g.h.slice(0,O+1)+E)}if(O=E,O==".."||O==".")E="";else if(O.indexOf("./")!=-1||O.indexOf("/.")!=-1){E=O.lastIndexOf("/",0)==0,O=O.split("/");const V=[];for(let Y=0;Y<O.length;){const Te=O[Y++];Te=="."?E&&Y==O.length&&V.push(""):Te==".."?((V.length>1||V.length==1&&V[0]!="")&&V.pop(),E&&Y==O.length&&V.push("")):(V.push(Te),E=!0)}E=V.join("/")}else E=O}return _?g.h=E:_=d.i.toString()!=="",_?Yd(g,l0(d.i)):_=!!d.m,_&&(g.m=d.m),g};function nr(d){return new cs(d)}function ya(d,g,_){d.j=_?va(g,!0):g,d.j&&(d.j=d.j.replace(/:$/,""))}function _a(d,g){if(g){if(g=Number(g),isNaN(g)||g<0)throw Error("Bad port number "+g);d.u=g}else d.u=null}function Yd(d,g,_){g instanceof ba?(d.i=g,Ek(d.i,d.l)):(_||(g=wa(g,wk)),d.i=new ba(g,d.l))}function et(d,g,_){d.i.set(g,_)}function gc(d){return et(d,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),d}function va(d,g){return d?g?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function wa(d,g,_){return typeof d=="string"?(d=encodeURI(d).replace(g,yk),_&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function yk(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var r0=/[#\/\?@]/g,_k=/[#\?:]/g,vk=/[#\?]/g,wk=/[#\?@]/g,bk=/#/g;function ba(d,g){this.h=this.g=null,this.i=d||null,this.j=!!g}function gi(d){d.g||(d.g=new Map,d.h=0,d.i&&gk(d.i,function(g,_){d.add(decodeURIComponent(g.replace(/\+/g," ")),_)}))}n=ba.prototype,n.add=function(d,g){gi(this),this.i=null,d=co(this,d);let _=this.g.get(d);return _||this.g.set(d,_=[]),_.push(g),this.h+=1,this};function s0(d,g){gi(d),g=co(d,g),d.g.has(g)&&(d.i=null,d.h-=d.g.get(g).length,d.g.delete(g))}function i0(d,g){return gi(d),g=co(d,g),d.g.has(g)}n.forEach=function(d,g){gi(this),this.g.forEach(function(_,E){_.forEach(function(O){d.call(g,O,E,this)},this)},this)};function o0(d,g){gi(d);let _=[];if(typeof g=="string")i0(d,g)&&(_=_.concat(d.g.get(co(d,g))));else for(d=Array.from(d.g.values()),g=0;g<d.length;g++)_=_.concat(d[g]);return _}n.set=function(d,g){return gi(this),this.i=null,d=co(this,d),i0(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[g]),this.h+=1,this},n.get=function(d,g){return d?(d=o0(this,d),d.length>0?String(d[0]):g):g};function a0(d,g,_){s0(d,g),_.length>0&&(d.i=null,d.g.set(co(d,g),p(_)),d.h+=_.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],g=Array.from(this.g.keys());for(let E=0;E<g.length;E++){var _=g[E];const O=ma(_);_=o0(this,_);for(let V=0;V<_.length;V++){let Y=O;_[V]!==""&&(Y+="="+ma(_[V])),d.push(Y)}}return this.i=d.join("&")};function l0(d){const g=new ba;return g.i=d.i,d.g&&(g.g=new Map(d.g),g.h=d.h),g}function co(d,g){return g=String(g),d.j&&(g=g.toLowerCase()),g}function Ek(d,g){g&&!d.j&&(gi(d),d.i=null,d.g.forEach(function(_,E){const O=E.toLowerCase();E!=O&&(s0(this,E),a0(this,O,_))},d)),d.j=g}function Tk(d,g){const _=new pa;if(o.Image){const E=new Image;E.onload=u(us,_,"TestLoadImage: loaded",!0,g,E),E.onerror=u(us,_,"TestLoadImage: error",!1,g,E),E.onabort=u(us,_,"TestLoadImage: abort",!1,g,E),E.ontimeout=u(us,_,"TestLoadImage: timeout",!1,g,E),o.setTimeout(function(){E.ontimeout&&E.ontimeout()},1e4),E.src=d}else g(!1)}function Sk(d,g){const _=new pa,E=new AbortController,O=setTimeout(()=>{E.abort(),us(_,"TestPingServer: timeout",!1,g)},1e4);fetch(d,{signal:E.signal}).then(V=>{clearTimeout(O),V.ok?us(_,"TestPingServer: ok",!0,g):us(_,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(O),us(_,"TestPingServer: error",!1,g)})}function us(d,g,_,E,O){try{O&&(O.onload=null,O.onerror=null,O.onabort=null,O.ontimeout=null),E(_)}catch{}}function Ck(){this.g=new qt}function Xd(d){this.i=d.Sb||null,this.h=d.ab||!1}h(Xd,vn),Xd.prototype.g=function(){return new yc(this.i,this.h)};function yc(d,g){J.call(this),this.H=d,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}h(yc,J),n=yc.prototype,n.open=function(d,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=d,this.D=g,this.readyState=1,Ta(this)},n.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const g={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};d&&(g.body=d),(this.H||o).fetch(new Request(this.D,g)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ea(this)),this.readyState=0},n.Pa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Ta(this)),this.g&&(this.readyState=3,Ta(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;c0(this)}else d.text().then(this.Oa.bind(this),this.ga.bind(this))};function c0(d){d.j.read().then(d.Ma.bind(d)).catch(d.ga.bind(d))}n.Ma=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var g=d.value?d.value:new Uint8Array(0);(g=this.B.decode(g,{stream:!d.done}))&&(this.response=this.responseText+=g)}d.done?Ea(this):Ta(this),this.readyState==3&&c0(this)}},n.Oa=function(d){this.g&&(this.response=this.responseText=d,Ea(this))},n.Na=function(d){this.g&&(this.response=d,Ea(this))},n.ga=function(){this.g&&Ea(this)};function Ea(d){d.readyState=4,d.l=null,d.j=null,d.B=null,Ta(d)}n.setRequestHeader=function(d,g){this.A.append(d,g)},n.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],g=this.h.entries();for(var _=g.next();!_.done;)_=_.value,d.push(_[0]+": "+_[1]),_=g.next();return d.join(`\r
`)};function Ta(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(yc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function u0(d){let g="";return fn(d,function(_,E){g+=E,g+=":",g+=_,g+=`\r
`}),g}function Zd(d,g,_){e:{for(E in _){var E=!1;break e}E=!0}E||(_=u0(_),typeof d=="string"?_!=null&&ma(_):et(d,g,_))}function lt(d){J.call(this),this.headers=new Map,this.L=d||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}h(lt,J);var Ak=/^https?$/i,Ik=["POST","PUT"];n=lt.prototype,n.Fa=function(d){this.H=d},n.ea=function(d,g,_,E){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);g=g?g.toUpperCase():"GET",this.D=d,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Wy.g(),this.g.onreadystatechange=f(c(this.Ca,this));try{this.B=!0,this.g.open(g,String(d),!0),this.B=!1}catch(V){h0(this,V);return}if(d=_||"",_=new Map(this.headers),E)if(Object.getPrototypeOf(E)===Object.prototype)for(var O in E)_.set(O,E[O]);else if(typeof E.keys=="function"&&typeof E.get=="function")for(const V of E.keys())_.set(V,E.get(V));else throw Error("Unknown input type for opt_headers: "+String(E));E=Array.from(_.keys()).find(V=>V.toLowerCase()=="content-type"),O=o.FormData&&d instanceof o.FormData,!(Array.prototype.indexOf.call(Ik,g,void 0)>=0)||E||O||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[V,Y]of _)this.g.setRequestHeader(V,Y);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(d),this.v=!1}catch(V){h0(this,V)}};function h0(d,g){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=g,d.o=5,d0(d),_c(d)}function d0(d){d.A||(d.A=!0,K(d,"complete"),K(d,"error"))}n.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=d||7,K(this,"complete"),K(this,"abort"),_c(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),_c(this,!0)),lt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?f0(this):this.Xa())},n.Xa=function(){f0(this)};function f0(d){if(d.h&&typeof i<"u"){if(d.v&&hs(d)==4)setTimeout(d.Ca.bind(d),0);else if(K(d,"readystatechange"),hs(d)==4){d.h=!1;try{const V=d.ca();e:switch(V){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var _;if(!(_=g)){var E;if(E=V===0){let Y=String(d.D).match(n0)[1]||null;!Y&&o.self&&o.self.location&&(Y=o.self.location.protocol.slice(0,-1)),E=!Ak.test(Y?Y.toLowerCase():"")}_=E}if(_)K(d,"complete"),K(d,"success");else{d.o=6;try{var O=hs(d)>2?d.g.statusText:""}catch{O=""}d.l=O+" ["+d.ca()+"]",d0(d)}}finally{_c(d)}}}}function _c(d,g){if(d.g){d.m&&(clearTimeout(d.m),d.m=null);const _=d.g;d.g=null,g||K(d,"ready");try{_.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function hs(d){return d.g?d.g.readyState:0}n.ca=function(){try{return hs(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(d){if(this.g){var g=this.g.responseText;return d&&g.indexOf(d)==0&&(g=g.substring(d.length)),Wt(g)}};function p0(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.F){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function kk(d){const g={};d=(d.g&&hs(d)>=2&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let E=0;E<d.length;E++){if(C(d[E]))continue;var _=dk(d[E]);const O=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const V=g[O]||[];g[O]=V,V.push(_)}tr(g,function(E){return E.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Sa(d,g,_){return _&&_.internalChannelParams&&_.internalChannelParams[d]||g}function m0(d){this.za=0,this.i=[],this.j=new pa,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Sa("failFast",!1,d),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Sa("baseRetryDelayMs",5e3,d),this.Za=Sa("retryDelaySeedMs",1e4,d),this.Ta=Sa("forwardChannelMaxRetries",2,d),this.va=Sa("forwardChannelRequestTimeoutMs",2e4,d),this.ma=d&&d.xmlHttpFactory||void 0,this.Ua=d&&d.Rb||void 0,this.Aa=d&&d.useFetchStreams||!1,this.O=void 0,this.L=d&&d.supportsCrossDomainXhr||!1,this.M="",this.h=new Yy(d&&d.concurrentRequestLimit),this.Ba=new Ck,this.S=d&&d.fastHandshake||!1,this.R=d&&d.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=d&&d.Pb||!1,d&&d.ua&&this.j.ua(),d&&d.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&d&&d.detectBufferingProxy||!1,this.ia=void 0,d&&d.longPollingTimeout&&d.longPollingTimeout>0&&(this.ia=d.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=m0.prototype,n.ka=8,n.I=1,n.connect=function(d,g,_,E){on(0),this.W=d,this.H=g||{},_&&E!==void 0&&(this.H.OSID=_,this.H.OAID=E),this.F=this.X,this.J=S0(this,null,this.W),wc(this)};function ef(d){if(g0(d),d.I==3){var g=d.V++,_=nr(d.J);if(et(_,"SID",d.M),et(_,"RID",g),et(_,"TYPE","terminate"),Ca(d,_),g=new ls(d,d.j,g),g.M=2,g.A=gc(nr(_)),_=!1,o.navigator&&o.navigator.sendBeacon)try{_=o.navigator.sendBeacon(g.A.toString(),"")}catch{}!_&&o.Image&&(new Image().src=g.A,_=!0),_||(g.g=C0(g.j,null),g.g.ea(g.A)),g.F=Date.now(),mc(g)}T0(d)}function vc(d){d.g&&(nf(d),d.g.cancel(),d.g=null)}function g0(d){vc(d),d.v&&(o.clearTimeout(d.v),d.v=null),bc(d),d.h.cancel(),d.m&&(typeof d.m=="number"&&o.clearTimeout(d.m),d.m=null)}function wc(d){if(!Xy(d.h)&&!d.m){d.m=!0;var g=d.Ea;L||w(),q||(L(),q=!0),S.add(g,d),d.D=0}}function Rk(d,g){return Zy(d.h)>=d.h.j-(d.m?1:0)?!1:d.m?(d.i=g.G.concat(d.i),!0):d.I==1||d.I==2||d.D>=(d.Sa?0:d.Ta)?!1:(d.m=fa(c(d.Ea,d,g),E0(d,d.D)),d.D++,!0)}n.Ea=function(d){if(this.m)if(this.m=null,this.I==1){if(!d){this.V=Math.floor(Math.random()*1e5),d=this.V++;const O=new ls(this,this.j,d);let V=this.o;if(this.U&&(V?(V=_n(V),xr(V,this.U)):V=this.U),this.u!==null||this.R||(O.J=V,V=null),this.S)e:{for(var g=0,_=0;_<this.i.length;_++){t:{var E=this.i[_];if("__data__"in E.map&&(E=E.map.__data__,typeof E=="string")){E=E.length;break t}E=void 0}if(E===void 0)break;if(g+=E,g>4096){g=_;break e}if(g===4096||_===this.i.length-1){g=_+1;break e}}g=1e3}else g=1e3;g=_0(this,O,g),_=nr(this.J),et(_,"RID",d),et(_,"CVER",22),this.G&&et(_,"X-HTTP-Session-Id",this.G),Ca(this,_),V&&(this.R?g="headers="+ma(u0(V))+"&"+g:this.u&&Zd(_,this.u,V)),Qd(this.h,O),this.Ra&&et(_,"TYPE","init"),this.S?(et(_,"$req",g),et(_,"SID","null"),O.U=!0,qd(O,_,null)):qd(O,_,g),this.I=2}}else this.I==3&&(d?y0(this,d):this.i.length==0||Xy(this.h)||y0(this))};function y0(d,g){var _;g?_=g.l:_=d.V++;const E=nr(d.J);et(E,"SID",d.M),et(E,"RID",_),et(E,"AID",d.K),Ca(d,E),d.u&&d.o&&Zd(E,d.u,d.o),_=new ls(d,d.j,_,d.D+1),d.u===null&&(_.J=d.o),g&&(d.i=g.G.concat(d.i)),g=_0(d,_,1e3),_.H=Math.round(d.va*.5)+Math.round(d.va*.5*Math.random()),Qd(d.h,_),qd(_,E,g)}function Ca(d,g){d.H&&fn(d.H,function(_,E){et(g,E,_)}),d.l&&fn({},function(_,E){et(g,E,_)})}function _0(d,g,_){_=Math.min(d.i.length,_);const E=d.l?c(d.l.Ka,d.l,d):null;e:{var O=d.i;let Te=-1;for(;;){const Et=["count="+_];Te==-1?_>0?(Te=O[0].g,Et.push("ofs="+Te)):Te=0:Et.push("ofs="+Te);let We=!0;for(let Ct=0;Ct<_;Ct++){var V=O[Ct].g;const rr=O[Ct].map;if(V-=Te,V<0)Te=Math.max(0,O[Ct].g-100),We=!1;else try{V="req"+V+"_"||"";try{var Y=rr instanceof Map?rr:Object.entries(rr);for(const[_i,ds]of Y){let fs=ds;a(ds)&&(fs=De(ds)),Et.push(V+_i+"="+encodeURIComponent(fs))}}catch(_i){throw Et.push(V+"type="+encodeURIComponent("_badmap")),_i}}catch{E&&E(rr)}}if(We){Y=Et.join("&");break e}}Y=void 0}return d=d.i.splice(0,_),g.G=d,Y}function v0(d){if(!d.g&&!d.v){d.Y=1;var g=d.Da;L||w(),q||(L(),q=!0),S.add(g,d),d.A=0}}function tf(d){return d.g||d.v||d.A>=3?!1:(d.Y++,d.v=fa(c(d.Da,d),E0(d,d.A)),d.A++,!0)}n.Da=function(){if(this.v=null,w0(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var d=4*this.T;this.j.info("BP detection timer enabled: "+d),this.B=fa(c(this.Wa,this),d)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,on(10),vc(this),w0(this))};function nf(d){d.B!=null&&(o.clearTimeout(d.B),d.B=null)}function w0(d){d.g=new ls(d,d.j,"rpc",d.Y),d.u===null&&(d.g.J=d.o),d.g.P=0;var g=nr(d.na);et(g,"RID","rpc"),et(g,"SID",d.M),et(g,"AID",d.K),et(g,"CI",d.F?"0":"1"),!d.F&&d.ia&&et(g,"TO",d.ia),et(g,"TYPE","xmlhttp"),Ca(d,g),d.u&&d.o&&Zd(g,d.u,d.o),d.O&&(d.g.H=d.O);var _=d.g;d=d.ba,_.M=1,_.A=gc(nr(g)),_.u=null,_.R=!0,Gy(_,d)}n.Va=function(){this.C!=null&&(this.C=null,vc(this),tf(this),on(19))};function bc(d){d.C!=null&&(o.clearTimeout(d.C),d.C=null)}function b0(d,g){var _=null;if(d.g==g){bc(d),nf(d),d.g=null;var E=2}else if(Jd(d.h,g))_=g.G,e0(d.h,g),E=1;else return;if(d.I!=0){if(g.o)if(E==1){_=g.u?g.u.length:0,g=Date.now()-g.F;var O=d.D;E=pi(),K(E,new Hy(E,_)),wc(d)}else v0(d);else if(O=g.m,O==3||O==0&&g.X>0||!(E==1&&Rk(d,g)||E==2&&tf(d)))switch(_&&_.length>0&&(g=d.h,g.i=g.i.concat(_)),O){case 1:yi(d,5);break;case 4:yi(d,10);break;case 3:yi(d,6);break;default:yi(d,2)}}}function E0(d,g){let _=d.Qa+Math.floor(Math.random()*d.Za);return d.isActive()||(_*=2),_*g}function yi(d,g){if(d.j.info("Error code "+g),g==2){var _=c(d.bb,d),E=d.Ua;const O=!E;E=new cs(E||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ya(E,"https"),gc(E),O?Tk(E.toString(),_):Sk(E.toString(),_)}else on(2);d.I=0,d.l&&d.l.pa(g),T0(d),g0(d)}n.bb=function(d){d?(this.j.info("Successfully pinged google.com"),on(2)):(this.j.info("Failed to ping google.com"),on(1))};function T0(d){if(d.I=0,d.ja=[],d.l){const g=t0(d.h);(g.length!=0||d.i.length!=0)&&(m(d.ja,g),m(d.ja,d.i),d.h.i.length=0,p(d.i),d.i.length=0),d.l.oa()}}function S0(d,g,_){var E=_ instanceof cs?nr(_):new cs(_);if(E.g!="")g&&(E.g=g+"."+E.g),_a(E,E.u);else{var O=o.location;E=O.protocol,g=g?g+"."+O.hostname:O.hostname,O=+O.port;const V=new cs(null);E&&ya(V,E),g&&(V.g=g),O&&_a(V,O),_&&(V.h=_),E=V}return _=d.G,g=d.wa,_&&g&&et(E,_,g),et(E,"VER",d.ka),Ca(d,E),E}function C0(d,g,_){if(g&&!d.L)throw Error("Can't create secondary domain capable XhrIo object.");return g=d.Aa&&!d.ma?new lt(new Xd({ab:_})):new lt(d.ma),g.Fa(d.L),g}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function A0(){}n=A0.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ec(){}Ec.prototype.g=function(d,g){return new bn(d,g)};function bn(d,g){J.call(this),this.g=new m0(g),this.l=d,this.h=g&&g.messageUrlParams||null,d=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(d?d["X-WebChannel-Content-Type"]=g.messageContentType:d={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.sa&&(d?d["X-WebChannel-Client-Profile"]=g.sa:d={"X-WebChannel-Client-Profile":g.sa}),this.g.U=d,(d=g&&g.Qb)&&!C(d)&&(this.g.u=d),this.A=g&&g.supportsCrossDomainXhr||!1,this.v=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!C(g)&&(this.g.G=g,d=this.h,d!==null&&g in d&&(d=this.h,g in d&&delete d[g])),this.j=new uo(this)}h(bn,J),bn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},bn.prototype.close=function(){ef(this.g)},bn.prototype.o=function(d){var g=this.g;if(typeof d=="string"){var _={};_.__data__=d,d=_}else this.v&&(_={},_.__data__=De(d),d=_);g.i.push(new mk(g.Ya++,d)),g.I==3&&wc(g)},bn.prototype.N=function(){this.g.l=null,delete this.j,ef(this.g),delete this.g,bn.Z.N.call(this)};function I0(d){ao.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var g=d.__sm__;if(g){e:{for(const _ in g){d=_;break e}d=void 0}(this.i=d)&&(d=this.i,g=g!==null&&d in g?g[d]:void 0),this.data=g}else this.data=d}h(I0,ao);function k0(){Ot.call(this),this.status=1}h(k0,Ot);function uo(d){this.g=d}h(uo,A0),uo.prototype.ra=function(){K(this.g,"a")},uo.prototype.qa=function(d){K(this.g,new I0(d))},uo.prototype.pa=function(d){K(this.g,new k0)},uo.prototype.oa=function(){K(this.g,"b")},Ec.prototype.createWebChannel=Ec.prototype.g,bn.prototype.send=bn.prototype.o,bn.prototype.open=bn.prototype.m,bn.prototype.close=bn.prototype.close,WE=function(){return new Ec},jE=function(){return pi()},HE=St,kp={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},pc.NO_ERROR=0,pc.TIMEOUT=8,pc.HTTP_ERROR=6,tu=pc,jy.COMPLETE="complete",zE=jy,wn.EventType=zn,zn.OPEN="a",zn.CLOSE="b",zn.ERROR="c",zn.MESSAGE="d",J.prototype.listen=J.prototype.J,Da=wn,lt.prototype.listenOnce=lt.prototype.K,lt.prototype.getLastError=lt.prototype.Ha,lt.prototype.getLastErrorCode=lt.prototype.ya,lt.prototype.getStatus=lt.prototype.ca,lt.prototype.getResponseJson=lt.prototype.La,lt.prototype.getResponseText=lt.prototype.la,lt.prototype.send=lt.prototype.ea,lt.prototype.setWithCredentials=lt.prototype.Fa,UE=lt}).apply(typeof kc<"u"?kc:typeof self<"u"?self:typeof window<"u"?window:{});const U_="@firebase/firestore",z_="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Qt.UNAUTHENTICATED=new Qt(null),Qt.GOOGLE_CREDENTIALS=new Qt("google-credentials-uid"),Qt.FIRST_PARTY=new Qt("first-party-uid"),Qt.MOCK_USER=new Qt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let na="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ji=new tg("@firebase/firestore");function vo(){return ji.logLevel}function se(n,...e){if(ji.logLevel<=xe.DEBUG){const t=e.map(sg);ji.debug(`Firestore (${na}): ${n}`,...t)}}function es(n,...e){if(ji.logLevel<=xe.ERROR){const t=e.map(sg);ji.error(`Firestore (${na}): ${n}`,...t)}}function zo(n,...e){if(ji.logLevel<=xe.WARN){const t=e.map(sg);ji.warn(`Firestore (${na}): ${n}`,...t)}}function sg(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ge(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,qE(n,r,t)}function qE(n,e,t){let r=`FIRESTORE (${na}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw es(r),new Error(r)}function Ue(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||qE(e,s,r)}function Ee(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ne extends Ir{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KE{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class w2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Qt.UNAUTHENTICATED)))}shutdown(){}}class b2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class E2{constructor(e){this.t=e,this.currentUser=Qt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ue(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let i=new Hs;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Hs,e.enqueueRetryable((()=>s(this.currentUser)))};const o=()=>{const l=i;e.enqueueRetryable((async()=>{await l.promise,await s(this.currentUser)}))},a=l=>{se("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((l=>a(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(se("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Hs)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(se("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ue(typeof r.accessToken=="string",31837,{l:r}),new KE(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ue(e===null||typeof e=="string",2055,{h:e}),new Qt(e)}}class T2{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Qt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class S2{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new T2(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Qt.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class H_{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class C2{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Nn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ue(this.o===void 0,3512);const r=i=>{i.error!=null&&se("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,se("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>r(i)))};const s=i=>{se("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>s(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):se("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new H_(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ue(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new H_(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A2(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ig{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=A2(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%62))}return r}}function Me(n,e){return n<e?-1:n>e?1:0}function Rp(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const s=n.charAt(r),i=e.charAt(r);if(s!==i)return Cf(s)===Cf(i)?Me(s,i):Cf(s)?1:-1}return Me(n.length,e.length)}const I2=55296,k2=57343;function Cf(n){const e=n.charCodeAt(0);return e>=I2&&e<=k2}function Ho(n,e,t){return n.length===e.length&&n.every(((r,s)=>t(r,e[s])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j_="__name__";class cr{constructor(e,t,r){t===void 0?t=0:t>e.length&&ge(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&ge(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return cr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof cr?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=cr.compareSegments(e.get(s),t.get(s));if(i!==0)return i}return Me(e.length,t.length)}static compareSegments(e,t){const r=cr.isNumericId(e),s=cr.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?cr.extractNumericId(e).compare(cr.extractNumericId(t)):Rp(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return zs.fromString(e.substring(4,e.length-2))}}class Ye extends cr{construct(e,t,r){return new Ye(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new ne(B.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((s=>s.length>0)))}return new Ye(t)}static emptyPath(){return new Ye([])}}const R2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class $t extends cr{construct(e,t,r){return new $t(e,t,r)}static isValidIdentifier(e){return R2.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),$t.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===j_}static keyField(){return new $t([j_])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new ne(B.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new ne(B.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ne(B.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new ne(B.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new $t(t)}static emptyPath(){return new $t([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{constructor(e){this.path=e}static fromPath(e){return new ae(Ye.fromString(e))}static fromName(e){return new ae(Ye.fromString(e).popFirst(5))}static empty(){return new ae(Ye.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ye.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ye.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ae(new Ye(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GE(n,e,t){if(!t)throw new ne(B.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function x2(n,e,t,r){if(e===!0&&r===!0)throw new ne(B.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function W_(n){if(!ae.isDocumentKey(n))throw new ne(B.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function q_(n){if(ae.isDocumentKey(n))throw new ne(B.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function JE(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function od(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ge(12329,{type:typeof n})}function Gr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ne(B.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=od(n);throw new ne(B.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _t(n,e){const t={typeString:n};return e&&(t.value=e),t}function Zl(n,e){if(!JE(n))throw new ne(B.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const o=n[r];if(s&&typeof o!==s){t=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){t=`Expected '${r}' field to equal '${i.value}'`;break}}if(t)throw new ne(B.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K_=-62135596800,G_=1e6;class nt{static now(){return nt.fromMillis(Date.now())}static fromDate(e){return nt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*G_);return new nt(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ne(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ne(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<K_)throw new ne(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ne(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/G_}_compareTo(e){return this.seconds===e.seconds?Me(this.nanoseconds,e.nanoseconds):Me(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:nt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Zl(e,nt._jsonSchema))return new nt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-K_;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}nt._jsonSchemaVersion="firestore/timestamp/1.0",nt._jsonSchema={type:_t("string",nt._jsonSchemaVersion),seconds:_t("number"),nanoseconds:_t("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{static fromTimestamp(e){return new ve(e)}static min(){return new ve(new nt(0,0))}static max(){return new ve(new nt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Al=-1;function M2(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=ve.fromTimestamp(r===1e9?new nt(t+1,0):new nt(t,r));return new Zs(s,ae.empty(),e)}function P2(n){return new Zs(n.readTime,n.key,Al)}class Zs{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Zs(ve.min(),ae.empty(),Al)}static max(){return new Zs(ve.max(),ae.empty(),Al)}}function N2(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ae.comparator(n.documentKey,e.documentKey),t!==0?t:Me(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class D2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ra(n){if(n.code!==B.FAILED_PRECONDITION||n.message!==O2)throw n;se("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ge(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new z(((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof z?t:z.resolve(t)}catch(t){return z.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):z.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):z.reject(t)}static resolve(e){return new z(((t,r)=>{t(e)}))}static reject(e){return new z(((t,r)=>{r(e)}))}static waitFor(e){return new z(((t,r)=>{let s=0,i=0,o=!1;e.forEach((a=>{++s,a.next((()=>{++i,o&&i===s&&t()}),(l=>r(l)))})),o=!0,i===s&&t()}))}static or(e){let t=z.resolve(!1);for(const r of e)t=t.next((s=>s?z.resolve(s):r()));return t}static forEach(e,t){const r=[];return e.forEach(((s,i)=>{r.push(t.call(this,s,i))})),this.waitFor(r)}static mapArray(e,t){return new z(((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const c=l;t(e[c]).next((u=>{o[c]=u,++a,a===i&&r(o)}),(u=>s(u)))}}))}static doWhile(e,t){return new z(((r,s)=>{const i=()=>{e()===!0?t().next((()=>{i()}),s):r()};i()}))}}function L2(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function sa(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ad.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const og=-1;function ld(n){return n==null}function xu(n){return n===0&&1/n==-1/0}function V2(n){return typeof n=="number"&&Number.isInteger(n)&&!xu(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QE="";function F2(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=J_(e)),e=B2(n.get(t),e);return J_(e)}function B2(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case QE:t+="";break;default:t+=i}}return t}function J_(n){return n+QE+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q_(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ci(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function YE(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e,t){this.comparator=e,this.root=t||Lt.EMPTY}insert(e,t){return new at(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Lt.BLACK,null,null))}remove(e){return new at(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Lt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Rc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Rc(this.root,e,this.comparator,!1)}getReverseIterator(){return new Rc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Rc(this.root,e,this.comparator,!0)}}class Rc{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Lt{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??Lt.RED,this.left=s??Lt.EMPTY,this.right=i??Lt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new Lt(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Lt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Lt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Lt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Lt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ge(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ge(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ge(27949);return e+(this.isRed()?0:1)}}Lt.EMPTY=null,Lt.RED=!0,Lt.BLACK=!1;Lt.EMPTY=new class{constructor(){this.size=0}get key(){throw ge(57766)}get value(){throw ge(16141)}get color(){throw ge(16727)}get left(){throw ge(29726)}get right(){throw ge(36894)}copy(e,t,r,s,i){return this}insert(e,t,r){return new Lt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e){this.comparator=e,this.data=new at(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Y_(this.data.getIterator())}getIteratorFrom(e){return new Y_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Tt)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Tt(this.comparator);return t.data=e,t}}class Y_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e){this.fields=e,e.sort($t.comparator)}static empty(){return new In([])}unionWith(e){let t=new Tt($t.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new In(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ho(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new XE("Invalid base64 string: "+i):i}})(e);return new Ut(t)}static fromUint8Array(e){const t=(function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i})(e);return new Ut(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Me(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ut.EMPTY_BYTE_STRING=new Ut("");const $2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ei(n){if(Ue(!!n,39018),typeof n=="string"){let e=0;const t=$2.exec(n);if(Ue(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ft(n.seconds),nanos:ft(n.nanos)}}function ft(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ti(n){return typeof n=="string"?Ut.fromBase64String(n):Ut.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZE="server_timestamp",eT="__type__",tT="__previous_value__",nT="__local_write_time__";function ag(n){return(n?.mapValue?.fields||{})[eT]?.stringValue===ZE}function cd(n){const e=n.mapValue.fields[tT];return ag(e)?cd(e):e}function Il(n){const e=ei(n.mapValue.fields[nT].timestampValue);return new nt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U2{constructor(e,t,r,s,i,o,a,l,c,u){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=u}}const Mu="(default)";class kl{constructor(e,t){this.projectId=e,this.database=t||Mu}static empty(){return new kl("","")}get isDefaultDatabase(){return this.database===Mu}isEqual(e){return e instanceof kl&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rT="__type__",z2="__max__",xc={mapValue:{}},sT="__vector__",Pu="value";function ni(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?ag(n)?4:j2(n)?9007199254740991:H2(n)?10:11:ge(28295,{value:n})}function Er(n,e){if(n===e)return!0;const t=ni(n);if(t!==ni(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Il(n).isEqual(Il(e));case 3:return(function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=ei(s.timestampValue),a=ei(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,i){return ti(s.bytesValue).isEqual(ti(i.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,i){return ft(s.geoPointValue.latitude)===ft(i.geoPointValue.latitude)&&ft(s.geoPointValue.longitude)===ft(i.geoPointValue.longitude)})(n,e);case 2:return(function(s,i){if("integerValue"in s&&"integerValue"in i)return ft(s.integerValue)===ft(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=ft(s.doubleValue),a=ft(i.doubleValue);return o===a?xu(o)===xu(a):isNaN(o)&&isNaN(a)}return!1})(n,e);case 9:return Ho(n.arrayValue.values||[],e.arrayValue.values||[],Er);case 10:case 11:return(function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(Q_(o)!==Q_(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Er(o[l],a[l])))return!1;return!0})(n,e);default:return ge(52216,{left:n})}}function Rl(n,e){return(n.values||[]).find((t=>Er(t,e)))!==void 0}function jo(n,e){if(n===e)return 0;const t=ni(n),r=ni(e);if(t!==r)return Me(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Me(n.booleanValue,e.booleanValue);case 2:return(function(i,o){const a=ft(i.integerValue||i.doubleValue),l=ft(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1})(n,e);case 3:return X_(n.timestampValue,e.timestampValue);case 4:return X_(Il(n),Il(e));case 5:return Rp(n.stringValue,e.stringValue);case 6:return(function(i,o){const a=ti(i),l=ti(o);return a.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(i,o){const a=i.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const u=Me(a[c],l[c]);if(u!==0)return u}return Me(a.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(i,o){const a=Me(ft(i.latitude),ft(o.latitude));return a!==0?a:Me(ft(i.longitude),ft(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Z_(n.arrayValue,e.arrayValue);case 10:return(function(i,o){const a=i.fields||{},l=o.fields||{},c=a[Pu]?.arrayValue,u=l[Pu]?.arrayValue,h=Me(c?.values?.length||0,u?.values?.length||0);return h!==0?h:Z_(c,u)})(n.mapValue,e.mapValue);case 11:return(function(i,o){if(i===xc.mapValue&&o===xc.mapValue)return 0;if(i===xc.mapValue)return 1;if(o===xc.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),c=o.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let h=0;h<l.length&&h<u.length;++h){const f=Rp(l[h],u[h]);if(f!==0)return f;const p=jo(a[l[h]],c[u[h]]);if(p!==0)return p}return Me(l.length,u.length)})(n.mapValue,e.mapValue);default:throw ge(23264,{he:t})}}function X_(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Me(n,e);const t=ei(n),r=ei(e),s=Me(t.seconds,r.seconds);return s!==0?s:Me(t.nanos,r.nanos)}function Z_(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=jo(t[s],r[s]);if(i)return i}return Me(t.length,r.length)}function Wo(n){return xp(n)}function xp(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=ei(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return ti(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return ae.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=xp(i);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${xp(t.fields[o])}`;return s+"}"})(n.mapValue):ge(61005,{value:n})}function nu(n){switch(ni(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=cd(n);return e?16+nu(e):16;case 5:return 2*n.stringValue.length;case 6:return ti(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((s,i)=>s+nu(i)),0)})(n.arrayValue);case 10:case 11:return(function(r){let s=0;return ci(r.fields,((i,o)=>{s+=i.length+nu(o)})),s})(n.mapValue);default:throw ge(13486,{value:n})}}function ev(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Mp(n){return!!n&&"integerValue"in n}function lg(n){return!!n&&"arrayValue"in n}function tv(n){return!!n&&"nullValue"in n}function nv(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ru(n){return!!n&&"mapValue"in n}function H2(n){return(n?.mapValue?.fields||{})[rT]?.stringValue===sT}function el(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return ci(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=el(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=el(n.arrayValue.values[t]);return e}return{...n}}function j2(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===z2}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e){this.value=e}static empty(){return new gn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!ru(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=el(t)}setAll(e){let t=$t.emptyPath(),r={},s=[];e.forEach(((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,r,s),r={},s=[],t=a.popLast()}o?r[a.lastSegment()]=el(o):s.push(a.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());ru(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Er(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];ru(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){ci(t,((s,i)=>e[s]=i));for(const s of r)delete e[s]}clone(){return new gn(el(this.value))}}function iT(n){const e=[];return ci(n.fields,((t,r)=>{const s=new $t([t]);if(ru(r)){const i=iT(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)})),new In(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e,t,r,s,i,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Zt(e,0,ve.min(),ve.min(),ve.min(),gn.empty(),0)}static newFoundDocument(e,t,r,s){return new Zt(e,1,t,ve.min(),r,s,0)}static newNoDocument(e,t){return new Zt(e,2,t,ve.min(),ve.min(),gn.empty(),0)}static newUnknownDocument(e,t){return new Zt(e,3,t,ve.min(),ve.min(),gn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=gn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=gn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Zt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Zt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu{constructor(e,t){this.position=e,this.inclusive=t}}function rv(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],o=n.position[s];if(i.field.isKeyField()?r=ae.comparator(ae.fromName(o.referenceValue),t.key):r=jo(o,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function sv(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Er(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xl{constructor(e,t="asc"){this.field=e,this.dir=t}}function W2(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oT{}class yt extends oT{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new K2(e,t,r):t==="array-contains"?new Q2(e,r):t==="in"?new Y2(e,r):t==="not-in"?new X2(e,r):t==="array-contains-any"?new Z2(e,r):new yt(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new G2(e,r):new J2(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(jo(t,this.value)):t!==null&&ni(this.value)===ni(t)&&this.matchesComparison(jo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ge(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Xn extends oT{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Xn(e,t)}matches(e){return aT(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function aT(n){return n.op==="and"}function lT(n){return q2(n)&&aT(n)}function q2(n){for(const e of n.filters)if(e instanceof Xn)return!1;return!0}function Pp(n){if(n instanceof yt)return n.field.canonicalString()+n.op.toString()+Wo(n.value);if(lT(n))return n.filters.map((e=>Pp(e))).join(",");{const e=n.filters.map((t=>Pp(t))).join(",");return`${n.op}(${e})`}}function cT(n,e){return n instanceof yt?(function(r,s){return s instanceof yt&&r.op===s.op&&r.field.isEqual(s.field)&&Er(r.value,s.value)})(n,e):n instanceof Xn?(function(r,s){return s instanceof Xn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce(((i,o,a)=>i&&cT(o,s.filters[a])),!0):!1})(n,e):void ge(19439)}function uT(n){return n instanceof yt?(function(t){return`${t.field.canonicalString()} ${t.op} ${Wo(t.value)}`})(n):n instanceof Xn?(function(t){return t.op.toString()+" {"+t.getFilters().map(uT).join(" ,")+"}"})(n):"Filter"}class K2 extends yt{constructor(e,t,r){super(e,t,r),this.key=ae.fromName(r.referenceValue)}matches(e){const t=ae.comparator(e.key,this.key);return this.matchesComparison(t)}}class G2 extends yt{constructor(e,t){super(e,"in",t),this.keys=hT("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class J2 extends yt{constructor(e,t){super(e,"not-in",t),this.keys=hT("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function hT(n,e){return(e.arrayValue?.values||[]).map((t=>ae.fromName(t.referenceValue)))}class Q2 extends yt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return lg(t)&&Rl(t.arrayValue,this.value)}}class Y2 extends yt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Rl(this.value.arrayValue,t)}}class X2 extends yt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Rl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Rl(this.value.arrayValue,t)}}class Z2 extends yt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!lg(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Rl(this.value.arrayValue,r)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eO{constructor(e,t=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function iv(n,e=null,t=[],r=[],s=null,i=null,o=null){return new eO(n,e,t,r,s,i,o)}function cg(n){const e=Ee(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>Pp(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(i){return i.field.canonicalString()+i.dir})(r))).join(","),ld(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>Wo(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>Wo(r))).join(",")),e.Te=t}return e.Te}function ug(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!W2(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!cT(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!sv(n.startAt,e.startAt)&&sv(n.endAt,e.endAt)}function Np(n){return ae.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ia{constructor(e,t=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function tO(n,e,t,r,s,i,o,a){return new ia(n,e,t,r,s,i,o,a)}function ud(n){return new ia(n)}function ov(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function dT(n){return n.collectionGroup!==null}function tl(n){const e=Ee(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Tt($t.comparator);return o.filters.forEach((l=>{l.getFlattenedFilters().forEach((c=>{c.isInequality()&&(a=a.add(c.field))}))})),a})(e).forEach((i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new xl(i,r))})),t.has($t.keyField().canonicalString())||e.Ie.push(new xl($t.keyField(),r))}return e.Ie}function pr(n){const e=Ee(n);return e.Ee||(e.Ee=nO(e,tl(n))),e.Ee}function nO(n,e){if(n.limitType==="F")return iv(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const i=s.dir==="desc"?"asc":"desc";return new xl(s.field,i)}));const t=n.endAt?new Nu(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Nu(n.startAt.position,n.startAt.inclusive):null;return iv(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Op(n,e){const t=n.filters.concat([e]);return new ia(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Dp(n,e,t){return new ia(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function hd(n,e){return ug(pr(n),pr(e))&&n.limitType===e.limitType}function fT(n){return`${cg(pr(n))}|lt:${n.limitType}`}function wo(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((s=>uT(s))).join(", ")}]`),ld(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((s=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(s))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((s=>Wo(s))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((s=>Wo(s))).join(",")),`Target(${r})`})(pr(n))}; limitType=${n.limitType})`}function dd(n,e){return e.isFoundDocument()&&(function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):ae.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)})(n,e)&&(function(r,s){for(const i of tl(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0})(n,e)&&(function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0})(n,e)&&(function(r,s){return!(r.startAt&&!(function(o,a,l){const c=rv(o,a,l);return o.inclusive?c<=0:c<0})(r.startAt,tl(r),s)||r.endAt&&!(function(o,a,l){const c=rv(o,a,l);return o.inclusive?c>=0:c>0})(r.endAt,tl(r),s))})(n,e)}function rO(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function pT(n){return(e,t)=>{let r=!1;for(const s of tl(n)){const i=sO(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function sO(n,e,t){const r=n.field.isKeyField()?ae.comparator(e.key,t.key):(function(i,o,a){const l=o.data.field(i),c=a.data.field(i);return l!==null&&c!==null?jo(l,c):ge(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return ge(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ci(this.inner,((t,r)=>{for(const[s,i]of r)e(s,i)}))}isEmpty(){return YE(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iO=new at(ae.comparator);function ts(){return iO}const mT=new at(ae.comparator);function La(...n){let e=mT;for(const t of n)e=e.insert(t.key,t);return e}function gT(n){let e=mT;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function ki(){return nl()}function yT(){return nl()}function nl(){return new no((n=>n.toString()),((n,e)=>n.isEqual(e)))}const oO=new at(ae.comparator),aO=new Tt(ae.comparator);function Pe(...n){let e=aO;for(const t of n)e=e.add(t);return e}const lO=new Tt(Me);function cO(){return lO}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hg(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:xu(e)?"-0":e}}function _T(n){return{integerValue:""+n}}function vT(n,e){return V2(e)?_T(e):hg(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd{constructor(){this._=void 0}}function uO(n,e,t){return n instanceof Ml?(function(s,i){const o={fields:{[eT]:{stringValue:ZE},[nT]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&ag(i)&&(i=cd(i)),i&&(o.fields[tT]=i),{mapValue:o}})(t,e):n instanceof Pl?bT(n,e):n instanceof Nl?ET(n,e):(function(s,i){const o=wT(s,i),a=av(o)+av(s.Ae);return Mp(o)&&Mp(s.Ae)?_T(a):hg(s.serializer,a)})(n,e)}function hO(n,e,t){return n instanceof Pl?bT(n,e):n instanceof Nl?ET(n,e):t}function wT(n,e){return n instanceof Ol?(function(r){return Mp(r)||(function(i){return!!i&&"doubleValue"in i})(r)})(e)?e:{integerValue:0}:null}class Ml extends fd{}class Pl extends fd{constructor(e){super(),this.elements=e}}function bT(n,e){const t=TT(e);for(const r of n.elements)t.some((s=>Er(s,r)))||t.push(r);return{arrayValue:{values:t}}}class Nl extends fd{constructor(e){super(),this.elements=e}}function ET(n,e){let t=TT(e);for(const r of n.elements)t=t.filter((s=>!Er(s,r)));return{arrayValue:{values:t}}}class Ol extends fd{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function av(n){return ft(n.integerValue||n.doubleValue)}function TT(n){return lg(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ST{constructor(e,t){this.field=e,this.transform=t}}function dO(n,e){return n.field.isEqual(e.field)&&(function(r,s){return r instanceof Pl&&s instanceof Pl||r instanceof Nl&&s instanceof Nl?Ho(r.elements,s.elements,Er):r instanceof Ol&&s instanceof Ol?Er(r.Ae,s.Ae):r instanceof Ml&&s instanceof Ml})(n.transform,e.transform)}class fO{constructor(e,t){this.version=e,this.transformResults=t}}class mr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new mr}static exists(e){return new mr(void 0,e)}static updateTime(e){return new mr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function su(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class pd{}function CT(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new IT(n.key,mr.none()):new ec(n.key,n.data,mr.none());{const t=n.data,r=gn.empty();let s=new Tt($t.comparator);for(let i of e.fields)if(!s.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new ui(n.key,r,new In(s.toArray()),mr.none())}}function pO(n,e,t){n instanceof ec?(function(s,i,o){const a=s.value.clone(),l=cv(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()})(n,e,t):n instanceof ui?(function(s,i,o){if(!su(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=cv(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(AT(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()})(n,e,t):(function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function rl(n,e,t,r){return n instanceof ec?(function(i,o,a,l){if(!su(i.precondition,o))return a;const c=i.value.clone(),u=uv(i.fieldTransforms,l,o);return c.setAll(u),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null})(n,e,t,r):n instanceof ui?(function(i,o,a,l){if(!su(i.precondition,o))return a;const c=uv(i.fieldTransforms,l,o),u=o.data;return u.setAll(AT(i)),u.setAll(c),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((h=>h.field)))})(n,e,t,r):(function(i,o,a){return su(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a})(n,e,t)}function mO(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=wT(r.transform,s||null);i!=null&&(t===null&&(t=gn.empty()),t.set(r.field,i))}return t||null}function lv(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Ho(r,s,((i,o)=>dO(i,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class ec extends pd{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ui extends pd{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function AT(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function cv(n,e,t){const r=new Map;Ue(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let s=0;s<t.length;s++){const i=n[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,hO(o,a,t[s]))}return r}function uv(n,e,t){const r=new Map;for(const s of n){const i=s.transform,o=t.data.field(s.field);r.set(s.field,uO(i,o,e))}return r}class IT extends pd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class gO extends pd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yO{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&pO(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=rl(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=rl(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=yT();return this.mutations.forEach((s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(s.key)?null:a;const l=CT(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(ve.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Pe())}isEqual(e){return this.batchId===e.batchId&&Ho(this.mutations,e.mutations,((t,r)=>lv(t,r)))&&Ho(this.baseMutations,e.baseMutations,((t,r)=>lv(t,r)))}}class dg{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){Ue(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=(function(){return oO})();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new dg(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _O{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vO{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gt,Oe;function wO(n){switch(n){case B.OK:return ge(64938);case B.CANCELLED:case B.UNKNOWN:case B.DEADLINE_EXCEEDED:case B.RESOURCE_EXHAUSTED:case B.INTERNAL:case B.UNAVAILABLE:case B.UNAUTHENTICATED:return!1;case B.INVALID_ARGUMENT:case B.NOT_FOUND:case B.ALREADY_EXISTS:case B.PERMISSION_DENIED:case B.FAILED_PRECONDITION:case B.ABORTED:case B.OUT_OF_RANGE:case B.UNIMPLEMENTED:case B.DATA_LOSS:return!0;default:return ge(15467,{code:n})}}function kT(n){if(n===void 0)return es("GRPC error has no .code"),B.UNKNOWN;switch(n){case gt.OK:return B.OK;case gt.CANCELLED:return B.CANCELLED;case gt.UNKNOWN:return B.UNKNOWN;case gt.DEADLINE_EXCEEDED:return B.DEADLINE_EXCEEDED;case gt.RESOURCE_EXHAUSTED:return B.RESOURCE_EXHAUSTED;case gt.INTERNAL:return B.INTERNAL;case gt.UNAVAILABLE:return B.UNAVAILABLE;case gt.UNAUTHENTICATED:return B.UNAUTHENTICATED;case gt.INVALID_ARGUMENT:return B.INVALID_ARGUMENT;case gt.NOT_FOUND:return B.NOT_FOUND;case gt.ALREADY_EXISTS:return B.ALREADY_EXISTS;case gt.PERMISSION_DENIED:return B.PERMISSION_DENIED;case gt.FAILED_PRECONDITION:return B.FAILED_PRECONDITION;case gt.ABORTED:return B.ABORTED;case gt.OUT_OF_RANGE:return B.OUT_OF_RANGE;case gt.UNIMPLEMENTED:return B.UNIMPLEMENTED;case gt.DATA_LOSS:return B.DATA_LOSS;default:return ge(39323,{code:n})}}(Oe=gt||(gt={}))[Oe.OK=0]="OK",Oe[Oe.CANCELLED=1]="CANCELLED",Oe[Oe.UNKNOWN=2]="UNKNOWN",Oe[Oe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Oe[Oe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Oe[Oe.NOT_FOUND=5]="NOT_FOUND",Oe[Oe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Oe[Oe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Oe[Oe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Oe[Oe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Oe[Oe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Oe[Oe.ABORTED=10]="ABORTED",Oe[Oe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Oe[Oe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Oe[Oe.INTERNAL=13]="INTERNAL",Oe[Oe.UNAVAILABLE=14]="UNAVAILABLE",Oe[Oe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bO(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EO=new zs([4294967295,4294967295],0);function hv(n){const e=bO().encode(n),t=new $E;return t.update(e),new Uint8Array(t.digest())}function dv(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new zs([t,r],0),new zs([s,i],0)]}class fg{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Va(`Invalid padding: ${t}`);if(r<0)throw new Va(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Va(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Va(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=zs.fromNumber(this.ge)}ye(e,t,r){let s=e.add(t.multiply(zs.fromNumber(r)));return s.compare(EO)===1&&(s=new zs([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=hv(e),[r,s]=dv(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new fg(i,s,t);return r.forEach((a=>o.insert(a))),o}insert(e){if(this.ge===0)return;const t=hv(e),[r,s]=dv(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.Se(o)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Va extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class md{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,tc.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new md(ve.min(),s,new at(Me),ts(),Pe())}}class tc{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new tc(r,t,Pe(),Pe(),Pe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(e,t,r,s){this.be=e,this.removedTargetIds=t,this.key=r,this.De=s}}class RT{constructor(e,t){this.targetId=e,this.Ce=t}}class xT{constructor(e,t,r=Ut.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class fv{constructor(){this.ve=0,this.Fe=pv(),this.Me=Ut.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Pe(),t=Pe(),r=Pe();return this.Fe.forEach(((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:ge(38017,{changeType:i})}})),new tc(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=pv()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ue(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class TO{constructor(e){this.Ge=e,this.ze=new Map,this.je=ts(),this.Je=Mc(),this.He=Mc(),this.Ye=new at(Me)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:ge(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,r=e.Ce.count,s=this.ot(t);if(s){const i=s.target;if(Np(i))if(r===0){const o=new ae(i.path);this.et(t,o,Zt.newNoDocument(o,ve.min()))}else Ue(r===1,20013,{expectedCount:r});else{const o=this._t(t);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,c)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let o,a;try{o=ti(r).toUint8Array()}catch(l){if(l instanceof XE)return zo("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new fg(o,s,i)}catch(l){return zo(l instanceof Va?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let s=0;return r.forEach((i=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.et(t,i,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((i,o)=>{const a=this.ot(o);if(a){if(i.current&&Np(a.target)){const l=new ae(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,Zt.newNoDocument(l,e))}i.Be&&(t.set(o,i.ke()),i.qe())}}));let r=Pe();this.He.forEach(((i,o)=>{let a=!0;o.forEachWhile((l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)})),a&&(r=r.add(i))})),this.je.forEach(((i,o)=>o.setReadTime(e)));const s=new md(e,t,this.Ye,this.je,r);return this.je=ts(),this.Je=Mc(),this.He=Mc(),this.Ye=new at(Me),s}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new fv,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Tt(Me),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Tt(Me),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||se("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new fv),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Mc(){return new at(ae.comparator)}function pv(){return new at(ae.comparator)}const SO={asc:"ASCENDING",desc:"DESCENDING"},CO={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},AO={and:"AND",or:"OR"};class IO{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Lp(n,e){return n.useProto3Json||ld(e)?e:{value:e}}function Ou(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function MT(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function kO(n,e){return Ou(n,e.toTimestamp())}function gr(n){return Ue(!!n,49232),ve.fromTimestamp((function(t){const r=ei(t);return new nt(r.seconds,r.nanos)})(n))}function pg(n,e){return Vp(n,e).canonicalString()}function Vp(n,e){const t=(function(s){return new Ye(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function PT(n){const e=Ye.fromString(n);return Ue(VT(e),10190,{key:e.toString()}),e}function Fp(n,e){return pg(n.databaseId,e.path)}function Af(n,e){const t=PT(e);if(t.get(1)!==n.databaseId.projectId)throw new ne(B.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ne(B.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ae(OT(t))}function NT(n,e){return pg(n.databaseId,e)}function RO(n){const e=PT(n);return e.length===4?Ye.emptyPath():OT(e)}function Bp(n){return new Ye(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function OT(n){return Ue(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function mv(n,e,t){return{name:Fp(n,e),fields:t.value.mapValue.fields}}function xO(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:ge(39313,{state:c})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=(function(c,u){return c.useProto3Json?(Ue(u===void 0||typeof u=="string",58123),Ut.fromBase64String(u||"")):(Ue(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),Ut.fromUint8Array(u||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&(function(c){const u=c.code===void 0?B.UNKNOWN:kT(c.code);return new ne(u,c.message||"")})(o);t=new xT(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Af(n,r.document.name),i=gr(r.document.updateTime),o=r.document.createTime?gr(r.document.createTime):ve.min(),a=new gn({mapValue:{fields:r.document.fields}}),l=Zt.newFoundDocument(s,i,o,a),c=r.targetIds||[],u=r.removedTargetIds||[];t=new iu(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Af(n,r.document),i=r.readTime?gr(r.readTime):ve.min(),o=Zt.newNoDocument(s,i),a=r.removedTargetIds||[];t=new iu([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Af(n,r.document),i=r.removedTargetIds||[];t=new iu([],i,s,null)}else{if(!("filter"in e))return ge(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new vO(s,i),a=r.targetId;t=new RT(a,o)}}return t}function MO(n,e){let t;if(e instanceof ec)t={update:mv(n,e.key,e.value)};else if(e instanceof IT)t={delete:Fp(n,e.key)};else if(e instanceof ui)t={update:mv(n,e.key,e.data),updateMask:$O(e.fieldMask)};else{if(!(e instanceof gO))return ge(16599,{Vt:e.type});t={verify:Fp(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(i,o){const a=o.transform;if(a instanceof Ml)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Pl)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Nl)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Ol)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw ge(20930,{transform:o.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(s,i){return i.updateTime!==void 0?{updateTime:kO(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ge(27497)})(n,e.precondition)),t}function PO(n,e){return n&&n.length>0?(Ue(e!==void 0,14353),n.map((t=>(function(s,i){let o=s.updateTime?gr(s.updateTime):gr(i);return o.isEqual(ve.min())&&(o=gr(i)),new fO(o,s.transformResults||[])})(t,e)))):[]}function NO(n,e){return{documents:[NT(n,e.path)]}}function OO(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=NT(n,s);const i=(function(c){if(c.length!==0)return LT(Xn.create(c,"and"))})(e.filters);i&&(t.structuredQuery.where=i);const o=(function(c){if(c.length!==0)return c.map((u=>(function(f){return{field:bo(f.field),direction:VO(f.dir)}})(u)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=Lp(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(c){return{before:c.inclusive,values:c.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(c){return{before:!c.inclusive,values:c.position}})(e.endAt)),{ft:t,parent:s}}function DO(n){let e=RO(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){Ue(r===1,65062);const u=t.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let i=[];t.where&&(i=(function(h){const f=DT(h);return f instanceof Xn&&lT(f)?f.getFilters():[f]})(t.where));let o=[];t.orderBy&&(o=(function(h){return h.map((f=>(function(m){return new xl(Eo(m.field),(function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(m.direction))})(f)))})(t.orderBy));let a=null;t.limit&&(a=(function(h){let f;return f=typeof h=="object"?h.value:h,ld(f)?null:f})(t.limit));let l=null;t.startAt&&(l=(function(h){const f=!!h.before,p=h.values||[];return new Nu(p,f)})(t.startAt));let c=null;return t.endAt&&(c=(function(h){const f=!h.before,p=h.values||[];return new Nu(p,f)})(t.endAt)),tO(e,s,o,i,a,"F",l,c)}function LO(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ge(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function DT(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Eo(t.unaryFilter.field);return yt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Eo(t.unaryFilter.field);return yt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Eo(t.unaryFilter.field);return yt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Eo(t.unaryFilter.field);return yt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ge(61313);default:return ge(60726)}})(n):n.fieldFilter!==void 0?(function(t){return yt.create(Eo(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ge(58110);default:return ge(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Xn.create(t.compositeFilter.filters.map((r=>DT(r))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ge(1026)}})(t.compositeFilter.op))})(n):ge(30097,{filter:n})}function VO(n){return SO[n]}function FO(n){return CO[n]}function BO(n){return AO[n]}function bo(n){return{fieldPath:n.canonicalString()}}function Eo(n){return $t.fromServerFormat(n.fieldPath)}function LT(n){return n instanceof yt?(function(t){if(t.op==="=="){if(nv(t.value))return{unaryFilter:{field:bo(t.field),op:"IS_NAN"}};if(tv(t.value))return{unaryFilter:{field:bo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(nv(t.value))return{unaryFilter:{field:bo(t.field),op:"IS_NOT_NAN"}};if(tv(t.value))return{unaryFilter:{field:bo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:bo(t.field),op:FO(t.op),value:t.value}}})(n):n instanceof Xn?(function(t){const r=t.getFilters().map((s=>LT(s)));return r.length===1?r[0]:{compositeFilter:{op:BO(t.op),filters:r}}})(n):ge(54877,{filter:n})}function $O(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function VT(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Os{constructor(e,t,r,s,i=ve.min(),o=ve.min(),a=Ut.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Os(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Os(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Os(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Os(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UO{constructor(e){this.yt=e}}function zO(n){const e=DO({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Dp(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HO{constructor(){this.Cn=new jO}addToCollectionParentIndex(e,t){return this.Cn.add(t),z.resolve()}getCollectionParents(e,t){return z.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return z.resolve()}deleteFieldIndex(e,t){return z.resolve()}deleteAllFieldIndexes(e){return z.resolve()}createTargetIndexes(e,t){return z.resolve()}getDocumentsMatchingTarget(e,t){return z.resolve(null)}getIndexType(e,t){return z.resolve(0)}getFieldIndexes(e,t){return z.resolve([])}getNextCollectionGroupToUpdate(e){return z.resolve(null)}getMinOffset(e,t){return z.resolve(Zs.min())}getMinOffsetFromCollectionGroup(e,t){return z.resolve(Zs.min())}updateCollectionGroup(e,t,r){return z.resolve()}updateIndexEntries(e,t){return z.resolve()}}class jO{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new Tt(Ye.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Tt(Ye.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},FT=41943040;class pn{static withCacheSize(e){return new pn(e,pn.DEFAULT_COLLECTION_PERCENTILE,pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */pn.DEFAULT_COLLECTION_PERCENTILE=10,pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,pn.DEFAULT=new pn(FT,pn.DEFAULT_COLLECTION_PERCENTILE,pn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),pn.DISABLED=new pn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qo{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new qo(0)}static cr(){return new qo(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yv="LruGarbageCollector",WO=1048576;function _v([n,e],[t,r]){const s=Me(n,t);return s===0?Me(e,r):s}class qO{constructor(e){this.Ir=e,this.buffer=new Tt(_v),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();_v(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class KO{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){se(yv,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){sa(t)?se(yv,"Ignoring IndexedDB error during garbage collection: ",t):await ra(t)}await this.Vr(3e5)}))}}class GO{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return z.resolve(ad.ce);const r=new qO(t);return this.mr.forEachTarget(e,(s=>r.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>r.Ar(s))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(se("LruGarbageCollector","Garbage collection skipped; disabled"),z.resolve(gv)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(se("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),gv):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,s,i,o,a,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((h=>(h>this.params.maximumSequenceNumbersToCollect?(se("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),s=this.params.maximumSequenceNumbersToCollect):s=h,o=Date.now(),this.nthSequenceNumber(e,s)))).next((h=>(r=h,a=Date.now(),this.removeTargets(e,r,t)))).next((h=>(i=h,l=Date.now(),this.removeOrphanedDocuments(e,r)))).next((h=>(c=Date.now(),vo()<=xe.DEBUG&&se("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(l-a)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-u}ms`),z.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:h}))))}}function JO(n,e){return new GO(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QO{constructor(){this.changes=new no((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Zt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?z.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YO{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XO{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(r=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(r!==null&&rl(r.mutation,s,In.empty(),nt.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,Pe()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=Pe()){const s=ki();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,r).next((i=>{let o=La();return i.forEach(((a,l)=>{o=o.insert(a,l.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){const r=ki();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,Pe())))}populateOverlays(e,t,r){const s=[];return r.forEach((i=>{t.has(i)||s.push(i)})),this.documentOverlayCache.getOverlays(e,s).next((i=>{i.forEach(((o,a)=>{t.set(o,a)}))}))}computeViews(e,t,r,s){let i=ts();const o=nl(),a=(function(){return nl()})();return t.forEach(((l,c)=>{const u=r.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof ui)?i=i.insert(c.key,c):u!==void 0?(o.set(c.key,u.mutation.getFieldMask()),rl(u.mutation,c,u.mutation.getFieldMask(),nt.now())):o.set(c.key,In.empty())})),this.recalculateAndSaveOverlays(e,i).next((l=>(l.forEach(((c,u)=>o.set(c,u))),t.forEach(((c,u)=>a.set(c,new YO(u,o.get(c)??null)))),a)))}recalculateAndSaveOverlays(e,t){const r=nl();let s=new at(((o,a)=>o-a)),i=Pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(const a of o)a.keys().forEach((l=>{const c=t.get(l);if(c===null)return;let u=r.get(l)||In.empty();u=a.applyToLocalView(c,u),r.set(l,u);const h=(s.get(a.batchId)||Pe()).add(l);s=s.insert(a.batchId,h)}))})).next((()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,h=yT();u.forEach((f=>{if(!i.has(f)){const p=CT(t.get(f),r.get(f));p!==null&&h.set(f,p),i=i.add(f)}})),o.push(this.documentOverlayCache.saveOverlays(e,c,h))}return z.waitFor(o)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,s){return(function(o){return ae.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):dT(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next((i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):z.resolve(ki());let a=Al,l=i;return o.next((c=>z.forEach(c,((u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),i.get(u)?z.resolve():this.remoteDocumentCache.getEntry(e,u).next((f=>{l=l.insert(u,f)}))))).next((()=>this.populateOverlays(e,c,i))).next((()=>this.computeViews(e,l,c,Pe()))).next((u=>({batchId:a,changes:gT(u)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ae(t)).next((r=>{let s=La();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let o=La();return this.indexManager.getCollectionParents(e,i).next((a=>z.forEach(a,(l=>{const c=(function(h,f){return new ia(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)})(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r,s).next((u=>{u.forEach(((h,f)=>{o=o.insert(h,f)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s)))).next((o=>{i.forEach(((l,c)=>{const u=c.getKey();o.get(u)===null&&(o=o.insert(u,Zt.newInvalidDocument(u)))}));let a=La();return o.forEach(((l,c)=>{const u=i.get(l);u!==void 0&&rl(u.mutation,c,In.empty(),nt.now()),dd(t,c)&&(a=a.insert(l,c))})),a}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZO{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return z.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:gr(s.createTime)}})(t)),z.resolve()}getNamedQuery(e,t){return z.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(s){return{name:s.name,query:zO(s.bundledQuery),readTime:gr(s.readTime)}})(t)),z.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eD{constructor(){this.overlays=new at(ae.comparator),this.qr=new Map}getOverlay(e,t){return z.resolve(this.overlays.get(t))}getOverlays(e,t){const r=ki();return z.forEach(t,(s=>this.getOverlay(e,s).next((i=>{i!==null&&r.set(s,i)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((s,i)=>{this.St(e,t,i)})),z.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(r)),z.resolve()}getOverlaysForCollection(e,t,r){const s=ki(),i=t.length+1,o=new ae(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return z.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new at(((c,u)=>c-u));const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let u=i.get(c.largestBatchId);u===null&&(u=ki(),i=i.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=ki(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((c,u)=>a.set(c,u))),!(a.size()>=s)););return z.resolve(a)}St(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new _O(t,r));let i=this.qr.get(t);i===void 0&&(i=Pe(),this.qr.set(t,i)),this.qr.set(t,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tD{constructor(){this.sessionToken=Ut.EMPTY_BYTE_STRING}getSessionToken(e){return z.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,z.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mg{constructor(){this.Qr=new Tt(At.$r),this.Ur=new Tt(At.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new At(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new At(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new ae(new Ye([])),r=new At(t,e),s=new At(t,e+1),i=[];return this.Ur.forEachInRange([r,s],(o=>{this.Gr(o),i.push(o.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new ae(new Ye([])),r=new At(t,e),s=new At(t,e+1);let i=Pe();return this.Ur.forEachInRange([r,s],(o=>{i=i.add(o.key)})),i}containsKey(e){const t=new At(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class At{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return ae.comparator(e.key,t.key)||Me(e.Yr,t.Yr)}static Kr(e,t){return Me(e.Yr,t.Yr)||ae.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nD{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Tt(At.$r)}checkEmpty(e){return z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new yO(i,t,r,s);this.mutationQueue.push(o);for(const a of s)this.Zr=this.Zr.add(new At(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return z.resolve(o)}lookupMutationBatch(e,t){return z.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.ei(r),i=s<0?0:s;return z.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return z.resolve(this.mutationQueue.length===0?og:this.tr-1)}getAllMutationBatches(e){return z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new At(t,0),s=new At(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],(o=>{const a=this.Xr(o.Yr);i.push(a)})),z.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Tt(Me);return t.forEach((s=>{const i=new At(s,0),o=new At(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],(a=>{r=r.add(a.Yr)}))})),z.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;ae.isDocumentKey(i)||(i=i.child(""));const o=new At(new ae(i),0);let a=new Tt(Me);return this.Zr.forEachWhile((l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.Yr)),!0)}),o),z.resolve(this.ti(a))}ti(e){const t=[];return e.forEach((r=>{const s=this.Xr(r);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){Ue(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return z.forEach(t.mutations,(s=>{const i=new At(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new At(t,0),s=this.Zr.firstAfterOrEqual(r);return z.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,z.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rD{constructor(e){this.ri=e,this.docs=(function(){return new at(ae.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,o=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return z.resolve(r?r.document.mutableCopy():Zt.newInvalidDocument(t))}getEntries(e,t){let r=ts();return t.forEach((s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Zt.newInvalidDocument(s))})),z.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=ts();const o=t.path,a=new ae(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||N2(P2(u),r)<=0||(s.has(u.key)||dd(t,u))&&(i=i.insert(u.key,u.mutableCopy()))}return z.resolve(i)}getAllFromCollectionGroup(e,t,r,s){ge(9500)}ii(e,t){return z.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new sD(this)}getSize(e){return z.resolve(this.size)}}class sD extends QO{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)})),z.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iD{constructor(e){this.persistence=e,this.si=new no((t=>cg(t)),ug),this.lastRemoteSnapshotVersion=ve.min(),this.highestTargetId=0,this.oi=0,this._i=new mg,this.targetCount=0,this.ai=qo.ur()}forEachTarget(e,t){return this.si.forEach(((r,s)=>t(s))),z.resolve()}getLastRemoteSnapshotVersion(e){return z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return z.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),z.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),z.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new qo(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,z.resolve()}updateTargetData(e,t){return this.Pr(t),z.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,z.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.si.forEach(((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)})),z.waitFor(i).next((()=>s))}getTargetCount(e){return z.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return z.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),z.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach((o=>{i.push(s.markPotentiallyOrphaned(e,o))})),z.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),z.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return z.resolve(r)}containsKey(e,t){return z.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BT{constructor(e,t){this.ui={},this.overlays={},this.ci=new ad(0),this.li=!1,this.li=!0,this.hi=new tD,this.referenceDelegate=e(this),this.Pi=new iD(this),this.indexManager=new HO,this.remoteDocumentCache=(function(s){return new rD(s)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new UO(t),this.Ii=new ZO(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new eD,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new nD(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){se("MemoryPersistence","Starting transaction:",e);const s=new oD(this.ci.next());return this.referenceDelegate.Ei(),r(s).next((i=>this.referenceDelegate.di(s).next((()=>i)))).toPromise().then((i=>(s.raiseOnCommittedEvent(),i)))}Ai(e,t){return z.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class oD extends D2{constructor(e){super(),this.currentSequenceNumber=e}}class gg{constructor(e){this.persistence=e,this.Ri=new mg,this.Vi=null}static mi(e){return new gg(e)}get fi(){if(this.Vi)return this.Vi;throw ge(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),z.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),z.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),z.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((s=>this.fi.add(s.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((i=>this.fi.add(i.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return z.forEach(this.fi,(r=>{const s=ae.fromPath(r);return this.gi(e,s).next((i=>{i||t.removeEntry(s,ve.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return z.or([()=>z.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Du{constructor(e,t){this.persistence=e,this.pi=new no((r=>F2(r.path)),((r,s)=>r.isEqual(s))),this.garbageCollector=JO(this,t)}static mi(e,t){return new Du(e,t)}Ei(){}di(e){return z.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((s=>r+s))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return z.forEach(this.pi,((r,s)=>this.br(e,r,s).next((i=>i?z.resolve():t(s)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,(o=>this.br(e,o,t).next((a=>{a||(r++,i.removeEntry(o,ve.min()))})))).next((()=>i.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),z.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),z.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),z.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),z.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=nu(e.data.value)),t}br(e,t,r){return z.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return z.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yg{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=s}static As(e,t){let r=Pe(),s=Pe();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new yg(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lD{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return nN()?8:L2(tn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.ys(e,t).next((o=>{i.result=o})).next((()=>{if(!i.result)return this.ws(e,t,s,r).next((o=>{i.result=o}))})).next((()=>{if(i.result)return;const o=new aD;return this.Ss(e,t,o).next((a=>{if(i.result=a,this.Vs)return this.bs(e,t,o,a.size)}))})).next((()=>i.result))}bs(e,t,r,s){return r.documentReadCount<this.fs?(vo()<=xe.DEBUG&&se("QueryEngine","SDK will not create cache indexes for query:",wo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),z.resolve()):(vo()<=xe.DEBUG&&se("QueryEngine","Query:",wo(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(vo()<=xe.DEBUG&&se("QueryEngine","The SDK decides to create cache indexes for query:",wo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,pr(t))):z.resolve())}ys(e,t){if(ov(t))return z.resolve(null);let r=pr(t);return this.indexManager.getIndexType(e,r).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=Dp(t,null,"F"),r=pr(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((i=>{const o=Pe(...i);return this.ps.getDocuments(e,o).next((a=>this.indexManager.getMinOffset(e,r).next((l=>{const c=this.Ds(t,a);return this.Cs(t,c,o,l.readTime)?this.ys(e,Dp(t,null,"F")):this.vs(e,c,t,l)}))))})))))}ws(e,t,r,s){return ov(t)||s.isEqual(ve.min())?z.resolve(null):this.ps.getDocuments(e,r).next((i=>{const o=this.Ds(t,i);return this.Cs(t,o,r,s)?z.resolve(null):(vo()<=xe.DEBUG&&se("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),wo(t)),this.vs(e,o,t,M2(s,Al)).next((a=>a)))}))}Ds(e,t){let r=new Tt(pT(e));return t.forEach(((s,i)=>{dd(e,i)&&(r=r.add(i))})),r}Cs(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,t,r){return vo()<=xe.DEBUG&&se("QueryEngine","Using full collection scan to execute query:",wo(t)),this.ps.getDocumentsMatchingQuery(e,t,Zs.min(),r)}vs(e,t,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next((i=>(t.forEach((o=>{i=i.insert(o.key,o)})),i)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _g="LocalStore",cD=3e8;class uD{constructor(e,t,r,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new at(Me),this.xs=new no((i=>cg(i)),ug),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new XO(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function hD(n,e,t,r){return new uD(n,e,t,r)}async function $T(n,e){const t=Ee(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next((i=>(s=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((i=>{const o=[],a=[];let l=Pe();for(const c of s){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of i){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return t.localDocuments.getDocuments(r,l).next((c=>({Ls:c,removedBatchIds:o,addedBatchIds:a})))}))}))}function dD(n,e){const t=Ee(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const s=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(a,l,c,u){const h=c.batch,f=h.keys();let p=z.resolve();return f.forEach((m=>{p=p.next((()=>u.getEntry(l,m))).next((y=>{const v=c.docVersions.get(m);Ue(v!==null,48541),y.version.compareTo(v)<0&&(h.applyToRemoteDocument(y,c),y.isValidDocument()&&(y.setReadTime(c.commitVersion),u.addEntry(y)))}))})),p.next((()=>a.mutationQueue.removeMutationBatch(l,h)))})(t,r,e,i).next((()=>i.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(a){let l=Pe();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l})(e)))).next((()=>t.localDocuments.getDocuments(r,s)))}))}function UT(n){const e=Ee(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function fD(n,e){const t=Ee(n),r=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const a=[];e.targetChanges.forEach(((u,h)=>{const f=s.get(h);if(!f)return;a.push(t.Pi.removeMatchingKeys(i,u.removedDocuments,h).next((()=>t.Pi.addMatchingKeys(i,u.addedDocuments,h))));let p=f.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?p=p.withResumeToken(Ut.EMPTY_BYTE_STRING,ve.min()).withLastLimboFreeSnapshotVersion(ve.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,r)),s=s.insert(h,p),(function(y,v,T){return y.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-y.snapshotVersion.toMicroseconds()>=cD?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0})(f,p,u)&&a.push(t.Pi.updateTargetData(i,p))}));let l=ts(),c=Pe();if(e.documentUpdates.forEach((u=>{e.resolvedLimboDocuments.has(u)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(i,u))})),a.push(pD(i,o,e.documentUpdates).next((u=>{l=u.ks,c=u.qs}))),!r.isEqual(ve.min())){const u=t.Pi.getLastRemoteSnapshotVersion(i).next((h=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r)));a.push(u)}return z.waitFor(a).next((()=>o.apply(i))).next((()=>t.localDocuments.getLocalViewOfDocuments(i,l,c))).next((()=>l))})).then((i=>(t.Ms=s,i)))}function pD(n,e,t){let r=Pe(),s=Pe();return t.forEach((i=>r=r.add(i))),e.getEntries(n,r).next((i=>{let o=ts();return t.forEach(((a,l)=>{const c=i.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(ve.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):se(_g,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)})),{ks:o,qs:s}}))}function mD(n,e){const t=Ee(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=og),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function gD(n,e){const t=Ee(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let s;return t.Pi.getTargetData(r,e).next((i=>i?(s=i,z.resolve(s)):t.Pi.allocateTargetId(r).next((o=>(s=new Os(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,s).next((()=>s)))))))})).then((r=>{const s=t.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function $p(n,e,t){const r=Ee(n),s=r.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,(o=>r.persistence.referenceDelegate.removeTarget(o,s)))}catch(o){if(!sa(o))throw o;se(_g,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function vv(n,e,t){const r=Ee(n);let s=ve.min(),i=Pe();return r.persistence.runTransaction("Execute query","readwrite",(o=>(function(l,c,u){const h=Ee(l),f=h.xs.get(u);return f!==void 0?z.resolve(h.Ms.get(f)):h.Pi.getTargetData(c,u)})(r,o,pr(e)).next((a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next((l=>{i=l}))})).next((()=>r.Fs.getDocumentsMatchingQuery(o,e,t?s:ve.min(),t?i:Pe()))).next((a=>(yD(r,rO(e),a),{documents:a,Qs:i})))))}function yD(n,e,t){let r=n.Os.get(e)||ve.min();t.forEach(((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)})),n.Os.set(e,r)}class wv{constructor(){this.activeTargetIds=cO()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class _D{constructor(){this.Mo=new wv,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new wv,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vD{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bv="ConnectivityMonitor";class Ev{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){se(bv,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){se(bv,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pc=null;function Up(){return Pc===null?Pc=(function(){return 268435456+Math.round(2147483648*Math.random())})():Pc++,"0x"+Pc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const If="RestConnection",wD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class bD{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Mu?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,t,r,s,i){const o=Up(),a=this.zo(e,t.toUriEncodedString());se(If,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,i);const{host:c}=new URL(a),u=eo(c);return this.Jo(e,a,l,r,u).then((h=>(se(If,`Received RPC '${e}' ${o}: `,h),h)),(h=>{throw zo(If,`RPC '${e}' ${o} failed with error: `,h,"url: ",a,"request:",r),h}))}Ho(e,t,r,s,i,o){return this.Go(e,t,r,s,i)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+na})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,i)=>e[i]=s)),r&&r.headers.forEach(((s,i)=>e[i]=s))}zo(e,t){const r=wD[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ED{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kt="WebChannelConnection";class TD extends bD{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,s,i){const o=Up();return new Promise(((a,l)=>{const c=new UE;c.setWithCredentials(!0),c.listenOnce(zE.COMPLETE,(()=>{try{switch(c.getLastErrorCode()){case tu.NO_ERROR:const h=c.getResponseJson();se(Kt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(h)),a(h);break;case tu.TIMEOUT:se(Kt,`RPC '${e}' ${o} timed out`),l(new ne(B.DEADLINE_EXCEEDED,"Request time out"));break;case tu.HTTP_ERROR:const f=c.getStatus();if(se(Kt,`RPC '${e}' ${o} failed with status:`,f,"response text:",c.getResponseText()),f>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);const m=p?.error;if(m&&m.status&&m.message){const y=(function(T){const M=T.toLowerCase().replace(/_/g,"-");return Object.values(B).indexOf(M)>=0?M:B.UNKNOWN})(m.status);l(new ne(y,m.message))}else l(new ne(B.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new ne(B.UNAVAILABLE,"Connection failed."));break;default:ge(9055,{l_:e,streamId:o,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{se(Kt,`RPC '${e}' ${o} completed.`)}}));const u=JSON.stringify(s);se(Kt,`RPC '${e}' ${o} sending request:`,s),c.send(t,"POST",u,r,15)}))}T_(e,t,r){const s=Up(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=WE(),a=jE(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const u=i.join("");se(Kt,`Creating RPC '${e}' stream ${s}: ${u}`,l);const h=o.createWebChannel(u,l);this.I_(h);let f=!1,p=!1;const m=new ED({Yo:v=>{p?se(Kt,`Not sending because RPC '${e}' stream ${s} is closed:`,v):(f||(se(Kt,`Opening RPC '${e}' stream ${s} transport.`),h.open(),f=!0),se(Kt,`RPC '${e}' stream ${s} sending:`,v),h.send(v))},Zo:()=>h.close()}),y=(v,T,M)=>{v.listen(T,(P=>{try{M(P)}catch(D){setTimeout((()=>{throw D}),0)}}))};return y(h,Da.EventType.OPEN,(()=>{p||(se(Kt,`RPC '${e}' stream ${s} transport opened.`),m.o_())})),y(h,Da.EventType.CLOSE,(()=>{p||(p=!0,se(Kt,`RPC '${e}' stream ${s} transport closed`),m.a_(),this.E_(h))})),y(h,Da.EventType.ERROR,(v=>{p||(p=!0,zo(Kt,`RPC '${e}' stream ${s} transport errored. Name:`,v.name,"Message:",v.message),m.a_(new ne(B.UNAVAILABLE,"The operation could not be completed")))})),y(h,Da.EventType.MESSAGE,(v=>{if(!p){const T=v.data[0];Ue(!!T,16349);const M=T,P=M?.error||M[0]?.error;if(P){se(Kt,`RPC '${e}' stream ${s} received error:`,P);const D=P.status;let L=(function(w){const b=gt[w];if(b!==void 0)return kT(b)})(D),q=P.message;L===void 0&&(L=B.INTERNAL,q="Unknown error status: "+D+" with message "+P.message),p=!0,m.a_(new ne(L,q)),h.close()}else se(Kt,`RPC '${e}' stream ${s} received:`,T),m.u_(T)}})),y(a,HE.STAT_EVENT,(v=>{v.stat===kp.PROXY?se(Kt,`RPC '${e}' stream ${s} detected buffering proxy`):v.stat===kp.NOPROXY&&se(Kt,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{m.__()}),0),m}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function kf(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gd(n){return new IO(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zT{constructor(e,t,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-r);s>0&&se("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tv="PersistentStream";class HT{constructor(e,t,r,s,i,o,a,l){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new zT(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===B.RESOURCE_EXHAUSTED?(es(t.toString()),es("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===B.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,s])=>{this.D_===t&&this.G_(r,s)}),(r=>{e((()=>{const s=new ne(B.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{r((()=>this.z_(s)))})),this.stream.onMessage((s=>{r((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return se(Tv,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(se(Tv,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class SD extends HT{constructor(e,t,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=xO(this.serializer,e),r=(function(i){if(!("targetChange"in i))return ve.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ve.min():o.readTime?gr(o.readTime):ve.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=Bp(this.serializer),t.addTarget=(function(i,o){let a;const l=o.target;if(a=Np(l)?{documents:NO(i,l)}:{query:OO(i,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=MT(i,o.resumeToken);const c=Lp(i,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(ve.min())>0){a.readTime=Ou(i,o.snapshotVersion.toTimestamp());const c=Lp(i,o.expectedCount);c!==null&&(a.expectedCount=c)}return a})(this.serializer,e);const r=LO(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=Bp(this.serializer),t.removeTarget=e,this.q_(t)}}class CD extends HT{constructor(e,t,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Ue(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ue(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ue(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=PO(e.writeResults,e.commitTime),r=gr(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Bp(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>MO(this.serializer,r)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AD{}class ID extends AD{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new ne(B.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,o])=>this.connection.Go(e,Vp(t,r),s,i,o))).catch((i=>{throw i.name==="FirebaseError"?(i.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new ne(B.UNKNOWN,i.toString())}))}Ho(e,t,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,a])=>this.connection.Ho(e,Vp(t,r),s,o,a,i))).catch((o=>{throw o.name==="FirebaseError"?(o.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ne(B.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class kD{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(es(t),this.aa=!1):se("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wi="RemoteStore";class RD{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((o=>{r.enqueueAndForget((async()=>{ro(this)&&(se(Wi,"Restarting streams for network reachability change."),await(async function(l){const c=Ee(l);c.Ea.add(4),await nc(c),c.Ra.set("Unknown"),c.Ea.delete(4),await yd(c)})(this))}))})),this.Ra=new kD(r,s)}}async function yd(n){if(ro(n))for(const e of n.da)await e(!0)}async function nc(n){for(const e of n.da)await e(!1)}function jT(n,e){const t=Ee(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Eg(t)?bg(t):oa(t).O_()&&wg(t,e))}function vg(n,e){const t=Ee(n),r=oa(t);t.Ia.delete(e),r.O_()&&WT(t,e),t.Ia.size===0&&(r.O_()?r.L_():ro(t)&&t.Ra.set("Unknown"))}function wg(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ve.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}oa(n).Y_(e)}function WT(n,e){n.Va.Ue(e),oa(n).Z_(e)}function bg(n){n.Va=new TO({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),oa(n).start(),n.Ra.ua()}function Eg(n){return ro(n)&&!oa(n).x_()&&n.Ia.size>0}function ro(n){return Ee(n).Ea.size===0}function qT(n){n.Va=void 0}async function xD(n){n.Ra.set("Online")}async function MD(n){n.Ia.forEach(((e,t)=>{wg(n,e)}))}async function PD(n,e){qT(n),Eg(n)?(n.Ra.ha(e),bg(n)):n.Ra.set("Unknown")}async function ND(n,e,t){if(n.Ra.set("Online"),e instanceof xT&&e.state===2&&e.cause)try{await(async function(s,i){const o=i.cause;for(const a of i.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.Va.removeTarget(a))})(n,e)}catch(r){se(Wi,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Lu(n,r)}else if(e instanceof iu?n.Va.Ze(e):e instanceof RT?n.Va.st(e):n.Va.tt(e),!t.isEqual(ve.min()))try{const r=await UT(n.localStore);t.compareTo(r)>=0&&await(function(i,o){const a=i.Va.Tt(o);return a.targetChanges.forEach(((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=i.Ia.get(c);u&&i.Ia.set(c,u.withResumeToken(l.resumeToken,o))}})),a.targetMismatches.forEach(((l,c)=>{const u=i.Ia.get(l);if(!u)return;i.Ia.set(l,u.withResumeToken(Ut.EMPTY_BYTE_STRING,u.snapshotVersion)),WT(i,l);const h=new Os(u.target,l,c,u.sequenceNumber);wg(i,h)})),i.remoteSyncer.applyRemoteEvent(a)})(n,t)}catch(r){se(Wi,"Failed to raise snapshot:",r),await Lu(n,r)}}async function Lu(n,e,t){if(!sa(e))throw e;n.Ea.add(1),await nc(n),n.Ra.set("Offline"),t||(t=()=>UT(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{se(Wi,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await yd(n)}))}function KT(n,e){return e().catch((t=>Lu(n,t,e)))}async function _d(n){const e=Ee(n),t=ri(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:og;for(;OD(e);)try{const s=await mD(e.localStore,r);if(s===null){e.Ta.length===0&&t.L_();break}r=s.batchId,DD(e,s)}catch(s){await Lu(e,s)}GT(e)&&JT(e)}function OD(n){return ro(n)&&n.Ta.length<10}function DD(n,e){n.Ta.push(e);const t=ri(n);t.O_()&&t.X_&&t.ea(e.mutations)}function GT(n){return ro(n)&&!ri(n).x_()&&n.Ta.length>0}function JT(n){ri(n).start()}async function LD(n){ri(n).ra()}async function VD(n){const e=ri(n);for(const t of n.Ta)e.ea(t.mutations)}async function FD(n,e,t){const r=n.Ta.shift(),s=dg.from(r,e,t);await KT(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await _d(n)}async function BD(n,e){e&&ri(n).X_&&await(async function(r,s){if((function(o){return wO(o)&&o!==B.ABORTED})(s.code)){const i=r.Ta.shift();ri(r).B_(),await KT(r,(()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s))),await _d(r)}})(n,e),GT(n)&&JT(n)}async function Sv(n,e){const t=Ee(n);t.asyncQueue.verifyOperationInProgress(),se(Wi,"RemoteStore received new credentials");const r=ro(t);t.Ea.add(3),await nc(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await yd(t)}async function $D(n,e){const t=Ee(n);e?(t.Ea.delete(2),await yd(t)):e||(t.Ea.add(2),await nc(t),t.Ra.set("Unknown"))}function oa(n){return n.ma||(n.ma=(function(t,r,s){const i=Ee(t);return i.sa(),new SD(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(n.datastore,n.asyncQueue,{Xo:xD.bind(null,n),t_:MD.bind(null,n),r_:PD.bind(null,n),H_:ND.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),Eg(n)?bg(n):n.Ra.set("Unknown")):(await n.ma.stop(),qT(n))}))),n.ma}function ri(n){return n.fa||(n.fa=(function(t,r,s){const i=Ee(t);return i.sa(),new CD(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:LD.bind(null,n),r_:BD.bind(null,n),ta:VD.bind(null,n),na:FD.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await _d(n)):(await n.fa.stop(),n.Ta.length>0&&(se(Wi,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tg{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Hs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const o=Date.now()+r,a=new Tg(e,t,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ne(B.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Sg(n,e){if(es("AsyncQueue",`${e}: ${n}`),sa(n))return new ne(B.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No{static emptySet(e){return new No(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||ae.comparator(t.key,r.key):(t,r)=>ae.comparator(t.key,r.key),this.keyedMap=La(),this.sortedSet=new at(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof No)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new No;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cv{constructor(){this.ga=new at(ae.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):ge(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class Ko{constructor(e,t,r,s,i,o,a,l,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,s,i){const o=[];return t.forEach((a=>{o.push({type:0,doc:a})})),new Ko(e,t,No.emptySet(t),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&hd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UD{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class zD{constructor(){this.queries=Av(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const s=Ee(t),i=s.queries;s.queries=Av(),i.forEach(((o,a)=>{for(const l of a.Sa)l.onError(r)}))})(this,new ne(B.ABORTED,"Firestore shutting down"))}}function Av(){return new no((n=>fT(n)),hd)}async function QT(n,e){const t=Ee(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new UD,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await t.onListen(s,!0);break;case 1:i.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(o){const a=Sg(o,`Initialization of query '${wo(e.query)}' failed`);return void e.onError(a)}t.queries.set(s,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&Cg(t)}async function YT(n,e){const t=Ee(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function HD(n,e){const t=Ee(n);let r=!1;for(const s of e){const i=s.query,o=t.queries.get(i);if(o){for(const a of o.Sa)a.Fa(s)&&(r=!0);o.wa=s}}r&&Cg(t)}function jD(n,e,t){const r=Ee(n),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(t);r.queries.delete(e)}function Cg(n){n.Ca.forEach((e=>{e.next()}))}var zp,Iv;(Iv=zp||(zp={})).Ma="default",Iv.Cache="cache";class XT{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Ko(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Ko.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==zp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZT{constructor(e){this.key=e}}class eS{constructor(e){this.key=e}}class WD{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Pe(),this.mutatedKeys=Pe(),this.eu=pT(e),this.tu=new No(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new Cv,s=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((u,h)=>{const f=s.get(u),p=dd(this.query,h)?h:null,m=!!f&&this.mutatedKeys.has(f.key),y=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let v=!1;f&&p?f.data.isEqual(p.data)?m!==y&&(r.track({type:3,doc:p}),v=!0):this.su(f,p)||(r.track({type:2,doc:p}),v=!0,(l&&this.eu(p,l)>0||c&&this.eu(p,c)<0)&&(a=!0)):!f&&p?(r.track({type:0,doc:p}),v=!0):f&&!p&&(r.track({type:1,doc:f}),v=!0,(l||c)&&(a=!0)),v&&(p?(o=o.add(p),i=y?i.add(u):i.delete(u)):(o=o.delete(u),i=i.delete(u)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),i=i.delete(u.key),r.track({type:1,doc:u})}return{tu:o,iu:r,Cs:a,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((u,h)=>(function(p,m){const y=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ge(20277,{Rt:v})}};return y(p)-y(m)})(u.type,h.type)||this.eu(u.doc,h.doc))),this.ou(r),s=s??!1;const a=t&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,c=l!==this.Za;return this.Za=l,o.length!==0||c?{snapshot:new Ko(this.query,e.tu,i,o,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Cv,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Pe(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new eS(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new ZT(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=Pe();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Ko.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Ag="SyncEngine";class qD{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class KD{constructor(e){this.key=e,this.hu=!1}}class GD{constructor(e,t,r,s,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new no((a=>fT(a)),hd),this.Iu=new Map,this.Eu=new Set,this.du=new at(ae.comparator),this.Au=new Map,this.Ru=new mg,this.Vu={},this.mu=new Map,this.fu=qo.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function JD(n,e,t=!0){const r=oS(n);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await tS(r,e,t,!0),s}async function QD(n,e){const t=oS(n);await tS(t,e,!0,!1)}async function tS(n,e,t,r){const s=await gD(n.localStore,pr(e)),i=s.targetId,o=n.sharedClientState.addLocalQueryTarget(i,t);let a;return r&&(a=await YD(n,e,i,o==="current",s.resumeToken)),n.isPrimaryClient&&t&&jT(n.remoteStore,s),a}async function YD(n,e,t,r,s){n.pu=(h,f,p)=>(async function(y,v,T,M){let P=v.view.ru(T);P.Cs&&(P=await vv(y.localStore,v.query,!1).then((({documents:S})=>v.view.ru(S,P))));const D=M&&M.targetChanges.get(v.targetId),L=M&&M.targetMismatches.get(v.targetId)!=null,q=v.view.applyChanges(P,y.isPrimaryClient,D,L);return Rv(y,v.targetId,q.au),q.snapshot})(n,h,f,p);const i=await vv(n.localStore,e,!0),o=new WD(e,i.Qs),a=o.ru(i.documents),l=tc.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),c=o.applyChanges(a,n.isPrimaryClient,l);Rv(n,t,c.au);const u=new qD(e,t,o);return n.Tu.set(e,u),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),c.snapshot}async function XD(n,e,t){const r=Ee(n),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter((o=>!hd(o,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await $p(r.localStore,s.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(s.targetId),t&&vg(r.remoteStore,s.targetId),Hp(r,s.targetId)})).catch(ra)):(Hp(r,s.targetId),await $p(r.localStore,s.targetId,!0))}async function ZD(n,e){const t=Ee(n),r=t.Tu.get(e),s=t.Iu.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),vg(t.remoteStore,r.targetId))}async function eL(n,e,t){const r=aL(n);try{const s=await(function(o,a){const l=Ee(o),c=nt.now(),u=a.reduce(((p,m)=>p.add(m.key)),Pe());let h,f;return l.persistence.runTransaction("Locally write mutations","readwrite",(p=>{let m=ts(),y=Pe();return l.Ns.getEntries(p,u).next((v=>{m=v,m.forEach(((T,M)=>{M.isValidDocument()||(y=y.add(T))}))})).next((()=>l.localDocuments.getOverlayedDocuments(p,m))).next((v=>{h=v;const T=[];for(const M of a){const P=mO(M,h.get(M.key).overlayedDocument);P!=null&&T.push(new ui(M.key,P,iT(P.value.mapValue),mr.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,T,a)})).next((v=>{f=v;const T=v.applyToLocalDocumentSet(h,y);return l.documentOverlayCache.saveOverlays(p,v.batchId,T)}))})).then((()=>({batchId:f.batchId,changes:gT(h)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),(function(o,a,l){let c=o.Vu[o.currentUser.toKey()];c||(c=new at(Me)),c=c.insert(a,l),o.Vu[o.currentUser.toKey()]=c})(r,s.batchId,t),await rc(r,s.changes),await _d(r.remoteStore)}catch(s){const i=Sg(s,"Failed to persist write");t.reject(i)}}async function nS(n,e){const t=Ee(n);try{const r=await fD(t.localStore,e);e.targetChanges.forEach(((s,i)=>{const o=t.Au.get(i);o&&(Ue(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?Ue(o.hu,14607):s.removedDocuments.size>0&&(Ue(o.hu,42227),o.hu=!1))})),await rc(t,r,e)}catch(r){await ra(r)}}function kv(n,e,t){const r=Ee(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Tu.forEach(((i,o)=>{const a=o.view.va(e);a.snapshot&&s.push(a.snapshot)})),(function(o,a){const l=Ee(o);l.onlineState=a;let c=!1;l.queries.forEach(((u,h)=>{for(const f of h.Sa)f.va(a)&&(c=!0)})),c&&Cg(l)})(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function tL(n,e,t){const r=Ee(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new at(ae.comparator);o=o.insert(i,Zt.newNoDocument(i,ve.min()));const a=Pe().add(i),l=new md(ve.min(),new Map,new at(Me),o,a);await nS(r,l),r.du=r.du.remove(i),r.Au.delete(e),Ig(r)}else await $p(r.localStore,e,!1).then((()=>Hp(r,e,t))).catch(ra)}async function nL(n,e){const t=Ee(n),r=e.batch.batchId;try{const s=await dD(t.localStore,e);sS(t,r,null),rS(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await rc(t,s)}catch(s){await ra(s)}}async function rL(n,e,t){const r=Ee(n);try{const s=await(function(o,a){const l=Ee(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",(c=>{let u;return l.mutationQueue.lookupMutationBatch(c,a).next((h=>(Ue(h!==null,37113),u=h.keys(),l.mutationQueue.removeMutationBatch(c,h)))).next((()=>l.mutationQueue.performConsistencyCheck(c))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,a))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u))).next((()=>l.localDocuments.getDocuments(c,u)))}))})(r.localStore,e);sS(r,e,t),rS(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await rc(r,s)}catch(s){await ra(s)}}function rS(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function sS(n,e,t){const r=Ee(n);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function Hp(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||iS(n,r)}))}function iS(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(vg(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),Ig(n))}function Rv(n,e,t){for(const r of t)r instanceof ZT?(n.Ru.addReference(r.key,e),sL(n,r)):r instanceof eS?(se(Ag,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||iS(n,r.key)):ge(19791,{wu:r})}function sL(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(se(Ag,"New document in limbo: "+t),n.Eu.add(r),Ig(n))}function Ig(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new ae(Ye.fromString(e)),r=n.fu.next();n.Au.set(r,new KD(t)),n.du=n.du.insert(t,r),jT(n.remoteStore,new Os(pr(ud(t.path)),r,"TargetPurposeLimboResolution",ad.ce))}}async function rc(n,e,t){const r=Ee(n),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach(((a,l)=>{o.push(r.pu(l,e,t).then((c=>{if((c||t)&&r.isPrimaryClient){const u=c?!c.fromCache:t?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,u?"current":"not-current")}if(c){s.push(c);const u=yg.As(l.targetId,c);i.push(u)}})))})),await Promise.all(o),r.Pu.H_(s),await(async function(l,c){const u=Ee(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",(h=>z.forEach(c,(f=>z.forEach(f.Es,(p=>u.persistence.referenceDelegate.addReference(h,f.targetId,p))).next((()=>z.forEach(f.ds,(p=>u.persistence.referenceDelegate.removeReference(h,f.targetId,p)))))))))}catch(h){if(!sa(h))throw h;se(_g,"Failed to update sequence numbers: "+h)}for(const h of c){const f=h.targetId;if(!h.fromCache){const p=u.Ms.get(f),m=p.snapshotVersion,y=p.withLastLimboFreeSnapshotVersion(m);u.Ms=u.Ms.insert(f,y)}}})(r.localStore,i))}async function iL(n,e){const t=Ee(n);if(!t.currentUser.isEqual(e)){se(Ag,"User change. New user:",e.toKey());const r=await $T(t.localStore,e);t.currentUser=e,(function(i,o){i.mu.forEach((a=>{a.forEach((l=>{l.reject(new ne(B.CANCELLED,o))}))})),i.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await rc(t,r.Ls)}}function oL(n,e){const t=Ee(n),r=t.Au.get(e);if(r&&r.hu)return Pe().add(r.key);{let s=Pe();const i=t.Iu.get(e);if(!i)return s;for(const o of i){const a=t.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}function oS(n){const e=Ee(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=nS.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=oL.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=tL.bind(null,e),e.Pu.H_=HD.bind(null,e.eventManager),e.Pu.yu=jD.bind(null,e.eventManager),e}function aL(n){const e=Ee(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=nL.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=rL.bind(null,e),e}class Vu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=gd(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return hD(this.persistence,new lD,e.initialUser,this.serializer)}Cu(e){return new BT(gg.mi,this.serializer)}Du(e){return new _D}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Vu.provider={build:()=>new Vu};class lL extends Vu{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ue(this.persistence.referenceDelegate instanceof Du,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new KO(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?pn.withCacheSize(this.cacheSizeBytes):pn.DEFAULT;return new BT((r=>Du.mi(r,t)),this.serializer)}}class jp{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>kv(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=iL.bind(null,this.syncEngine),await $D(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new zD})()}createDatastore(e){const t=gd(e.databaseInfo.databaseId),r=(function(i){return new TD(i)})(e.databaseInfo);return(function(i,o,a,l){return new ID(i,o,a,l)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,s,i,o,a){return new RD(r,s,i,o,a)})(this.localStore,this.datastore,e.asyncQueue,(t=>kv(this.syncEngine,t,0)),(function(){return Ev.v()?new Ev:new vD})())}createSyncEngine(e,t){return(function(s,i,o,a,l,c,u){const h=new GD(s,i,o,a,l,c);return u&&(h.gu=!0),h})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=Ee(t);se(Wi,"RemoteStore shutting down."),r.Ea.add(5),await nc(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}jp.provider={build:()=>new jp};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aS{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):es("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const si="FirestoreClient";class cL{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=Qt.UNAUTHENTICATED,this.clientId=ig.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,(async o=>{se(si,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,(o=>(se(si,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Hs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Sg(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Rf(n,e){n.asyncQueue.verifyOperationInProgress(),se(si,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async s=>{r.isEqual(s)||(await $T(e.localStore,s),r=s)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function xv(n,e){n.asyncQueue.verifyOperationInProgress();const t=await uL(n);se(si,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>Sv(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,s)=>Sv(e.remoteStore,s))),n._onlineComponents=e}async function uL(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){se(si,"Using user provided OfflineComponentProvider");try{await Rf(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===B.FAILED_PRECONDITION||s.code===B.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;zo("Error using user provided cache. Falling back to memory cache: "+t),await Rf(n,new Vu)}}else se(si,"Using default OfflineComponentProvider"),await Rf(n,new lL(void 0));return n._offlineComponents}async function lS(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(se(si,"Using user provided OnlineComponentProvider"),await xv(n,n._uninitializedComponentsProvider._online)):(se(si,"Using default OnlineComponentProvider"),await xv(n,new jp))),n._onlineComponents}function hL(n){return lS(n).then((e=>e.syncEngine))}async function Wp(n){const e=await lS(n),t=e.eventManager;return t.onListen=JD.bind(null,e.syncEngine),t.onUnlisten=XD.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=QD.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=ZD.bind(null,e.syncEngine),t}function dL(n,e,t={}){const r=new Hs;return n.asyncQueue.enqueueAndForget((async()=>(function(i,o,a,l,c){const u=new aS({next:f=>{u.Nu(),o.enqueueAndForget((()=>YT(i,h)));const p=f.docs.has(a);!p&&f.fromCache?c.reject(new ne(B.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&f.fromCache&&l&&l.source==="server"?c.reject(new ne(B.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new XT(ud(a.path),u,{includeMetadataChanges:!0,qa:!0});return QT(i,h)})(await Wp(n),n.asyncQueue,e,t,r))),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cS(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mv=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uS="firestore.googleapis.com",Pv=!0;class Nv{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ne(B.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=uS,this.ssl=Pv}else this.host=e.host,this.ssl=e.ssl??Pv;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=FT;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<WO)throw new ne(B.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}x2("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=cS(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new ne(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new ne(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new ne(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,s){return r.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class vd{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Nv({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ne(B.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ne(B.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Nv(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new w2;switch(r.type){case"firstParty":return new S2(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ne(B.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=Mv.get(t);r&&(se("ComponentProvider","Removing Datastore"),Mv.delete(t),r.terminate())})(this),Promise.resolve()}}function fL(n,e,t,r={}){n=Gr(n,vd);const s=eo(e),i=n._getSettings(),o={...i,emulatorOptions:n._getEmulatorOptions()},a=`${e}:${t}`;s&&(Zm(`https://${a}`),eg("Firestore",!0)),i.host!==uS&&i.host!==a&&zo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:a,ssl:s,emulatorOptions:r};if(!zi(l,o)&&(n._setSettings(l),r.mockUserToken)){let c,u;if(typeof r.mockUserToken=="string")c=r.mockUserToken,u=Qt.MOCK_USER;else{c=OE(r.mockUserToken,n._app?.options.projectId);const h=r.mockUserToken.sub||r.mockUserToken.user_id;if(!h)throw new ne(B.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Qt(h)}n._authCredentials=new b2(new KE(c,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new so(this.firestore,e,this._query)}}class pt{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new js(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new pt(this.firestore,e,this._key)}toJSON(){return{type:pt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Zl(t,pt._jsonSchema))return new pt(e,r||null,new ae(Ye.fromString(t.referencePath)))}}pt._jsonSchemaVersion="firestore/documentReference/1.0",pt._jsonSchema={type:_t("string",pt._jsonSchemaVersion),referencePath:_t("string")};class js extends so{constructor(e,t,r){super(e,t,ud(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new pt(this.firestore,null,new ae(e))}withConverter(e){return new js(this.firestore,e,this._path)}}function hS(n,e,...t){if(n=wt(n),GE("collection","path",e),n instanceof vd){const r=Ye.fromString(e,...t);return q_(r),new js(n,null,r)}{if(!(n instanceof pt||n instanceof js))throw new ne(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ye.fromString(e,...t));return q_(r),new js(n.firestore,null,r)}}function kg(n,e,...t){if(n=wt(n),arguments.length===1&&(e=ig.newId()),GE("doc","path",e),n instanceof vd){const r=Ye.fromString(e,...t);return W_(r),new pt(n,null,new ae(r))}{if(!(n instanceof pt||n instanceof js))throw new ne(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ye.fromString(e,...t));return W_(r),new pt(n.firestore,n instanceof js?n.converter:null,new ae(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ov="AsyncQueue";class Dv{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new zT(this,"async_queue_retry"),this._c=()=>{const r=kf();r&&se(Ov,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=kf();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=kf();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Hs;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!sa(e))throw e;se(Ov,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,es("INTERNAL UNHANDLED ERROR: ",Lv(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=Tg.createAndSchedule(this,e,t,r,(i=>this.hc(i)));return this.tc.push(s),s}uc(){this.nc&&ge(47125,{Pc:Lv(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Lv(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vv(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1})(n,["next","error","complete"])}class Go extends vd{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new Dv,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Dv(e),this._firestoreClient=void 0,await e}}}function pL(n,e){const t=typeof n=="object"?n:rg(),r=typeof n=="string"?n:Mu,s=id(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=ME("firestore");i&&fL(s,...i)}return s}function Rg(n){if(n._terminated)throw new ne(B.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||mL(n),n._firestoreClient}function mL(n){const e=n._freezeSettings(),t=(function(s,i,o,a){return new U2(s,i,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,cS(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new cL(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(s){const i=s?._online.build();return{_offline:s?._offline.build(i),_online:i}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e){this._byteString=e}static fromBase64String(e){try{return new On(Ut.fromBase64String(e))}catch(t){throw new ne(B.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new On(Ut.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:On._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Zl(e,On._jsonSchema))return On.fromBase64String(e.bytes)}}On._jsonSchemaVersion="firestore/bytes/1.0",On._jsonSchema={type:_t("string",On._jsonSchemaVersion),bytes:_t("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ne(B.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new $t(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ne(B.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ne(B.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Me(this._lat,e._lat)||Me(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:yr._jsonSchemaVersion}}static fromJSON(e){if(Zl(e,yr._jsonSchema))return new yr(e.latitude,e.longitude)}}yr._jsonSchemaVersion="firestore/geoPoint/1.0",yr._jsonSchema={type:_t("string",yr._jsonSchemaVersion),latitude:_t("number"),longitude:_t("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:_r._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Zl(e,_r._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new _r(e.vectorValues);throw new ne(B.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}_r._jsonSchemaVersion="firestore/vectorValue/1.0",_r._jsonSchema={type:_t("string",_r._jsonSchemaVersion),vectorValues:_t("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gL=/^__.*__$/;class yL{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new ui(e,this.data,this.fieldMask,t,this.fieldTransforms):new ec(e,this.data,t,this.fieldTransforms)}}class dS{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new ui(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function fS(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ge(40011,{Ac:n})}}class xg{constructor(e,t,r,s,i,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new xg({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Fu(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(fS(this.Ac)&&gL.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class _L{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||gd(e)}Cc(e,t,r,s=!1){return new xg({Ac:e,methodName:t,Dc:r,path:$t.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Mg(n){const e=n._freezeSettings(),t=gd(n._databaseId);return new _L(n._databaseId,!!e.ignoreUndefinedProperties,t)}function vL(n,e,t,r,s,i={}){const o=n.Cc(i.merge||i.mergeFields?2:0,e,t,s);Og("Data must be an object, but it was:",o,r);const a=pS(r,o);let l,c;if(i.merge)l=new In(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const u=[];for(const h of i.mergeFields){const f=qp(e,h,t);if(!o.contains(f))throw new ne(B.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);gS(u,f)||u.push(f)}l=new In(u),c=o.fieldTransforms.filter((h=>l.covers(h.field)))}else l=null,c=o.fieldTransforms;return new yL(new gn(a),l,c)}class bd extends sc{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof bd}}class Pg extends sc{_toFieldTransform(e){return new ST(e.path,new Ml)}isEqual(e){return e instanceof Pg}}class Ng extends sc{constructor(e,t){super(e),this.Fc=t}_toFieldTransform(e){const t=new Ol(e.serializer,vT(e.serializer,this.Fc));return new ST(e.path,t)}isEqual(e){return e instanceof Ng&&this.Fc===e.Fc}}function wL(n,e,t,r){const s=n.Cc(1,e,t);Og("Data must be an object, but it was:",s,r);const i=[],o=gn.empty();ci(r,((l,c)=>{const u=Dg(e,l,t);c=wt(c);const h=s.yc(u);if(c instanceof bd)i.push(u);else{const f=ic(c,h);f!=null&&(i.push(u),o.set(u,f))}}));const a=new In(i);return new dS(o,a,s.fieldTransforms)}function bL(n,e,t,r,s,i){const o=n.Cc(1,e,t),a=[qp(e,r,t)],l=[s];if(i.length%2!=0)throw new ne(B.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<i.length;f+=2)a.push(qp(e,i[f])),l.push(i[f+1]);const c=[],u=gn.empty();for(let f=a.length-1;f>=0;--f)if(!gS(c,a[f])){const p=a[f];let m=l[f];m=wt(m);const y=o.yc(p);if(m instanceof bd)c.push(p);else{const v=ic(m,y);v!=null&&(c.push(p),u.set(p,v))}}const h=new In(c);return new dS(u,h,o.fieldTransforms)}function EL(n,e,t,r=!1){return ic(t,n.Cc(r?4:3,e))}function ic(n,e){if(mS(n=wt(n)))return Og("Unsupported field value:",e,n),pS(n,e);if(n instanceof sc)return(function(r,s){if(!fS(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,s){const i=[];let o=0;for(const a of r){let l=ic(a,s.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}})(n,e)}return(function(r,s){if((r=wt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return vT(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=nt.fromDate(r);return{timestampValue:Ou(s.serializer,i)}}if(r instanceof nt){const i=new nt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ou(s.serializer,i)}}if(r instanceof yr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof On)return{bytesValue:MT(s.serializer,r._byteString)};if(r instanceof pt){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:pg(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof _r)return(function(o,a){return{mapValue:{fields:{[rT]:{stringValue:sT},[Pu]:{arrayValue:{values:o.toArray().map((c=>{if(typeof c!="number")throw a.Sc("VectorValues must only contain numeric values.");return hg(a.serializer,c)}))}}}}}})(r,s);throw s.Sc(`Unsupported field value: ${od(r)}`)})(n,e)}function pS(n,e){const t={};return YE(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ci(n,((r,s)=>{const i=ic(s,e.mc(r));i!=null&&(t[r]=i)})),{mapValue:{fields:t}}}function mS(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof nt||n instanceof yr||n instanceof On||n instanceof pt||n instanceof sc||n instanceof _r)}function Og(n,e,t){if(!mS(t)||!JE(t)){const r=od(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function qp(n,e,t){if((e=wt(e))instanceof wd)return e._internalPath;if(typeof e=="string")return Dg(n,e);throw Fu("Field path arguments must be of type string or ",n,!1,void 0,t)}const TL=new RegExp("[~\\*/\\[\\]]");function Dg(n,e,t){if(e.search(TL)>=0)throw Fu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new wd(...e.split("."))._internalPath}catch{throw Fu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Fu(n,e,t,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new ne(B.INVALID_ARGUMENT,a+n+l)}function gS(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yS{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new pt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new SL(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Lg("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class SL extends yS{data(){return super.data()}}function Lg(n,e){return typeof e=="string"?Dg(n,e):e instanceof wd?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CL(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ne(B.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Vg{}class _S extends Vg{}function AL(n,e,...t){let r=[];e instanceof Vg&&r.push(e),r=r.concat(t),(function(i){const o=i.filter((l=>l instanceof Bg)).length,a=i.filter((l=>l instanceof Fg)).length;if(o>1||o>0&&a>0)throw new ne(B.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const s of r)n=s._apply(n);return n}class Fg extends _S{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Fg(e,t,r)}_apply(e){const t=this._parse(e);return vS(e._query,t),new so(e.firestore,e.converter,Op(e._query,t))}_parse(e){const t=Mg(e.firestore);return(function(i,o,a,l,c,u,h){let f;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new ne(B.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){$v(h,u);const m=[];for(const y of h)m.push(Bv(l,i,y));f={arrayValue:{values:m}}}else f=Bv(l,i,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||$v(h,u),f=EL(a,o,h,u==="in"||u==="not-in");return yt.create(c,u,f)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class Bg extends Vg{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Bg(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:Xn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)vS(o,l),o=Op(o,l)})(e._query,t),new so(e.firestore,e.converter,Op(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class $g extends _S{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new $g(e,t)}_apply(e){const t=(function(s,i,o){if(s.startAt!==null)throw new ne(B.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new ne(B.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new xl(i,o)})(e._query,this._field,this._direction);return new so(e.firestore,e.converter,(function(s,i){const o=s.explicitOrderBy.concat([i]);return new ia(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)})(e._query,t))}}function Fv(n,e="asc"){const t=e,r=Lg("orderBy",n);return $g._create(r,t)}function Bv(n,e,t){if(typeof(t=wt(t))=="string"){if(t==="")throw new ne(B.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!dT(e)&&t.indexOf("/")!==-1)throw new ne(B.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Ye.fromString(t));if(!ae.isDocumentKey(r))throw new ne(B.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ev(n,new ae(r))}if(t instanceof pt)return ev(n,t._key);throw new ne(B.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${od(t)}.`)}function $v(n,e){if(!Array.isArray(n)||n.length===0)throw new ne(B.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function vS(n,e){const t=(function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null})(n.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ne(B.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ne(B.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class IL{convertValue(e,t="none"){switch(ni(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ft(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ti(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ge(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return ci(e,((s,i)=>{r[s]=this.convertValue(i,t)})),r}convertVectorValue(e){const t=e.fields?.[Pu].arrayValue?.values?.map((r=>ft(r.doubleValue)));return new _r(t)}convertGeoPoint(e){return new yr(ft(e.latitude),ft(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=cd(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Il(e));default:return null}}convertTimestamp(e){const t=ei(e);return new nt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Ye.fromString(e);Ue(VT(r),9688,{name:e});const s=new kl(r.get(1),r.get(3)),i=new ae(r.popFirst(5));return s.isEqual(t)||es(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kL(n,e,t){let r;return r=n?n.toFirestore(e):e,r}class Fa{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Li extends yS{constructor(e,t,r,s,i,o){super(e,t,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new ou(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Lg("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ne(B.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Li._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Li._jsonSchemaVersion="firestore/documentSnapshot/1.0",Li._jsonSchema={type:_t("string",Li._jsonSchemaVersion),bundleSource:_t("string","DocumentSnapshot"),bundleName:_t("string"),bundle:_t("string")};class ou extends Li{data(e={}){return super.data(e)}}class Oo{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Fa(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new ou(this._firestore,this._userDataWriter,r.key,r,new Fa(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ne(B.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map((a=>{const l=new ou(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Fa(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}}))}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((a=>i||a.type!==3)).map((a=>{const l=new ou(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Fa(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,u=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:RL(a.type),doc:l,oldIndex:c,newIndex:u}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ne(B.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Oo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ig.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],s=[];return this.docs.forEach((i=>{i._document!==null&&(t.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function RL(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ge(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xL(n){n=Gr(n,pt);const e=Gr(n.firestore,Go);return dL(Rg(e),n._key).then((t=>TS(e,n,t)))}Oo._jsonSchemaVersion="firestore/querySnapshot/1.0",Oo._jsonSchema={type:_t("string",Oo._jsonSchemaVersion),bundleSource:_t("string","QuerySnapshot"),bundleName:_t("string"),bundle:_t("string")};class wS extends IL{constructor(e){super(),this.firestore=e}convertBytes(e){return new On(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new pt(this.firestore,null,t)}}function ML(n,e,t,...r){n=Gr(n,pt);const s=Gr(n.firestore,Go),i=Mg(s);let o;return o=typeof(e=wt(e))=="string"||e instanceof wd?bL(i,"updateDoc",n._key,e,t,r):wL(i,"updateDoc",n._key,e),ES(s,[o.toMutation(n._key,mr.exists(!0))])}function PL(n,e){const t=Gr(n.firestore,Go),r=kg(n),s=kL(n.converter,e);return ES(t,[vL(Mg(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,mr.exists(!1))]).then((()=>r))}function bS(n,...e){n=wt(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||Vv(e[r])||(t=e[r++]);const s={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Vv(e[r])){const l=e[r];e[r]=l.next?.bind(l),e[r+1]=l.error?.bind(l),e[r+2]=l.complete?.bind(l)}let i,o,a;if(n instanceof pt)o=Gr(n.firestore,Go),a=ud(n._key.path),i={next:l=>{e[r]&&e[r](TS(o,n,l))},error:e[r+1],complete:e[r+2]};else{const l=Gr(n,so);o=Gr(l.firestore,Go),a=l._query;const c=new wS(o);i={next:u=>{e[r]&&e[r](new Oo(o,c,l,u))},error:e[r+1],complete:e[r+2]},CL(n._query)}return(function(c,u,h,f){const p=new aS(f),m=new XT(u,p,h);return c.asyncQueue.enqueueAndForget((async()=>QT(await Wp(c),m))),()=>{p.Nu(),c.asyncQueue.enqueueAndForget((async()=>YT(await Wp(c),m)))}})(Rg(o),a,s,i)}function ES(n,e){return(function(r,s){const i=new Hs;return r.asyncQueue.enqueueAndForget((async()=>eL(await hL(r),s,i))),i.promise})(Rg(n),e)}function TS(n,e,t){const r=t.docs.get(e._key),s=new wS(n);return new Li(n,s,e._key,r,new Fa(t.hasPendingWrites,t.fromCache),e.converter)}function NL(){return new Pg("serverTimestamp")}function OL(n){return new Ng("increment",n)}(function(e,t=!0){(function(s){na=s})(to),Hi(new Xs("firestore",((r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new Go(new E2(r.getProvider("auth-internal")),new C2(o,r.getProvider("app-check-internal")),(function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new ne(B.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new kl(c.options.projectId,u)})(o,s),o);return i={useFetchStreams:t,...i},a._setSettings(i),a}),"PUBLIC").setMultipleInstances(!0)),fr(U_,z_,e),fr(U_,z_,"esm2020")})();var DL="firebase",LL="12.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */fr(DL,LL,"app");function SS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const VL=SS,CS=new Yl("auth","Firebase",SS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bu=new tg("@firebase/auth");function FL(n,...e){Bu.logLevel<=xe.WARN&&Bu.warn(`Auth (${to}): ${n}`,...e)}function au(n,...e){Bu.logLevel<=xe.ERROR&&Bu.error(`Auth (${to}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zn(n,...e){throw Ug(n,...e)}function vr(n,...e){return Ug(n,...e)}function AS(n,e,t){const r={...VL(),[e]:t};return new Yl("auth","Firebase",r).create(e,{appName:n.name})}function Ws(n){return AS(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ug(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return CS.create(n,...e)}function pe(n,e,...t){if(!n)throw Ug(e,...t)}function Wr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw au(e),new Error(e)}function ns(n,e){n||Wr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kp(){return typeof self<"u"&&self.location?.href||""}function BL(){return Uv()==="http:"||Uv()==="https:"}function Uv(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $L(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(BL()||ZP()||"connection"in navigator)?navigator.onLine:!0}function UL(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(e,t){this.shortDelay=e,this.longDelay=t,ns(t>e,"Short delay should be less than long delay!"),this.isMobile=QP()||eN()}get(){return $L()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zg(n,e){ns(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IS{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Wr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Wr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Wr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zL={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HL=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],jL=new oc(3e4,6e4);function io(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function hi(n,e,t,r,s={}){return kS(n,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=Xl({key:n.config.apiKey,...o}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const c={method:e,headers:l,...i};return XP()||(c.referrerPolicy="no-referrer"),n.emulatorConfig&&eo(n.emulatorConfig.host)&&(c.credentials="include"),IS.fetch()(await RS(n,n.config.apiHost,t,a),c)})}async function kS(n,e,t){n._canInitEmulator=!1;const r={...zL,...e};try{const s=new qL(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Nc(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Nc(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Nc(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw Nc(n,"user-disabled",o);const u=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw AS(n,u,c);Zn(n,u)}}catch(s){if(s instanceof Ir)throw s;Zn(n,"network-request-failed",{message:String(s)})}}async function Ed(n,e,t,r,s={}){const i=await hi(n,e,t,r,s);return"mfaPendingCredential"in i&&Zn(n,"multi-factor-auth-required",{_serverResponse:i}),i}async function RS(n,e,t,r){const s=`${e}${t}?${r}`,i=n,o=i.config.emulator?zg(n.config,s):`${n.config.apiScheme}://${s}`;return HL.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function WL(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class qL{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(vr(this.auth,"network-request-failed")),jL.get())})}}function Nc(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=vr(n,e,r);return s.customData._tokenResponse=t,s}function zv(n){return n!==void 0&&n.enterprise!==void 0}class KL{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return WL(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function GL(n,e){return hi(n,"GET","/v2/recaptchaConfig",io(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JL(n,e){return hi(n,"POST","/v1/accounts:delete",e)}async function $u(n,e){return hi(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sl(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function QL(n,e=!1){const t=wt(n),r=await t.getIdToken(e),s=Hg(r);pe(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i?.sign_in_provider;return{claims:s,token:r,authTime:sl(xf(s.auth_time)),issuedAtTime:sl(xf(s.iat)),expirationTime:sl(xf(s.exp)),signInProvider:o||null,signInSecondFactor:i?.sign_in_second_factor||null}}function xf(n){return Number(n)*1e3}function Hg(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return au("JWT malformed, contained fewer than 3 sections"),null;try{const s=RE(t);return s?JSON.parse(s):(au("Failed to decode base64 JWT payload"),null)}catch(s){return au("Caught error parsing JWT payload as JSON",s?.toString()),null}}function Hv(n){const e=Hg(n);return pe(e,"internal-error"),pe(typeof e.exp<"u","internal-error"),pe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dl(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Ir&&YL(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function YL({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XL{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gp{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=sl(this.lastLoginAt),this.creationTime=sl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uu(n){const e=n.auth,t=await n.getIdToken(),r=await Dl(n,$u(e,{idToken:t}));pe(r?.users.length,e,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const i=s.providerUserInfo?.length?xS(s.providerUserInfo):[],o=eV(n.providerData,i),a=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!o?.length,c=a?l:!1,u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Gp(s.createdAt,s.lastLoginAt),isAnonymous:c};Object.assign(n,u)}async function ZL(n){const e=wt(n);await Uu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function eV(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function xS(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tV(n,e){const t=await kS(n,{},async()=>{const r=Xl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,o=await RS(n,s,"/v1/token",`key=${i}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return n.emulatorConfig&&eo(n.emulatorConfig.host)&&(l.credentials="include"),IS.fetch()(o,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function nV(n,e){return hi(n,"POST","/v2/accounts:revokeToken",io(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){pe(e.idToken,"internal-error"),pe(typeof e.idToken<"u","internal-error"),pe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Hv(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){pe(e.length!==0,"internal-error");const t=Hv(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(pe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await tV(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,o=new Do;return r&&(pe(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(pe(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(pe(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Do,this.toJSON())}_performRefresh(){return Wr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gs(n,e){pe(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Wn{constructor({uid:e,auth:t,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new XL(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Gp(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Dl(this,this.stsTokenManager.getToken(this.auth,e));return pe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return QL(this,e)}reload(){return ZL(this)}_assign(e){this!==e&&(pe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Wn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){pe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Uu(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Nn(this.auth.app))return Promise.reject(Ws(this.auth));const e=await this.getIdToken();return await Dl(this,JL(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,s=t.email??void 0,i=t.phoneNumber??void 0,o=t.photoURL??void 0,a=t.tenantId??void 0,l=t._redirectEventId??void 0,c=t.createdAt??void 0,u=t.lastLoginAt??void 0,{uid:h,emailVerified:f,isAnonymous:p,providerData:m,stsTokenManager:y}=t;pe(h&&y,e,"internal-error");const v=Do.fromJSON(this.name,y);pe(typeof h=="string",e,"internal-error"),gs(r,e.name),gs(s,e.name),pe(typeof f=="boolean",e,"internal-error"),pe(typeof p=="boolean",e,"internal-error"),gs(i,e.name),gs(o,e.name),gs(a,e.name),gs(l,e.name),gs(c,e.name),gs(u,e.name);const T=new Wn({uid:h,auth:e,email:s,emailVerified:f,displayName:r,isAnonymous:p,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:v,createdAt:c,lastLoginAt:u});return m&&Array.isArray(m)&&(T.providerData=m.map(M=>({...M}))),l&&(T._redirectEventId=l),T}static async _fromIdTokenResponse(e,t,r=!1){const s=new Do;s.updateFromServerResponse(t);const i=new Wn({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Uu(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];pe(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?xS(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!i?.length,a=new Do;a.updateFromIdToken(r);const l=new Wn({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Gp(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!i?.length};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jv=new Map;function qr(n){ns(n instanceof Function,"Expected a class definition");let e=jv.get(n);return e?(ns(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,jv.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}MS.type="NONE";const Wv=MS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lu(n,e,t){return`firebase:${n}:${e}:${t}`}class Lo{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=lu(this.userKey,s.apiKey,i),this.fullPersistenceKey=lu("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await $u(this.auth,{idToken:e}).catch(()=>{});return t?Wn._fromGetAccountInfoResponse(this.auth,t,e):null}return Wn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Lo(qr(Wv),e,r);const s=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||qr(Wv);const o=lu(r,e.config.apiKey,e.name);let a=null;for(const c of t)try{const u=await c._get(o);if(u){let h;if(typeof u=="string"){const f=await $u(e,{idToken:u}).catch(()=>{});if(!f)break;h=await Wn._fromGetAccountInfoResponse(e,f,u)}else h=Wn._fromJSON(e,u);c!==i&&(a=h),i=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new Lo(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==i)try{await c._remove(o)}catch{}})),new Lo(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qv(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(DS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(PS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(VS(e))return"Blackberry";if(FS(e))return"Webos";if(NS(e))return"Safari";if((e.includes("chrome/")||OS(e))&&!e.includes("edge/"))return"Chrome";if(LS(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function PS(n=tn()){return/firefox\//i.test(n)}function NS(n=tn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function OS(n=tn()){return/crios\//i.test(n)}function DS(n=tn()){return/iemobile/i.test(n)}function LS(n=tn()){return/android/i.test(n)}function VS(n=tn()){return/blackberry/i.test(n)}function FS(n=tn()){return/webos/i.test(n)}function jg(n=tn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function rV(n=tn()){return jg(n)&&!!window.navigator?.standalone}function sV(){return tN()&&document.documentMode===10}function BS(n=tn()){return jg(n)||LS(n)||FS(n)||VS(n)||/windows phone/i.test(n)||DS(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $S(n,e=[]){let t;switch(n){case"Browser":t=qv(tn());break;case"Worker":t=`${qv(tn())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${to}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iV{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oV(n,e={}){return hi(n,"GET","/v2/passwordPolicy",io(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aV=6;class lV{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??aV,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cV{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Kv(this),this.idTokenSubscription=new Kv(this),this.beforeStateQueue=new iV(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=CS,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=qr(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Lo.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await $u(this,{idToken:e}),r=await Wn._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Nn(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,o=r?._redirectEventId,a=await this.tryRedirectSignIn(e);(!i||i===o)&&a?.user&&(r=a.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(i){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return pe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Uu(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=UL()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Nn(this.app))return Promise.reject(Ws(this));const t=e?wt(e):null;return t&&pe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&pe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Nn(this.app)?Promise.reject(Ws(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Nn(this.app)?Promise.reject(Ws(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(qr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await oV(this),t=new lV(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Yl("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await nV(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&qr(e)||this._popupRedirectResolver;pe(t,this,"argument-error"),this.redirectPersistenceManager=await Lo.create(this,[qr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(pe(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return pe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=$S(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(Nn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&FL(`Error while retrieving App Check token: ${e.error}`),e?.token}}function aa(n){return wt(n)}class Kv{constructor(e){this.auth=e,this.observer=null,this.addObserver=cN(t=>this.observer=t)}get next(){return pe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Td={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function uV(n){Td=n}function US(n){return Td.loadJS(n)}function hV(){return Td.recaptchaEnterpriseScript}function dV(){return Td.gapiScript}function fV(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class pV{constructor(){this.enterprise=new mV}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class mV{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const gV="recaptcha-enterprise",zS="NO_RECAPTCHA";class yV{constructor(e){this.type=gV,this.auth=aa(e)}async verify(e="verify",t=!1){async function r(i){if(!t){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{GL(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new KL(l);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;zv(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(c=>{o(c)}).catch(()=>{o(zS)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new pV().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(a=>{if(!t&&zv(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=hV();l.length!==0&&(l+=a),US(l).then(()=>{s(a,i,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function Gv(n,e,t,r=!1,s=!1){const i=new yV(n);let o;if(s)o=zS;else try{o=await i.verify(t)}catch{o=await i.verify(t,!0)}const a={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,c=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Jv(n,e,t,r,s){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Gv(n,e,t,t==="getOobCode");return r(n,i)}else return r(n,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await Gv(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _V(n,e){const t=id(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(zi(i,e??{}))return s;Zn(s,"already-initialized")}return t.initialize({options:e})}function vV(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(qr);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function wV(n,e,t){const r=aa(n);pe(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=HS(e),{host:o,port:a}=bV(e),l=a===null?"":`:${a}`,c={url:`${i}//${o}${l}/`},u=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){pe(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),pe(zi(c,r.config.emulator)&&zi(u,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=c,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,eo(o)?(Zm(`${i}//${o}${l}`),eg("Auth",!0)):EV()}function HS(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function bV(n){const e=HS(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Qv(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:Qv(o)}}}function Qv(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function EV(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Wr("not implemented")}_getIdTokenResponse(e){return Wr("not implemented")}_linkToIdToken(e,t){return Wr("not implemented")}_getReauthenticationResolver(e){return Wr("not implemented")}}async function TV(n,e){return hi(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SV(n,e){return Ed(n,"POST","/v1/accounts:signInWithPassword",io(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CV(n,e){return Ed(n,"POST","/v1/accounts:signInWithEmailLink",io(n,e))}async function AV(n,e){return Ed(n,"POST","/v1/accounts:signInWithEmailLink",io(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll extends Wg{constructor(e,t,r,s=null){super("password",r),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new Ll(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Ll(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Jv(e,t,"signInWithPassword",SV);case"emailLink":return CV(e,{email:this._email,oobCode:this._password});default:Zn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Jv(e,r,"signUpPassword",TV);case"emailLink":return AV(e,{idToken:t,email:this._email,oobCode:this._password});default:Zn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vo(n,e){return Ed(n,"POST","/v1/accounts:signInWithIdp",io(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IV="http://localhost";class qi extends Wg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new qi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Zn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=t;if(!r||!s)return null;const o=new qi(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Vo(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Vo(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Vo(e,t)}buildRequest(){const e={requestUri:IV,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Xl(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kV(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function RV(n){const e=Na(Oa(n)).link,t=e?Na(Oa(e)).deep_link_id:null,r=Na(Oa(n)).deep_link_id;return(r?Na(Oa(r)).link:null)||r||t||e||n}class qg{constructor(e){const t=Na(Oa(e)),r=t.apiKey??null,s=t.oobCode??null,i=kV(t.mode??null);pe(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=RV(e);try{return new qg(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class la{constructor(){this.providerId=la.PROVIDER_ID}static credential(e,t){return Ll._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=qg.parseLink(t);return pe(r,"argument-error"),Ll._fromEmailAndCode(e,r.code,r.tenantId)}}la.PROVIDER_ID="password";la.EMAIL_PASSWORD_SIGN_IN_METHOD="password";la.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac extends jS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As extends ac{constructor(){super("facebook.com")}static credential(e){return qi._fromParams({providerId:As.PROVIDER_ID,signInMethod:As.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return As.credentialFromTaggedObject(e)}static credentialFromError(e){return As.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return As.credential(e.oauthAccessToken)}catch{return null}}}As.FACEBOOK_SIGN_IN_METHOD="facebook.com";As.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is extends ac{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return qi._fromParams({providerId:Is.PROVIDER_ID,signInMethod:Is.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Is.credentialFromTaggedObject(e)}static credentialFromError(e){return Is.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Is.credential(t,r)}catch{return null}}}Is.GOOGLE_SIGN_IN_METHOD="google.com";Is.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ks extends ac{constructor(){super("github.com")}static credential(e){return qi._fromParams({providerId:ks.PROVIDER_ID,signInMethod:ks.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ks.credentialFromTaggedObject(e)}static credentialFromError(e){return ks.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ks.credential(e.oauthAccessToken)}catch{return null}}}ks.GITHUB_SIGN_IN_METHOD="github.com";ks.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rs extends ac{constructor(){super("twitter.com")}static credential(e,t){return qi._fromParams({providerId:Rs.PROVIDER_ID,signInMethod:Rs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Rs.credentialFromTaggedObject(e)}static credentialFromError(e){return Rs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Rs.credential(t,r)}catch{return null}}}Rs.TWITTER_SIGN_IN_METHOD="twitter.com";Rs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await Wn._fromIdTokenResponse(e,r,s),o=Yv(r);return new Jo({user:i,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=Yv(r);return new Jo({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function Yv(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu extends Ir{constructor(e,t,r,s){super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,zu.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new zu(e,t,r,s)}}function WS(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?zu._fromErrorAndOperation(n,i,e,r):i})}async function xV(n,e,t=!1){const r=await Dl(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Jo._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MV(n,e,t=!1){const{auth:r}=n;if(Nn(r.app))return Promise.reject(Ws(r));const s="reauthenticate";try{const i=await Dl(n,WS(r,s,e,n),t);pe(i.idToken,r,"internal-error");const o=Hg(i.idToken);pe(o,r,"internal-error");const{sub:a}=o;return pe(n.uid===a,r,"user-mismatch"),Jo._forOperation(n,s,i)}catch(i){throw i?.code==="auth/user-not-found"&&Zn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qS(n,e,t=!1){if(Nn(n.app))return Promise.reject(Ws(n));const r="signIn",s=await WS(n,r,e),i=await Jo._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}async function PV(n,e){return qS(aa(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NV(n){const e=aa(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function OV(n,e,t){return Nn(n.app)?Promise.reject(Ws(n)):PV(wt(n),la.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&NV(n),r})}function DV(n,e,t,r){return wt(n).onIdTokenChanged(e,t,r)}function LV(n,e,t){return wt(n).beforeAuthStateChanged(e,t)}function KS(n,e,t,r){return wt(n).onAuthStateChanged(e,t,r)}function VV(n){return wt(n).signOut()}const Hu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Hu,"1"),this.storage.removeItem(Hu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FV=1e3,BV=10;class JS extends GS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=BS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);sV()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,BV):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},FV)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}JS.type="LOCAL";const $V=JS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS extends GS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}QS.type="SESSION";const YS=QS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UV(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new Sd(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,o=this.handlersMap[s];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async c=>c(t.origin,i)),l=await UV(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Sd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kg(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zV{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const c=Kg("",20);s.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(h){const f=h;if(f.data.eventId===c)switch(f.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(f.data.response);break;default:clearTimeout(u),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wr(){return window}function HV(n){wr().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XS(){return typeof wr().WorkerGlobalScope<"u"&&typeof wr().importScripts=="function"}async function jV(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function WV(){return navigator?.serviceWorker?.controller||null}function qV(){return XS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZS="firebaseLocalStorageDb",KV=1,ju="firebaseLocalStorage",eC="fbase_key";class lc{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Cd(n,e){return n.transaction([ju],e?"readwrite":"readonly").objectStore(ju)}function GV(){const n=indexedDB.deleteDatabase(ZS);return new lc(n).toPromise()}function Jp(){const n=indexedDB.open(ZS,KV);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(ju,{keyPath:eC})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(ju)?e(r):(r.close(),await GV(),e(await Jp()))})})}async function Xv(n,e,t){const r=Cd(n,!0).put({[eC]:e,value:t});return new lc(r).toPromise()}async function JV(n,e){const t=Cd(n,!1).get(e),r=await new lc(t).toPromise();return r===void 0?null:r.value}function Zv(n,e){const t=Cd(n,!0).delete(e);return new lc(t).toPromise()}const QV=800,YV=3;class tC{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Jp(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>YV)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return XS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Sd._getInstance(qV()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await jV(),!this.activeServiceWorker)return;this.sender=new zV(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||WV()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Jp();return await Xv(e,Hu,"1"),await Zv(e,Hu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Xv(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>JV(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Zv(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Cd(s,!1).getAll();return new lc(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),QV)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}tC.type="LOCAL";const XV=tC;new oc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZV(n,e){return e?qr(e):(pe(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gg extends Wg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Vo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Vo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Vo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function e3(n){return qS(n.auth,new Gg(n),n.bypassAuthState)}function t3(n){const{auth:e,user:t}=n;return pe(t,e,"internal-error"),MV(t,new Gg(n),n.bypassAuthState)}async function n3(n){const{auth:e,user:t}=n;return pe(t,e,"internal-error"),xV(t,new Gg(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nC{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return e3;case"linkViaPopup":case"linkViaRedirect":return n3;case"reauthViaPopup":case"reauthViaRedirect":return t3;default:Zn(this.auth,"internal-error")}}resolve(e){ns(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ns(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r3=new oc(2e3,1e4);class Io extends nC{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Io.currentPopupAction&&Io.currentPopupAction.cancel(),Io.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return pe(e,this.auth,"internal-error"),e}async onExecution(){ns(this.filter.length===1,"Popup operations only handle one event");const e=Kg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(vr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(vr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Io.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(vr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,r3.get())};e()}}Io.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s3="pendingRedirect",cu=new Map;class i3 extends nC{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=cu.get(this.auth._key());if(!e){try{const r=await o3(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}cu.set(this.auth._key(),e)}return this.bypassAuthState||cu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function o3(n,e){const t=c3(e),r=l3(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function a3(n,e){cu.set(n._key(),e)}function l3(n){return qr(n._redirectPersistence)}function c3(n){return lu(s3,n.config.apiKey,n.name)}async function u3(n,e,t=!1){if(Nn(n.app))return Promise.reject(Ws(n));const r=aa(n),s=ZV(r,e),o=await new i3(r,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h3=600*1e3;class d3{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!f3(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!rC(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(vr(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=h3&&this.cachedEventUids.clear(),this.cachedEventUids.has(ew(e))}saveEventToCache(e){this.cachedEventUids.add(ew(e)),this.lastProcessedEventTime=Date.now()}}function ew(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function rC({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function f3(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return rC(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p3(n,e={}){return hi(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m3=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,g3=/^https?/;async function y3(n){if(n.config.emulator)return;const{authorizedDomains:e}=await p3(n);for(const t of e)try{if(_3(t))return}catch{}Zn(n,"unauthorized-domain")}function _3(n){const e=Kp(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!g3.test(t))return!1;if(m3.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v3=new oc(3e4,6e4);function tw(){const n=wr().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function w3(n){return new Promise((e,t)=>{function r(){tw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{tw(),t(vr(n,"network-request-failed"))},timeout:v3.get()})}if(wr().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(wr().gapi?.load)r();else{const s=fV("iframefcb");return wr()[s]=()=>{gapi.load?r():t(vr(n,"network-request-failed"))},US(`${dV()}?onload=${s}`).catch(i=>t(i))}}).catch(e=>{throw uu=null,e})}let uu=null;function b3(n){return uu=uu||w3(n),uu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E3=new oc(5e3,15e3),T3="__/auth/iframe",S3="emulator/auth/iframe",C3={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},A3=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function I3(n){const e=n.config;pe(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?zg(e,S3):`https://${n.config.authDomain}/${T3}`,r={apiKey:e.apiKey,appName:n.name,v:to},s=A3.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${Xl(r).slice(1)}`}async function k3(n){const e=await b3(n),t=wr().gapi;return pe(t,n,"internal-error"),e.open({where:document.body,url:I3(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:C3,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=vr(n,"network-request-failed"),a=wr().setTimeout(()=>{i(o)},E3.get());function l(){wr().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R3={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},x3=500,M3=600,P3="_blank",N3="http://localhost";class nw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function O3(n,e,t,r=x3,s=M3){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...R3,width:r.toString(),height:s.toString(),top:i,left:o},c=tn().toLowerCase();t&&(a=OS(c)?P3:t),PS(c)&&(e=e||N3,l.scrollbars="yes");const u=Object.entries(l).reduce((f,[p,m])=>`${f}${p}=${m},`,"");if(rV(c)&&a!=="_self")return D3(e||"",a),new nw(null);const h=window.open(e||"",a,u);pe(h,n,"popup-blocked");try{h.focus()}catch{}return new nw(h)}function D3(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L3="__/auth/handler",V3="emulator/auth/handler",F3=encodeURIComponent("fac");async function rw(n,e,t,r,s,i){pe(n.config.authDomain,n,"auth-domain-config-required"),pe(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:to,eventId:s};if(e instanceof jS){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",lN(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries({}))o[u]=h}if(e instanceof ac){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(o.scopes=u.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const l=await n._getAppCheckToken(),c=l?`#${F3}=${encodeURIComponent(l)}`:"";return`${B3(n)}?${Xl(a).slice(1)}${c}`}function B3({config:n}){return n.emulator?zg(n,V3):`https://${n.authDomain}/${L3}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mf="webStorageSupport";class $3{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=YS,this._completeRedirectFn=u3,this._overrideRedirectResult=a3}async _openPopup(e,t,r,s){ns(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await rw(e,t,r,Kp(),s);return O3(e,i,Kg())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await rw(e,t,r,Kp(),s);return HV(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(ns(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await k3(e),r=new d3(e);return t.register("authEvent",s=>(pe(s?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Mf,{type:Mf},s=>{const i=s?.[0]?.[Mf];i!==void 0&&t(!!i),Zn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=y3(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return BS()||NS()||jg()}}const U3=$3;var sw="@firebase/auth",iw="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z3{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){pe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H3(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function j3(n){Hi(new Xs("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;pe(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:$S(n)},c=new cV(r,s,i,l);return vV(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Hi(new Xs("auth-internal",e=>{const t=aa(e.getProvider("auth").getImmediate());return(r=>new z3(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),fr(sw,iw,H3(n)),fr(sw,iw,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W3=300,q3=NE("authIdTokenMaxAge")||W3;let ow=null;const K3=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>q3)return;const s=t?.token;ow!==s&&(ow=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Jg(n=rg()){const e=id(n,"auth");if(e.isInitialized())return e.getImmediate();const t=_V(n,{popupRedirectResolver:U3,persistence:[XV,$V,YS]}),r=NE("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=K3(i.toString());LV(t,o,()=>o(t.currentUser)),DV(t,a=>o(a))}}const s=xE("auth");return s&&wV(t,`http://${s}`),t}function G3(){return document.getElementsByTagName("head")?.[0]??document}uV({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=vr("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",G3().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});j3("Browser");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sC="firebasestorage.googleapis.com",J3="storageBucket",Q3=120*1e3,Y3=600*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr extends Ir{constructor(e,t,r=0){super(Pf(e),`Firebase Storage: ${t} (${Pf(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,kr.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Pf(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Tr;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Tr||(Tr={}));function Pf(n){return"storage/"+n}function X3(){const n="An unknown error occurred, please check the error payload for server response.";return new kr(Tr.UNKNOWN,n)}function Z3(){return new kr(Tr.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function e4(){return new kr(Tr.CANCELED,"User canceled the upload/download.")}function t4(n){return new kr(Tr.INVALID_URL,"Invalid URL '"+n+"'.")}function n4(n){return new kr(Tr.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function aw(n){return new kr(Tr.INVALID_ARGUMENT,n)}function iC(){return new kr(Tr.APP_DELETED,"The Firebase app was deleted.")}function r4(n){return new kr(Tr.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=qn.makeFromUrl(e,t)}catch{return new qn(e,"")}if(r.path==="")return r;throw n4(e)}static makeFromUrl(e,t){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(D){D.path.charAt(D.path.length-1)==="/"&&(D.path_=D.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),l={bucket:1,path:3};function c(D){D.path_=decodeURIComponent(D.path)}const u="v[A-Za-z0-9_]+",h=t.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",p=new RegExp(`^https?://${h}/${u}/b/${s}/o${f}`,"i"),m={bucket:1,path:3},y=t===sC?"(?:storage.googleapis.com|storage.cloud.google.com)":t,v="([^?#]*)",T=new RegExp(`^https?://${y}/${s}/${v}`,"i"),P=[{regex:a,indices:l,postModify:i},{regex:p,indices:m,postModify:c},{regex:T,indices:{bucket:1,path:2},postModify:c}];for(let D=0;D<P.length;D++){const L=P[D],q=L.regex.exec(e);if(q){const S=q[L.indices.bucket];let w=q[L.indices.path];w||(w=""),r=new qn(S,w),L.postModify(r);break}}if(r==null)throw t4(e);return r}}class s4{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i4(n,e,t){let r=1,s=null,i=null,o=!1,a=0;function l(){return a===2}let c=!1;function u(...v){c||(c=!0,e.apply(null,v))}function h(v){s=setTimeout(()=>{s=null,n(p,l())},v)}function f(){i&&clearTimeout(i)}function p(v,...T){if(c){f();return}if(v){f(),u.call(null,v,...T);return}if(l()||o){f(),u.call(null,v,...T);return}r<64&&(r*=2);let P;a===1?(a=2,P=0):P=(r+Math.random())*1e3,h(P)}let m=!1;function y(v){m||(m=!0,f(),!c&&(s!==null?(v||(a=2),clearTimeout(s),h(0)):v||(a=1)))}return h(0),i=setTimeout(()=>{o=!0,y(!0)},t),y}function o4(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a4(n){return n!==void 0}function lw(n,e,t,r){if(r<e)throw aw(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw aw(`Invalid value for '${n}'. Expected ${t} or less.`)}function l4(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const s=e(r)+"="+e(n[r]);t=t+s+"&"}return t=t.slice(0,-1),t}var Wu;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Wu||(Wu={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c4(n,e){const t=n>=500&&n<600,s=[408,429].indexOf(n)!==-1,i=e.indexOf(n)!==-1;return t||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u4{constructor(e,t,r,s,i,o,a,l,c,u,h,f=!0,p=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=h,this.retry=f,this.isUsingEmulator=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((m,y)=>{this.resolve_=m,this.reject_=y,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new Oc(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===Wu.NO_ERROR,l=i.getStatus();if(!a||c4(l,this.additionalRetryCodes_)&&this.retry){const u=i.getErrorCode()===Wu.ABORT;r(!1,new Oc(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;r(!0,new Oc(c,i))})},t=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());a4(l)?i(l):i()}catch(l){o(l)}else if(a!==null){const l=X3();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(s.canceled){const l=this.appDelete_?iC():e4();o(l)}else{const l=Z3();o(l)}};this.canceled_?t(!1,new Oc(!1,null,!0)):this.backoffId_=i4(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&o4(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Oc{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function h4(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function d4(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function f4(n,e){e&&(n["X-Firebase-GMPID"]=e)}function p4(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function m4(n,e,t,r,s,i,o=!0,a=!1){const l=l4(n.urlParams),c=n.url+l,u=Object.assign({},n.headers);return f4(u,e),h4(u,t),d4(u,i),p4(u,r),new u4(c,n.method,u,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,s,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g4(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function y4(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qu{constructor(e,t){this._service=e,t instanceof qn?this._location=t:this._location=qn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new qu(e,t)}get root(){const e=new qn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return y4(this._location.path)}get storage(){return this._service}get parent(){const e=g4(this._location.path);if(e===null)return null;const t=new qn(this._location.bucket,e);return new qu(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw r4(e)}}function cw(n,e){const t=e?.[J3];return t==null?null:qn.makeFromBucketSpec(t,n)}function _4(n,e,t,r={}){n.host=`${e}:${t}`;const s=eo(e);s&&(Zm(`https://${n.host}/b`),eg("Storage",!0)),n._isUsingEmulator=!0,n._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(n._overrideAuthToken=typeof i=="string"?i:OE(i,n.app.options.projectId))}class v4{constructor(e,t,r,s,i,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=sC,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Q3,this._maxUploadRetryTime=Y3,this._requests=new Set,s!=null?this._bucket=qn.makeFromBucketSpec(s,this._host):this._bucket=cw(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=qn.makeFromBucketSpec(this._url,e):this._bucket=cw(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){lw("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){lw("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Nn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new qu(this,e)}_makeRequest(e,t,r,s,i=!0){if(this._deleted)return new s4(iC());{const o=m4(e,this._appId,r,s,t,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,s).getPromise()}}const uw="@firebase/storage",hw="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oC="storage";function w4(n=rg(),e){n=wt(n);const r=id(n,oC).getImmediate({identifier:e}),s=ME("storage");return s&&b4(r,...s),r}function b4(n,e,t,r={}){_4(n,e,t,r)}function E4(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),s=n.getProvider("app-check-internal");return new v4(t,r,s,e,to)}function T4(){Hi(new Xs(oC,E4,"PUBLIC").setMultipleInstances(!0)),fr(uw,hw,""),fr(uw,hw,"esm2020")}T4();const S4={apiKey:"AIzaSyB8uWskczwYPUG4fWBQ7XBcdHdKDM0wKVg",authDomain:"accounting-site-5c946.firebaseapp.com",projectId:"accounting-site-5c946",storageBucket:"accounting-site-5c946.firebasestorage.app",messagingSenderId:"1030715238547",appId:"1:1030715238547:web:84e73751e15b0e26e84566",measurementId:"G-7WC5XS8LJD"},Qg=VE(S4);Jg(Qg);const Ad=pL(Qg);w4(Qg);const C4={__name:"PageViews",setup(n){const e=$e(0);let t=null;const r=kg(Ad,"pageViews","main"),s=()=>{const o=localStorage.getItem("page_view_date"),a=new Date().toISOString().split("T")[0];return o===a},i=()=>{const o=new Date().toISOString().split("T")[0];localStorage.setItem("page_view_date",o)};return Ar(async()=>{t=bS(r,o=>{o.exists()&&(e.value=o.data().count??0)}),s()||(await ML(r,{count:OL(1)}),i())}),Gh(()=>{t&&t()}),(o,a)=>(we(),Ce("div",null,[W("p",null,""+it(e.value),1)]))}},A4={class:"home"},I4={__name:"Home",setup(n){const e=[{categories:[{title:"",desc:""},{title:"",desc:""},{title:"",desc:""},{title:"",desc:""}]}],t=[{target:"",categories:[{name:"",items:["","","","",""]},{name:"",items:["","",""]},{name:"",items:["","","",""]}]},{target:"",categories:[{name:"",items:["","","",""]},{name:"",items:["",""]},{name:"",items:["","","",""]}]},{target:"",categories:[{name:"",items:["",""]},{name:"",items:["","",""]}]}];return(r,s)=>(we(),Ce("div",A4,[s[0]||(s[0]=W("section",{class:"home-header"},[W("div",{class:"logo"},[W("img",{class:"img",src:dP})]),W("div",{class:"logo-desc"},[W("p",null,[W("b",null,"It is our moments of struggle that define us. How we handle them is what matters."),hr(),W("br"),hr(" President Allan Trumbull"),W("span",null,"Angel has Fallen")]),W("p",null,[hr(""),W("br"),hr(""),W("span",null,"3")])])],-1)),ke(AP),ke(k_,{title:"",infoList:e,twoCol:!0}),ke(k_,{title:"",infoList:t}),ke(FP,{title:""}),ke(C4)]))}},k4=zt(I4,[["__scopeId","data-v-e893f9d4"]]),R4={class:"btn"},x4={__name:"BackBtn",setup(n){const e=rd(),t=()=>{e.back()};return(r,s)=>(we(),Ce("div",R4,[W("button",{class:"back-btn",onClick:t},"   ")]))}},cc=zt(x4,[["__scopeId","data-v-13e8da75"]]),M4={class:"post-card"},P4={class:"date"},N4={__name:"PostCard",props:{post:Object},setup(n){return(e,t)=>{const r=Tu("router-link");return we(),Ce("div",M4,[W("h2",null,[ke(r,{to:`/news/${n.post.id}`,class:"title"},{default:Ns(()=>[hr(it(n.post.title),1)]),_:1},8,["to"])]),W("p",P4,it(n.post.date),1),W("p",null,it(n.post.summary),1)])}}},O4=zt(N4,[["__scopeId","data-v-d1950569"]]);/*!
 * pinia v3.0.3
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let aC;const Id=n=>aC=n,lC=Symbol();function Qp(n){return n&&typeof n=="object"&&Object.prototype.toString.call(n)==="[object Object]"&&typeof n.toJSON!="function"}var il;(function(n){n.direct="direct",n.patchObject="patch object",n.patchFunction="patch function"})(il||(il={}));function D4(){const n=a1(!0),e=n.run(()=>$e({}));let t=[],r=[];const s=zh({install(i){Id(s),s._a=i,i.provide(lC,s),i.config.globalProperties.$pinia=s,r.forEach(o=>t.push(o)),r=[]},use(i){return this._a?t.push(i):r.push(i),this},_p:t,_a:null,_e:n,_s:new Map,state:e});return s}const cC=()=>{};function dw(n,e,t,r=cC){n.push(e);const s=()=>{const i=n.indexOf(e);i>-1&&(n.splice(i,1),r())};return!t&&l1()&&Uk(s),s}function fo(n,...e){n.slice().forEach(t=>{t(...e)})}const L4=n=>n(),fw=Symbol(),Nf=Symbol();function Yp(n,e){n instanceof Map&&e instanceof Map?e.forEach((t,r)=>n.set(r,t)):n instanceof Set&&e instanceof Set&&e.forEach(n.add,n);for(const t in e){if(!e.hasOwnProperty(t))continue;const r=e[t],s=n[t];Qp(s)&&Qp(r)&&n.hasOwnProperty(t)&&!ot(r)&&!Bs(r)?n[t]=Yp(s,r):n[t]=r}return n}const V4=Symbol();function F4(n){return!Qp(n)||!Object.prototype.hasOwnProperty.call(n,V4)}const{assign:_s}=Object;function B4(n){return!!(ot(n)&&n.effect)}function $4(n,e,t,r){const{state:s,actions:i,getters:o}=e,a=t.state.value[n];let l;function c(){a||(t.state.value[n]=s?s():{});const u=hR(t.state.value[n]);return _s(u,i,Object.keys(o||{}).reduce((h,f)=>(h[f]=zh(un(()=>{Id(t);const p=t._s.get(n);return o[f].call(p,p)})),h),{}))}return l=uC(n,c,e,t,r,!0),l}function uC(n,e,t={},r,s,i){let o;const a=_s({actions:{}},t),l={deep:!0};let c,u,h=[],f=[],p;const m=r.state.value[n];!i&&!m&&(r.state.value[n]={}),$e({});let y;function v(w){let b;c=u=!1,typeof w=="function"?(w(r.state.value[n]),b={type:il.patchFunction,storeId:n,events:p}):(Yp(r.state.value[n],w),b={type:il.patchObject,payload:w,storeId:n,events:p});const I=y=Symbol();jh().then(()=>{y===I&&(c=!0)}),u=!0,fo(h,b,r.state.value[n])}const T=i?function(){const{state:b}=t,I=b?b():{};this.$patch(R=>{_s(R,I)})}:cC;function M(){o.stop(),h=[],f=[],r._s.delete(n)}const P=(w,b="")=>{if(fw in w)return w[Nf]=b,w;const I=function(){Id(r);const R=Array.from(arguments),k=[],C=[];function _e(fe){k.push(fe)}function Ae(fe){C.push(fe)}fo(f,{args:R,name:I[Nf],store:L,after:_e,onError:Ae});let Re;try{Re=w.apply(this&&this.$id===n?this:L,R)}catch(fe){throw fo(C,fe),fe}return Re instanceof Promise?Re.then(fe=>(fo(k,fe),fe)).catch(fe=>(fo(C,fe),Promise.reject(fe))):(fo(k,Re),Re)};return I[fw]=!0,I[Nf]=b,I},D={_p:r,$id:n,$onAction:dw.bind(null,f),$patch:v,$reset:T,$subscribe(w,b={}){const I=dw(h,w,b.detached,()=>R()),R=o.run(()=>Po(()=>r.state.value[n],k=>{(b.flush==="sync"?u:c)&&w({storeId:n,type:il.direct,events:p},k)},_s({},l,b)));return I},$dispose:M},L=Gl(D);r._s.set(n,L);const S=(r._a&&r._a.runWithContext||L4)(()=>r._e.run(()=>(o=a1()).run(()=>e({action:P}))));for(const w in S){const b=S[w];if(ot(b)&&!B4(b)||Bs(b))i||(m&&F4(b)&&(ot(b)?b.value=m[w]:Yp(b,m[w])),r.state.value[n][w]=b);else if(typeof b=="function"){const I=P(b,w);S[w]=I,a.actions[w]=b}}return _s(L,S),_s(Le(L),S),Object.defineProperty(L,"$state",{get:()=>r.state.value[n],set:w=>{v(b=>{_s(b,w)})}}),r._p.forEach(w=>{_s(L,o.run(()=>w({store:L,app:r._a,pinia:r,options:a})))}),m&&i&&t.hydrate&&t.hydrate(L.$state,m),c=!0,u=!0,L}/*! #__NO_SIDE_EFFECTS__ */function U4(n,e,t){let r;const s=typeof e=="function";r=s?t:e;function i(o,a){const l=qR();return o=o||(l?Vn(lC,null):null),o&&Id(o),o=aC,o._s.has(n)||(s?uC(n,e,r,o):$4(n,r,o)),o._s.get(n)}return i.$id=n,i}const hC=U4("posts",{state:()=>({posts:[],loaded:!1}),actions:{async fetchPosts(){if(this.loaded)return;const i=await(await fetch("https://sheets.googleapis.com/v4/spreadsheets/1DNYhoy2vsUD8Q8ASWpyD4VcHCAcvq5SeLs0SPYu44es/values/sheet1?key=AIzaSyDiTcvxQ6OQcpfP8RuWnJBSfO1DXpZn93c")).json();this.posts=i.values.slice(1).reverse().map((o,a)=>({id:a+1,title:o[0],summary:o[1],content:o[2],date:o[3],img:o[4]})),this.loaded=!0}}}),z4={class:"container"},H4={__name:"News",setup(n){const e=hC();return Ar(()=>{e.fetchPosts()}),(t,r)=>(we(),Ce("div",null,[ke(cc),W("div",z4,[r[0]||(r[0]=W("h1",null,"",-1)),(we(!0),Ce(Xt,null,Ga(qe(e).posts,s=>(we(),Yh(O4,{key:s.id,post:s},null,8,["post"]))),128))])]))}},j4=zt(H4,[["__scopeId","data-v-d97a21f6"]]),W4="/accounting-site/assets/article-img-001-BSNCPfqR.jpg",q4="/accounting-site/assets/gpt-img-WYr3Xaz-.png",K4={key:0,class:"post"},G4={class:"container"},J4={class:"date"},Q4={key:0,class:"img-inside"},Y4=["src"],X4={__name:"Post",setup(n){const e=Xm(),t=hC();Ar(()=>{t.fetchPosts()});const r=un(()=>t.posts.find(i=>i.id===Number(e.params.id)));function s(i){return new URL(Object.assign({"../assets/article-images/article-img-001.jpg":W4,"../assets/article-images/gpt-img.png":q4})[`../assets/article-images/${i}`],import.meta.url).href}return(i,o)=>(we(),Ce("div",null,[ke(cc),qe(r)?(we(),Ce("div",K4,[W("div",G4,[W("h2",null,it(qe(r).title),1),W("p",J4,it(qe(r).date),1),W("pre",null,it(qe(r).content),1),qe(r).img?(we(),Ce("div",Q4,[W("img",{src:s(qe(r).img),class:"img"},null,8,Y4)])):br("",!0)])])):br("",!0)]))}},Z4=zt(X4,[["__scopeId","data-v-f8001e87"]]),e5={key:0,class:"toast-overlay"},t5={class:"toast-modal"},n5={__name:"Toast",props:{message:{type:String,required:!0},visible:{type:Boolean,default:!1}},emits:["update:visible"],setup(n,{emit:e}){const t=n,r=e,s=$e(t.visible);Po(()=>t.visible,o=>{s.value=o});const i=()=>{s.value=!1,r("update:visible",!1)};return(o,a)=>(we(),Yh(uE,{name:"fade"},{default:Ns(()=>[s.value?(we(),Ce("div",e5,[W("div",t5,[W("p",null,it(n.message),1),W("button",{onClick:i},"OK")])])):br("",!0)]),_:1}))}},dC=zt(n5,[["__scopeId","data-v-6a803a6b"]]);function Dt(n){this.content=n}Dt.prototype={constructor:Dt,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var r=t&&t!=n?this.remove(t):this,s=r.find(n),i=r.content.slice();return s==-1?i.push(t||n,e):(i[s+1]=e,t&&(i[s]=t)),new Dt(i)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new Dt(t)},addToStart:function(n,e){return new Dt([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new Dt(t)},addBefore:function(n,e,t){var r=this.remove(e),s=r.content.slice(),i=r.find(n);return s.splice(i==-1?s.length:i,0,e,t),new Dt(s)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=Dt.from(n),n.size?new Dt(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=Dt.from(n),n.size?new Dt(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=Dt.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};Dt.from=function(n){if(n instanceof Dt)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new Dt(e)};function fC(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let s=n.child(r),i=e.child(r);if(s==i){t+=s.nodeSize;continue}if(!s.sameMarkup(i))return t;if(s.isText&&s.text!=i.text){for(let o=0;s.text[o]==i.text[o];o++)t++;return t}if(s.content.size||i.content.size){let o=fC(s.content,i.content,t+1);if(o!=null)return o}t+=s.nodeSize}}function pC(n,e,t,r){for(let s=n.childCount,i=e.childCount;;){if(s==0||i==0)return s==i?null:{a:t,b:r};let o=n.child(--s),a=e.child(--i),l=o.nodeSize;if(o==a){t-=l,r-=l;continue}if(!o.sameMarkup(a))return{a:t,b:r};if(o.isText&&o.text!=a.text){let c=0,u=Math.min(o.text.length,a.text.length);for(;c<u&&o.text[o.text.length-c-1]==a.text[a.text.length-c-1];)c++,t--,r--;return{a:t,b:r}}if(o.content.size||a.content.size){let c=pC(o.content,a.content,t-1,r-1);if(c)return c}t-=l,r-=l}}class H{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,s=0,i){for(let o=0,a=0;a<t;o++){let l=this.content[o],c=a+l.nodeSize;if(c>e&&r(l,s+a,i||null,o)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,t-u),r,s+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,s){let i="",o=!0;return this.nodesBetween(e,t,(a,l)=>{let c=a.isText?a.text.slice(Math.max(e,l)-l,t-l):a.isLeaf?s?typeof s=="function"?s(a):s:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&c||a.isTextblock)&&r&&(o?o=!1:i+=r),i+=c},0),i}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,s=this.content.slice(),i=0;for(t.isText&&t.sameMarkup(r)&&(s[s.length-1]=t.withText(t.text+r.text),i=1);i<e.content.length;i++)s.push(e.content[i]);return new H(s,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],s=0;if(t>e)for(let i=0,o=0;o<t;i++){let a=this.content[i],l=o+a.nodeSize;l>e&&((o<e||l>t)&&(a.isText?a=a.cut(Math.max(0,e-o),Math.min(a.text.length,t-o)):a=a.cut(Math.max(0,e-o-1),Math.min(a.content.size,t-o-1))),r.push(a),s+=a.nodeSize),o=l}return new H(r,s)}cutByIndex(e,t){return e==t?H.empty:e==0&&t==this.content.length?this:new H(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let s=this.content.slice(),i=this.size+t.nodeSize-r.nodeSize;return s[e]=t,new H(s,i)}addToStart(e){return new H([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new H(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let s=this.content[t];e(s,r,t),r+=s.nodeSize}}findDiffStart(e,t=0){return fC(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return pC(this,e,t,r)}findIndex(e){if(e==0)return Dc(0,e);if(e==this.size)return Dc(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let t=0,r=0;;t++){let s=this.child(t),i=r+s.nodeSize;if(i>=e)return i==e?Dc(t+1,i):Dc(t,r);r=i}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return H.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new H(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return H.empty;let t,r=0;for(let s=0;s<e.length;s++){let i=e[s];r+=i.nodeSize,s&&i.isText&&e[s-1].sameMarkup(i)?(t||(t=e.slice(0,s)),t[t.length-1]=i.withText(t[t.length-1].text+i.text)):t&&t.push(i)}return new H(t||e,r)}static from(e){if(!e)return H.empty;if(e instanceof H)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new H([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}H.empty=new H([],0);const Of={index:0,offset:0};function Dc(n,e){return Of.index=n,Of.offset=e,Of}function Ku(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!Ku(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!Ku(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}let Ge=class Xp{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let s=0;s<e.length;s++){let i=e[s];if(this.eq(i))return e;if(this.type.excludes(i.type))t||(t=e.slice(0,s));else{if(i.type.excludes(this.type))return e;!r&&i.type.rank>this.type.rank&&(t||(t=e.slice(0,s)),t.push(this),r=!0),t&&t.push(i)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Ku(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);let s=r.create(t.attrs);return r.checkAttrs(s.attrs),s}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return Xp.none;if(e instanceof Xp)return[e];let t=e.slice();return t.sort((r,s)=>r.type.rank-s.type.rank),t}};Ge.none=[];class Gu extends Error{}class X{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=gC(this.content,e+this.openStart,t);return r&&new X(r,this.openStart,this.openEnd)}removeBetween(e,t){return new X(mC(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return X.empty;let r=t.openStart||0,s=t.openEnd||0;if(typeof r!="number"||typeof s!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new X(H.fromJSON(e,t.content),r,s)}static maxOpen(e,t=!0){let r=0,s=0;for(let i=e.firstChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.firstChild)r++;for(let i=e.lastChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.lastChild)s++;return new X(e,r,s)}}X.empty=new X(H.empty,0,0);function mC(n,e,t){let{index:r,offset:s}=n.findIndex(e),i=n.maybeChild(r),{index:o,offset:a}=n.findIndex(t);if(s==e||i.isText){if(a!=t&&!n.child(o).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=o)throw new RangeError("Removing non-flat range");return n.replaceChild(r,i.copy(mC(i.content,e-s-1,t-s-1)))}function gC(n,e,t,r){let{index:s,offset:i}=n.findIndex(e),o=n.maybeChild(s);if(i==e||o.isText)return r&&!r.canReplace(s,s,t)?null:n.cut(0,e).append(t).append(n.cut(e));let a=gC(o.content,e-i-1,t,o);return a&&n.replaceChild(s,o.copy(a))}function r5(n,e,t){if(t.openStart>n.depth)throw new Gu("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new Gu("Inconsistent open depths");return yC(n,e,t,0)}function yC(n,e,t,r){let s=n.index(r),i=n.node(r);if(s==e.index(r)&&r<n.depth-t.openStart){let o=yC(n,e,t,r+1);return i.copy(i.content.replaceChild(s,o))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let o=n.parent,a=o.content;return Fi(o,a.cut(0,n.parentOffset).append(t.content).append(a.cut(e.parentOffset)))}else{let{start:o,end:a}=s5(t,n);return Fi(i,vC(n,o,a,e,r))}else return Fi(i,Ju(n,e,r))}function _C(n,e){if(!e.type.compatibleContent(n.type))throw new Gu("Cannot join "+e.type.name+" onto "+n.type.name)}function Zp(n,e,t){let r=n.node(t);return _C(r,e.node(t)),r}function Vi(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function ol(n,e,t,r){let s=(e||n).node(t),i=0,o=e?e.index(t):s.childCount;n&&(i=n.index(t),n.depth>t?i++:n.textOffset&&(Vi(n.nodeAfter,r),i++));for(let a=i;a<o;a++)Vi(s.child(a),r);e&&e.depth==t&&e.textOffset&&Vi(e.nodeBefore,r)}function Fi(n,e){return n.type.checkContent(e),n.copy(e)}function vC(n,e,t,r,s){let i=n.depth>s&&Zp(n,e,s+1),o=r.depth>s&&Zp(t,r,s+1),a=[];return ol(null,n,s,a),i&&o&&e.index(s)==t.index(s)?(_C(i,o),Vi(Fi(i,vC(n,e,t,r,s+1)),a)):(i&&Vi(Fi(i,Ju(n,e,s+1)),a),ol(e,t,s,a),o&&Vi(Fi(o,Ju(t,r,s+1)),a)),ol(r,null,s,a),new H(a)}function Ju(n,e,t){let r=[];if(ol(null,n,t,r),n.depth>t){let s=Zp(n,e,t+1);Vi(Fi(s,Ju(n,e,t+1)),r)}return ol(e,null,t,r),new H(r)}function s5(n,e){let t=e.depth-n.openStart,s=e.node(t).copy(n.content);for(let i=t-1;i>=0;i--)s=e.node(i).copy(H.from(s));return{start:s.resolveNoCache(n.openStart+t),end:s.resolveNoCache(s.content.size-n.openEnd-t)}}class Vl{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],s=e.child(t);return r?e.child(t).cut(r):s}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],s=t==0?0:this.path[t*3-1]+1;for(let i=0;i<e;i++)s+=r.child(i).nodeSize;return s}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return Ge.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),s=e.maybeChild(t);if(!r){let a=r;r=s,s=a}let i=r.marks;for(var o=0;o<i.length;o++)i[o].type.spec.inclusive===!1&&(!s||!i[o].isInSet(s.marks))&&(i=i[o--].removeFromSet(i));return i}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,s=e.parent.maybeChild(e.index());for(var i=0;i<r.length;i++)r[i].type.spec.inclusive===!1&&(!s||!r[i].isInSet(s.marks))&&(r=r[i--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new Qu(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],s=0,i=t;for(let o=e;;){let{index:a,offset:l}=o.content.findIndex(i),c=i-l;if(r.push(o,a,s+l),!c||(o=o.child(a),o.isText))break;i=c-1,s+=l+1}return new Vl(t,r,i)}static resolveCached(e,t){let r=pw.get(e);if(r)for(let i=0;i<r.elts.length;i++){let o=r.elts[i];if(o.pos==t)return o}else pw.set(e,r=new i5);let s=r.elts[r.i]=Vl.resolve(e,t);return r.i=(r.i+1)%o5,s}}class i5{constructor(){this.elts=[],this.i=0}}const o5=12,pw=new WeakMap;class Qu{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const a5=Object.create(null);class Jn{constructor(e,t,r,s=Ge.none){this.type=e,this.attrs=t,this.marks=s,this.content=r||H.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,s=0){this.content.nodesBetween(e,t,r,s,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,s){return this.content.textBetween(e,t,r,s)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&Ku(this.attrs,t||e.defaultAttrs||a5)&&Ge.sameSet(this.marks,r||Ge.none)}copy(e=null){return e==this.content?this:new Jn(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Jn(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return X.empty;let s=this.resolve(e),i=this.resolve(t),o=r?0:s.sharedDepth(t),a=s.start(o),c=s.node(o).content.cut(s.pos-a,i.pos-a);return new X(c,s.depth-o,i.depth-o)}replace(e,t,r){return r5(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:s}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(s==e||t.isText)return t;e-=s+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let s=this.content.child(t-1);return{node:s,index:t-1,offset:r-s.nodeSize}}resolve(e){return Vl.resolveCached(this,e)}resolveNoCache(e){return Vl.resolve(this,e)}rangeHasMark(e,t,r){let s=!1;return t>e&&this.nodesBetween(e,t,i=>(r.isInSet(i.marks)&&(s=!0),!s)),s}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),wC(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=H.empty,s=0,i=r.childCount){let o=this.contentMatchAt(e).matchFragment(r,s,i),a=o&&o.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(let l=s;l<i;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,t,r,s){if(s&&!this.type.allowsMarks(s))return!1;let i=this.contentMatchAt(e).matchType(r),o=i&&i.matchFragment(this.content,t);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Ge.none;for(let t=0;t<this.marks.length;t++){let r=this.marks[t];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!Ge.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let s=H.fromJSON(e,t.content),i=e.nodeType(t.type).create(t.attrs,s,r);return i.type.checkAttrs(i.attrs),i}}Jn.prototype.text=void 0;class Yu extends Jn{constructor(e,t,r,s){if(super(e,t,null,s),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):wC(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Yu(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Yu(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function wC(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class Ki{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new l5(e,t);if(r.next==null)return Ki.empty;let s=bC(r);r.next&&r.err("Unexpected trailing text");let i=m5(p5(s));return g5(i,r),i}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let s=this;for(let i=t;s&&i<r;i++)s=s.matchType(e.child(i).type);return s}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let s=[this];function i(o,a){let l=o.matchFragment(e,r);if(l&&(!t||l.validEnd))return H.from(a.map(c=>c.createAndFill()));for(let c=0;c<o.next.length;c++){let{type:u,next:h}=o.next[c];if(!(u.isText||u.hasRequiredAttrs())&&s.indexOf(h)==-1){s.push(h);let f=i(h,a.concat(u));if(f)return f}}return null}return i(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let s=r.shift(),i=s.match;if(i.matchType(e)){let o=[];for(let a=s;a.type;a=a.via)o.push(a.type);return o.reverse()}for(let o=0;o<i.next.length;o++){let{type:a,next:l}=i.next[o];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in t)&&(!s.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:s}),t[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(r){e.push(r);for(let s=0;s<r.next.length;s++)e.indexOf(r.next[s].next)==-1&&t(r.next[s].next)}return t(this),e.map((r,s)=>{let i=s+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)i+=(o?", ":"")+r.next[o].type.name+"->"+e.indexOf(r.next[o].next);return i}).join(`
`)}}Ki.empty=new Ki(!0);class l5{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function bC(n){let e=[];do e.push(c5(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function c5(n){let e=[];do e.push(u5(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function u5(n){let e=f5(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=h5(n,e);else break;return e}function mw(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function h5(n,e){let t=mw(n),r=t;return n.eat(",")&&(n.next!="}"?r=mw(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:r,expr:e}}function d5(n,e){let t=n.nodeTypes,r=t[e];if(r)return[r];let s=[];for(let i in t){let o=t[i];o.isInGroup(e)&&s.push(o)}return s.length==0&&n.err("No node type or group '"+e+"' found"),s}function f5(n){if(n.eat("(")){let e=bC(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=d5(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function p5(n){let e=[[]];return s(i(n,0),t()),e;function t(){return e.push([])-1}function r(o,a,l){let c={term:l,to:a};return e[o].push(c),c}function s(o,a){o.forEach(l=>l.to=a)}function i(o,a){if(o.type=="choice")return o.exprs.reduce((l,c)=>l.concat(i(c,a)),[]);if(o.type=="seq")for(let l=0;;l++){let c=i(o.exprs[l],a);if(l==o.exprs.length-1)return c;s(c,a=t())}else if(o.type=="star"){let l=t();return r(a,l),s(i(o.expr,l),l),[r(l)]}else if(o.type=="plus"){let l=t();return s(i(o.expr,a),l),s(i(o.expr,l),l),[r(l)]}else{if(o.type=="opt")return[r(a)].concat(i(o.expr,a));if(o.type=="range"){let l=a;for(let c=0;c<o.min;c++){let u=t();s(i(o.expr,l),u),l=u}if(o.max==-1)s(i(o.expr,l),l);else for(let c=o.min;c<o.max;c++){let u=t();r(l,u),s(i(o.expr,l),u),l=u}return[r(l)]}else{if(o.type=="name")return[r(a,void 0,o.value)];throw new Error("Unknown expr type")}}}}function EC(n,e){return e-n}function gw(n,e){let t=[];return r(e),t.sort(EC);function r(s){let i=n[s];if(i.length==1&&!i[0].term)return r(i[0].to);t.push(s);for(let o=0;o<i.length;o++){let{term:a,to:l}=i[o];!a&&t.indexOf(l)==-1&&r(l)}}}function m5(n){let e=Object.create(null);return t(gw(n,0));function t(r){let s=[];r.forEach(o=>{n[o].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let u=0;u<s.length;u++)s[u][0]==a&&(c=s[u][1]);gw(n,l).forEach(u=>{c||s.push([a,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let i=e[r.join(",")]=new Ki(r.indexOf(n.length-1)>-1);for(let o=0;o<s.length;o++){let a=s[o][1].sort(EC);i.next.push({type:s[o][0],next:e[a.join(",")]||t(a)})}return i}}function g5(n,e){for(let t=0,r=[n];t<r.length;t++){let s=r[t],i=!s.validEnd,o=[];for(let a=0;a<s.next.length;a++){let{type:l,next:c}=s.next[a];o.push(l.name),i&&!(l.isText||l.hasRequiredAttrs())&&(i=!1),r.indexOf(c)==-1&&r.push(c)}i&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function TC(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function SC(n,e){let t=Object.create(null);for(let r in n){let s=e&&e[r];if(s===void 0){let i=n[r];if(i.hasDefault)s=i.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=s}return t}function CC(n,e,t,r){for(let s in e)if(!(s in n))throw new RangeError(`Unsupported attribute ${s} for ${t} of type ${s}`);for(let s in n){let i=n[s];i.validate&&i.validate(e[s])}}function AC(n,e){let t=Object.create(null);if(e)for(let r in e)t[r]=new _5(n,r,e[r]);return t}let yw=class IC{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=AC(e,r.attrs),this.defaultAttrs=TC(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Ki.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:SC(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Jn(this,this.computeAttrs(e),H.from(t),Ge.setFrom(r))}createChecked(e=null,t,r){return t=H.from(t),this.checkContent(t),new Jn(this,this.computeAttrs(e),t,Ge.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),t=H.from(t),t.size){let o=this.contentMatch.fillBefore(t);if(!o)return null;t=o.append(t)}let s=this.contentMatch.matchFragment(t),i=s&&s.fillBefore(H.empty,!0);return i?new Jn(this,e,t.append(i),Ge.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){CC(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:Ge.none:e}static compile(e,t){let r=Object.create(null);e.forEach((i,o)=>r[i]=new IC(i,t,o));let s=t.spec.topNode||"doc";if(!r[s])throw new RangeError("Schema is missing its top node type ('"+s+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let i in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function y5(n,e,t){let r=t.split("|");return s=>{let i=s===null?"null":typeof s;if(r.indexOf(i)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${n}, got ${i}`)}}class _5{constructor(e,t,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?y5(e,t,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class kd{constructor(e,t,r,s){this.name=e,this.rank=t,this.schema=r,this.spec=s,this.attrs=AC(e,s.attrs),this.excluded=null;let i=TC(this.attrs);this.instance=i?new Ge(this,i):null}create(e=null){return!e&&this.instance?this.instance:new Ge(this,SC(this.attrs,e))}static compile(e,t){let r=Object.create(null),s=0;return e.forEach((i,o)=>r[i]=new kd(i,s++,t,o)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){CC(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class kC{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let s in e)t[s]=e[s];t.nodes=Dt.from(e.nodes),t.marks=Dt.from(e.marks||{}),this.nodes=yw.compile(this.spec.nodes,this),this.marks=kd.compile(this.spec.marks,this);let r=Object.create(null);for(let s in this.nodes){if(s in this.marks)throw new RangeError(s+" can not be both a node and a mark");let i=this.nodes[s],o=i.spec.content||"",a=i.spec.marks;if(i.contentMatch=r[o]||(r[o]=Ki.parse(o,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!i.isInline||!i.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=i}i.markSet=a=="_"?null:a?_w(this,a.split(" ")):a==""||!i.inlineContent?[]:null}for(let s in this.marks){let i=this.marks[s],o=i.spec.excludes;i.excluded=o==null?[i]:o==""?[]:_w(this,o.split(" "))}this.nodeFromJSON=s=>Jn.fromJSON(this,s),this.markFromJSON=s=>Ge.fromJSON(this,s),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,s){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof yw){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,s)}text(e,t){let r=this.nodes.text;return new Yu(r,r.defaultAttrs,e,Ge.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function _w(n,e){let t=[];for(let r=0;r<e.length;r++){let s=e[r],i=n.marks[s],o=i;if(i)t.push(i);else for(let a in n.marks){let l=n.marks[a];(s=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(s)>-1)&&t.push(o=l)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return t}function v5(n){return n.tag!=null}function w5(n){return n.style!=null}class qs{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let r=this.matchedStyles=[];t.forEach(s=>{if(v5(s))this.tags.push(s);else if(w5(s)){let i=/[^=]*/.exec(s.style)[0];r.indexOf(i)<0&&r.push(i),this.styles.push(s)}}),this.normalizeLists=!this.tags.some(s=>{if(!/^(ul|ol)\b/.test(s.tag)||!s.node)return!1;let i=e.nodes[s.node];return i.contentMatch.matchType(i)})}parse(e,t={}){let r=new ww(this,t,!1);return r.addAll(e,Ge.none,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new ww(this,t,!0);return r.addAll(e,Ge.none,t.from,t.to),X.maxOpen(r.finish())}matchTag(e,t,r){for(let s=r?this.tags.indexOf(r)+1:0;s<this.tags.length;s++){let i=this.tags[s];if(T5(e,i.tag)&&(i.namespace===void 0||e.namespaceURI==i.namespace)&&(!i.context||t.matchesContext(i.context))){if(i.getAttrs){let o=i.getAttrs(e);if(o===!1)continue;i.attrs=o||void 0}return i}}}matchStyle(e,t,r,s){for(let i=s?this.styles.indexOf(s)+1:0;i<this.styles.length;i++){let o=this.styles[i],a=o.style;if(!(a.indexOf(e)!=0||o.context&&!r.matchesContext(o.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=t))){if(o.getAttrs){let l=o.getAttrs(t);if(l===!1)continue;o.attrs=l||void 0}return o}}}static schemaRules(e){let t=[];function r(s){let i=s.priority==null?50:s.priority,o=0;for(;o<t.length;o++){let a=t[o];if((a.priority==null?50:a.priority)<i)break}t.splice(o,0,s)}for(let s in e.marks){let i=e.marks[s].spec.parseDOM;i&&i.forEach(o=>{r(o=bw(o)),o.mark||o.ignore||o.clearMark||(o.mark=s)})}for(let s in e.nodes){let i=e.nodes[s].spec.parseDOM;i&&i.forEach(o=>{r(o=bw(o)),o.node||o.ignore||o.mark||(o.node=s)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new qs(e,qs.schemaRules(e)))}}const RC={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},b5={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},xC={ol:!0,ul:!0},Fl=1,em=2,al=4;function vw(n,e,t){return e!=null?(e?Fl:0)|(e==="full"?em:0):n&&n.whitespace=="pre"?Fl|em:t&~al}class Lc{constructor(e,t,r,s,i,o){this.type=e,this.attrs=t,this.marks=r,this.solid=s,this.options=o,this.content=[],this.activeMarks=Ge.none,this.match=i||(o&al?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(H.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,s;return(s=r.findWrapping(e.type))?(this.match=r,s):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Fl)){let r=this.content[this.content.length-1],s;if(r&&r.isText&&(s=/[ \t\r\n\u000c]+$/.exec(r.text))){let i=r;r.text.length==s[0].length?this.content.pop():this.content[this.content.length-1]=i.withText(i.text.slice(0,i.text.length-s[0].length))}}let t=H.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(H.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!RC.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class ww{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let s=t.topNode,i,o=vw(null,t.preserveWhitespace,0)|(r?al:0);s?i=new Lc(s.type,s.attrs,Ge.none,!0,t.topMatch||s.type.contentMatch,o):r?i=new Lc(null,null,Ge.none,!0,null,o):i=new Lc(e.schema.topNodeType,null,Ge.none,!0,null,o),this.nodes=[i],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){e.nodeType==3?this.addTextNode(e,t):e.nodeType==1&&this.addElement(e,t)}addTextNode(e,t){let r=e.nodeValue,s=this.top,i=s.options&em?"full":this.localPreserveWS||(s.options&Fl)>0,{schema:o}=this.parser;if(i==="full"||s.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(i)if(i==="full")r=r.replace(/\r\n?/g,`
`);else if(o.linebreakReplacement&&/[\r\n]/.test(r)&&this.top.findWrapping(o.linebreakReplacement.create())){let a=r.split(/\r?\n|\r/);for(let l=0;l<a.length;l++)l&&this.insertNode(o.linebreakReplacement.create(),t,!0),a[l]&&this.insertNode(o.text(a[l]),t,!/\S/.test(a[l]));r=""}else r=r.replace(/\r?\n|\r/g," ");else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let a=s.content[s.content.length-1],l=e.previousSibling;(!a||l&&l.nodeName=="BR"||a.isText&&/[ \t\r\n\u000c]$/.test(a.text))&&(r=r.slice(1))}r&&this.insertNode(o.text(r),t,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,t,r){let s=this.localPreserveWS,i=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let o=e.nodeName.toLowerCase(),a;xC.hasOwnProperty(o)&&this.parser.normalizeLists&&E5(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(a=this.parser.matchTag(e,this,r));e:if(l?l.ignore:b5.hasOwnProperty(o))this.findInside(e),this.ignoreFallback(e,t);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let c,u=this.needsBlock;if(RC.hasOwnProperty(o))i.content.length&&i.content[0].isInline&&this.open&&(this.open--,i=this.top),c=!0,i.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let h=l&&l.skip?t:this.readStyles(e,t);h&&this.addAll(e,h),c&&this.sync(i),this.needsBlock=u}else{let c=this.readStyles(e,t);c&&this.addElementByRule(e,l,c,l.consuming===!1?a:void 0)}this.localPreserveWS=s}leafFallback(e,t){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),t)}ignoreFallback(e,t){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),t,!0)}readStyles(e,t){let r=e.style;if(r&&r.length)for(let s=0;s<this.parser.matchedStyles.length;s++){let i=this.parser.matchedStyles[s],o=r.getPropertyValue(i);if(o)for(let a=void 0;;){let l=this.parser.matchStyle(i,o,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?t=t.filter(c=>!l.clearMark(c)):t=t.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)a=l;else break}}return t}addElementByRule(e,t,r,s){let i,o;if(t.node)if(o=this.parser.schema.nodes[t.node],o.isLeaf)this.insertNode(o.create(t.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let l=this.enter(o,t.attrs||null,r,t.preserveWhitespace);l&&(i=!0,r=l)}else{let l=this.parser.schema.marks[t.mark];r=r.concat(l.create(t.attrs))}let a=this.top;if(o&&o.isLeaf)this.findInside(e);else if(s)this.addElement(e,r,s);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l,r,!1));else{let l=e;typeof t.contentElement=="string"?l=e.querySelector(t.contentElement):typeof t.contentElement=="function"?l=t.contentElement(e):t.contentElement&&(l=t.contentElement),this.findAround(e,l,!0),this.addAll(l,r),this.findAround(e,l,!1)}i&&this.sync(a)&&this.open--}addAll(e,t,r,s){let i=r||0;for(let o=r?e.childNodes[r]:e.firstChild,a=s==null?null:e.childNodes[s];o!=a;o=o.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(o,t);this.findAtPoint(e,i)}findPlace(e,t,r){let s,i;for(let o=this.open,a=0;o>=0;o--){let l=this.nodes[o],c=l.findWrapping(e);if(c&&(!s||s.length>c.length+a)&&(s=c,i=l,!c.length))break;if(l.solid){if(r)break;a+=2}}if(!s)return null;this.sync(i);for(let o=0;o<s.length;o++)t=this.enterInner(s[o],null,t,!1);return t}insertNode(e,t,r){if(e.isInline&&this.needsBlock&&!this.top.type){let i=this.textblockFromContext();i&&(t=this.enterInner(i,null,t))}let s=this.findPlace(e,t,r);if(s){this.closeExtra();let i=this.top;i.match&&(i.match=i.match.matchType(e.type));let o=Ge.none;for(let a of s.concat(e.marks))(i.type?i.type.allowsMarkType(a.type):Ew(a.type,e.type))&&(o=a.addToSet(o));return i.content.push(e.mark(o)),!0}return!1}enter(e,t,r,s){let i=this.findPlace(e.create(t),r,!1);return i&&(i=this.enterInner(e,t,r,!0,s)),i}enterInner(e,t,r,s=!1,i){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(e);let a=vw(e,i,o.options);o.options&al&&o.content.length==0&&(a|=al);let l=Ge.none;return r=r.filter(c=>(o.type?o.type.allowsMarkType(c.type):Ew(c.type,e))?(l=c.addToSet(l),!1):!0),this.nodes.push(new Lc(e,t,l,s,null,a)),this.open++,r}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=Fl)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let s=r.length-1;s>=0;s--)e+=r[s].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let s=0;s<this.find.length;s++)this.find[s].pos==null&&e.nodeType==1&&e.contains(this.find[s].node)&&t.compareDocumentPosition(this.find[s].node)&(r?2:4)&&(this.find[s].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,s=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(s?0:1),o=(a,l)=>{for(;a>=0;a--){let c=t[a];if(c==""){if(a==t.length-1||a==0)continue;for(;l>=i;l--)if(o(a-1,l))return!0;return!1}else{let u=l>0||l==0&&s?this.nodes[l].type:r&&l>=i?r.node(l-i).type:null;if(!u||u.name!=c&&!u.isInGroup(c))return!1;l--}}return!0};return o(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}}function E5(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&xC.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function T5(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function bw(n){let e={};for(let t in n)e[t]=n[t];return e}function Ew(n,e){let t=e.schema.nodes;for(let r in t){let s=t[r];if(!s.allowsMarkType(n))continue;let i=[],o=a=>{i.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==e||i.indexOf(u)<0&&o(u))return!0}};if(o(s.contentMatch))return!0}}class oo{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=Df(t).createDocumentFragment());let s=r,i=[];return e.forEach(o=>{if(i.length||o.marks.length){let a=0,l=0;for(;a<i.length&&l<o.marks.length;){let c=o.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(i[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<i.length;)s=i.pop()[1];for(;l<o.marks.length;){let c=o.marks[l++],u=this.serializeMark(c,o.isInline,t);u&&(i.push([c,s]),s.appendChild(u.dom),s=u.contentDOM||u.dom)}}s.appendChild(this.serializeNodeInner(o,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:s}=hu(Df(t),this.nodes[e.type.name](e),null,e.attrs);if(s){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,s)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let s=e.marks.length-1;s>=0;s--){let i=this.serializeMark(e.marks[s],e.isInline,t);i&&((i.contentDOM||i.dom).appendChild(r),r=i.dom)}return r}serializeMark(e,t,r={}){let s=this.marks[e.type.name];return s&&hu(Df(r),s(e,t),null,e.attrs)}static renderSpec(e,t,r=null,s){return hu(e,t,r,s)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new oo(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=Tw(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return Tw(e.marks)}}function Tw(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function Df(n){return n.document||window.document}const Sw=new WeakMap;function S5(n){let e=Sw.get(n);return e===void 0&&Sw.set(n,e=C5(n)),e}function C5(n){let e=null;function t(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let s=0;s<r.length;s++)t(r[s]);else for(let s in r)t(r[s])}return t(n),e}function hu(n,e,t,r){if(typeof e=="string")return{dom:n.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let s=e[0],i;if(typeof s!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(i=S5(r))&&i.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let o=s.indexOf(" ");o>0&&(t=s.slice(0,o),s=s.slice(o+1));let a,l=t?n.createElementNS(t,s):n.createElement(s),c=e[1],u=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){u=2;for(let h in c)if(c[h]!=null){let f=h.indexOf(" ");f>0?l.setAttributeNS(h.slice(0,f),h.slice(f+1),c[h]):h=="style"&&l.style?l.style.cssText=c[h]:l.setAttribute(h,c[h])}}for(let h=u;h<e.length;h++){let f=e[h];if(f===0){if(h<e.length-1||h>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:p,contentDOM:m}=hu(n,f,t,r);if(l.appendChild(p),m){if(a)throw new RangeError("Multiple content holes");a=m}}}return{dom:l,contentDOM:a}}const MC=65535,PC=Math.pow(2,16);function A5(n,e){return n+e*PC}function Cw(n){return n&MC}function I5(n){return(n-(n&MC))/PC}const NC=1,OC=2,du=4,DC=8;class tm{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&DC)>0}get deletedBefore(){return(this.delInfo&(NC|du))>0}get deletedAfter(){return(this.delInfo&(OC|du))>0}get deletedAcross(){return(this.delInfo&du)>0}}class Tn{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&Tn.empty)return Tn.empty}recover(e){let t=0,r=Cw(e);if(!this.inverted)for(let s=0;s<r;s++)t+=this.ranges[s*3+2]-this.ranges[s*3+1];return this.ranges[r*3]+t+I5(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let s=0,i=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?s:0);if(l>e)break;let c=this.ranges[a+i],u=this.ranges[a+o],h=l+c;if(e<=h){let f=c?e==l?-1:e==h?1:t:t,p=l+s+(f<0?0:u);if(r)return p;let m=e==(t<0?l:h)?null:A5(a/3,e-l),y=e==l?OC:e==h?NC:du;return(t<0?e!=l:e!=h)&&(y|=DC),new tm(p,y,m)}s+=u-c}return r?e+s:new tm(e+s,0,null)}touches(e,t){let r=0,s=Cw(t),i=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+i],u=l+c;if(e<=u&&a==s*3)return!0;r+=this.ranges[a+o]-c}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let s=0,i=0;s<this.ranges.length;s+=3){let o=this.ranges[s],a=o-(this.inverted?i:0),l=o+(this.inverted?0:i),c=this.ranges[s+t],u=this.ranges[s+r];e(a,a+c,l,l+u),i+=u-c}}invert(){return new Tn(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Tn.empty:new Tn(e<0?[0,-e,0]:[0,0,e])}}Tn.empty=new Tn([]);class Bl{constructor(e,t,r=0,s=e?e.length:0){this.mirror=t,this.from=r,this.to=s,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(e=0,t=this.maps.length){return new Bl(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),t!=null&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,r=this._maps.length;t<e._maps.length;t++){let s=e.getMirror(t);this.appendMap(e._maps[t],s!=null&&s<t?r+s:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this._maps.length+e._maps.length;t>=0;t--){let s=e.getMirror(t);this.appendMap(e._maps[t].invert(),s!=null&&s>t?r-s-1:void 0)}}invert(){let e=new Bl;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let s=0;for(let i=this.from;i<this.to;i++){let o=this._maps[i],a=o.mapResult(e,t);if(a.recover!=null){let l=this.getMirror(i);if(l!=null&&l>i&&l<this.to){i=l,e=this._maps[l].recover(a.recover);continue}}s|=a.delInfo,e=a.pos}return r?e:new tm(e,s,null)}}const Lf=Object.create(null);class sn{getMap(){return Tn.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Lf[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Lf)throw new RangeError("Duplicate use of step JSON ID "+e);return Lf[e]=t,t.prototype.jsonID=e,t}}class vt{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new vt(e,null)}static fail(e){return new vt(null,e)}static fromReplace(e,t,r,s){try{return vt.ok(e.replace(t,r,s))}catch(i){if(i instanceof Gu)return vt.fail(i.message);throw i}}}function Yg(n,e,t){let r=[];for(let s=0;s<n.childCount;s++){let i=n.child(s);i.content.size&&(i=i.copy(Yg(i.content,e,i))),i.isInline&&(i=e(i,t,s)),r.push(i)}return H.fromArray(r)}class Ds extends sn{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),s=r.node(r.sharedDepth(this.to)),i=new X(Yg(t.content,(o,a)=>!o.isAtom||!a.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),s),t.openStart,t.openEnd);return vt.fromReplace(e,this.from,this.to,i)}invert(){return new Kn(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Ds(t.pos,r.pos,this.mark)}merge(e){return e instanceof Ds&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Ds(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Ds(t.from,t.to,e.markFromJSON(t.mark))}}sn.jsonID("addMark",Ds);class Kn extends sn{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new X(Yg(t.content,s=>s.mark(this.mark.removeFromSet(s.marks)),e),t.openStart,t.openEnd);return vt.fromReplace(e,this.from,this.to,r)}invert(){return new Ds(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Kn(t.pos,r.pos,this.mark)}merge(e){return e instanceof Kn&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Kn(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Kn(t.from,t.to,e.markFromJSON(t.mark))}}sn.jsonID("removeMark",Kn);class Ls extends sn{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return vt.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return vt.fromReplace(e,this.pos,this.pos+1,new X(H.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let s=0;s<t.marks.length;s++)if(!t.marks[s].isInSet(r))return new Ls(this.pos,t.marks[s]);return new Ls(this.pos,this.mark)}}return new Gi(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Ls(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Ls(t.pos,e.markFromJSON(t.mark))}}sn.jsonID("addNodeMark",Ls);class Gi extends sn{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return vt.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return vt.fromReplace(e,this.pos,this.pos+1,new X(H.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new Ls(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Gi(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Gi(t.pos,e.markFromJSON(t.mark))}}sn.jsonID("removeNodeMark",Gi);class It extends sn{constructor(e,t,r,s=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=s}apply(e){return this.structure&&nm(e,this.from,this.to)?vt.fail("Structure replace would overwrite content"):vt.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Tn([this.from,this.to-this.from,this.slice.size])}invert(e){return new It(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new It(t.pos,Math.max(t.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof It)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?X.empty:new X(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new It(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?X.empty:new X(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new It(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new It(t.from,t.to,X.fromJSON(e,t.slice),!!t.structure)}}sn.jsonID("replace",It);class xt extends sn{constructor(e,t,r,s,i,o,a=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=s,this.slice=i,this.insert=o,this.structure=a}apply(e){if(this.structure&&(nm(e,this.from,this.gapFrom)||nm(e,this.gapTo,this.to)))return vt.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return vt.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?vt.fromReplace(e,this.from,this.to,r):vt.fail("Content does not fit in gap")}getMap(){return new Tn([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new xt(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),s=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),i=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||s<t.pos||i>r.pos?null:new xt(t.pos,r.pos,s,i,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new xt(t.from,t.to,t.gapFrom,t.gapTo,X.fromJSON(e,t.slice),t.insert,!!t.structure)}}sn.jsonID("replaceAround",xt);function nm(n,e,t){let r=n.resolve(e),s=t-e,i=r.depth;for(;s>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,s--;if(s>0){let o=r.node(i).maybeChild(r.indexAfter(i));for(;s>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,s--}}return!1}function k5(n,e,t,r){let s=[],i=[],o,a;n.doc.nodesBetween(e,t,(l,c,u)=>{if(!l.isInline)return;let h=l.marks;if(!r.isInSet(h)&&u.type.allowsMarkType(r.type)){let f=Math.max(c,e),p=Math.min(c+l.nodeSize,t),m=r.addToSet(h);for(let y=0;y<h.length;y++)h[y].isInSet(m)||(o&&o.to==f&&o.mark.eq(h[y])?o.to=p:s.push(o=new Kn(f,p,h[y])));a&&a.to==f?a.to=p:i.push(a=new Ds(f,p,r))}}),s.forEach(l=>n.step(l)),i.forEach(l=>n.step(l))}function R5(n,e,t,r){let s=[],i=0;n.doc.nodesBetween(e,t,(o,a)=>{if(!o.isInline)return;i++;let l=null;if(r instanceof kd){let c=o.marks,u;for(;u=r.isInSet(c);)(l||(l=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(o.marks)&&(l=[r]):l=o.marks;if(l&&l.length){let c=Math.min(a+o.nodeSize,t);for(let u=0;u<l.length;u++){let h=l[u],f;for(let p=0;p<s.length;p++){let m=s[p];m.step==i-1&&h.eq(s[p].style)&&(f=m)}f?(f.to=c,f.step=i):s.push({style:h,from:Math.max(a,e),to:c,step:i})}}}),s.forEach(o=>n.step(new Kn(o.from,o.to,o.style)))}function Xg(n,e,t,r=t.contentMatch,s=!0){let i=n.doc.nodeAt(e),o=[],a=e+1;for(let l=0;l<i.childCount;l++){let c=i.child(l),u=a+c.nodeSize,h=r.matchType(c.type);if(!h)o.push(new It(a,u,X.empty));else{r=h;for(let f=0;f<c.marks.length;f++)t.allowsMarkType(c.marks[f].type)||n.step(new Kn(a,u,c.marks[f]));if(s&&c.isText&&t.whitespace!="pre"){let f,p=/\r?\n|\r/g,m;for(;f=p.exec(c.text);)m||(m=new X(H.from(t.schema.text(" ",t.allowedMarks(c.marks))),0,0)),o.push(new It(a+f.index,a+f.index+f[0].length,m))}}a=u}if(!r.validEnd){let l=r.fillBefore(H.empty,!0);n.replace(a,a,new X(l,0,0))}for(let l=o.length-1;l>=0;l--)n.step(o[l])}function x5(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function ca(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth,s=0,i=0;;--r){let o=n.$from.node(r),a=n.$from.index(r)+s,l=n.$to.indexAfter(r)-i;if(r<n.depth&&o.canReplace(a,l,t))return r;if(r==0||o.type.spec.isolating||!x5(o,a,l))break;a&&(s=1),l<o.childCount&&(i=1)}return null}function M5(n,e,t){let{$from:r,$to:s,depth:i}=e,o=r.before(i+1),a=s.after(i+1),l=o,c=a,u=H.empty,h=0;for(let m=i,y=!1;m>t;m--)y||r.index(m)>0?(y=!0,u=H.from(r.node(m).copy(u)),h++):l--;let f=H.empty,p=0;for(let m=i,y=!1;m>t;m--)y||s.after(m+1)<s.end(m)?(y=!0,f=H.from(s.node(m).copy(f)),p++):c++;n.step(new xt(l,c,o,a,new X(u.append(f),h,p),u.size-h,!0))}function Zg(n,e,t=null,r=n){let s=P5(n,e),i=s&&N5(r,e);return i?s.map(Aw).concat({type:e,attrs:t}).concat(i.map(Aw)):null}function Aw(n){return{type:n,attrs:null}}function P5(n,e){let{parent:t,startIndex:r,endIndex:s}=n,i=t.contentMatchAt(r).findWrapping(e);if(!i)return null;let o=i.length?i[0]:e;return t.canReplaceWith(r,s,o)?i:null}function N5(n,e){let{parent:t,startIndex:r,endIndex:s}=n,i=t.child(r),o=e.contentMatch.findWrapping(i.type);if(!o)return null;let l=(o.length?o[o.length-1]:e).contentMatch;for(let c=r;l&&c<s;c++)l=l.matchType(t.child(c).type);return!l||!l.validEnd?null:o}function O5(n,e,t){let r=H.empty;for(let o=t.length-1;o>=0;o--){if(r.size){let a=t[o].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=H.from(t[o].type.create(t[o].attrs,r))}let s=e.start,i=e.end;n.step(new xt(s,i,s,i,new X(r,0,0),t.length,!0))}function D5(n,e,t,r,s){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=n.steps.length;n.doc.nodesBetween(e,t,(o,a)=>{let l=typeof s=="function"?s(o):s;if(o.isTextblock&&!o.hasMarkup(r,l)&&L5(n.doc,n.mapping.slice(i).map(a),r)){let c=null;if(r.schema.linebreakReplacement){let p=r.whitespace=="pre",m=!!r.contentMatch.matchType(r.schema.linebreakReplacement);p&&!m?c=!1:!p&&m&&(c=!0)}c===!1&&VC(n,o,a,i),Xg(n,n.mapping.slice(i).map(a,1),r,void 0,c===null);let u=n.mapping.slice(i),h=u.map(a,1),f=u.map(a+o.nodeSize,1);return n.step(new xt(h,f,h+1,f-1,new X(H.from(r.create(l,null,o.marks)),0,0),1,!0)),c===!0&&LC(n,o,a,i),!1}})}function LC(n,e,t,r){e.forEach((s,i)=>{if(s.isText){let o,a=/\r?\n|\r/g;for(;o=a.exec(s.text);){let l=n.mapping.slice(r).map(t+1+i+o.index);n.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function VC(n,e,t,r){e.forEach((s,i)=>{if(s.type==s.type.schema.linebreakReplacement){let o=n.mapping.slice(r).map(t+1+i);n.replaceWith(o,o+1,e.type.schema.text(`
`))}})}function L5(n,e,t){let r=n.resolve(e),s=r.index();return r.parent.canReplaceWith(s,s+1,t)}function V5(n,e,t,r,s){let i=n.doc.nodeAt(e);if(!i)throw new RangeError("No node at given position");t||(t=i.type);let o=t.create(r,null,s||i.marks);if(i.isLeaf)return n.replaceWith(e,e+i.nodeSize,o);if(!t.validContent(i.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new xt(e,e+i.nodeSize,e+1,e+i.nodeSize-1,new X(H.from(o),0,0),1,!0))}function Jr(n,e,t=1,r){let s=n.resolve(e),i=s.depth-t,o=r&&r[r.length-1]||s.parent;if(i<0||s.parent.type.spec.isolating||!s.parent.canReplace(s.index(),s.parent.childCount)||!o.type.validContent(s.parent.content.cutByIndex(s.index(),s.parent.childCount)))return!1;for(let c=s.depth-1,u=t-2;c>i;c--,u--){let h=s.node(c),f=s.index(c);if(h.type.spec.isolating)return!1;let p=h.content.cutByIndex(f,h.childCount),m=r&&r[u+1];m&&(p=p.replaceChild(0,m.type.create(m.attrs)));let y=r&&r[u]||h;if(!h.canReplace(f+1,h.childCount)||!y.type.validContent(p))return!1}let a=s.indexAfter(i),l=r&&r[0];return s.node(i).canReplaceWith(a,a,l?l.type:s.node(i+1).type)}function F5(n,e,t=1,r){let s=n.doc.resolve(e),i=H.empty,o=H.empty;for(let a=s.depth,l=s.depth-t,c=t-1;a>l;a--,c--){i=H.from(s.node(a).copy(i));let u=r&&r[c];o=H.from(u?u.type.create(u.attrs,o):s.node(a).copy(o))}n.step(new It(e,e,new X(i.append(o),t,t),!0))}function di(n,e){let t=n.resolve(e),r=t.index();return FC(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function B5(n,e){e.content.size||n.type.compatibleContent(e.type);let t=n.contentMatchAt(n.childCount),{linebreakReplacement:r}=n.type.schema;for(let s=0;s<e.childCount;s++){let i=e.child(s),o=i.type==r?n.type.schema.nodes.text:i.type;if(t=t.matchType(o),!t||!n.type.allowsMarks(i.marks))return!1}return t.validEnd}function FC(n,e){return!!(n&&e&&!n.isLeaf&&B5(n,e))}function Rd(n,e,t=-1){let r=n.resolve(e);for(let s=r.depth;;s--){let i,o,a=r.index(s);if(s==r.depth?(i=r.nodeBefore,o=r.nodeAfter):t>0?(i=r.node(s+1),a++,o=r.node(s).maybeChild(a)):(i=r.node(s).maybeChild(a-1),o=r.node(s+1)),i&&!i.isTextblock&&FC(i,o)&&r.node(s).canReplace(a,a+1))return e;if(s==0)break;e=t<0?r.before(s):r.after(s)}}function $5(n,e,t){let r=null,{linebreakReplacement:s}=n.doc.type.schema,i=n.doc.resolve(e-t),o=i.node().type;if(s&&o.inlineContent){let u=o.whitespace=="pre",h=!!o.contentMatch.matchType(s);u&&!h?r=!1:!u&&h&&(r=!0)}let a=n.steps.length;if(r===!1){let u=n.doc.resolve(e+t);VC(n,u.node(),u.before(),a)}o.inlineContent&&Xg(n,e+t-1,o,i.node().contentMatchAt(i.index()),r==null);let l=n.mapping.slice(a),c=l.map(e-t);if(n.step(new It(c,l.map(e+t,-1),X.empty,!0)),r===!0){let u=n.doc.resolve(c);LC(n,u.node(),u.before(),n.steps.length)}return n}function U5(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let s=r.depth-1;s>=0;s--){let i=r.index(s);if(r.node(s).canReplaceWith(i,i,t))return r.before(s+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(let s=r.depth-1;s>=0;s--){let i=r.indexAfter(s);if(r.node(s).canReplaceWith(i,i,t))return r.after(s+1);if(i<r.node(s).childCount)return null}return null}function BC(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let s=t.content;for(let i=0;i<t.openStart;i++)s=s.firstChild.content;for(let i=1;i<=(t.openStart==0&&t.size?2:1);i++)for(let o=r.depth;o>=0;o--){let a=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,l=r.index(o)+(a>0?1:0),c=r.node(o),u=!1;if(i==1)u=c.canReplace(l,l,s);else{let h=c.contentMatchAt(l).findWrapping(s.firstChild.type);u=h&&c.canReplaceWith(l,l,h[0])}if(u)return a==0?r.pos:a<0?r.before(o+1):r.after(o+1)}return null}function xd(n,e,t=e,r=X.empty){if(e==t&&!r.size)return null;let s=n.resolve(e),i=n.resolve(t);return $C(s,i,r)?new It(e,t,r):new z5(s,i,r).fit()}function $C(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class z5{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=H.empty;for(let s=0;s<=e.depth;s++){let i=e.node(s);this.frontier.push({type:i.type,match:i.contentMatchAt(e.indexAfter(s))})}for(let s=e.depth;s>0;s--)this.placed=H.from(e.node(s).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,s=this.close(e<0?this.$to:r.doc.resolve(e));if(!s)return null;let i=this.placed,o=r.depth,a=s.depth;for(;o&&a&&i.childCount==1;)i=i.firstChild.content,o--,a--;let l=new X(i,o,a);return e>-1?new xt(r.pos,e,this.$to.pos,this.$to.end(),l,t):l.size||r.pos!=this.$to.pos?new It(r.pos,s.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,s=this.unplaced.openEnd;r<e;r++){let i=t.firstChild;if(t.childCount>1&&(s=0),i.type.spec.isolating&&s<=r){e=r;break}t=i.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let s,i=null;r?(i=Vf(this.unplaced.content,r-1).firstChild,s=i.content):s=this.unplaced.content;let o=s.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],u,h=null;if(t==1&&(o?c.matchType(o.type)||(h=c.fillBefore(H.from(o),!1)):i&&l.compatibleContent(i.type)))return{sliceDepth:r,frontierDepth:a,parent:i,inject:h};if(t==2&&o&&(u=c.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:a,parent:i,wrap:u};if(i&&c.matchType(i.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,s=Vf(e,t);return!s.childCount||s.firstChild.isLeaf?!1:(this.unplaced=new X(e,t+1,Math.max(r,s.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,s=Vf(e,t);if(s.childCount<=1&&t>0){let i=e.size-t<=t+s.size;this.unplaced=new X(Ba(e,t-1,1),t-1,i?t-1:r)}else this.unplaced=new X(Ba(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:s,wrap:i}){for(;this.depth>t;)this.closeFrontierNode();if(i)for(let y=0;y<i.length;y++)this.openFrontierNode(i[y]);let o=this.unplaced,a=r?r.content:o.content,l=o.openStart-e,c=0,u=[],{match:h,type:f}=this.frontier[t];if(s){for(let y=0;y<s.childCount;y++)u.push(s.child(y));h=h.matchFragment(s)}let p=a.size+e-(o.content.size-o.openEnd);for(;c<a.childCount;){let y=a.child(c),v=h.matchType(y.type);if(!v)break;c++,(c>1||l==0||y.content.size)&&(h=v,u.push(UC(y.mark(f.allowedMarks(y.marks)),c==1?l:0,c==a.childCount?p:-1)))}let m=c==a.childCount;m||(p=-1),this.placed=$a(this.placed,t,H.from(u)),this.frontier[t].match=h,m&&p<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let y=0,v=a;y<p;y++){let T=v.lastChild;this.frontier.push({type:T.type,match:T.contentMatchAt(T.childCount)}),v=T.content}this.unplaced=m?e==0?X.empty:new X(Ba(o.content,e-1,1),e-1,p<0?o.openEnd:e-1):new X(Ba(o.content,e,c),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!Ff(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,s=this.$to.after(r);for(;r>1&&s==this.$to.end(--r);)++s;return s}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:s}=this.frontier[t],i=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),o=Ff(e,t,s,r,i);if(o){for(let a=t-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=Ff(e,a,c,l,!0);if(!u||u.childCount)continue e}return{depth:t,fit:o,move:i?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=$a(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let s=e.node(r),i=s.type.contentMatch.fillBefore(s.content,!0,e.index(r));this.openFrontierNode(s.type,s.attrs,i)}return e}openFrontierNode(e,t=null,r){let s=this.frontier[this.depth];s.match=s.match.matchType(e),this.placed=$a(this.placed,this.depth,H.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(H.empty,!0);t.childCount&&(this.placed=$a(this.placed,this.frontier.length,t))}}function Ba(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(Ba(n.firstChild.content,e-1,t)))}function $a(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy($a(n.lastChild.content,e-1,t)))}function Vf(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function UC(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,UC(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(H.empty,!0)))),n.copy(r)}function Ff(n,e,t,r,s){let i=n.node(e),o=s?n.indexAfter(e):n.index(e);if(o==i.childCount&&!t.compatibleContent(i.type))return null;let a=r.fillBefore(i.content,!0,o);return a&&!H5(t,i.content,o)?a:null}function H5(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function j5(n){return n.spec.defining||n.spec.definingForContent}function W5(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let s=n.doc.resolve(e),i=n.doc.resolve(t);if($C(s,i,r))return n.step(new It(e,t,r));let o=HC(s,i);o[o.length-1]==0&&o.pop();let a=-(s.depth+1);o.unshift(a);for(let f=s.depth,p=s.pos-1;f>0;f--,p--){let m=s.node(f).type.spec;if(m.defining||m.definingAsContext||m.isolating)break;o.indexOf(f)>-1?a=f:s.before(f)==p&&o.splice(1,0,-f)}let l=o.indexOf(a),c=[],u=r.openStart;for(let f=r.content,p=0;;p++){let m=f.firstChild;if(c.push(m),p==r.openStart)break;f=m.content}for(let f=u-1;f>=0;f--){let p=c[f],m=j5(p.type);if(m&&!p.sameMarkup(s.node(Math.abs(a)-1)))u=f;else if(m||!p.type.isTextblock)break}for(let f=r.openStart;f>=0;f--){let p=(f+u+1)%(r.openStart+1),m=c[p];if(m)for(let y=0;y<o.length;y++){let v=o[(y+l)%o.length],T=!0;v<0&&(T=!1,v=-v);let M=s.node(v-1),P=s.index(v-1);if(M.canReplaceWith(P,P,m.type,m.marks))return n.replace(s.before(v),T?i.after(v):t,new X(zC(r.content,0,r.openStart,p),p,r.openEnd))}}let h=n.steps.length;for(let f=o.length-1;f>=0&&(n.replace(e,t,r),!(n.steps.length>h));f--){let p=o[f];p<0||(e=s.before(p),t=i.after(p))}}function zC(n,e,t,r,s){if(e<t){let i=n.firstChild;n=n.replaceChild(0,i.copy(zC(i.content,e+1,t,r,i)))}if(e>r){let i=s.contentMatchAt(0),o=i.fillBefore(n).append(n);n=o.append(i.matchFragment(o).fillBefore(H.empty,!0))}return n}function q5(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let s=U5(n.doc,e,r.type);s!=null&&(e=t=s)}n.replaceRange(e,t,new X(H.from(r),0,0))}function K5(n,e,t){let r=n.doc.resolve(e),s=n.doc.resolve(t),i=HC(r,s);for(let o=0;o<i.length;o++){let a=i[o],l=o==i.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return n.delete(r.start(a),s.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),s.indexAfter(a-1))))return n.delete(r.before(a),s.after(a))}for(let o=1;o<=r.depth&&o<=s.depth;o++)if(e-r.start(o)==r.depth-o&&t>r.end(o)&&s.end(o)-t!=s.depth-o&&r.start(o-1)==s.start(o-1)&&r.node(o-1).canReplace(r.index(o-1),s.index(o-1)))return n.delete(r.before(o),t);n.delete(e,t)}function HC(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let s=r;s>=0;s--){let i=n.start(s);if(i<n.pos-(n.depth-s)||e.end(s)>e.pos+(e.depth-s)||n.node(s).type.spec.isolating||e.node(s).type.spec.isolating)break;(i==e.start(s)||s==n.depth&&s==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&s&&e.start(s-1)==i-1)&&t.push(s)}return t}class Fo extends sn{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return vt.fail("No node at attribute step's position");let r=Object.create(null);for(let i in t.attrs)r[i]=t.attrs[i];r[this.attr]=this.value;let s=t.type.create(r,null,t.marks);return vt.fromReplace(e,this.pos,this.pos+1,new X(H.from(s),0,t.isLeaf?0:1))}getMap(){return Tn.empty}invert(e){return new Fo(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Fo(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Fo(t.pos,t.attr,t.value)}}sn.jsonID("attr",Fo);class $l extends sn{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let s in e.attrs)t[s]=e.attrs[s];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return vt.ok(r)}getMap(){return Tn.empty}invert(e){return new $l(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new $l(t.attr,t.value)}}sn.jsonID("docAttr",$l);let Qo=class extends Error{};Qo=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};Qo.prototype=Object.create(Error.prototype);Qo.prototype.constructor=Qo;Qo.prototype.name="TransformError";class ey{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Bl}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new Qo(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=X.empty){let s=xd(this.doc,e,t,r);return s&&this.step(s),this}replaceWith(e,t,r){return this.replace(e,t,new X(H.from(r),0,0))}delete(e,t){return this.replace(e,t,X.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return W5(this,e,t,r),this}replaceRangeWith(e,t,r){return q5(this,e,t,r),this}deleteRange(e,t){return K5(this,e,t),this}lift(e,t){return M5(this,e,t),this}join(e,t=1){return $5(this,e,t),this}wrap(e,t){return O5(this,e,t),this}setBlockType(e,t=e,r,s=null){return D5(this,e,t,r,s),this}setNodeMarkup(e,t,r=null,s){return V5(this,e,t,r,s),this}setNodeAttribute(e,t,r){return this.step(new Fo(e,t,r)),this}setDocAttribute(e,t){return this.step(new $l(e,t)),this}addNodeMark(e,t){return this.step(new Ls(e,t)),this}removeNodeMark(e,t){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t instanceof Ge)t.isInSet(r.marks)&&this.step(new Gi(e,t));else{let s=r.marks,i,o=[];for(;i=t.isInSet(s);)o.push(new Gi(e,i)),s=i.removeFromSet(s);for(let a=o.length-1;a>=0;a--)this.step(o[a])}return this}split(e,t=1,r){return F5(this,e,t,r),this}addMark(e,t,r){return k5(this,e,t,r),this}removeMark(e,t,r){return R5(this,e,t,r),this}clearIncompatible(e,t,r){return Xg(this,e,t,r),this}}const Bf=Object.create(null);class me{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new jC(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=X.empty){let r=t.content.lastChild,s=null;for(let a=0;a<t.openEnd;a++)s=r,r=r.lastChild;let i=e.steps.length,o=this.ranges;for(let a=0;a<o.length;a++){let{$from:l,$to:c}=o[a],u=e.mapping.slice(i);e.replaceRange(u.map(l.pos),u.map(c.pos),a?X.empty:t),a==0&&Rw(e,i,(r?r.isInline:s&&s.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,s=this.ranges;for(let i=0;i<s.length;i++){let{$from:o,$to:a}=s[i],l=e.mapping.slice(r),c=l.map(o.pos),u=l.map(a.pos);i?e.deleteRange(c,u):(e.replaceRangeWith(c,u,t),Rw(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let s=e.parent.inlineContent?new ue(e):To(e.node(0),e.parent,e.pos,e.index(),t,r);if(s)return s;for(let i=e.depth-1;i>=0;i--){let o=t<0?To(e.node(0),e.node(i),e.before(i+1),e.index(i),t,r):To(e.node(0),e.node(i),e.after(i+1),e.index(i)+1,t,r);if(o)return o}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new kn(e.node(0))}static atStart(e){return To(e,e,0,0,1)||new kn(e)}static atEnd(e){return To(e,e,e.content.size,e.childCount,-1)||new kn(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Bf[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Bf)throw new RangeError("Duplicate use of selection JSON ID "+e);return Bf[e]=t,t.prototype.jsonID=e,t}getBookmark(){return ue.between(this.$anchor,this.$head).getBookmark()}}me.prototype.visible=!0;class jC{constructor(e,t){this.$from=e,this.$to=t}}let Iw=!1;function kw(n){!Iw&&!n.parent.inlineContent&&(Iw=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class ue extends me{constructor(e,t=e){kw(e),kw(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return me.near(r);let s=e.resolve(t.map(this.anchor));return new ue(s.parent.inlineContent?s:r,r)}replace(e,t=X.empty){if(super.replace(e,t),t==X.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof ue&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Md(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new ue(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let s=e.resolve(t);return new this(s,r==t?s:e.resolve(r))}static between(e,t,r){let s=e.pos-t.pos;if((!r||s)&&(r=s>=0?1:-1),!t.parent.inlineContent){let i=me.findFrom(t,r,!0)||me.findFrom(t,-r,!0);if(i)t=i.$head;else return me.near(t,r)}return e.parent.inlineContent||(s==0?e=t:(e=(me.findFrom(e,-r,!0)||me.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=s<0&&(e=t))),new ue(e,t)}}me.jsonID("text",ue);class Md{constructor(e,t){this.anchor=e,this.head=t}map(e){return new Md(e.map(this.anchor),e.map(this.head))}resolve(e){return ue.between(e.resolve(this.anchor),e.resolve(this.head))}}class le extends me{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:s}=t.mapResult(this.anchor),i=e.resolve(s);return r?me.near(i):new le(i)}content(){return new X(H.from(this.node),0,0)}eq(e){return e instanceof le&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new ty(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new le(e.resolve(t.anchor))}static create(e,t){return new le(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}le.prototype.visible=!1;me.jsonID("node",le);class ty{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new Md(r,r):new ty(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&le.isSelectable(r)?new le(t):me.near(t)}}class kn extends me{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=X.empty){if(t==X.empty){e.delete(0,e.doc.content.size);let r=me.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new kn(e)}map(e){return new kn(e)}eq(e){return e instanceof kn}getBookmark(){return G5}}me.jsonID("all",kn);const G5={map(){return this},resolve(n){return new kn(n)}};function To(n,e,t,r,s,i=!1){if(e.inlineContent)return ue.create(n,t);for(let o=r-(s>0?0:1);s>0?o<e.childCount:o>=0;o+=s){let a=e.child(o);if(a.isAtom){if(!i&&le.isSelectable(a))return le.create(n,t-(s<0?a.nodeSize:0))}else{let l=To(n,a,t+s,s<0?a.childCount:0,s,i);if(l)return l}t+=a.nodeSize*s}return null}function Rw(n,e,t){let r=n.steps.length-1;if(r<e)return;let s=n.steps[r];if(!(s instanceof It||s instanceof xt))return;let i=n.mapping.maps[r],o;i.forEach((a,l,c,u)=>{o==null&&(o=u)}),n.setSelection(me.near(n.doc.resolve(o),t))}const xw=1,Vc=2,Mw=4;class J5 extends ey{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|xw)&~Vc,this.storedMarks=null,this}get selectionSet(){return(this.updated&xw)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Vc,this}ensureMarks(e){return Ge.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Vc)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&~Vc,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let r=this.selection;return t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Ge.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,r){let s=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(s.text(e),!0):this.deleteSelection();{if(r==null&&(r=t),!e)return this.deleteRange(t,r);let i=this.storedMarks;if(!i){let o=this.doc.resolve(t);i=r==t?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,s.text(e,i)),!this.selection.empty&&this.selection.to==t+e.length&&this.setSelection(me.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=Mw,this}get scrolledIntoView(){return(this.updated&Mw)>0}}function Pw(n,e){return!e||!n?n:n.bind(e)}class Ua{constructor(e,t,r){this.name=e,this.init=Pw(t.init,r),this.apply=Pw(t.apply,r)}}const Q5=[new Ua("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new Ua("selection",{init(n,e){return n.selection||me.atStart(e.doc)},apply(n){return n.selection}}),new Ua("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new Ua("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}})];class $f{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=Q5.slice(),t&&t.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Ua(r.key,r.spec.state,r))})}}class ko{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=t){let s=this.config.plugins[r];if(s.spec.filterTransaction&&!s.spec.filterTransaction.call(s,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],r=this.applyInner(e),s=null;for(;;){let i=!1;for(let o=0;o<this.config.plugins.length;o++){let a=this.config.plugins[o];if(a.spec.appendTransaction){let l=s?s[o].n:0,c=s?s[o].state:this,u=l<t.length&&a.spec.appendTransaction.call(a,l?t.slice(l):t,c,r);if(u&&r.filterTransaction(u,o)){if(u.setMeta("appendedTransaction",e),!s){s=[];for(let h=0;h<this.config.plugins.length;h++)s.push(h<o?{state:r,n:t.length}:{state:this,n:0})}t.push(u),r=r.applyInner(u),i=!0}s&&(s[o]={state:r,n:t.length})}}if(!i)return{state:r,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new ko(this.config),r=this.config.fields;for(let s=0;s<r.length;s++){let i=r[s];t[i.name]=i.apply(e,this[i.name],this,t)}return t}get tr(){return new J5(this)}static create(e){let t=new $f(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new ko(t);for(let s=0;s<t.fields.length;s++)r[t.fields[s].name]=t.fields[s].init(e,r);return r}reconfigure(e){let t=new $f(this.schema,e.plugins),r=t.fields,s=new ko(t);for(let i=0;i<r.length;i++){let o=r[i].name;s[o]=this.hasOwnProperty(o)?this[o]:r[i].init(e,s)}return s}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let s=e[r],i=s.spec.state;i&&i.toJSON&&(t[r]=i.toJSON.call(s,this[s.key]))}return t}static fromJSON(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let s=new $f(e.schema,e.plugins),i=new ko(s);return s.fields.forEach(o=>{if(o.name=="doc")i.doc=Jn.fromJSON(e.schema,t.doc);else if(o.name=="selection")i.selection=me.fromJSON(i.doc,t.selection);else if(o.name=="storedMarks")t.storedMarks&&(i.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],c=l.spec.state;if(l.key==o.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(t,a)){i[o.name]=c.fromJSON.call(l,e,t[a],i);return}}i[o.name]=o.init(e,i)}}),i}}function WC(n,e,t){for(let r in n){let s=n[r];s instanceof Function?s=s.bind(e):r=="handleDOMEvents"&&(s=WC(s,e,{})),t[r]=s}return t}class st{constructor(e){this.spec=e,this.props={},e.props&&WC(e.props,this,this.props),this.key=e.key?e.key.key:qC("plugin")}getState(e){return e[this.key]}}const Uf=Object.create(null);function qC(n){return n in Uf?n+"$"+ ++Uf[n]:(Uf[n]=0,n+"$")}class dt{constructor(e="key"){this.key=qC(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const ny=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function KC(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("backward",n):t.parentOffset>0)?null:t}const GC=(n,e,t)=>{let r=KC(n,t);if(!r)return!1;let s=ry(r);if(!s){let o=r.blockRange(),a=o&&ca(o);return a==null?!1:(e&&e(n.tr.lift(o,a).scrollIntoView()),!0)}let i=s.nodeBefore;if(rA(n,s,e,-1))return!0;if(r.parent.content.size==0&&(Yo(i,"end")||le.isSelectable(i)))for(let o=r.depth;;o--){let a=xd(n.doc,r.before(o),r.after(o),X.empty);if(a&&a.slice.size<a.to-a.from){if(e){let l=n.tr.step(a);l.setSelection(Yo(i,"end")?me.findFrom(l.doc.resolve(l.mapping.map(s.pos,-1)),-1):le.create(l.doc,s.pos-i.nodeSize)),e(l.scrollIntoView())}return!0}if(o==1||r.node(o-1).childCount>1)break}return i.isAtom&&s.depth==r.depth-1?(e&&e(n.tr.delete(s.pos-i.nodeSize,s.pos).scrollIntoView()),!0):!1},Y5=(n,e,t)=>{let r=KC(n,t);if(!r)return!1;let s=ry(r);return s?JC(n,s,e):!1},X5=(n,e,t)=>{let r=YC(n,t);if(!r)return!1;let s=sy(r);return s?JC(n,s,e):!1};function JC(n,e,t){let r=e.nodeBefore,s=r,i=e.pos-1;for(;!s.isTextblock;i--){if(s.type.spec.isolating)return!1;let u=s.lastChild;if(!u)return!1;s=u}let o=e.nodeAfter,a=o,l=e.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let u=a.firstChild;if(!u)return!1;a=u}let c=xd(n.doc,i,l,X.empty);if(!c||c.from!=i||c instanceof It&&c.slice.size>=l-i)return!1;if(t){let u=n.tr.step(c);u.setSelection(ue.create(u.doc,i)),t(u.scrollIntoView())}return!0}function Yo(n,e,t=!1){for(let r=n;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(t&&r.childCount!=1)return!1}return!1}const QC=(n,e,t)=>{let{$head:r,empty:s}=n.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):r.parentOffset>0)return!1;i=ry(r)}let o=i&&i.nodeBefore;return!o||!le.isSelectable(o)?!1:(e&&e(n.tr.setSelection(le.create(n.doc,i.pos-o.nodeSize)).scrollIntoView()),!0)};function ry(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function YC(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("forward",n):t.parentOffset<t.parent.content.size)?null:t}const XC=(n,e,t)=>{let r=YC(n,t);if(!r)return!1;let s=sy(r);if(!s)return!1;let i=s.nodeAfter;if(rA(n,s,e,1))return!0;if(r.parent.content.size==0&&(Yo(i,"start")||le.isSelectable(i))){let o=xd(n.doc,r.before(),r.after(),X.empty);if(o&&o.slice.size<o.to-o.from){if(e){let a=n.tr.step(o);a.setSelection(Yo(i,"start")?me.findFrom(a.doc.resolve(a.mapping.map(s.pos)),1):le.create(a.doc,a.mapping.map(s.pos))),e(a.scrollIntoView())}return!0}}return i.isAtom&&s.depth==r.depth-1?(e&&e(n.tr.delete(s.pos,s.pos+i.nodeSize).scrollIntoView()),!0):!1},ZC=(n,e,t)=>{let{$head:r,empty:s}=n.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;i=sy(r)}let o=i&&i.nodeAfter;return!o||!le.isSelectable(o)?!1:(e&&e(n.tr.setSelection(le.create(n.doc,i.pos)).scrollIntoView()),!0)};function sy(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const Z5=(n,e)=>{let t=n.selection,r=t instanceof le,s;if(r){if(t.node.isTextblock||!di(n.doc,t.from))return!1;s=t.from}else if(s=Rd(n.doc,t.from,-1),s==null)return!1;if(e){let i=n.tr.join(s);r&&i.setSelection(le.create(i.doc,s-n.doc.resolve(s).nodeBefore.nodeSize)),e(i.scrollIntoView())}return!0},eF=(n,e)=>{let t=n.selection,r;if(t instanceof le){if(t.node.isTextblock||!di(n.doc,t.to))return!1;r=t.to}else if(r=Rd(n.doc,t.to,1),r==null)return!1;return e&&e(n.tr.join(r).scrollIntoView()),!0},tF=(n,e)=>{let{$from:t,$to:r}=n.selection,s=t.blockRange(r),i=s&&ca(s);return i==null?!1:(e&&e(n.tr.lift(s,i).scrollIntoView()),!0)},eA=(n,e)=>{let{$head:t,$anchor:r}=n.selection;return!t.parent.type.spec.code||!t.sameParent(r)?!1:(e&&e(n.tr.insertText(`
`).scrollIntoView()),!0)};function iy(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const nF=(n,e)=>{let{$head:t,$anchor:r}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(r))return!1;let s=t.node(-1),i=t.indexAfter(-1),o=iy(s.contentMatchAt(i));if(!o||!s.canReplaceWith(i,i,o))return!1;if(e){let a=t.after(),l=n.tr.replaceWith(a,a,o.createAndFill());l.setSelection(me.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},tA=(n,e)=>{let t=n.selection,{$from:r,$to:s}=t;if(t instanceof kn||r.parent.inlineContent||s.parent.inlineContent)return!1;let i=iy(s.parent.contentMatchAt(s.indexAfter()));if(!i||!i.isTextblock)return!1;if(e){let o=(!r.parentOffset&&s.index()<s.parent.childCount?r:s).pos,a=n.tr.insert(o,i.createAndFill());a.setSelection(ue.create(a.doc,o+1)),e(a.scrollIntoView())}return!0},nA=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let i=t.before();if(Jr(n.doc,i))return e&&e(n.tr.split(i).scrollIntoView()),!0}let r=t.blockRange(),s=r&&ca(r);return s==null?!1:(e&&e(n.tr.lift(r,s).scrollIntoView()),!0)};function rF(n){return(e,t)=>{let{$from:r,$to:s}=e.selection;if(e.selection instanceof le&&e.selection.node.isBlock)return!r.parentOffset||!Jr(e.doc,r.pos)?!1:(t&&t(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let i=[],o,a,l=!1,c=!1;for(let p=r.depth;;p--)if(r.node(p).isBlock){l=r.end(p)==r.pos+(r.depth-p),c=r.start(p)==r.pos-(r.depth-p),a=iy(r.node(p-1).contentMatchAt(r.indexAfter(p-1))),i.unshift(l&&a?{type:a}:null),o=p;break}else{if(p==1)return!1;i.unshift(null)}let u=e.tr;(e.selection instanceof ue||e.selection instanceof kn)&&u.deleteSelection();let h=u.mapping.map(r.pos),f=Jr(u.doc,h,i.length,i);if(f||(i[0]=a?{type:a}:null,f=Jr(u.doc,h,i.length,i)),!f)return!1;if(u.split(h,i.length,i),!l&&c&&r.node(o).type!=a){let p=u.mapping.map(r.before(o)),m=u.doc.resolve(p);a&&r.node(o-1).canReplaceWith(m.index(),m.index()+1,a)&&u.setNodeMarkup(u.mapping.map(r.before(o)),a)}return t&&t(u.scrollIntoView()),!0}}const sF=rF(),iF=(n,e)=>{let{$from:t,to:r}=n.selection,s,i=t.sharedDepth(r);return i==0?!1:(s=t.before(i),e&&e(n.tr.setSelection(le.create(n.doc,s))),!0)};function oF(n,e,t){let r=e.nodeBefore,s=e.nodeAfter,i=e.index();return!r||!s||!r.type.compatibleContent(s.type)?!1:!r.content.size&&e.parent.canReplace(i-1,i)?(t&&t(n.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(i,i+1)||!(s.isTextblock||di(n.doc,e.pos))?!1:(t&&t(n.tr.join(e.pos).scrollIntoView()),!0)}function rA(n,e,t,r){let s=e.nodeBefore,i=e.nodeAfter,o,a,l=s.type.spec.isolating||i.type.spec.isolating;if(!l&&oF(n,e,t))return!0;let c=!l&&e.parent.canReplace(e.index(),e.index()+1);if(c&&(o=(a=s.contentMatchAt(s.childCount)).findWrapping(i.type))&&a.matchType(o[0]||i.type).validEnd){if(t){let p=e.pos+i.nodeSize,m=H.empty;for(let T=o.length-1;T>=0;T--)m=H.from(o[T].create(null,m));m=H.from(s.copy(m));let y=n.tr.step(new xt(e.pos-1,p,e.pos,p,new X(m,1,0),o.length,!0)),v=y.doc.resolve(p+2*o.length);v.nodeAfter&&v.nodeAfter.type==s.type&&di(y.doc,v.pos)&&y.join(v.pos),t(y.scrollIntoView())}return!0}let u=i.type.spec.isolating||r>0&&l?null:me.findFrom(e,1),h=u&&u.$from.blockRange(u.$to),f=h&&ca(h);if(f!=null&&f>=e.depth)return t&&t(n.tr.lift(h,f).scrollIntoView()),!0;if(c&&Yo(i,"start",!0)&&Yo(s,"end")){let p=s,m=[];for(;m.push(p),!p.isTextblock;)p=p.lastChild;let y=i,v=1;for(;!y.isTextblock;y=y.firstChild)v++;if(p.canReplace(p.childCount,p.childCount,y.content)){if(t){let T=H.empty;for(let P=m.length-1;P>=0;P--)T=H.from(m[P].copy(T));let M=n.tr.step(new xt(e.pos-m.length,e.pos+i.nodeSize,e.pos+v,e.pos+i.nodeSize-v,new X(T,m.length,0),0,!0));t(M.scrollIntoView())}return!0}}return!1}function sA(n){return function(e,t){let r=e.selection,s=n<0?r.$from:r.$to,i=s.depth;for(;s.node(i).isInline;){if(!i)return!1;i--}return s.node(i).isTextblock?(t&&t(e.tr.setSelection(ue.create(e.doc,n<0?s.start(i):s.end(i)))),!0):!1}}const aF=sA(-1),lF=sA(1);function cF(n,e=null){return function(t,r){let{$from:s,$to:i}=t.selection,o=s.blockRange(i),a=o&&Zg(o,n,e);return a?(r&&r(t.tr.wrap(o,a).scrollIntoView()),!0):!1}}function Nw(n,e=null){return function(t,r){let s=!1;for(let i=0;i<t.selection.ranges.length&&!s;i++){let{$from:{pos:o},$to:{pos:a}}=t.selection.ranges[i];t.doc.nodesBetween(o,a,(l,c)=>{if(s)return!1;if(!(!l.isTextblock||l.hasMarkup(n,e)))if(l.type==n)s=!0;else{let u=t.doc.resolve(c),h=u.index();s=u.parent.canReplaceWith(h,h+1,n)}})}if(!s)return!1;if(r){let i=t.tr;for(let o=0;o<t.selection.ranges.length;o++){let{$from:{pos:a},$to:{pos:l}}=t.selection.ranges[o];i.setBlockType(a,l,n,e)}r(i.scrollIntoView())}return!0}}function oy(...n){return function(e,t,r){for(let s=0;s<n.length;s++)if(n[s](e,t,r))return!0;return!1}}oy(ny,GC,QC);oy(ny,XC,ZC);oy(eA,tA,nA,sF);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function uF(n,e=null){return function(t,r){let{$from:s,$to:i}=t.selection,o=s.blockRange(i);if(!o)return!1;let a=r?t.tr:null;return hF(a,o,n,e)?(r&&r(a.scrollIntoView()),!0):!1}}function hF(n,e,t,r=null){let s=!1,i=e,o=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(t)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let l=o.resolve(e.start-2);i=new Qu(l,l,e.depth),e.endIndex<e.parent.childCount&&(e=new Qu(e.$from,o.resolve(e.$to.end(e.depth)),e.depth)),s=!0}let a=Zg(i,t,r,e);return a?(n&&dF(n,e,a,s,t),!0):!1}function dF(n,e,t,r,s){let i=H.empty;for(let u=t.length-1;u>=0;u--)i=H.from(t[u].type.create(t[u].attrs,i));n.step(new xt(e.start-(r?2:0),e.end,e.start,e.end,new X(i,0,0),t.length,!0));let o=0;for(let u=0;u<t.length;u++)t[u].type==s&&(o=u+1);let a=t.length-o,l=e.start+t.length-(r?2:0),c=e.parent;for(let u=e.startIndex,h=e.endIndex,f=!0;u<h;u++,f=!1)!f&&Jr(n.doc,l,a)&&(n.split(l,a),l+=2*a),l+=c.child(u).nodeSize;return n}function fF(n){return function(e,t){let{$from:r,$to:s}=e.selection,i=r.blockRange(s,o=>o.childCount>0&&o.firstChild.type==n);return i?t?r.node(i.depth-1).type==n?pF(e,t,n,i):mF(e,t,i):!0:!1}}function pF(n,e,t,r){let s=n.tr,i=r.end,o=r.$to.end(r.depth);i<o&&(s.step(new xt(i-1,o,i,o,new X(H.from(t.create(null,r.parent.copy())),1,0),1,!0)),r=new Qu(s.doc.resolve(r.$from.pos),s.doc.resolve(o),r.depth));const a=ca(r);if(a==null)return!1;s.lift(r,a);let l=s.doc.resolve(s.mapping.map(i,-1)-1);return di(s.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&s.join(l.pos),e(s.scrollIntoView()),!0}function mF(n,e,t){let r=n.tr,s=t.parent;for(let p=t.end,m=t.endIndex-1,y=t.startIndex;m>y;m--)p-=s.child(m).nodeSize,r.delete(p-1,p+1);let i=r.doc.resolve(t.start),o=i.nodeAfter;if(r.mapping.map(t.end)!=t.start+i.nodeAfter.nodeSize)return!1;let a=t.startIndex==0,l=t.endIndex==s.childCount,c=i.node(-1),u=i.index(-1);if(!c.canReplace(u+(a?0:1),u+1,o.content.append(l?H.empty:H.from(s))))return!1;let h=i.pos,f=h+o.nodeSize;return r.step(new xt(h-(a?1:0),f+(l?1:0),h+1,f-1,new X((a?H.empty:H.from(s.copy(H.empty))).append(l?H.empty:H.from(s.copy(H.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}function gF(n){return function(e,t){let{$from:r,$to:s}=e.selection,i=r.blockRange(s,c=>c.childCount>0&&c.firstChild.type==n);if(!i)return!1;let o=i.startIndex;if(o==0)return!1;let a=i.parent,l=a.child(o-1);if(l.type!=n)return!1;if(t){let c=l.lastChild&&l.lastChild.type==a.type,u=H.from(c?n.create():null),h=new X(H.from(n.create(null,H.from(a.type.create(null,u)))),c?3:1,0),f=i.start,p=i.end;t(e.tr.step(new xt(f-(c?3:1),p,f,p,h,1,!0)).scrollIntoView())}return!0}}const Ft=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},Xo=function(n){let e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e};let rm=null;const $r=function(n,e,t){let r=rm||(rm=document.createRange());return r.setEnd(n,t??n.nodeValue.length),r.setStart(n,e||0),r},yF=function(){rm=null},Ji=function(n,e,t,r){return t&&(Ow(n,e,t,r,-1)||Ow(n,e,t,r,1))},_F=/^(img|br|input|textarea|hr)$/i;function Ow(n,e,t,r,s){for(var i;;){if(n==t&&e==r)return!0;if(e==(s<0?0:Dn(n))){let o=n.parentNode;if(!o||o.nodeType!=1||uc(n)||_F.test(n.nodeName)||n.contentEditable=="false")return!1;e=Ft(n)+(s<0?0:1),n=o}else if(n.nodeType==1){let o=n.childNodes[e+(s<0?-1:0)];if(o.nodeType==1&&o.contentEditable=="false")if(!((i=o.pmViewDesc)===null||i===void 0)&&i.ignoreForSelection)e+=s;else return!1;else n=o,e=s<0?Dn(n):0}else return!1}}function Dn(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function vF(n,e){for(;;){if(n.nodeType==3&&e)return n;if(n.nodeType==1&&e>0){if(n.contentEditable=="false")return null;n=n.childNodes[e-1],e=Dn(n)}else if(n.parentNode&&!uc(n))e=Ft(n),n=n.parentNode;else return null}}function wF(n,e){for(;;){if(n.nodeType==3&&e<n.nodeValue.length)return n;if(n.nodeType==1&&e<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[e],e=0}else if(n.parentNode&&!uc(n))e=Ft(n)+1,n=n.parentNode;else return null}}function bF(n,e,t){for(let r=e==0,s=e==Dn(n);r||s;){if(n==t)return!0;let i=Ft(n);if(n=n.parentNode,!n)return!1;r=r&&i==0,s=s&&i==Dn(n)}}function uc(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const Pd=function(n){return n.focusNode&&Ji(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function Ii(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function EF(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function TF(n,e,t){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(e,t);if(r)return{node:r.offsetNode,offset:Math.min(Dn(r.offsetNode),r.offset)}}catch{}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(e,t);if(r)return{node:r.startContainer,offset:Math.min(Dn(r.startContainer),r.startOffset)}}}const Sr=typeof navigator<"u"?navigator:null,Dw=typeof document<"u"?document:null,fi=Sr&&Sr.userAgent||"",sm=/Edge\/(\d+)/.exec(fi),iA=/MSIE \d/.exec(fi),im=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(fi),yn=!!(iA||im||sm),Ks=iA?document.documentMode:im?+im[1]:sm?+sm[1]:0,Fn=!yn&&/gecko\/(\d+)/i.test(fi);Fn&&+(/Firefox\/(\d+)/.exec(fi)||[0,0])[1];const om=!yn&&/Chrome\/(\d+)/.exec(fi),kt=!!om,oA=om?+om[1]:0,nn=!yn&&!!Sr&&/Apple Computer/.test(Sr.vendor),Zo=nn&&(/Mobile\/\w+/.test(fi)||!!Sr&&Sr.maxTouchPoints>2),Pn=Zo||(Sr?/Mac/.test(Sr.platform):!1),aA=Sr?/Win/.test(Sr.platform):!1,Kr=/Android \d/.test(fi),hc=!!Dw&&"webkitFontSmoothing"in Dw.documentElement.style,SF=hc?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function CF(n){let e=n.defaultView&&n.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function Or(n,e){return typeof n=="number"?n:n[e]}function AF(n){let e=n.getBoundingClientRect(),t=e.width/n.offsetWidth||1,r=e.height/n.offsetHeight||1;return{left:e.left,right:e.left+n.clientWidth*t,top:e.top,bottom:e.top+n.clientHeight*r}}function Lw(n,e,t){let r=n.someProp("scrollThreshold")||0,s=n.someProp("scrollMargin")||5,i=n.dom.ownerDocument;for(let o=t||n.dom;o;){if(o.nodeType!=1){o=Xo(o);continue}let a=o,l=a==i.body,c=l?CF(i):AF(a),u=0,h=0;if(e.top<c.top+Or(r,"top")?h=-(c.top-e.top+Or(s,"top")):e.bottom>c.bottom-Or(r,"bottom")&&(h=e.bottom-e.top>c.bottom-c.top?e.top+Or(s,"top")-c.top:e.bottom-c.bottom+Or(s,"bottom")),e.left<c.left+Or(r,"left")?u=-(c.left-e.left+Or(s,"left")):e.right>c.right-Or(r,"right")&&(u=e.right-c.right+Or(s,"right")),u||h)if(l)i.defaultView.scrollBy(u,h);else{let p=a.scrollLeft,m=a.scrollTop;h&&(a.scrollTop+=h),u&&(a.scrollLeft+=u);let y=a.scrollLeft-p,v=a.scrollTop-m;e={left:e.left-y,top:e.top-v,right:e.right-y,bottom:e.bottom-v}}let f=l?"fixed":getComputedStyle(o).position;if(/^(fixed|sticky)$/.test(f))break;o=f=="absolute"?o.offsetParent:Xo(o)}}function IF(n){let e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),r,s;for(let i=(e.left+e.right)/2,o=t+1;o<Math.min(innerHeight,e.bottom);o+=5){let a=n.root.elementFromPoint(i,o);if(!a||a==n.dom||!n.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=t-20){r=a,s=l.top;break}}return{refDOM:r,refTop:s,stack:lA(n.dom)}}function lA(n){let e=[],t=n.ownerDocument;for(let r=n;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=t);r=Xo(r));return e}function kF({refDOM:n,refTop:e,stack:t}){let r=n?n.getBoundingClientRect().top:0;cA(t,r==0?0:r-e)}function cA(n,e){for(let t=0;t<n.length;t++){let{dom:r,top:s,left:i}=n[t];r.scrollTop!=s+e&&(r.scrollTop=s+e),r.scrollLeft!=i&&(r.scrollLeft=i)}}let po=null;function RF(n){if(n.setActive)return n.setActive();if(po)return n.focus(po);let e=lA(n);n.focus(po==null?{get preventScroll(){return po={preventScroll:!0},!0}}:void 0),po||(po=!1,cA(e,0))}function uA(n,e){let t,r=2e8,s,i=0,o=e.top,a=e.top,l,c;for(let u=n.firstChild,h=0;u;u=u.nextSibling,h++){let f;if(u.nodeType==1)f=u.getClientRects();else if(u.nodeType==3)f=$r(u).getClientRects();else continue;for(let p=0;p<f.length;p++){let m=f[p];if(m.top<=o&&m.bottom>=a){o=Math.max(m.bottom,o),a=Math.min(m.top,a);let y=m.left>e.left?m.left-e.left:m.right<e.left?e.left-m.right:0;if(y<r){t=u,r=y,s=y&&t.nodeType==3?{left:m.right<e.left?m.right:m.left,top:e.top}:e,u.nodeType==1&&y&&(i=h+(e.left>=(m.left+m.right)/2?1:0));continue}}else m.top>e.top&&!l&&m.left<=e.left&&m.right>=e.left&&(l=u,c={left:Math.max(m.left,Math.min(m.right,e.left)),top:m.top});!t&&(e.left>=m.right&&e.top>=m.top||e.left>=m.left&&e.top>=m.bottom)&&(i=h+1)}}return!t&&l&&(t=l,s=c,r=0),t&&t.nodeType==3?xF(t,s):!t||r&&t.nodeType==1?{node:n,offset:i}:uA(t,s)}function xF(n,e){let t=n.nodeValue.length,r=document.createRange(),s;for(let i=0;i<t;i++){r.setEnd(n,i+1),r.setStart(n,i);let o=vs(r,1);if(o.top!=o.bottom&&ay(e,o)){s={node:n,offset:i+(e.left>=(o.left+o.right)/2?1:0)};break}}return r.detach(),s||{node:n,offset:0}}function ay(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function MF(n,e){let t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}function PF(n,e,t){let{node:r,offset:s}=uA(e,t),i=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();i=o.left!=o.right&&t.left>(o.left+o.right)/2?1:-1}return n.docView.posFromDOM(r,s,i)}function NF(n,e,t,r){let s=-1;for(let i=e,o=!1;i!=n.dom;){let a=n.docView.nearestDesc(i,!0),l;if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)&&((l=a.dom.getBoundingClientRect()).width||l.height)&&(a.node.isBlock&&a.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(a.dom.nodeName)&&(!o&&l.left>r.left||l.top>r.top?s=a.posBefore:(!o&&l.right<r.left||l.bottom<r.top)&&(s=a.posAfter),o=!0),!a.contentDOM&&s<0&&!a.node.isText))return(a.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?a.posBefore:a.posAfter;i=a.dom.parentNode}return s>-1?s:n.docView.posFromDOM(e,t,-1)}function hA(n,e,t){let r=n.childNodes.length;if(r&&t.top<t.bottom)for(let s=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-t.top)/(t.bottom-t.top))-2)),i=s;;){let o=n.childNodes[i];if(o.nodeType==1){let a=o.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(ay(e,c))return hA(o,e,c)}}if((i=(i+1)%r)==s)break}return n}function OF(n,e){let t=n.dom.ownerDocument,r,s=0,i=TF(t,e.left,e.top);i&&({node:r,offset:s}=i);let o=(n.root.elementFromPoint?n.root:t).elementFromPoint(e.left,e.top),a;if(!o||!n.dom.contains(o.nodeType!=1?o.parentNode:o)){let c=n.dom.getBoundingClientRect();if(!ay(e,c)||(o=hA(n.dom,e,c),!o))return null}if(nn)for(let c=o;r&&c;c=Xo(c))c.draggable&&(r=void 0);if(o=MF(o,e),r){if(Fn&&r.nodeType==1&&(s=Math.min(s,r.childNodes.length),s<r.childNodes.length)){let u=r.childNodes[s],h;u.nodeName=="IMG"&&(h=u.getBoundingClientRect()).right<=e.left&&h.bottom>e.top&&s++}let c;hc&&s&&r.nodeType==1&&(c=r.childNodes[s-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&s--,r==n.dom&&s==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?a=n.state.doc.content.size:(s==0||r.nodeType!=1||r.childNodes[s-1].nodeName!="BR")&&(a=NF(n,r,s,e))}a==null&&(a=PF(n,o,e));let l=n.docView.nearestDesc(o,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function Vw(n){return n.top<n.bottom||n.left<n.right}function vs(n,e){let t=n.getClientRects();if(t.length){let r=t[e<0?0:t.length-1];if(Vw(r))return r}return Array.prototype.find.call(t,Vw)||n.getBoundingClientRect()}const DF=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function dA(n,e,t){let{node:r,offset:s,atom:i}=n.docView.domFromPos(e,t<0?-1:1),o=hc||Fn;if(r.nodeType==3)if(o&&(DF.test(r.nodeValue)||(t<0?!s:s==r.nodeValue.length))){let l=vs($r(r,s,s),t);if(Fn&&s&&/\s/.test(r.nodeValue[s-1])&&s<r.nodeValue.length){let c=vs($r(r,s-1,s-1),-1);if(c.top==l.top){let u=vs($r(r,s,s+1),-1);if(u.top!=l.top)return xa(u,u.left<c.left)}}return l}else{let l=s,c=s,u=t<0?1:-1;return t<0&&!s?(c++,u=-1):t>=0&&s==r.nodeValue.length?(l--,u=1):t<0?l--:c++,xa(vs($r(r,l,c),u),u<0)}if(!n.state.doc.resolve(e-(i||0)).parent.inlineContent){if(i==null&&s&&(t<0||s==Dn(r))){let l=r.childNodes[s-1];if(l.nodeType==1)return zf(l.getBoundingClientRect(),!1)}if(i==null&&s<Dn(r)){let l=r.childNodes[s];if(l.nodeType==1)return zf(l.getBoundingClientRect(),!0)}return zf(r.getBoundingClientRect(),t>=0)}if(i==null&&s&&(t<0||s==Dn(r))){let l=r.childNodes[s-1],c=l.nodeType==3?$r(l,Dn(l)-(o?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return xa(vs(c,1),!1)}if(i==null&&s<Dn(r)){let l=r.childNodes[s];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?$r(l,0,o?0:1):l.nodeType==1?l:null:null;if(c)return xa(vs(c,-1),!0)}return xa(vs(r.nodeType==3?$r(r):r,-t),t>=0)}function xa(n,e){if(n.width==0)return n;let t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function zf(n,e){if(n.height==0)return n;let t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function fA(n,e,t){let r=n.state,s=n.root.activeElement;r!=e&&n.updateState(e),s!=n.dom&&n.focus();try{return t()}finally{r!=e&&n.updateState(r),s!=n.dom&&s&&s.focus()}}function LF(n,e,t){let r=e.selection,s=t=="up"?r.$from:r.$to;return fA(n,e,()=>{let{node:i}=n.docView.domFromPos(s.pos,t=="up"?-1:1);for(;;){let a=n.docView.nearestDesc(i,!0);if(!a)break;if(a.node.isBlock){i=a.contentDOM||a.dom;break}i=a.dom.parentNode}let o=dA(n,s.pos,1);for(let a=i.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=$r(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let u=l[c];if(u.bottom>u.top+1&&(t=="up"?o.top-u.top>(u.bottom-o.top)*2:u.bottom-o.bottom>(o.bottom-u.top)*2))return!1}}return!0})}const VF=/[\u0590-\u08ac]/;function FF(n,e,t){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let s=r.parentOffset,i=!s,o=s==r.parent.content.size,a=n.domSelection();return a?!VF.test(r.parent.textContent)||!a.modify?t=="left"||t=="backward"?i:o:fA(n,e,()=>{let{focusNode:l,focusOffset:c,anchorNode:u,anchorOffset:h}=n.domSelectionRange(),f=a.caretBidiLevel;a.modify("move",t,"character");let p=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:m,focusOffset:y}=n.domSelectionRange(),v=m&&!p.contains(m.nodeType==1?m:m.parentNode)||l==m&&c==y;try{a.collapse(u,h),l&&(l!=u||c!=h)&&a.extend&&a.extend(l,c)}catch{}return f!=null&&(a.caretBidiLevel=f),v}):r.pos==r.start()||r.pos==r.end()}let Fw=null,Bw=null,$w=!1;function BF(n,e,t){return Fw==e&&Bw==t?$w:(Fw=e,Bw=t,$w=t=="up"||t=="down"?LF(n,e,t):FF(n,e,t))}const Bn=0,Uw=1,Ri=2,Cr=3;class dc{constructor(e,t,r,s){this.parent=e,this.children=t,this.dom=r,this.contentDOM=s,this.dirty=Bn,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){let s=this.children[t];if(s==e)return r;r+=s.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let i,o;if(e==this.contentDOM)i=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.previousSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.previousSibling;return i?this.posBeforeChild(o)+o.size:this.posAtStart}else{let i,o;if(e==this.contentDOM)i=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.nextSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.nextSibling;return i?this.posBeforeChild(o):this.posAtEnd}let s;if(e==this.dom&&this.contentDOM)s=t>Ft(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))s=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let i=e;;i=i.parentNode){if(i==this.dom){s=!1;break}if(i.previousSibling)break}if(s==null&&t==e.childNodes.length)for(let i=e;;i=i.parentNode){if(i==this.dom){s=!0;break}if(i.nextSibling)break}}return s??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,s=e;s;s=s.parentNode){let i=this.getDesc(s),o;if(i&&(!t||i.node))if(r&&(o=i.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))r=!1;else return i}}getDesc(e){let t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let s=e;s;s=s.parentNode){let i=this.getDesc(s);if(i)return i.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let s=this.children[t],i=r+s.size;if(r==e&&i!=r){for(;!s.border&&s.children.length;)for(let o=0;o<s.children.length;o++){let a=s.children[o];if(a.size){s=a;break}}return s}if(e<i)return s.descAt(e-r-s.border);r=i}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,s=0;for(let i=0;r<this.children.length;r++){let o=this.children[r],a=i+o.size;if(a>e||o instanceof mA){s=e-i;break}i=a}if(s)return this.children[r].domFromPos(s-this.children[r].border,t);for(let i;r&&!(i=this.children[r-1]).size&&i instanceof pA&&i.side>=0;r--);if(t<=0){let i,o=!0;for(;i=r?this.children[r-1]:null,!(!i||i.dom.parentNode==this.contentDOM);r--,o=!1);return i&&t&&o&&!i.border&&!i.domAtom?i.domFromPos(i.size,t):{node:this.contentDOM,offset:i?Ft(i.dom)+1:0}}else{let i,o=!0;for(;i=r<this.children.length?this.children[r]:null,!(!i||i.dom.parentNode==this.contentDOM);r++,o=!1);return i&&o&&!i.border&&!i.domAtom?i.domFromPos(0,t):{node:this.contentDOM,offset:i?Ft(i.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let s=-1,i=-1;for(let o=r,a=0;;a++){let l=this.children[a],c=o+l.size;if(s==-1&&e<=c){let u=o+l.border;if(e>=u&&t<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,t,u);e=o;for(let h=a;h>0;h--){let f=this.children[h-1];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(1)){s=Ft(f.dom)+1;break}e-=f.size}s==-1&&(s=0)}if(s>-1&&(c>t||a==this.children.length-1)){t=c;for(let u=a+1;u<this.children.length;u++){let h=this.children[u];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(-1)){i=Ft(h.dom);break}t+=h.size}i==-1&&(i=this.contentDOM.childNodes.length);break}o=c}return{node:this.contentDOM,from:e,to:t,fromOffset:s,toOffset:i}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,s=!1){let i=Math.min(e,t),o=Math.max(e,t);for(let p=0,m=0;p<this.children.length;p++){let y=this.children[p],v=m+y.size;if(i>m&&o<v)return y.setSelection(e-m-y.border,t-m-y.border,r,s);m=v}let a=this.domFromPos(e,e?-1:1),l=t==e?a:this.domFromPos(t,t?-1:1),c=r.root.getSelection(),u=r.domSelectionRange(),h=!1;if((Fn||nn)&&e==t){let{node:p,offset:m}=a;if(p.nodeType==3){if(h=!!(m&&p.nodeValue[m-1]==`
`),h&&m==p.nodeValue.length)for(let y=p,v;y;y=y.parentNode){if(v=y.nextSibling){v.nodeName=="BR"&&(a=l={node:v.parentNode,offset:Ft(v)+1});break}let T=y.pmViewDesc;if(T&&T.node&&T.node.isBlock)break}}else{let y=p.childNodes[m-1];h=y&&(y.nodeName=="BR"||y.contentEditable=="false")}}if(Fn&&u.focusNode&&u.focusNode!=l.node&&u.focusNode.nodeType==1){let p=u.focusNode.childNodes[u.focusOffset];p&&p.contentEditable=="false"&&(s=!0)}if(!(s||h&&nn)&&Ji(a.node,a.offset,u.anchorNode,u.anchorOffset)&&Ji(l.node,l.offset,u.focusNode,u.focusOffset))return;let f=!1;if((c.extend||e==t)&&!(h&&Fn)){c.collapse(a.node,a.offset);try{e!=t&&c.extend(l.node,l.offset),f=!0}catch{}}if(!f){if(e>t){let m=a;a=l,l=m}let p=document.createRange();p.setEnd(l.node,l.offset),p.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(p)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,s=0;s<this.children.length;s++){let i=this.children[s],o=r+i.size;if(r==o?e<=o&&t>=r:e<o&&t>r){let a=r+i.border,l=o-i.border;if(e>=a&&t<=l){this.dirty=e==r||t==o?Ri:Uw,e==a&&t==l&&(i.contentLost||i.dom.parentNode!=this.contentDOM)?i.dirty=Cr:i.markDirty(e-a,t-a);return}else i.dirty=i.dom==i.contentDOM&&i.dom.parentNode==this.contentDOM&&!i.children.length?Ri:Cr}r=o}this.dirty=Ri}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let r=e==1?Ri:Uw;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class pA extends dc{constructor(e,t,r,s){let i,o=t.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!i)return s;if(i.parent)return i.parent.posBeforeChild(i)})),!t.type.spec.raw){if(o.nodeType!=1){let a=document.createElement("span");a.appendChild(o),o=a}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=t,this.widget=t,i=this}matchesWidget(e){return this.dirty==Bn&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class $F extends dc{constructor(e,t,r,s){super(e,[],t,null),this.textDOM=r,this.text=s}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class Qi extends dc{constructor(e,t,r,s,i){super(e,[],r,s),this.mark=t,this.spec=i}static create(e,t,r,s){let i=s.nodeViews[t.type.name],o=i&&i(t,s,r);return(!o||!o.dom)&&(o=oo.renderSpec(document,t.type.spec.toDOM(t,r),null,t.attrs)),new Qi(e,t,o.dom,o.contentDOM||o.dom,o)}parseRule(){return this.dirty&Cr||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Cr&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=Bn){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=Bn}}slice(e,t,r){let s=Qi.create(this.parent,this.mark,!0,r),i=this.children,o=this.size;t<o&&(i=lm(i,t,o,r)),e>0&&(i=lm(i,0,e,r));for(let a=0;a<i.length;a++)i[a].parent=s;return s.children=i,s}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Gs extends dc{constructor(e,t,r,s,i,o,a,l,c){super(e,[],i,o),this.node=t,this.outerDeco=r,this.innerDeco=s,this.nodeDOM=a}static create(e,t,r,s,i,o){let a=i.nodeViews[t.type.name],l,c=a&&a(t,i,()=>{if(!l)return o;if(l.parent)return l.parent.posBeforeChild(l)},r,s),u=c&&c.dom,h=c&&c.contentDOM;if(t.isText){if(!u)u=document.createTextNode(t.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:h}=oo.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs));!h&&!t.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),t.type.spec.draggable&&(u.draggable=!0));let f=u;return u=_A(u,r,t),c?l=new UF(e,t,r,s,u,h||null,f,c,i,o+1):t.isText?new Nd(e,t,r,s,u,f,i):new Gs(e,t,r,s,u,h||null,f,i,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>H.empty)}return e}matchesNode(e,t,r){return this.dirty==Bn&&e.eq(this.node)&&Xu(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let r=this.node.inlineContent,s=t,i=e.composing?this.localCompositionInfo(e,t):null,o=i&&i.pos>-1?i:null,a=i&&i.pos<0,l=new HF(this,o&&o.node,e);qF(this.node,this.innerDeco,(c,u,h)=>{c.spec.marks?l.syncToMarks(c.spec.marks,r,e):c.type.side>=0&&!h&&l.syncToMarks(u==this.node.childCount?Ge.none:this.node.child(u).marks,r,e),l.placeWidget(c,e,s)},(c,u,h,f)=>{l.syncToMarks(c.marks,r,e);let p;l.findNodeMatch(c,u,h,f)||a&&e.state.selection.from>s&&e.state.selection.to<s+c.nodeSize&&(p=l.findIndexWithChild(i.node))>-1&&l.updateNodeAt(c,u,h,p,e)||l.updateNextNode(c,u,h,e,f,s)||l.addNode(c,u,h,e,s),s+=c.nodeSize}),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==Ri)&&(o&&this.protectLocalComposition(e,o),gA(this.contentDOM,this.children,e),Zo&&KF(this.dom))}localCompositionInfo(e,t){let{from:r,to:s}=e.state.selection;if(!(e.state.selection instanceof ue)||r<t||s>t+this.node.content.size)return null;let i=e.input.compositionNode;if(!i||!this.dom.contains(i.parentNode))return null;if(this.node.inlineContent){let o=i.nodeValue,a=GF(this.node.content,o,r-t,s-t);return a<0?null:{node:i,pos:a,text:o}}else return{node:i,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:r,text:s}){if(this.getDesc(t))return;let i=t;for(;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}let o=new $F(this,i,t,s);e.input.compositionNodes.push(o),this.children=lm(this.children,r,r+s.length,e,o)}update(e,t,r,s){return this.dirty==Cr||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,r,s),!0)}updateInner(e,t,r,s){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(s,this.posAtStart),this.dirty=Bn}updateOuterDeco(e){if(Xu(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=yA(this.dom,this.nodeDOM,am(this.outerDeco,this.node,t),am(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function zw(n,e,t,r,s){_A(r,e,n);let i=new Gs(void 0,n,e,t,r,r,r,s,0);return i.contentDOM&&i.updateChildren(s,0),i}class Nd extends Gs{constructor(e,t,r,s,i,o,a){super(e,t,r,s,i,null,o,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,s){return this.dirty==Cr||this.dirty!=Bn&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=Bn||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,s.trackWrites==this.nodeDOM&&(s.trackWrites=null)),this.node=e,this.dirty=Bn,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,r){let s=this.node.cut(e,t),i=document.createTextNode(s.text);return new Nd(this.parent,s,this.outerDeco,this.innerDeco,i,i,r)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=Cr)}get domAtom(){return!1}isText(e){return this.node.text==e}}class mA extends dc{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==Bn&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class UF extends Gs{constructor(e,t,r,s,i,o,a,l,c,u){super(e,t,r,s,i,o,a,c,u),this.spec=l}update(e,t,r,s){if(this.dirty==Cr)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let i=this.spec.update(e,t,r);return i&&this.updateInner(e,t,r,s),i}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,r,s)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,r,s){this.spec.setSelection?this.spec.setSelection(e,t,r.root):super.setSelection(e,t,r,s)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function gA(n,e,t){let r=n.firstChild,s=!1;for(let i=0;i<e.length;i++){let o=e[i],a=o.dom;if(a.parentNode==n){for(;a!=r;)r=Hw(r),s=!0;r=r.nextSibling}else s=!0,n.insertBefore(a,r);if(o instanceof Qi){let l=r?r.previousSibling:n.lastChild;gA(o.contentDOM,o.children,t),r=l?l.nextSibling:n.firstChild}}for(;r;)r=Hw(r),s=!0;s&&t.trackWrites==n&&(t.trackWrites=null)}const ll=function(n){n&&(this.nodeName=n)};ll.prototype=Object.create(null);const xi=[new ll];function am(n,e,t){if(n.length==0)return xi;let r=t?xi[0]:new ll,s=[r];for(let i=0;i<n.length;i++){let o=n[i].type.attrs;if(o){o.nodeName&&s.push(r=new ll(o.nodeName));for(let a in o){let l=o[a];l!=null&&(t&&s.length==1&&s.push(r=new ll(e.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return s}function yA(n,e,t,r){if(t==xi&&r==xi)return e;let s=e;for(let i=0;i<r.length;i++){let o=r[i],a=t[i];if(i){let l;a&&a.nodeName==o.nodeName&&s!=n&&(l=s.parentNode)&&l.nodeName.toLowerCase()==o.nodeName||(l=document.createElement(o.nodeName),l.pmIsDeco=!0,l.appendChild(s),a=xi[0]),s=l}zF(s,a||xi[0],o)}return s}function zF(n,e,t){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in t)&&n.removeAttribute(r);for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&t[r]!=e[r]&&n.setAttribute(r,t[r]);if(e.class!=t.class){let r=e.class?e.class.split(" ").filter(Boolean):[],s=t.class?t.class.split(" ").filter(Boolean):[];for(let i=0;i<r.length;i++)s.indexOf(r[i])==-1&&n.classList.remove(r[i]);for(let i=0;i<s.length;i++)r.indexOf(s[i])==-1&&n.classList.add(s[i]);n.classList.length==0&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,s;for(;s=r.exec(e.style);)n.style.removeProperty(s[1])}t.style&&(n.style.cssText+=t.style)}}function _A(n,e,t){return yA(n,n,xi,am(e,t,n.nodeType!=1))}function Xu(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function Hw(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class HF{constructor(e,t,r){this.lock=t,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=jF(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,r){let s=0,i=this.stack.length>>1,o=Math.min(i,e.length);for(;s<o&&(s==i-1?this.top:this.stack[s+1<<1]).matchesMark(e[s])&&e[s].type.spec.spanning!==!1;)s++;for(;s<i;)this.destroyRest(),this.top.dirty=Bn,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let c=this.top.children[l];if(c.matchesMark(e[i])&&!this.isLocked(c.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=Qi.create(this.top,e[i],t,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,i++}}findNodeMatch(e,t,r,s){let i=-1,o;if(s>=this.preMatch.index&&(o=this.preMatch.matches[s-this.preMatch.index]).parent==this.top&&o.matchesNode(e,t,r))i=this.top.children.indexOf(o,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(e,t,r)&&!this.preMatch.matched.has(c)){i=a;break}}return i<0?!1:(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(e,t,r,s,i){let o=this.top.children[s];return o.dirty==Cr&&o.dom==o.contentDOM&&(o.dirty=Ri),o.update(e,t,r,i)?(this.destroyBetween(this.index,s),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let s=this.index;s<this.top.children.length;s++)if(this.top.children[s]==r)return s}return-1}e=t}}updateNextNode(e,t,r,s,i,o){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof Gs){let c=this.preMatch.matched.get(l);if(c!=null&&c!=i)return!1;let u=l.dom,h,f=this.isLocked(u)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=Cr&&Xu(t,l.outerDeco));if(!f&&l.update(e,t,r,s))return this.destroyBetween(this.index,a),l.dom!=u&&(this.changed=!0),this.index++,!0;if(!f&&(h=this.recreateWrapper(l,e,t,r,s,o)))return this.destroyBetween(this.index,a),this.top.children[this.index]=h,h.contentDOM&&(h.dirty=Ri,h.updateChildren(s,o+1),h.dirty=Bn),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,r,s,i,o){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!Xu(r,e.outerDeco)||!s.eq(e.innerDeco))return null;let a=Gs.create(this.top,t,r,s,i,o);if(a.contentDOM){a.children=e.children,e.children=[];for(let l of a.children)l.parent=a}return e.destroy(),a}addNode(e,t,r,s,i){let o=Gs.create(this.top,e,t,r,s,i);o.contentDOM&&o.updateChildren(s,i+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,t,r){let s=this.index<this.top.children.length?this.top.children[this.index]:null;if(s&&s.matchesWidget(e)&&(e==s.widget||!s.widget.type.toDOM.parentNode))this.index++;else{let i=new pA(this.top,e,t,r);this.top.children.splice(this.index++,0,i),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof Qi;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof Nd)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((nn||kt)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let s=new mA(this.top,[],r,null);t!=this.top?t.children.push(s):t.children.splice(this.index++,0,s),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function jF(n,e){let t=e,r=t.children.length,s=n.childCount,i=new Map,o=[];e:for(;s>0;){let a;for(;;)if(r){let c=t.children[r-1];if(c instanceof Qi)t=c,r=c.children.length;else{a=c,r--;break}}else{if(t==e)break e;r=t.parent.children.indexOf(t),t=t.parent}let l=a.node;if(l){if(l!=n.child(s-1))break;--s,i.set(a,s),o.push(a)}}return{index:s,matched:i,matches:o.reverse()}}function WF(n,e){return n.type.side-e.type.side}function qF(n,e,t,r){let s=e.locals(n),i=0;if(s.length==0){for(let c=0;c<n.childCount;c++){let u=n.child(c);r(u,s,e.forChild(i,u),c),i+=u.nodeSize}return}let o=0,a=[],l=null;for(let c=0;;){let u,h;for(;o<s.length&&s[o].to==i;){let v=s[o++];v.widget&&(u?(h||(h=[u])).push(v):u=v)}if(u)if(h){h.sort(WF);for(let v=0;v<h.length;v++)t(h[v],c,!!l)}else t(u,c,!!l);let f,p;if(l)p=-1,f=l,l=null;else if(c<n.childCount)p=c,f=n.child(c++);else break;for(let v=0;v<a.length;v++)a[v].to<=i&&a.splice(v--,1);for(;o<s.length&&s[o].from<=i&&s[o].to>i;)a.push(s[o++]);let m=i+f.nodeSize;if(f.isText){let v=m;o<s.length&&s[o].from<v&&(v=s[o].from);for(let T=0;T<a.length;T++)a[T].to<v&&(v=a[T].to);v<m&&(l=f.cut(v-i),f=f.cut(0,v-i),m=v,p=-1)}else for(;o<s.length&&s[o].to<m;)o++;let y=f.isInline&&!f.isLeaf?a.filter(v=>!v.inline):a.slice();r(f,y,e.forChild(i,f),p),i=m}}function KF(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=e}}function GF(n,e,t,r){for(let s=0,i=0;s<n.childCount&&i<=r;){let o=n.child(s++),a=i;if(i+=o.nodeSize,!o.isText)continue;let l=o.text;for(;s<n.childCount;){let c=n.child(s++);if(i+=c.nodeSize,!c.isText)break;l+=c.text}if(i>=t){if(i>=r&&l.slice(r-e.length-a,r-a)==e)return r-e.length;let c=a<r?l.lastIndexOf(e,r-a-1):-1;if(c>=0&&c+e.length+a>=t)return a+c;if(t==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}function lm(n,e,t,r,s){let i=[];for(let o=0,a=0;o<n.length;o++){let l=n[o],c=a,u=a+=l.size;c>=t||u<=e?i.push(l):(c<e&&i.push(l.slice(0,e-c,r)),s&&(i.push(s),s=void 0),u>t&&i.push(l.slice(t-c,l.size,r)))}return i}function ly(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let s=n.docView.nearestDesc(t.focusNode),i=s&&s.size==0,o=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(o<0)return null;let a=r.resolve(o),l,c;if(Pd(t)){for(l=o;s&&!s.node;)s=s.parent;let h=s.node;if(s&&h.isAtom&&le.isSelectable(h)&&s.parent&&!(h.isInline&&bF(t.focusNode,t.focusOffset,s.dom))){let f=s.posBefore;c=new le(o==f?a:r.resolve(f))}}else{if(t instanceof n.dom.ownerDocument.defaultView.Selection&&t.rangeCount>1){let h=o,f=o;for(let p=0;p<t.rangeCount;p++){let m=t.getRangeAt(p);h=Math.min(h,n.docView.posFromDOM(m.startContainer,m.startOffset,1)),f=Math.max(f,n.docView.posFromDOM(m.endContainer,m.endOffset,-1))}if(h<0)return null;[l,o]=f==n.state.selection.anchor?[f,h]:[h,f],a=r.resolve(o)}else l=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(l<0)return null}let u=r.resolve(l);if(!c){let h=e=="pointer"||n.state.selection.head<a.pos&&!i?1:-1;c=cy(n,u,a,h)}return c}function vA(n){return n.editable?n.hasFocus():bA(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function Qr(n,e=!1){let t=n.state.selection;if(wA(n,t),!!vA(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&kt){let r=n.domSelectionRange(),s=n.domObserver.currentSelection;if(r.anchorNode&&s.anchorNode&&Ji(r.anchorNode,r.anchorOffset,s.anchorNode,s.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)QF(n);else{let{anchor:r,head:s}=t,i,o;jw&&!(t instanceof ue)&&(t.$from.parent.inlineContent||(i=Ww(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(o=Ww(n,t.to))),n.docView.setSelection(r,s,n,e),jw&&(i&&qw(i),o&&qw(o)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&JF(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const jw=nn||kt&&oA<63;function Ww(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),s=r<t.childNodes.length?t.childNodes[r]:null,i=r?t.childNodes[r-1]:null;if(nn&&s&&s.contentEditable=="false")return Hf(s);if((!s||s.contentEditable=="false")&&(!i||i.contentEditable=="false")){if(s)return Hf(s);if(i)return Hf(i)}}function Hf(n){return n.contentEditable="true",nn&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function qw(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function JF(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,s=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=s)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!vA(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function QF(n){let e=n.domSelection();if(!e)return;let t=n.cursorWrapper.dom,r=t.nodeName=="IMG";r?e.collapse(t.parentNode,Ft(t)+1):e.collapse(t,0),!r&&!n.state.selection.visible&&yn&&Ks<=11&&(t.disabled=!0,t.disabled=!1)}function wA(n,e){if(e instanceof le){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(Kw(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else Kw(n)}function Kw(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function cy(n,e,t,r){return n.someProp("createSelectionBetween",s=>s(n,e,t))||ue.between(e,t,r)}function Gw(n){return n.editable&&!n.hasFocus()?!1:bA(n)}function bA(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function YF(n){let e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.domSelectionRange();return Ji(e.node,e.offset,t.anchorNode,t.anchorOffset)}function cm(n,e){let{$anchor:t,$head:r}=n.selection,s=e>0?t.max(r):t.min(r),i=s.parent.inlineContent?s.depth?n.doc.resolve(e>0?s.after():s.before()):null:s;return i&&me.findFrom(i,e)}function Ts(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function Jw(n,e,t){let r=n.state.selection;if(r instanceof ue)if(t.indexOf("s")>-1){let{$head:s}=r,i=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter;if(!i||i.isText||!i.isLeaf)return!1;let o=n.state.doc.resolve(s.pos+i.nodeSize*(e<0?-1:1));return Ts(n,new ue(r.$anchor,o))}else if(r.empty){if(n.endOfTextblock(e>0?"forward":"backward")){let s=cm(n.state,e);return s&&s instanceof le?Ts(n,s):!1}else if(!(Pn&&t.indexOf("m")>-1)){let s=r.$head,i=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter,o;if(!i||i.isText)return!1;let a=e<0?s.pos-i.nodeSize:s.pos;return i.isAtom||(o=n.docView.descAt(a))&&!o.contentDOM?le.isSelectable(i)?Ts(n,new le(e<0?n.state.doc.resolve(s.pos-i.nodeSize):s)):hc?Ts(n,new ue(n.state.doc.resolve(e<0?a:a+i.nodeSize))):!1:!1}}else return!1;else{if(r instanceof le&&r.node.isInline)return Ts(n,new ue(e>0?r.$to:r.$from));{let s=cm(n.state,e);return s?Ts(n,s):!1}}}function Zu(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function cl(n,e){let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function mo(n,e){return e<0?XF(n):ZF(n)}function XF(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let s,i,o=!1;for(Fn&&t.nodeType==1&&r<Zu(t)&&cl(t.childNodes[r],-1)&&(o=!0);;)if(r>0){if(t.nodeType!=1)break;{let a=t.childNodes[r-1];if(cl(a,-1))s=t,i=--r;else if(a.nodeType==3)t=a,r=t.nodeValue.length;else break}}else{if(EA(t))break;{let a=t.previousSibling;for(;a&&cl(a,-1);)s=t.parentNode,i=Ft(a),a=a.previousSibling;if(a)t=a,r=Zu(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}o?um(n,t,r):s&&um(n,s,i)}function ZF(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let s=Zu(t),i,o;for(;;)if(r<s){if(t.nodeType!=1)break;let a=t.childNodes[r];if(cl(a,1))i=t,o=++r;else break}else{if(EA(t))break;{let a=t.nextSibling;for(;a&&cl(a,1);)i=a.parentNode,o=Ft(a)+1,a=a.nextSibling;if(a)t=a,r=0,s=Zu(t);else{if(t=t.parentNode,t==n.dom)break;r=s=0}}}i&&um(n,i,o)}function EA(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function e6(n,e){for(;n&&e==n.childNodes.length&&!uc(n);)e=Ft(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function t6(n,e){for(;n&&!e&&!uc(n);)e=Ft(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function um(n,e,t){if(e.nodeType!=3){let i,o;(o=e6(e,t))?(e=o,t=0):(i=t6(e,t))&&(e=i,t=i.nodeValue.length)}let r=n.domSelection();if(!r)return;if(Pd(r)){let i=document.createRange();i.setEnd(e,t),i.setStart(e,t),r.removeAllRanges(),r.addRange(i)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:s}=n;setTimeout(()=>{n.state==s&&Qr(n)},50)}function Qw(n,e){let t=n.state.doc.resolve(e);if(!(kt||aA)&&t.parent.inlineContent){let s=n.coordsAtPos(e);if(e>t.start()){let i=n.coordsAtPos(e-1),o=(i.top+i.bottom)/2;if(o>s.top&&o<s.bottom&&Math.abs(i.left-s.left)>1)return i.left<s.left?"ltr":"rtl"}if(e<t.end()){let i=n.coordsAtPos(e+1),o=(i.top+i.bottom)/2;if(o>s.top&&o<s.bottom&&Math.abs(i.left-s.left)>1)return i.left>s.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function Yw(n,e,t){let r=n.state.selection;if(r instanceof ue&&!r.empty||t.indexOf("s")>-1||Pn&&t.indexOf("m")>-1)return!1;let{$from:s,$to:i}=r;if(!s.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let o=cm(n.state,e);if(o&&o instanceof le)return Ts(n,o)}if(!s.parent.inlineContent){let o=e<0?s:i,a=r instanceof kn?me.near(o,e):me.findFrom(o,e);return a?Ts(n,a):!1}return!1}function Xw(n,e){if(!(n.state.selection instanceof ue))return!0;let{$head:t,$anchor:r,empty:s}=n.state.selection;if(!t.sameParent(r))return!0;if(!s)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let i=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(i&&!i.isText){let o=n.state.tr;return e<0?o.delete(t.pos-i.nodeSize,t.pos):o.delete(t.pos,t.pos+i.nodeSize),n.dispatch(o),!0}return!1}function Zw(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function n6(n){if(!nn||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;Zw(n,r,"true"),setTimeout(()=>Zw(n,r,"false"),20)}return!1}function r6(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function s6(n,e){let t=e.keyCode,r=r6(e);if(t==8||Pn&&t==72&&r=="c")return Xw(n,-1)||mo(n,-1);if(t==46&&!e.shiftKey||Pn&&t==68&&r=="c")return Xw(n,1)||mo(n,1);if(t==13||t==27)return!0;if(t==37||Pn&&t==66&&r=="c"){let s=t==37?Qw(n,n.state.selection.from)=="ltr"?-1:1:-1;return Jw(n,s,r)||mo(n,s)}else if(t==39||Pn&&t==70&&r=="c"){let s=t==39?Qw(n,n.state.selection.from)=="ltr"?1:-1:1;return Jw(n,s,r)||mo(n,s)}else{if(t==38||Pn&&t==80&&r=="c")return Yw(n,-1,r)||mo(n,-1);if(t==40||Pn&&t==78&&r=="c")return n6(n)||Yw(n,1,r)||mo(n,1);if(r==(Pn?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function uy(n,e){n.someProp("transformCopied",p=>{e=p(e,n)});let t=[],{content:r,openStart:s,openEnd:i}=e;for(;s>1&&i>1&&r.childCount==1&&r.firstChild.childCount==1;){s--,i--;let p=r.firstChild;t.push(p.type.name,p.attrs!=p.type.defaultAttrs?p.attrs:null),r=p.content}let o=n.someProp("clipboardSerializer")||oo.fromSchema(n.state.schema),a=kA(),l=a.createElement("div");l.appendChild(o.serializeFragment(r,{document:a}));let c=l.firstChild,u,h=0;for(;c&&c.nodeType==1&&(u=IA[c.nodeName.toLowerCase()]);){for(let p=u.length-1;p>=0;p--){let m=a.createElement(u[p]);for(;l.firstChild;)m.appendChild(l.firstChild);l.appendChild(m),h++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${s} ${i}${h?` -${h}`:""} ${JSON.stringify(t)}`);let f=n.someProp("clipboardTextSerializer",p=>p(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:f,slice:e}}function TA(n,e,t,r,s){let i=s.parent.type.spec.code,o,a;if(!t&&!e)return null;let l=!!e&&(r||i||!t);if(l){if(n.someProp("transformPastedText",f=>{e=f(e,i||r,n)}),i)return a=new X(H.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),n.someProp("transformPasted",f=>{a=f(a,n,!0)}),a;let h=n.someProp("clipboardTextParser",f=>f(e,s,r,n));if(h)a=h;else{let f=s.marks(),{schema:p}=n.state,m=oo.fromSchema(p);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(y=>{let v=o.appendChild(document.createElement("p"));y&&v.appendChild(m.serializeNode(p.text(y,f)))})}}else n.someProp("transformPastedHTML",h=>{t=h(t,n)}),o=l6(t),hc&&c6(o);let c=o&&o.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let h=+u[3];h>0;h--){let f=o.firstChild;for(;f&&f.nodeType!=1;)f=f.nextSibling;if(!f)break;o=f}if(a||(a=(n.someProp("clipboardParser")||n.someProp("domParser")||qs.fromSchema(n.state.schema)).parseSlice(o,{preserveWhitespace:!!(l||u),context:s,ruleFromNode(f){return f.nodeName=="BR"&&!f.nextSibling&&f.parentNode&&!i6.test(f.parentNode.nodeName)?{ignore:!0}:null}})),u)a=u6(eb(a,+u[1],+u[2]),u[4]);else if(a=X.maxOpen(o6(a.content,s),!0),a.openStart||a.openEnd){let h=0,f=0;for(let p=a.content.firstChild;h<a.openStart&&!p.type.spec.isolating;h++,p=p.firstChild);for(let p=a.content.lastChild;f<a.openEnd&&!p.type.spec.isolating;f++,p=p.lastChild);a=eb(a,h,f)}return n.someProp("transformPasted",h=>{a=h(a,n,l)}),a}const i6=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function o6(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let s=e.node(t).contentMatchAt(e.index(t)),i,o=[];if(n.forEach(a=>{if(!o)return;let l=s.findWrapping(a.type),c;if(!l)return o=null;if(c=o.length&&i.length&&CA(l,i,a,o[o.length-1],0))o[o.length-1]=c;else{o.length&&(o[o.length-1]=AA(o[o.length-1],i.length));let u=SA(a,l);o.push(u),s=s.matchType(u.type),i=l}}),o)return H.from(o)}return n}function SA(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,H.from(n));return n}function CA(n,e,t,r,s){if(s<n.length&&s<e.length&&n[s]==e[s]){let i=CA(n,e,t,r.lastChild,s+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(s==n.length-1?t.type:n[s+1]))return r.copy(r.content.append(H.from(SA(t,n,s+1))))}}function AA(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,AA(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(H.empty,!0);return n.copy(t.append(r))}function hm(n,e,t,r,s,i){let o=e<0?n.firstChild:n.lastChild,a=o.content;return n.childCount>1&&(i=0),s<r-1&&(a=hm(a,e,t,r,s+1,i)),s>=t&&(a=e<0?o.contentMatchAt(0).fillBefore(a,i<=s).append(a):a.append(o.contentMatchAt(o.childCount).fillBefore(H.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,o.copy(a))}function eb(n,e,t){return e<n.openStart&&(n=new X(hm(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new X(hm(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const IA={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let tb=null;function kA(){return tb||(tb=document.implementation.createHTMLDocument("title"))}let jf=null;function a6(n){let e=window.trustedTypes;return e?(jf||(jf=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:t=>t})),jf.createHTML(n)):n}function l6(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=kA().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),s;if((s=r&&IA[r[1].toLowerCase()])&&(n=s.map(i=>"<"+i+">").join("")+n+s.map(i=>"</"+i+">").reverse().join("")),t.innerHTML=a6(n),s)for(let i=0;i<s.length;i++)t=t.querySelector(s[i])||t;return t}function c6(n){let e=n.querySelectorAll(kt?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function u6(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return n}let{content:s,openStart:i,openEnd:o}=n;for(let a=r.length-2;a>=0;a-=2){let l=t.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;s=H.from(l.create(r[a+1],s)),i++,o++}return new X(s,i,o)}const hn={},dn={},h6={touchstart:!0,touchmove:!0};class d6{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function f6(n){for(let e in hn){let t=hn[e];n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>{m6(n,r)&&!hy(n,r)&&(n.editable||!(r.type in dn))&&t(n,r)},h6[e]?{passive:!0}:void 0)}nn&&n.dom.addEventListener("input",()=>null),dm(n)}function Vs(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}function p6(n){n.domObserver.stop();for(let e in n.input.eventHandlers)n.dom.removeEventListener(e,n.input.eventHandlers[e]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function dm(n){n.someProp("handleDOMEvents",e=>{for(let t in e)n.input.eventHandlers[t]||n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>hy(n,r))})}function hy(n,e){return n.someProp("handleDOMEvents",t=>{let r=t[e.type];return r?r(n,e)||e.defaultPrevented:!1})}function m6(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=n.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function g6(n,e){!hy(n,e)&&hn[e.type]&&(n.editable||!(e.type in dn))&&hn[e.type](n,e)}dn.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!xA(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(Kr&&kt&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),Zo&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",s=>s(n,Ii(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||s6(n,t)?t.preventDefault():Vs(n,"key")};dn.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};dn.keypress=(n,e)=>{let t=e;if(xA(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||Pn&&t.metaKey)return;if(n.someProp("handleKeyPress",s=>s(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof ue)||!r.$from.sameParent(r.$to)){let s=String.fromCharCode(t.charCode),i=()=>n.state.tr.insertText(s).scrollIntoView();!/[\r\n]/.test(s)&&!n.someProp("handleTextInput",o=>o(n,r.$from.pos,r.$to.pos,s,i))&&n.dispatch(i()),t.preventDefault()}};function Od(n){return{left:n.clientX,top:n.clientY}}function y6(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function dy(n,e,t,r,s){if(r==-1)return!1;let i=n.state.doc.resolve(r);for(let o=i.depth+1;o>0;o--)if(n.someProp(e,a=>o>i.depth?a(n,t,i.nodeAfter,i.before(o),s,!0):a(n,t,i.node(o),i.before(o),s,!1)))return!0;return!1}function Bo(n,e,t){if(n.focused||n.focus(),n.state.selection.eq(e))return;let r=n.state.tr.setSelection(e);r.setMeta("pointer",!0),n.dispatch(r)}function _6(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&le.isSelectable(r)?(Bo(n,new le(t)),!0):!1}function v6(n,e){if(e==-1)return!1;let t=n.state.selection,r,s;t instanceof le&&(r=t.node);let i=n.state.doc.resolve(e);for(let o=i.depth+1;o>0;o--){let a=o>i.depth?i.nodeAfter:i.node(o);if(le.isSelectable(a)){r&&t.$from.depth>0&&o>=t.$from.depth&&i.before(t.$from.depth+1)==t.$from.pos?s=i.before(t.$from.depth):s=i.before(o);break}}return s!=null?(Bo(n,le.create(n.state.doc,s)),!0):!1}function w6(n,e,t,r,s){return dy(n,"handleClickOn",e,t,r)||n.someProp("handleClick",i=>i(n,e,r))||(s?v6(n,t):_6(n,t))}function b6(n,e,t,r){return dy(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",s=>s(n,e,r))}function E6(n,e,t,r){return dy(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",s=>s(n,e,r))||T6(n,t,r)}function T6(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(Bo(n,ue.create(r,0,r.content.size)),!0):!1;let s=r.resolve(e);for(let i=s.depth+1;i>0;i--){let o=i>s.depth?s.nodeAfter:s.node(i),a=s.before(i);if(o.inlineContent)Bo(n,ue.create(r,a+1,a+1+o.content.size));else if(le.isSelectable(o))Bo(n,le.create(r,a));else continue;return!0}}function fy(n){return eh(n)}const RA=Pn?"metaKey":"ctrlKey";hn.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=fy(n),s=Date.now(),i="singleClick";s-n.input.lastClick.time<500&&y6(t,n.input.lastClick)&&!t[RA]&&n.input.lastClick.button==t.button&&(n.input.lastClick.type=="singleClick"?i="doubleClick":n.input.lastClick.type=="doubleClick"&&(i="tripleClick")),n.input.lastClick={time:s,x:t.clientX,y:t.clientY,type:i,button:t.button};let o=n.posAtCoords(Od(t));o&&(i=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new S6(n,o,t,!!r)):(i=="doubleClick"?b6:E6)(n,o.pos,o.inside,t)?t.preventDefault():Vs(n,"pointer"))};class S6{constructor(e,t,r,s){this.view=e,this.pos=t,this.event=r,this.flushed=s,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[RA],this.allowDefault=r.shiftKey;let i,o;if(t.inside>-1)i=e.state.doc.nodeAt(t.inside),o=t.inside;else{let u=e.state.doc.resolve(t.pos);i=u.parent,o=u.depth?u.before():0}const a=s?null:r.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l&&l.nodeDOM.nodeType==1?l.nodeDOM:null;let{selection:c}=e.state;(r.button==0&&i.type.spec.draggable&&i.type.spec.selectable!==!1||c instanceof le&&c.from<=o&&c.to>o)&&(this.mightDrag={node:i,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Fn&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Vs(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Qr(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(Od(e))),this.updateAllowDefault(e),this.allowDefault||!t?Vs(this.view,"pointer"):w6(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||nn&&this.mightDrag&&!this.mightDrag.node.isAtom||kt&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(Bo(this.view,me.near(this.view.state.doc.resolve(t.pos))),e.preventDefault()):Vs(this.view,"pointer")}move(e){this.updateAllowDefault(e),Vs(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}hn.touchstart=n=>{n.input.lastTouch=Date.now(),fy(n),Vs(n,"pointer")};hn.touchmove=n=>{n.input.lastTouch=Date.now(),Vs(n,"pointer")};hn.contextmenu=n=>fy(n);function xA(n,e){return n.composing?!0:nn&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const C6=Kr?5e3:-1;dn.compositionstart=dn.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$to;if(e.selection instanceof ue&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)||kt&&aA&&A6(n)))n.markCursor=n.state.storedMarks||t.marks(),eh(n,!0),n.markCursor=null;else if(eh(n,!e.selection.empty),Fn&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let s=r.focusNode,i=r.focusOffset;s&&s.nodeType==1&&i!=0;){let o=i<0?s.lastChild:s.childNodes[i-1];if(!o)break;if(o.nodeType==3){let a=n.domSelection();a&&a.collapse(o,o.nodeValue.length);break}else s=o,i=-1}}n.input.composing=!0}MA(n,C6)};function A6(n){let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(!e||e.nodeType!=1||t>=e.childNodes.length)return!1;let r=e.childNodes[t];return r.nodeType==1&&r.contentEditable=="false"}dn.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,MA(n,20))};function MA(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>eh(n),e))}function PA(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=k6());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function I6(n){let e=n.domSelectionRange();if(!e.focusNode)return null;let t=vF(e.focusNode,e.focusOffset),r=wF(e.focusNode,e.focusOffset);if(t&&r&&t!=r){let s=r.pmViewDesc,i=n.domObserver.lastChangedTextNode;if(t==i||r==i)return i;if(!s||!s.isText(r.nodeValue))return r;if(n.input.compositionNode==r){let o=t.pmViewDesc;if(!(!o||!o.isText(t.nodeValue)))return r}}return t||r}function k6(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function eh(n,e=!1){if(!(Kr&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),PA(n),e||n.docView&&n.docView.dirty){let t=ly(n),r=n.state.selection;return t&&!t.eq(r)?n.dispatch(n.state.tr.setSelection(t)):(n.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?n.dispatch(n.state.tr.deleteSelection()):n.updateState(n.state),!0}return!1}}function R6(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),s=document.createRange();s.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(s),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const Ul=yn&&Ks<15||Zo&&SF<604;hn.copy=dn.cut=(n,e)=>{let t=e,r=n.state.selection,s=t.type=="cut";if(r.empty)return;let i=Ul?null:t.clipboardData,o=r.content(),{dom:a,text:l}=uy(n,o);i?(t.preventDefault(),i.clearData(),i.setData("text/html",a.innerHTML),i.setData("text/plain",l)):R6(n,a),s&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function x6(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function M6(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let s=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?zl(n,r.value,null,s,e):zl(n,r.textContent,r.innerHTML,s,e)},50)}function zl(n,e,t,r,s){let i=TA(n,e,t,r,n.state.selection.$from);if(n.someProp("handlePaste",l=>l(n,s,i||X.empty)))return!0;if(!i)return!1;let o=x6(i),a=o?n.state.tr.replaceSelectionWith(o,r):n.state.tr.replaceSelection(i);return n.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function NA(n){let e=n.getData("text/plain")||n.getData("Text");if(e)return e;let t=n.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}dn.paste=(n,e)=>{let t=e;if(n.composing&&!Kr)return;let r=Ul?null:t.clipboardData,s=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&zl(n,NA(r),r.getData("text/html"),s,t)?t.preventDefault():M6(n,t)};class OA{constructor(e,t,r){this.slice=e,this.move=t,this.node=r}}const P6=Pn?"altKey":"ctrlKey";function DA(n,e){let t=n.someProp("dragCopies",r=>!r(e));return t??!e[P6]}hn.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let s=n.state.selection,i=s.empty?null:n.posAtCoords(Od(t)),o;if(!(i&&i.pos>=s.from&&i.pos<=(s instanceof le?s.to-1:s.to))){if(r&&r.mightDrag)o=le.create(n.state.doc,r.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let h=n.docView.nearestDesc(t.target,!0);h&&h.node.type.spec.draggable&&h!=n.docView&&(o=le.create(n.state.doc,h.posBefore))}}let a=(o||n.state.selection).content(),{dom:l,text:c,slice:u}=uy(n,a);(!t.dataTransfer.files.length||!kt||oA>120)&&t.dataTransfer.clearData(),t.dataTransfer.setData(Ul?"Text":"text/html",l.innerHTML),t.dataTransfer.effectAllowed="copyMove",Ul||t.dataTransfer.setData("text/plain",c),n.dragging=new OA(u,DA(n,t),o)};hn.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};dn.dragover=dn.dragenter=(n,e)=>e.preventDefault();dn.drop=(n,e)=>{try{N6(n,e,n.dragging)}finally{n.dragging=null}};function N6(n,e,t){if(!e.dataTransfer)return;let r=n.posAtCoords(Od(e));if(!r)return;let s=n.state.doc.resolve(r.pos),i=t&&t.slice;i?n.someProp("transformPasted",p=>{i=p(i,n,!1)}):i=TA(n,NA(e.dataTransfer),Ul?null:e.dataTransfer.getData("text/html"),!1,s);let o=!!(t&&DA(n,e));if(n.someProp("handleDrop",p=>p(n,e,i||X.empty,o))){e.preventDefault();return}if(!i)return;e.preventDefault();let a=i?BC(n.state.doc,s.pos,i):s.pos;a==null&&(a=s.pos);let l=n.state.tr;if(o){let{node:p}=t;p?p.replace(l):l.deleteSelection()}let c=l.mapping.map(a),u=i.openStart==0&&i.openEnd==0&&i.content.childCount==1,h=l.doc;if(u?l.replaceRangeWith(c,c,i.content.firstChild):l.replaceRange(c,c,i),l.doc.eq(h))return;let f=l.doc.resolve(c);if(u&&le.isSelectable(i.content.firstChild)&&f.nodeAfter&&f.nodeAfter.sameMarkup(i.content.firstChild))l.setSelection(new le(f));else{let p=l.mapping.map(a);l.mapping.maps[l.mapping.maps.length-1].forEach((m,y,v,T)=>p=T),l.setSelection(cy(n,f,l.doc.resolve(p)))}n.focus(),n.dispatch(l.setMeta("uiEvent","drop"))}hn.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&Qr(n)},20))};hn.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};hn.beforeinput=(n,e)=>{if(kt&&Kr&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",i=>i(n,Ii(8,"Backspace")))))return;let{$cursor:s}=n.state.selection;s&&s.pos>0&&n.dispatch(n.state.tr.delete(s.pos-1,s.pos).scrollIntoView())},50)}};for(let n in dn)hn[n]=dn[n];function Hl(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class th{constructor(e,t){this.toDOM=e,this.spec=t||Bi,this.side=this.spec.side||0}map(e,t,r,s){let{pos:i,deleted:o}=e.mapResult(t.from+s,this.side<0?-1:1);return o?null:new Rt(i-r,i-r,this)}valid(){return!0}eq(e){return this==e||e instanceof th&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Hl(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Js{constructor(e,t){this.attrs=e,this.spec=t||Bi}map(e,t,r,s){let i=e.map(t.from+s,this.spec.inclusiveStart?-1:1)-r,o=e.map(t.to+s,this.spec.inclusiveEnd?1:-1)-r;return i>=o?null:new Rt(i,o,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof Js&&Hl(this.attrs,e.attrs)&&Hl(this.spec,e.spec)}static is(e){return e.type instanceof Js}destroy(){}}class py{constructor(e,t){this.attrs=e,this.spec=t||Bi}map(e,t,r,s){let i=e.mapResult(t.from+s,1);if(i.deleted)return null;let o=e.mapResult(t.to+s,-1);return o.deleted||o.pos<=i.pos?null:new Rt(i.pos-r,o.pos-r,this)}valid(e,t){let{index:r,offset:s}=e.content.findIndex(t.from),i;return s==t.from&&!(i=e.child(r)).isText&&s+i.nodeSize==t.to}eq(e){return this==e||e instanceof py&&Hl(this.attrs,e.attrs)&&Hl(this.spec,e.spec)}destroy(){}}class Rt{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new Rt(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new Rt(e,e,new th(t,r))}static inline(e,t,r,s){return new Rt(e,t,new Js(r,s))}static node(e,t,r,s){return new Rt(e,t,new py(r,s))}get spec(){return this.type.spec}get inline(){return this.type instanceof Js}get widget(){return this.type instanceof th}}const So=[],Bi={};class Qe{constructor(e,t){this.local=e.length?e:So,this.children=t.length?t:So}static create(e,t){return t.length?nh(t,e,0,Bi):Jt}find(e,t,r){let s=[];return this.findInner(e??0,t??1e9,s,0,r),s}findInner(e,t,r,s,i){for(let o=0;o<this.local.length;o++){let a=this.local[o];a.from<=t&&a.to>=e&&(!i||i(a.spec))&&r.push(a.copy(a.from+s,a.to+s))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<t&&this.children[o+1]>e){let a=this.children[o]+1;this.children[o+2].findInner(e-a,t-a,r,s+a,i)}}map(e,t,r){return this==Jt||e.maps.length==0?this:this.mapInner(e,t,0,0,r||Bi)}mapInner(e,t,r,s,i){let o;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,r,s);l&&l.type.valid(t,l)?(o||(o=[])).push(l):i.onRemove&&i.onRemove(this.local[a].spec)}return this.children.length?O6(this.children,o||[],e,t,r,s,i):o?new Qe(o.sort($i),So):Jt}add(e,t){return t.length?this==Jt?Qe.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let s,i=0;e.forEach((a,l)=>{let c=l+r,u;if(u=VA(t,a,c)){for(s||(s=this.children.slice());i<s.length&&s[i]<l;)i+=3;s[i]==l?s[i+2]=s[i+2].addInner(a,u,c+1):s.splice(i,0,l,l+a.nodeSize,nh(u,a,c+1,Bi)),i+=3}});let o=LA(i?FA(t):t,-r);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||o.splice(a--,1);return new Qe(o.length?this.local.concat(o).sort($i):this.local,s||this.children)}remove(e){return e.length==0||this==Jt?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,s=this.local;for(let i=0;i<r.length;i+=3){let o,a=r[i]+t,l=r[i+1]+t;for(let u=0,h;u<e.length;u++)(h=e[u])&&h.from>a&&h.to<l&&(e[u]=null,(o||(o=[])).push(h));if(!o)continue;r==this.children&&(r=this.children.slice());let c=r[i+2].removeInner(o,a+1);c!=Jt?r[i+2]=c:(r.splice(i,3),i-=3)}if(s.length){for(let i=0,o;i<e.length;i++)if(o=e[i])for(let a=0;a<s.length;a++)s[a].eq(o,t)&&(s==this.local&&(s=this.local.slice()),s.splice(a--,1))}return r==this.children&&s==this.local?this:s.length||r.length?new Qe(s,r):Jt}forChild(e,t){if(this==Jt)return this;if(t.isLeaf)return Qe.empty;let r,s;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let i=e+1,o=i+t.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<o&&l.to>i&&l.type instanceof Js){let c=Math.max(i,l.from)-i,u=Math.min(o,l.to)-i;c<u&&(s||(s=[])).push(l.copy(c,u))}}if(s){let a=new Qe(s.sort($i),So);return r?new xs([a,r]):a}return r||Jt}eq(e){if(this==e)return!0;if(!(e instanceof Qe)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return my(this.localsInner(e))}localsInner(e){if(this==Jt)return So;if(e.inlineContent||!this.local.some(Js.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Js||t.push(this.local[r]);return t}forEachSet(e){e(this)}}Qe.empty=new Qe([],[]);Qe.removeOverlap=my;const Jt=Qe.empty;class xs{constructor(e){this.members=e}map(e,t){const r=this.members.map(s=>s.map(e,t,Bi));return xs.from(r)}forChild(e,t){if(t.isLeaf)return Qe.empty;let r=[];for(let s=0;s<this.members.length;s++){let i=this.members[s].forChild(e,t);i!=Jt&&(i instanceof xs?r=r.concat(i.members):r.push(i))}return xs.from(r)}eq(e){if(!(e instanceof xs)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let s=0;s<this.members.length;s++){let i=this.members[s].localsInner(e);if(i.length)if(!t)t=i;else{r&&(t=t.slice(),r=!1);for(let o=0;o<i.length;o++)t.push(i[o])}}return t?my(r?t:t.sort($i)):So}static from(e){switch(e.length){case 0:return Jt;case 1:return e[0];default:return new xs(e.every(t=>t instanceof Qe)?e:e.reduce((t,r)=>t.concat(r instanceof Qe?r:r.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function O6(n,e,t,r,s,i,o){let a=n.slice();for(let c=0,u=i;c<t.maps.length;c++){let h=0;t.maps[c].forEach((f,p,m,y)=>{let v=y-m-(p-f);for(let T=0;T<a.length;T+=3){let M=a[T+1];if(M<0||f>M+u-h)continue;let P=a[T]+u-h;p>=P?a[T+1]=f<=P?-2:-1:f>=u&&v&&(a[T]+=v,a[T+1]+=v)}h+=v}),u=t.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let u=t.map(n[c]+i),h=u-s;if(h<0||h>=r.content.size){l=!0;continue}let f=t.map(n[c+1]+i,-1),p=f-s,{index:m,offset:y}=r.content.findIndex(h),v=r.maybeChild(m);if(v&&y==h&&y+v.nodeSize==p){let T=a[c+2].mapInner(t,v,u+1,n[c]+i+1,o);T!=Jt?(a[c]=h,a[c+1]=p,a[c+2]=T):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=D6(a,n,e,t,s,i,o),u=nh(c,r,0,o);e=u.local;for(let h=0;h<a.length;h+=3)a[h+1]<0&&(a.splice(h,3),h-=3);for(let h=0,f=0;h<u.children.length;h+=3){let p=u.children[h];for(;f<a.length&&a[f]<p;)f+=3;a.splice(f,0,u.children[h],u.children[h+1],u.children[h+2])}}return new Qe(e.sort($i),a)}function LA(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let s=n[r];t.push(new Rt(s.from+e,s.to+e,s.type))}return t}function D6(n,e,t,r,s,i,o){function a(l,c){for(let u=0;u<l.local.length;u++){let h=l.local[u].map(r,s,c);h?t.push(h):o.onRemove&&o.onRemove(l.local[u].spec)}for(let u=0;u<l.children.length;u+=3)a(l.children[u+2],l.children[u]+c+1)}for(let l=0;l<n.length;l+=3)n[l+1]==-1&&a(n[l+2],e[l]+i+1);return t}function VA(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,s=null;for(let i=0,o;i<n.length;i++)(o=n[i])&&o.from>t&&o.to<r&&((s||(s=[])).push(o),n[i]=null);return s}function FA(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function nh(n,e,t,r){let s=[],i=!1;e.forEach((a,l)=>{let c=VA(n,a,l+t);if(c){i=!0;let u=nh(c,a,t+l+1,r);u!=Jt&&s.push(l,l+a.nodeSize,u)}});let o=LA(i?FA(n):n,-t).sort($i);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||(r.onRemove&&r.onRemove(o[a].spec),o.splice(a--,1));return o.length||s.length?new Qe(o,s):Jt}function $i(n,e){return n.from-e.from||n.to-e.to}function my(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let s=t+1;s<e.length;s++){let i=e[s];if(i.from==r.from){i.to!=r.to&&(e==n&&(e=n.slice()),e[s]=i.copy(i.from,r.to),nb(e,s+1,i.copy(r.to,i.to)));continue}else{i.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,i.from),nb(e,s,r.copy(i.from,r.to)));break}}}return e}function nb(n,e,t){for(;e<n.length&&$i(t,n[e])>0;)e++;n.splice(e,0,t)}function Wf(n){let e=[];return n.someProp("decorations",t=>{let r=t(n.state);r&&r!=Jt&&e.push(r)}),n.cursorWrapper&&e.push(Qe.create(n.state.doc,[n.cursorWrapper.deco])),xs.from(e)}const L6={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},V6=yn&&Ks<=11;class F6{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class B6{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new F6,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let s=0;s<r.length;s++)this.queue.push(r[s]);yn&&Ks<=11&&r.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),V6&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,L6)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(Gw(this.view)){if(this.suppressingSelectionUpdates)return Qr(this.view);if(yn&&Ks<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Ji(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,r;for(let i=e.focusNode;i;i=Xo(i))t.add(i);for(let i=e.anchorNode;i;i=Xo(i))if(t.has(i)){r=i;break}let s=r&&this.view.docView.nearestDesc(r);if(s&&s.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let r=e.domSelectionRange(),s=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&Gw(e)&&!this.ignoreSelectionChange(r),i=-1,o=-1,a=!1,l=[];if(e.editable)for(let u=0;u<t.length;u++){let h=this.registerMutation(t[u],l);h&&(i=i<0?h.from:Math.min(h.from,i),o=o<0?h.to:Math.max(h.to,o),h.typeOver&&(a=!0))}if(Fn&&l.length){let u=l.filter(h=>h.nodeName=="BR");if(u.length==2){let[h,f]=u;h.parentNode&&h.parentNode.parentNode==f.parentNode?f.remove():h.remove()}else{let{focusNode:h}=this.currentSelection;for(let f of u){let p=f.parentNode;p&&p.nodeName=="LI"&&(!h||z6(e,h)!=p)&&f.remove()}}}else if((kt||nn)&&l.some(u=>u.nodeName=="BR")&&(e.input.lastKeyCode==8||e.input.lastKeyCode==46)){for(let u of l)if(u.nodeName=="BR"&&u.parentNode){let h=u.nextSibling;h&&h.nodeType==1&&h.contentEditable=="false"&&u.parentNode.removeChild(u)}}let c=null;i<0&&s&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Pd(r)&&(c=ly(e))&&c.eq(me.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Qr(e),this.currentSelection.set(r),e.scrollToSelection()):(i>-1||s)&&(i>-1&&(e.docView.markDirty(i,o),$6(e)),this.handleDOMChange(i,o,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Qr(e),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let u=0;u<e.addedNodes.length;u++){let h=e.addedNodes[u];t.push(h),h.nodeType==3&&(this.lastChangedTextNode=h)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let s=e.previousSibling,i=e.nextSibling;if(yn&&Ks<=11&&e.addedNodes.length)for(let u=0;u<e.addedNodes.length;u++){let{previousSibling:h,nextSibling:f}=e.addedNodes[u];(!h||Array.prototype.indexOf.call(e.addedNodes,h)<0)&&(s=h),(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(i=f)}let o=s&&s.parentNode==e.target?Ft(s)+1:0,a=r.localPosFromDOM(e.target,o,-1),l=i&&i.parentNode==e.target?Ft(i):e.target.childNodes.length,c=r.localPosFromDOM(e.target,l,1);return{from:a,to:c}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let rb=new WeakMap,sb=!1;function $6(n){if(!rb.has(n)&&(rb.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=Fn,sb)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),sb=!0}}function ib(n,e){let t=e.startContainer,r=e.startOffset,s=e.endContainer,i=e.endOffset,o=n.domAtPos(n.state.selection.anchor);return Ji(o.node,o.offset,s,i)&&([t,r,s,i]=[s,i,t,r]),{anchorNode:t,anchorOffset:r,focusNode:s,focusOffset:i}}function U6(n,e){if(e.getComposedRanges){let s=e.getComposedRanges(n.root)[0];if(s)return ib(n,s)}let t;function r(s){s.preventDefault(),s.stopImmediatePropagation(),t=s.getTargetRanges()[0]}return n.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",r,!0),t?ib(n,t):null}function z6(n,e){for(let t=e.parentNode;t&&t!=n.dom;t=t.parentNode){let r=n.docView.nearestDesc(t,!0);if(r&&r.node.isBlock)return t}return null}function H6(n,e,t){let{node:r,fromOffset:s,toOffset:i,from:o,to:a}=n.docView.parseRange(e,t),l=n.domSelectionRange(),c,u=l.anchorNode;if(u&&n.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:l.anchorOffset}],Pd(l)||c.push({node:l.focusNode,offset:l.focusOffset})),kt&&n.input.lastKeyCode===8)for(let v=i;v>s;v--){let T=r.childNodes[v-1],M=T.pmViewDesc;if(T.nodeName=="BR"&&!M){i=v;break}if(!M||M.size)break}let h=n.state.doc,f=n.someProp("domParser")||qs.fromSchema(n.state.schema),p=h.resolve(o),m=null,y=f.parse(r,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:s,to:i,preserveWhitespace:p.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:j6,context:p});if(c&&c[0].pos!=null){let v=c[0].pos,T=c[1]&&c[1].pos;T==null&&(T=v),m={anchor:v+o,head:T+o}}return{doc:y,sel:m,from:o,to:a}}function j6(n){let e=n.pmViewDesc;if(e)return e.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(nn&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(n.parentNode.lastChild==n||nn&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const W6=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function q6(n,e,t,r,s){let i=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,e<0){let S=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,w=ly(n,S);if(w&&!n.state.selection.eq(w)){if(kt&&Kr&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",I=>I(n,Ii(13,"Enter"))))return;let b=n.state.tr.setSelection(w);S=="pointer"?b.setMeta("pointer",!0):S=="key"&&b.scrollIntoView(),i&&b.setMeta("composition",i),n.dispatch(b)}return}let o=n.state.doc.resolve(e),a=o.sharedDepth(t);e=o.before(a+1),t=n.state.doc.resolve(t).after(a+1);let l=n.state.selection,c=H6(n,e,t),u=n.state.doc,h=u.slice(c.from,c.to),f,p;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(f=n.state.selection.to,p="end"):(f=n.state.selection.from,p="start"),n.input.lastKeyCode=null;let m=J6(h.content,c.doc.content,c.from,f,p);if(m&&n.input.domChangeCount++,(Zo&&n.input.lastIOSEnter>Date.now()-225||Kr)&&s.some(S=>S.nodeType==1&&!W6.test(S.nodeName))&&(!m||m.endA>=m.endB)&&n.someProp("handleKeyDown",S=>S(n,Ii(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!m)if(r&&l instanceof ue&&!l.empty&&l.$head.sameParent(l.$anchor)&&!n.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))m={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let S=ob(n,n.state.doc,c.sel);if(S&&!S.eq(n.state.selection)){let w=n.state.tr.setSelection(S);i&&w.setMeta("composition",i),n.dispatch(w)}}return}n.state.selection.from<n.state.selection.to&&m.start==m.endB&&n.state.selection instanceof ue&&(m.start>n.state.selection.from&&m.start<=n.state.selection.from+2&&n.state.selection.from>=c.from?m.start=n.state.selection.from:m.endA<n.state.selection.to&&m.endA>=n.state.selection.to-2&&n.state.selection.to<=c.to&&(m.endB+=n.state.selection.to-m.endA,m.endA=n.state.selection.to)),yn&&Ks<=11&&m.endB==m.start+1&&m.endA==m.start&&m.start>c.from&&c.doc.textBetween(m.start-c.from-1,m.start-c.from+1)==" "&&(m.start--,m.endA--,m.endB--);let y=c.doc.resolveNoCache(m.start-c.from),v=c.doc.resolveNoCache(m.endB-c.from),T=u.resolve(m.start),M=y.sameParent(v)&&y.parent.inlineContent&&T.end()>=m.endA;if((Zo&&n.input.lastIOSEnter>Date.now()-225&&(!M||s.some(S=>S.nodeName=="DIV"||S.nodeName=="P"))||!M&&y.pos<c.doc.content.size&&(!y.sameParent(v)||!y.parent.inlineContent)&&y.pos<v.pos&&!/\S/.test(c.doc.textBetween(y.pos,v.pos,"","")))&&n.someProp("handleKeyDown",S=>S(n,Ii(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>m.start&&G6(u,m.start,m.endA,y,v)&&n.someProp("handleKeyDown",S=>S(n,Ii(8,"Backspace")))){Kr&&kt&&n.domObserver.suppressSelectionUpdates();return}kt&&m.endB==m.start&&(n.input.lastChromeDelete=Date.now()),Kr&&!M&&y.start()!=v.start()&&v.parentOffset==0&&y.depth==v.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==m.endA&&(m.endB-=2,v=c.doc.resolveNoCache(m.endB-c.from),setTimeout(()=>{n.someProp("handleKeyDown",function(S){return S(n,Ii(13,"Enter"))})},20));let P=m.start,D=m.endA,L=S=>{let w=S||n.state.tr.replace(P,D,c.doc.slice(m.start-c.from,m.endB-c.from));if(c.sel){let b=ob(n,w.doc,c.sel);b&&!(kt&&n.composing&&b.empty&&(m.start!=m.endB||n.input.lastChromeDelete<Date.now()-100)&&(b.head==P||b.head==w.mapping.map(D)-1)||yn&&b.empty&&b.head==P)&&w.setSelection(b)}return i&&w.setMeta("composition",i),w.scrollIntoView()},q;if(M)if(y.pos==v.pos){yn&&Ks<=11&&y.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>Qr(n),20));let S=L(n.state.tr.delete(P,D)),w=u.resolve(m.start).marksAcross(u.resolve(m.endA));w&&S.ensureMarks(w),n.dispatch(S)}else if(m.endA==m.endB&&(q=K6(y.parent.content.cut(y.parentOffset,v.parentOffset),T.parent.content.cut(T.parentOffset,m.endA-T.start())))){let S=L(n.state.tr);q.type=="add"?S.addMark(P,D,q.mark):S.removeMark(P,D,q.mark),n.dispatch(S)}else if(y.parent.child(y.index()).isText&&y.index()==v.index()-(v.textOffset?0:1)){let S=y.parent.textBetween(y.parentOffset,v.parentOffset),w=()=>L(n.state.tr.insertText(S,P,D));n.someProp("handleTextInput",b=>b(n,P,D,S,w))||n.dispatch(w())}else n.dispatch(L());else n.dispatch(L())}function ob(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:cy(n,e.resolve(t.anchor),e.resolve(t.head))}function K6(n,e){let t=n.firstChild.marks,r=e.firstChild.marks,s=t,i=r,o,a,l;for(let u=0;u<r.length;u++)s=r[u].removeFromSet(s);for(let u=0;u<t.length;u++)i=t[u].removeFromSet(i);if(s.length==1&&i.length==0)a=s[0],o="add",l=u=>u.mark(a.addToSet(u.marks));else if(s.length==0&&i.length==1)a=i[0],o="remove",l=u=>u.mark(a.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<e.childCount;u++)c.push(l(e.child(u)));if(H.from(c).eq(n))return{mark:a,type:o}}function G6(n,e,t,r,s){if(t-e<=s.pos-r.pos||qf(r,!0,!1)<s.pos)return!1;let i=n.resolve(e);if(!r.parent.isTextblock){let a=i.nodeAfter;return a!=null&&t==e+a.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let o=n.resolve(qf(i,!0,!0));return!o.parent.isTextblock||o.pos>t||qf(o,!0,!1)<t?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function qf(n,e,t){let r=n.depth,s=e?n.end():n.pos;for(;r>0&&(e||n.indexAfter(r)==n.node(r).childCount);)r--,s++,e=!1;if(t){let i=n.node(r).maybeChild(n.indexAfter(r));for(;i&&!i.isLeaf;)i=i.firstChild,s++}return s}function J6(n,e,t,r,s){let i=n.findDiffStart(e,t);if(i==null)return null;let{a:o,b:a}=n.findDiffEnd(e,t+n.size,t+e.size);if(s=="end"){let l=Math.max(0,i-Math.min(o,a));r-=o+l-i}if(o<i&&n.size<e.size){let l=r<=i&&r>=o?i-r:0;i-=l,i&&i<e.size&&ab(e.textBetween(i-1,i+1))&&(i+=l?1:-1),a=i+(a-o),o=i}else if(a<i){let l=r<=i&&r>=a?i-r:0;i-=l,i&&i<n.size&&ab(n.textBetween(i-1,i+1))&&(i+=l?1:-1),o=i+(o-a),a=i}return{start:i,endA:o,endB:a}}function ab(n){if(n.length!=2)return!1;let e=n.charCodeAt(0),t=n.charCodeAt(1);return e>=56320&&e<=57343&&t>=55296&&t<=56319}class BA{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new d6,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(db),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=ub(this),cb(this),this.nodeViews=hb(this),this.docView=zw(this.state.doc,lb(this),Wf(this),this.dom,this),this.domObserver=new B6(this,(r,s,i,o)=>q6(this,r,s,i,o)),this.domObserver.start(),f6(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&dm(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(db),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let r in this._props)t[r]=this._props[r];t.state=this.state;for(let r in e)t[r]=e[r];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var r;let s=this.state,i=!1,o=!1;e.storedMarks&&this.composing&&(PA(this),o=!0),this.state=e;let a=s.plugins!=e.plugins||this._props.plugins!=t.plugins;if(a||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let p=hb(this);Y6(p,this.nodeViews)&&(this.nodeViews=p,i=!0)}(a||t.handleDOMEvents!=this._props.handleDOMEvents)&&dm(this),this.editable=ub(this),cb(this);let l=Wf(this),c=lb(this),u=s.plugins!=e.plugins&&!s.doc.eq(e.doc)?"reset":e.scrollToSelection>s.scrollToSelection?"to selection":"preserve",h=i||!this.docView.matchesNode(e.doc,c,l);(h||!e.selection.eq(s.selection))&&(o=!0);let f=u=="preserve"&&o&&this.dom.style.overflowAnchor==null&&IF(this);if(o){this.domObserver.stop();let p=h&&(yn||kt)&&!this.composing&&!s.selection.empty&&!e.selection.empty&&Q6(s.selection,e.selection);if(h){let m=kt?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=I6(this)),(i||!this.docView.update(e.doc,c,l,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=zw(e.doc,c,l,this.dom,this)),m&&!this.trackWrites&&(p=!0)}p||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&YF(this))?Qr(this,p):(wA(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(s),!((r=this.dragging)===null||r===void 0)&&r.node&&!s.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,s),u=="reset"?this.dom.scrollTop=0:u=="to selection"?this.scrollToSelection():f&&kF(f)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof le){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&Lw(this,t.getBoundingClientRect(),e)}else Lw(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let r=this.directPlugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let r=this.state.plugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let r=this.pluginViews[t];r.update&&r.update(this,e)}}updateDraggedNode(e,t){let r=e.node,s=-1;if(this.state.doc.nodeAt(r.from)==r.node)s=r.from;else{let i=r.from+(this.state.doc.content.size-t.doc.content.size);(i>0&&this.state.doc.nodeAt(i))==r.node&&(s=i)}this.dragging=new OA(e.slice,e.move,s<0?void 0:le.create(this.state.doc,s))}someProp(e,t){let r=this._props&&this._props[e],s;if(r!=null&&(s=t?t(r):r))return s;for(let o=0;o<this.directPlugins.length;o++){let a=this.directPlugins[o].props[e];if(a!=null&&(s=t?t(a):a))return s}let i=this.state.plugins;if(i)for(let o=0;o<i.length;o++){let a=i[o].props[e];if(a!=null&&(s=t?t(a):a))return s}}hasFocus(){if(yn){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&RF(this.dom),Qr(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}updateRoot(){this._root=null}posAtCoords(e){return OF(this,e)}coordsAtPos(e,t=1){return dA(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,r=-1){let s=this.docView.posFromDOM(e,t,r);if(s==null)throw new RangeError("DOM position not inside the editor");return s}endOfTextblock(e,t){return BF(this,t||this.state,e)}pasteHTML(e,t){return zl(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return zl(this,e,null,!0,t||new ClipboardEvent("paste"))}serializeForClipboard(e){return uy(this,e)}destroy(){this.docView&&(p6(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Wf(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,yF())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return g6(this,e)}domSelectionRange(){let e=this.domSelection();return e?nn&&this.root.nodeType===11&&EF(this.dom.ownerDocument)==this.dom&&U6(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}BA.prototype.dispatch=function(n){let e=this._props.dispatchTransaction;e?e.call(this,n):this.updateState(this.state.apply(n))};function lb(n){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(let r in t)r=="class"?e.class+=" "+t[r]:r=="style"?e.style=(e.style?e.style+";":"")+t[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(t[r]))}),e.translate||(e.translate="no"),[Rt.node(0,n.state.doc.content.size,e)]}function cb(n){if(n.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),n.cursorWrapper={dom:e,deco:Rt.widget(n.state.selection.from,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function ub(n){return!n.someProp("editable",e=>e(n.state)===!1)}function Q6(n,e){let t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}function hb(n){let e=Object.create(null);function t(r){for(let s in r)Object.prototype.hasOwnProperty.call(e,s)||(e[s]=r[s])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function Y6(n,e){let t=0,r=0;for(let s in n){if(n[s]!=e[s])return!0;t++}for(let s in e)r++;return t!=r}function db(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var ii={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},rh={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},X6=typeof navigator<"u"&&/Mac/.test(navigator.platform),Z6=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Bt=0;Bt<10;Bt++)ii[48+Bt]=ii[96+Bt]=String(Bt);for(var Bt=1;Bt<=24;Bt++)ii[Bt+111]="F"+Bt;for(var Bt=65;Bt<=90;Bt++)ii[Bt]=String.fromCharCode(Bt+32),rh[Bt]=String.fromCharCode(Bt);for(var Kf in ii)rh.hasOwnProperty(Kf)||(rh[Kf]=ii[Kf]);function eB(n){var e=X6&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||Z6&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?rh:ii)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const tB=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),nB=typeof navigator<"u"&&/Win/.test(navigator.platform);function rB(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,s,i,o;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))tB?o=!0:s=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(t="Alt-"+t),s&&(t="Ctrl-"+t),o&&(t="Meta-"+t),i&&(t="Shift-"+t),t}function sB(n){let e=Object.create(null);for(let t in n)e[rB(t)]=n[t];return e}function Gf(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function iB(n){return new st({props:{handleKeyDown:gy(n)}})}function gy(n){let e=sB(n);return function(t,r){let s=eB(r),i,o=e[Gf(s,r)];if(o&&o(t.state,t.dispatch,t))return!0;if(s.length==1&&s!=" "){if(r.shiftKey){let a=e[Gf(s,r,!1)];if(a&&a(t.state,t.dispatch,t))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(nB&&r.ctrlKey&&r.altKey)&&(i=ii[r.keyCode])&&i!=s){let a=e[Gf(i,r)];if(a&&a(t.state,t.dispatch,t))return!0}}return!1}}var oB=Object.defineProperty,yy=(n,e)=>{for(var t in e)oB(n,t,{get:e[t],enumerable:!0})};function Dd(n){const{state:e,transaction:t}=n;let{selection:r}=t,{doc:s}=t,{storedMarks:i}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return i},get selection(){return r},get doc(){return s},get tr(){return r=t.selection,s=t.doc,i=t.storedMarks,t}}}var Ld=class{constructor(n){this.editor=n.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=n.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:n,editor:e,state:t}=this,{view:r}=e,{tr:s}=t,i=this.buildProps(s);return Object.fromEntries(Object.entries(n).map(([o,a])=>[o,(...c)=>{const u=a(...c)(i);return!s.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(s),u}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(n,e=!0){const{rawCommands:t,editor:r,state:s}=this,{view:i}=r,o=[],a=!!n,l=n||s.tr,c=()=>(!a&&e&&!l.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(l),o.every(h=>h===!0)),u={...Object.fromEntries(Object.entries(t).map(([h,f])=>[h,(...m)=>{const y=this.buildProps(l,e),v=f(...m)(y);return o.push(v),u}])),run:c};return u}createCan(n){const{rawCommands:e,state:t}=this,r=!1,s=n||t.tr,i=this.buildProps(s,r);return{...Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...c)=>l(...c)({...i,dispatch:void 0})])),chain:()=>this.createChain(s,r)}}buildProps(n,e=!0){const{rawCommands:t,editor:r,state:s}=this,{view:i}=r,o={tr:n,editor:r,view:i,state:Dd({state:s,transaction:n}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(n,e),can:()=>this.createCan(n),get commands(){return Object.fromEntries(Object.entries(t).map(([a,l])=>[a,(...c)=>l(...c)(o)]))}};return o}},$A={};yy($A,{blur:()=>aB,clearContent:()=>lB,clearNodes:()=>cB,command:()=>uB,createParagraphNear:()=>hB,cut:()=>dB,deleteCurrentNode:()=>fB,deleteNode:()=>pB,deleteRange:()=>mB,deleteSelection:()=>gB,enter:()=>yB,exitCode:()=>_B,extendMarkRange:()=>vB,first:()=>wB,focus:()=>EB,forEach:()=>TB,insertContent:()=>SB,insertContentAt:()=>IB,joinBackward:()=>xB,joinDown:()=>RB,joinForward:()=>MB,joinItemBackward:()=>PB,joinItemForward:()=>NB,joinTextblockBackward:()=>OB,joinTextblockForward:()=>DB,joinUp:()=>kB,keyboardShortcut:()=>VB,lift:()=>FB,liftEmptyBlock:()=>BB,liftListItem:()=>$B,newlineInCode:()=>UB,resetAttributes:()=>zB,scrollIntoView:()=>HB,selectAll:()=>jB,selectNodeBackward:()=>WB,selectNodeForward:()=>qB,selectParentNode:()=>KB,selectTextblockEnd:()=>GB,selectTextblockStart:()=>JB,setContent:()=>QB,setMark:()=>m9,setMeta:()=>g9,setNode:()=>y9,setNodeSelection:()=>_9,setTextDirection:()=>v9,setTextSelection:()=>w9,sinkListItem:()=>b9,splitBlock:()=>E9,splitListItem:()=>T9,toggleList:()=>S9,toggleMark:()=>C9,toggleNode:()=>A9,toggleWrap:()=>I9,undoInputRule:()=>k9,unsetAllMarks:()=>R9,unsetMark:()=>x9,unsetTextDirection:()=>M9,updateAttributes:()=>P9,wrapIn:()=>N9,wrapInList:()=>O9});var aB=()=>({editor:n,view:e})=>(requestAnimationFrame(()=>{var t;n.isDestroyed||(e.dom.blur(),(t=window?.getSelection())==null||t.removeAllRanges())}),!0),lB=(n=!0)=>({commands:e})=>e.setContent("",{emitUpdate:n}),cB=()=>({state:n,tr:e,dispatch:t})=>{const{selection:r}=e,{ranges:s}=r;return t&&s.forEach(({$from:i,$to:o})=>{n.doc.nodesBetween(i.pos,o.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:u}=e,h=c.resolve(u.map(l)),f=c.resolve(u.map(l+a.nodeSize)),p=h.blockRange(f);if(!p)return;const m=ca(p);if(a.type.isTextblock){const{defaultType:y}=h.parent.contentMatchAt(h.index());e.setNodeMarkup(p.start,y)}(m||m===0)&&e.lift(p,m)})}),!0},uB=n=>e=>n(e),hB=()=>({state:n,dispatch:e})=>tA(n,e),dB=(n,e)=>({editor:t,tr:r})=>{const{state:s}=t,i=s.doc.slice(n.from,n.to);r.deleteRange(n.from,n.to);const o=r.mapping.map(e);return r.insert(o,i.content),r.setSelection(new ue(r.doc.resolve(Math.max(o-1,0)))),!0},fB=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,r=t.$anchor.node();if(r.content.size>0)return!1;const s=n.selection.$anchor;for(let i=s.depth;i>0;i-=1)if(s.node(i).type===r.type){if(e){const a=s.before(i),l=s.after(i);n.delete(a,l).scrollIntoView()}return!0}return!1};function bt(n,e){if(typeof n=="string"){if(!e.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return e.nodes[n]}return n}var pB=n=>({tr:e,state:t,dispatch:r})=>{const s=bt(n,t.schema),i=e.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===s){if(r){const l=i.before(o),c=i.after(o);e.delete(l,c).scrollIntoView()}return!0}return!1},mB=n=>({tr:e,dispatch:t})=>{const{from:r,to:s}=n;return t&&e.delete(r,s),!0},gB=()=>({state:n,dispatch:e})=>ny(n,e),yB=()=>({commands:n})=>n.keyboardShortcut("Enter"),_B=()=>({state:n,dispatch:e})=>nF(n,e);function _y(n){return Object.prototype.toString.call(n)==="[object RegExp]"}function sh(n,e,t={strict:!0}){const r=Object.keys(e);return r.length?r.every(s=>t.strict?e[s]===n[s]:_y(e[s])?e[s].test(n[s]):e[s]===n[s]):!0}function UA(n,e,t={}){return n.find(r=>r.type===e&&sh(Object.fromEntries(Object.keys(t).map(s=>[s,r.attrs[s]])),t))}function fb(n,e,t={}){return!!UA(n,e,t)}function vy(n,e,t){var r;if(!n||!e)return;let s=n.parent.childAfter(n.parentOffset);if((!s.node||!s.node.marks.some(u=>u.type===e))&&(s=n.parent.childBefore(n.parentOffset)),!s.node||!s.node.marks.some(u=>u.type===e)||(t=t||((r=s.node.marks[0])==null?void 0:r.attrs),!UA([...s.node.marks],e,t)))return;let o=s.index,a=n.start()+s.offset,l=o+1,c=a+s.node.nodeSize;for(;o>0&&fb([...n.parent.child(o-1).marks],e,t);)o-=1,a-=n.parent.child(o).nodeSize;for(;l<n.parent.childCount&&fb([...n.parent.child(l).marks],e,t);)c+=n.parent.child(l).nodeSize,l+=1;return{from:a,to:c}}function ss(n,e){if(typeof n=="string"){if(!e.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return e.marks[n]}return n}var vB=(n,e={})=>({tr:t,state:r,dispatch:s})=>{const i=ss(n,r.schema),{doc:o,selection:a}=t,{$from:l,from:c,to:u}=a;if(s){const h=vy(l,i,e);if(h&&h.from<=c&&h.to>=u){const f=ue.create(o,h.from,h.to);t.setSelection(f)}}return!0},wB=n=>e=>{const t=typeof n=="function"?n(e):n;for(let r=0;r<t.length;r+=1)if(t[r](e))return!0;return!1};function zA(n){return n instanceof ue}function Mi(n=0,e=0,t=0){return Math.min(Math.max(n,e),t)}function HA(n,e=null){if(!e)return null;const t=me.atStart(n),r=me.atEnd(n);if(e==="start"||e===!0)return t;if(e==="end")return r;const s=t.from,i=r.to;return e==="all"?ue.create(n,Mi(0,s,i),Mi(n.content.size,s,i)):ue.create(n,Mi(e,s,i),Mi(e,s,i))}function bB(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function wy(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}var EB=(n=null,e={})=>({editor:t,view:r,tr:s,dispatch:i})=>{e={scrollIntoView:!0,...e};const o=()=>{(wy()||bB())&&r.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(r.focus(),e?.scrollIntoView&&t.commands.scrollIntoView())})};if(r.hasFocus()&&n===null||n===!1)return!0;if(i&&n===null&&!zA(t.state.selection))return o(),!0;const a=HA(s.doc,n)||t.state.selection,l=t.state.selection.eq(a);return i&&(l||s.setSelection(a),l&&s.storedMarks&&s.setStoredMarks(s.storedMarks),o()),!0},TB=(n,e)=>t=>n.every((r,s)=>e(r,{...t,index:s})),SB=(n,e)=>({tr:t,commands:r})=>r.insertContentAt({from:t.selection.from,to:t.selection.to},n,e),jA=n=>{const e=n.childNodes;for(let t=e.length-1;t>=0;t-=1){const r=e[t];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?n.removeChild(r):r.nodeType===1&&jA(r)}return n};function Fc(n){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const e=`<body>${n}</body>`,t=new window.DOMParser().parseFromString(e,"text/html").body;return jA(t)}function jl(n,e,t){if(n instanceof Jn||n instanceof H)return n;t={slice:!0,parseOptions:{},...t};const r=typeof n=="object"&&n!==null,s=typeof n=="string";if(r)try{if(Array.isArray(n)&&n.length>0)return H.fromArray(n.map(a=>e.nodeFromJSON(a)));const o=e.nodeFromJSON(n);return t.errorOnInvalidContent&&o.check(),o}catch(i){if(t.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:i});return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",i),jl("",e,t)}if(s){if(t.errorOnInvalidContent){let o=!1,a="";const l=new kC({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(o=!0,a=typeof c=="string"?c:c.outerHTML,null)}]}})});if(t.slice?qs.fromSchema(l).parseSlice(Fc(n),t.parseOptions):qs.fromSchema(l).parse(Fc(n),t.parseOptions),t.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const i=qs.fromSchema(e);return t.slice?i.parseSlice(Fc(n),t.parseOptions).content:i.parse(Fc(n),t.parseOptions)}return jl("",e,t)}function CB(n,e,t){const r=n.steps.length-1;if(r<e)return;const s=n.steps[r];if(!(s instanceof It||s instanceof xt))return;const i=n.mapping.maps[r];let o=0;i.forEach((a,l,c,u)=>{o===0&&(o=u)}),n.setSelection(me.near(n.doc.resolve(o),t))}var AB=n=>!("type"in n),IB=(n,e,t)=>({tr:r,dispatch:s,editor:i})=>{var o;if(s){t={parseOptions:i.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...t};let a;const l=v=>{i.emit("contentError",{editor:i,error:v,disableCollaboration:()=>{"collaboration"in i.storage&&typeof i.storage.collaboration=="object"&&i.storage.collaboration&&(i.storage.collaboration.isDisabled=!0)}})},c={preserveWhitespace:"full",...t.parseOptions};if(!t.errorOnInvalidContent&&!i.options.enableContentCheck&&i.options.emitContentError)try{jl(e,i.schema,{parseOptions:c,errorOnInvalidContent:!0})}catch(v){l(v)}try{a=jl(e,i.schema,{parseOptions:c,errorOnInvalidContent:(o=t.errorOnInvalidContent)!=null?o:i.options.enableContentCheck})}catch(v){return l(v),!1}let{from:u,to:h}=typeof n=="number"?{from:n,to:n}:{from:n.from,to:n.to},f=!0,p=!0;if((AB(a)?a:[a]).forEach(v=>{v.check(),f=f?v.isText&&v.marks.length===0:!1,p=p?v.isBlock:!1}),u===h&&p){const{parent:v}=r.doc.resolve(u);v.isTextblock&&!v.type.spec.code&&!v.childCount&&(u-=1,h+=1)}let y;if(f){if(Array.isArray(e))y=e.map(v=>v.text||"").join("");else if(e instanceof H){let v="";e.forEach(T=>{T.text&&(v+=T.text)}),y=v}else typeof e=="object"&&e&&e.text?y=e.text:y=e;r.insertText(y,u,h)}else{y=a;const v=r.doc.resolve(u),T=v.node(),M=v.parentOffset===0,P=T.isText||T.isTextblock,D=T.content.size>0;M&&P&&D&&(u=Math.max(0,u-1)),r.replaceWith(u,h,y)}t.updateSelection&&CB(r,r.steps.length-1,-1),t.applyInputRules&&r.setMeta("applyInputRules",{from:u,text:y}),t.applyPasteRules&&r.setMeta("applyPasteRules",{from:u,text:y})}return!0},kB=()=>({state:n,dispatch:e})=>Z5(n,e),RB=()=>({state:n,dispatch:e})=>eF(n,e),xB=()=>({state:n,dispatch:e})=>GC(n,e),MB=()=>({state:n,dispatch:e})=>XC(n,e),PB=()=>({state:n,dispatch:e,tr:t})=>{try{const r=Rd(n.doc,n.selection.$from.pos,-1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},NB=()=>({state:n,dispatch:e,tr:t})=>{try{const r=Rd(n.doc,n.selection.$from.pos,1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},OB=()=>({state:n,dispatch:e})=>Y5(n,e),DB=()=>({state:n,dispatch:e})=>X5(n,e);function WA(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function LB(n){const e=n.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let r,s,i,o;for(let a=0;a<e.length-1;a+=1){const l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))wy()||WA()?o=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(t=`Alt-${t}`),s&&(t=`Ctrl-${t}`),o&&(t=`Meta-${t}`),i&&(t=`Shift-${t}`),t}var VB=n=>({editor:e,view:t,tr:r,dispatch:s})=>{const i=LB(n).split(/-(?!$)/),o=i.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{t.someProp("handleKeyDown",c=>c(t,a))});return l?.steps.forEach(c=>{const u=c.map(r.mapping);u&&s&&r.maybeStep(u)}),!0};function oi(n,e,t={}){const{from:r,to:s,empty:i}=n.selection,o=e?bt(e,n.schema):null,a=[];n.doc.nodesBetween(r,s,(h,f)=>{if(h.isText)return;const p=Math.max(r,f),m=Math.min(s,f+h.nodeSize);a.push({node:h,from:p,to:m})});const l=s-r,c=a.filter(h=>o?o.name===h.node.type.name:!0).filter(h=>sh(h.node.attrs,t,{strict:!1}));return i?!!c.length:c.reduce((h,f)=>h+f.to-f.from,0)>=l}var FB=(n,e={})=>({state:t,dispatch:r})=>{const s=bt(n,t.schema);return oi(t,s,e)?tF(t,r):!1},BB=()=>({state:n,dispatch:e})=>nA(n,e),$B=n=>({state:e,dispatch:t})=>{const r=bt(n,e.schema);return fF(r)(e,t)},UB=()=>({state:n,dispatch:e})=>eA(n,e);function Vd(n,e){return e.nodes[n]?"node":e.marks[n]?"mark":null}function pb(n,e){const t=typeof e=="string"?[e]:e;return Object.keys(n).reduce((r,s)=>(t.includes(s)||(r[s]=n[s]),r),{})}var zB=(n,e)=>({tr:t,state:r,dispatch:s})=>{let i=null,o=null;const a=Vd(typeof n=="string"?n:n.name,r.schema);if(!a)return!1;a==="node"&&(i=bt(n,r.schema)),a==="mark"&&(o=ss(n,r.schema));let l=!1;return t.selection.ranges.forEach(c=>{r.doc.nodesBetween(c.$from.pos,c.$to.pos,(u,h)=>{i&&i===u.type&&(l=!0,s&&t.setNodeMarkup(h,void 0,pb(u.attrs,e))),o&&u.marks.length&&u.marks.forEach(f=>{o===f.type&&(l=!0,s&&t.addMark(h,h+u.nodeSize,o.create(pb(f.attrs,e))))})})}),l},HB=()=>({tr:n,dispatch:e})=>(e&&n.scrollIntoView(),!0),jB=()=>({tr:n,dispatch:e})=>{if(e){const t=new kn(n.doc);n.setSelection(t)}return!0},WB=()=>({state:n,dispatch:e})=>QC(n,e),qB=()=>({state:n,dispatch:e})=>ZC(n,e),KB=()=>({state:n,dispatch:e})=>iF(n,e),GB=()=>({state:n,dispatch:e})=>lF(n,e),JB=()=>({state:n,dispatch:e})=>aF(n,e);function fm(n,e,t={},r={}){return jl(n,e,{slice:!1,parseOptions:t,errorOnInvalidContent:r.errorOnInvalidContent})}var QB=(n,{errorOnInvalidContent:e,emitUpdate:t=!0,parseOptions:r={}}={})=>({editor:s,tr:i,dispatch:o,commands:a})=>{const{doc:l}=i;if(r.preserveWhitespace!=="full"){const c=fm(n,s.schema,r,{errorOnInvalidContent:e??s.options.enableContentCheck});return o&&i.replaceWith(0,l.content.size,c).setMeta("preventUpdate",!t),!0}return o&&i.setMeta("preventUpdate",!t),a.insertContentAt({from:0,to:l.content.size},n,{parseOptions:r,errorOnInvalidContent:e??s.options.enableContentCheck})};function qA(n,e){const t=ss(e,n.schema),{from:r,to:s,empty:i}=n.selection,o=[];i?(n.storedMarks&&o.push(...n.storedMarks),o.push(...n.selection.$head.marks())):n.doc.nodesBetween(r,s,l=>{o.push(...l.marks)});const a=o.find(l=>l.type.name===t.name);return a?{...a.attrs}:{}}function KA(n,e){const t=new ey(n);return e.forEach(r=>{r.steps.forEach(s=>{t.step(s)})}),t}function YB(n){for(let e=0;e<n.edgeCount;e+=1){const{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function XB(n,e,t){const r=[];return n.nodesBetween(e.from,e.to,(s,i)=>{t(s)&&r.push({node:s,pos:i})}),r}function GA(n,e){for(let t=n.depth;t>0;t-=1){const r=n.node(t);if(e(r))return{pos:t>0?n.before(t):0,start:n.start(t),depth:t,node:r}}}function Fd(n){return e=>GA(e.$from,n)}function oe(n,e,t){return n.config[e]===void 0&&n.parent?oe(n.parent,e,t):typeof n.config[e]=="function"?n.config[e].bind({...t,parent:n.parent?oe(n.parent,e,t):null}):n.config[e]}function by(n){return n.map(e=>{const t={name:e.name,options:e.options,storage:e.storage},r=oe(e,"addExtensions",t);return r?[e,...by(r())]:e}).flat(10)}function Ey(n,e){const t=oo.fromSchema(e).serializeFragment(n),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(t),s.innerHTML}function JA(n){return typeof n=="function"}function Ve(n,e=void 0,...t){return JA(n)?e?n.bind(e)(...t):n(...t):n}function ZB(n={}){return Object.keys(n).length===0&&n.constructor===Object}function ea(n){const e=n.filter(s=>s.type==="extension"),t=n.filter(s=>s.type==="node"),r=n.filter(s=>s.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:r}}function QA(n){const e=[],{nodeExtensions:t,markExtensions:r}=ea(n),s=[...t,...r],i={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage,extensions:s},l=oe(o,"addGlobalAttributes",a);if(!l)return;l().forEach(u=>{u.types.forEach(h=>{Object.entries(u.attributes).forEach(([f,p])=>{e.push({type:h,name:f,attribute:{...i,...p}})})})})}),s.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage},l=oe(o,"addAttributes",a);if(!l)return;const c=l();Object.entries(c).forEach(([u,h])=>{const f={...i,...h};typeof f?.default=="function"&&(f.default=f.default()),f?.isRequired&&f?.default===void 0&&delete f.default,e.push({type:o.name,name:u,attribute:f})})}),e}function Ze(...n){return n.filter(e=>!!e).reduce((e,t)=>{const r={...e};return Object.entries(t).forEach(([s,i])=>{if(!r[s]){r[s]=i;return}if(s==="class"){const a=i?String(i).split(" "):[],l=r[s]?r[s].split(" "):[],c=a.filter(u=>!l.includes(u));r[s]=[...l,...c].join(" ")}else if(s==="style"){const a=i?i.split(";").map(u=>u.trim()).filter(Boolean):[],l=r[s]?r[s].split(";").map(u=>u.trim()).filter(Boolean):[],c=new Map;l.forEach(u=>{const[h,f]=u.split(":").map(p=>p.trim());c.set(h,f)}),a.forEach(u=>{const[h,f]=u.split(":").map(p=>p.trim());c.set(h,f)}),r[s]=Array.from(c.entries()).map(([u,h])=>`${u}: ${h}`).join("; ")}else r[s]=i}),r},{})}function ih(n,e){return e.filter(t=>t.type===n.type.name).filter(t=>t.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(n.attrs)||{}:{[t.name]:n.attrs[t.name]}).reduce((t,r)=>Ze(t,r),{})}function e9(n){return typeof n!="string"?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):n==="true"?!0:n==="false"?!1:n}function mb(n,e){return"style"in n?n:{...n,getAttrs:t=>{const r=n.getAttrs?n.getAttrs(t):n.attrs;if(r===!1)return!1;const s=e.reduce((i,o)=>{const a=o.attribute.parseHTML?o.attribute.parseHTML(t):e9(t.getAttribute(o.name));return a==null?i:{...i,[o.name]:a}},{});return{...r,...s}}}}function gb(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>e==="attrs"&&ZB(t)?!1:t!=null))}function yb(n){var e,t;const r={};return!((e=n?.attribute)!=null&&e.isRequired)&&"default"in(n?.attribute||{})&&(r.default=n.attribute.default),((t=n?.attribute)==null?void 0:t.validate)!==void 0&&(r.validate=n.attribute.validate),[n.name,r]}function t9(n,e){var t;const r=QA(n),{nodeExtensions:s,markExtensions:i}=ea(n),o=(t=s.find(c=>oe(c,"topNode")))==null?void 0:t.name,a=Object.fromEntries(s.map(c=>{const u=r.filter(T=>T.type===c.name),h={name:c.name,options:c.options,storage:c.storage,editor:e},f=n.reduce((T,M)=>{const P=oe(M,"extendNodeSchema",h);return{...T,...P?P(c):{}}},{}),p=gb({...f,content:Ve(oe(c,"content",h)),marks:Ve(oe(c,"marks",h)),group:Ve(oe(c,"group",h)),inline:Ve(oe(c,"inline",h)),atom:Ve(oe(c,"atom",h)),selectable:Ve(oe(c,"selectable",h)),draggable:Ve(oe(c,"draggable",h)),code:Ve(oe(c,"code",h)),whitespace:Ve(oe(c,"whitespace",h)),linebreakReplacement:Ve(oe(c,"linebreakReplacement",h)),defining:Ve(oe(c,"defining",h)),isolating:Ve(oe(c,"isolating",h)),attrs:Object.fromEntries(u.map(yb))}),m=Ve(oe(c,"parseHTML",h));m&&(p.parseDOM=m.map(T=>mb(T,u)));const y=oe(c,"renderHTML",h);y&&(p.toDOM=T=>y({node:T,HTMLAttributes:ih(T,u)}));const v=oe(c,"renderText",h);return v&&(p.toText=v),[c.name,p]})),l=Object.fromEntries(i.map(c=>{const u=r.filter(v=>v.type===c.name),h={name:c.name,options:c.options,storage:c.storage,editor:e},f=n.reduce((v,T)=>{const M=oe(T,"extendMarkSchema",h);return{...v,...M?M(c):{}}},{}),p=gb({...f,inclusive:Ve(oe(c,"inclusive",h)),excludes:Ve(oe(c,"excludes",h)),group:Ve(oe(c,"group",h)),spanning:Ve(oe(c,"spanning",h)),code:Ve(oe(c,"code",h)),attrs:Object.fromEntries(u.map(yb))}),m=Ve(oe(c,"parseHTML",h));m&&(p.parseDOM=m.map(v=>mb(v,u)));const y=oe(c,"renderHTML",h);return y&&(p.toDOM=v=>y({mark:v,HTMLAttributes:ih(v,u)})),[c.name,p]}));return new kC({topNode:o,nodes:a,marks:l})}function n9(n){const e=n.filter((t,r)=>n.indexOf(t)!==r);return Array.from(new Set(e))}function Ty(n){return n.sort((t,r)=>{const s=oe(t,"priority")||100,i=oe(r,"priority")||100;return s>i?-1:s<i?1:0})}function YA(n){const e=Ty(by(n)),t=n9(e.map(r=>r.name));return t.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${t.map(r=>`'${r}'`).join(", ")}]. This can lead to issues.`),e}function XA(n,e,t){const{from:r,to:s}=e,{blockSeparator:i=`

`,textSerializers:o={}}=t||{};let a="";return n.nodesBetween(r,s,(l,c,u,h)=>{var f;l.isBlock&&c>r&&(a+=i);const p=o?.[l.type.name];if(p)return u&&(a+=p({node:l,pos:c,parent:u,index:h,range:e})),!1;l.isText&&(a+=(f=l?.text)==null?void 0:f.slice(Math.max(r,c)-c,s-c))}),a}function r9(n,e){const t={from:0,to:n.content.size};return XA(n,t,e)}function ZA(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}function s9(n,e){const t=bt(e,n.schema),{from:r,to:s}=n.selection,i=[];n.doc.nodesBetween(r,s,a=>{i.push(a)});const o=i.reverse().find(a=>a.type.name===t.name);return o?{...o.attrs}:{}}function eI(n,e){const t=Vd(typeof e=="string"?e:e.name,n.schema);return t==="node"?s9(n,e):t==="mark"?qA(n,e):{}}function i9(n,e=JSON.stringify){const t={};return n.filter(r=>{const s=e(r);return Object.prototype.hasOwnProperty.call(t,s)?!1:t[s]=!0})}function o9(n){const e=i9(n);return e.length===1?e:e.filter((t,r)=>!e.filter((i,o)=>o!==r).some(i=>t.oldRange.from>=i.oldRange.from&&t.oldRange.to<=i.oldRange.to&&t.newRange.from>=i.newRange.from&&t.newRange.to<=i.newRange.to))}function tI(n){const{mapping:e,steps:t}=n,r=[];return e.maps.forEach((s,i)=>{const o=[];if(s.ranges.length)s.forEach((a,l)=>{o.push({from:a,to:l})});else{const{from:a,to:l}=t[i];if(a===void 0||l===void 0)return;o.push({from:a,to:l})}o.forEach(({from:a,to:l})=>{const c=e.slice(i).map(a,-1),u=e.slice(i).map(l),h=e.invert().map(c,-1),f=e.invert().map(u);r.push({oldRange:{from:h,to:f},newRange:{from:c,to:u}})})}),o9(r)}function Sy(n,e,t){const r=[];return n===e?t.resolve(n).marks().forEach(s=>{const i=t.resolve(n),o=vy(i,s.type);o&&r.push({mark:s,...o})}):t.nodesBetween(n,e,(s,i)=>{!s||s?.nodeSize===void 0||r.push(...s.marks.map(o=>({from:i,to:i+s.nodeSize,mark:o})))}),r}var a9=(n,e,t,r=20)=>{const s=n.doc.resolve(t);let i=r,o=null;for(;i>0&&o===null;){const a=s.node(i);a?.type.name===e?o=a:i-=1}return[o,i]};function Jf(n,e){return e.nodes[n]||e.marks[n]||null}function fu(n,e,t){return Object.fromEntries(Object.entries(t).filter(([r])=>{const s=n.find(i=>i.type===e&&i.name===r);return s?s.attribute.keepOnSplit:!1}))}var l9=(n,e=500)=>{let t="";const r=n.parentOffset;return n.parent.nodesBetween(Math.max(0,r-e),r,(s,i,o,a)=>{var l,c;const u=((c=(l=s.type.spec).toText)==null?void 0:c.call(l,{node:s,pos:i,parent:o,index:a}))||s.textContent||"%leaf%";t+=s.isAtom&&!s.isText?u:u.slice(0,Math.max(0,r-i))}),t};function pm(n,e,t={}){const{empty:r,ranges:s}=n.selection,i=e?ss(e,n.schema):null;if(r)return!!(n.storedMarks||n.selection.$from.marks()).filter(h=>i?i.name===h.type.name:!0).find(h=>sh(h.attrs,t,{strict:!1}));let o=0;const a=[];if(s.forEach(({$from:h,$to:f})=>{const p=h.pos,m=f.pos;n.doc.nodesBetween(p,m,(y,v)=>{if(!y.isText&&!y.marks.length)return;const T=Math.max(p,v),M=Math.min(m,v+y.nodeSize),P=M-T;o+=P,a.push(...y.marks.map(D=>({mark:D,from:T,to:M})))})}),o===0)return!1;const l=a.filter(h=>i?i.name===h.mark.type.name:!0).filter(h=>sh(h.mark.attrs,t,{strict:!1})).reduce((h,f)=>h+f.to-f.from,0),c=a.filter(h=>i?h.mark.type!==i&&h.mark.type.excludes(i):!0).reduce((h,f)=>h+f.to-f.from,0);return(l>0?l+c:l)>=o}function c9(n,e,t={}){if(!e)return oi(n,null,t)||pm(n,null,t);const r=Vd(e,n.schema);return r==="node"?oi(n,e,t):r==="mark"?pm(n,e,t):!1}var u9=(n,e)=>{const{$from:t,$to:r,$anchor:s}=n.selection;if(e){const i=Fd(a=>a.type.name===e)(n.selection);if(!i)return!1;const o=n.doc.resolve(i.pos+1);return s.pos+1===o.end()}return!(r.parentOffset<r.parent.nodeSize-2||t.pos!==r.pos)},h9=n=>{const{$from:e,$to:t}=n.selection;return!(e.parentOffset>0||e.pos!==t.pos)};function _b(n,e){return Array.isArray(e)?e.some(t=>(typeof t=="string"?t:t.name)===n.name):e}function vb(n,e){const{nodeExtensions:t}=ea(e),r=t.find(o=>o.name===n);if(!r)return!1;const s={name:r.name,options:r.options,storage:r.storage},i=Ve(oe(r,"group",s));return typeof i!="string"?!1:i.split(" ").includes("list")}function Bd(n,{checkChildren:e=!0,ignoreWhitespace:t=!1}={}){var r;if(t){if(n.type.name==="hardBreak")return!0;if(n.isText)return/^\s*$/m.test((r=n.text)!=null?r:"")}if(n.isText)return!n.text;if(n.isAtom||n.isLeaf)return!1;if(n.content.childCount===0)return!0;if(e){let s=!0;return n.content.forEach(i=>{s!==!1&&(Bd(i,{ignoreWhitespace:t,checkChildren:e})||(s=!1))}),s}return!1}function nI(n){return n instanceof le}var rI=class sI{constructor(e){this.position=e}static fromJSON(e){return new sI(e.position)}toJSON(){return{position:this.position}}};function d9(n,e){const t=e.mapping.mapResult(n.position);return{position:new rI(t.pos),mapResult:t}}function f9(n){return new rI(n)}function p9(n,e,t){var r;const{selection:s}=e;let i=null;if(zA(s)&&(i=s.$cursor),i){const a=(r=n.storedMarks)!=null?r:i.marks();return i.parent.type.allowsMarkType(t)&&(!!t.isInSet(a)||!a.some(c=>c.type.excludes(t)))}const{ranges:o}=s;return o.some(({$from:a,$to:l})=>{let c=a.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(t):!1;return n.doc.nodesBetween(a.pos,l.pos,(u,h,f)=>{if(c)return!1;if(u.isInline){const p=!f||f.type.allowsMarkType(t),m=!!t.isInSet(u.marks)||!u.marks.some(y=>y.type.excludes(t));c=p&&m}return!c}),c})}var m9=(n,e={})=>({tr:t,state:r,dispatch:s})=>{const{selection:i}=t,{empty:o,ranges:a}=i,l=ss(n,r.schema);if(s)if(o){const c=qA(r,l);t.addStoredMark(l.create({...c,...e}))}else a.forEach(c=>{const u=c.$from.pos,h=c.$to.pos;r.doc.nodesBetween(u,h,(f,p)=>{const m=Math.max(p,u),y=Math.min(p+f.nodeSize,h);f.marks.find(T=>T.type===l)?f.marks.forEach(T=>{l===T.type&&t.addMark(m,y,l.create({...T.attrs,...e}))}):t.addMark(m,y,l.create(e))})});return p9(r,t,l)},g9=(n,e)=>({tr:t})=>(t.setMeta(n,e),!0),y9=(n,e={})=>({state:t,dispatch:r,chain:s})=>{const i=bt(n,t.schema);let o;return t.selection.$anchor.sameParent(t.selection.$head)&&(o=t.selection.$anchor.parent.attrs),i.isTextblock?s().command(({commands:a})=>Nw(i,{...o,...e})(t)?!0:a.clearNodes()).command(({state:a})=>Nw(i,{...o,...e})(a,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},_9=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,s=Mi(n,0,r.content.size),i=le.create(r,s);e.setSelection(i)}return!0},v9=(n,e)=>({tr:t,state:r,dispatch:s})=>{const{selection:i}=r;let o,a;return typeof e=="number"?(o=e,a=e):e&&"from"in e&&"to"in e?(o=e.from,a=e.to):(o=i.from,a=i.to),s&&t.doc.nodesBetween(o,a,(l,c)=>{l.isText||t.setNodeMarkup(c,void 0,{...l.attrs,dir:n})}),!0},w9=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,{from:s,to:i}=typeof n=="number"?{from:n,to:n}:n,o=ue.atStart(r).from,a=ue.atEnd(r).to,l=Mi(s,o,a),c=Mi(i,o,a),u=ue.create(r,l,c);e.setSelection(u)}return!0},b9=n=>({state:e,dispatch:t})=>{const r=bt(n,e.schema);return gF(r)(e,t)};function wb(n,e){const t=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(t){const r=t.filter(s=>e?.includes(s.type.name));n.tr.ensureMarks(r)}}var E9=({keepMarks:n=!0}={})=>({tr:e,state:t,dispatch:r,editor:s})=>{const{selection:i,doc:o}=e,{$from:a,$to:l}=i,c=s.extensionManager.attributes,u=fu(c,a.node().type.name,a.node().attrs);if(i instanceof le&&i.node.isBlock)return!a.parentOffset||!Jr(o,a.pos)?!1:(r&&(n&&wb(t,s.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const h=l.parentOffset===l.parent.content.size,f=a.depth===0?void 0:YB(a.node(-1).contentMatchAt(a.indexAfter(-1)));let p=h&&f?[{type:f,attrs:u}]:void 0,m=Jr(e.doc,e.mapping.map(a.pos),1,p);if(!p&&!m&&Jr(e.doc,e.mapping.map(a.pos),1,f?[{type:f}]:void 0)&&(m=!0,p=f?[{type:f,attrs:u}]:void 0),r){if(m&&(i instanceof ue&&e.deleteSelection(),e.split(e.mapping.map(a.pos),1,p),f&&!h&&!a.parentOffset&&a.parent.type!==f)){const y=e.mapping.map(a.before()),v=e.doc.resolve(y);a.node(-1).canReplaceWith(v.index(),v.index()+1,f)&&e.setNodeMarkup(e.mapping.map(a.before()),f)}n&&wb(t,s.extensionManager.splittableMarks),e.scrollIntoView()}return m},T9=(n,e={})=>({tr:t,state:r,dispatch:s,editor:i})=>{var o;const a=bt(n,r.schema),{$from:l,$to:c}=r.selection,u=r.selection.node;if(u&&u.isBlock||l.depth<2||!l.sameParent(c))return!1;const h=l.node(-1);if(h.type!==a)return!1;const f=i.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(s){let T=H.empty;const M=l.index(-1)?1:l.index(-2)?2:3;for(let w=l.depth-M;w>=l.depth-3;w-=1)T=H.from(l.node(w).copy(T));const P=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,D={...fu(f,l.node().type.name,l.node().attrs),...e},L=((o=a.contentMatch.defaultType)==null?void 0:o.createAndFill(D))||void 0;T=T.append(H.from(a.createAndFill(null,L)||void 0));const q=l.before(l.depth-(M-1));t.replace(q,l.after(-P),new X(T,4-M,0));let S=-1;t.doc.nodesBetween(q,t.doc.content.size,(w,b)=>{if(S>-1)return!1;w.isTextblock&&w.content.size===0&&(S=b+1)}),S>-1&&t.setSelection(ue.near(t.doc.resolve(S))),t.scrollIntoView()}return!0}const p=c.pos===l.end()?h.contentMatchAt(0).defaultType:null,m={...fu(f,h.type.name,h.attrs),...e},y={...fu(f,l.node().type.name,l.node().attrs),...e};t.delete(l.pos,c.pos);const v=p?[{type:a,attrs:m},{type:p,attrs:y}]:[{type:a,attrs:m}];if(!Jr(t.doc,l.pos,2))return!1;if(s){const{selection:T,storedMarks:M}=r,{splittableMarks:P}=i.extensionManager,D=M||T.$to.parentOffset&&T.$from.marks();if(t.split(l.pos,2,v).scrollIntoView(),!D||!s)return!0;const L=D.filter(q=>P.includes(q.type.name));t.ensureMarks(L)}return!0},Qf=(n,e)=>{const t=Fd(o=>o.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(r===void 0)return!0;const s=n.doc.nodeAt(r);return t.node.type===s?.type&&di(n.doc,t.pos)&&n.join(t.pos),!0},Yf=(n,e)=>{const t=Fd(o=>o.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(t.start).after(t.depth);if(r===void 0)return!0;const s=n.doc.nodeAt(r);return t.node.type===s?.type&&di(n.doc,r)&&n.join(r),!0},S9=(n,e,t,r={})=>({editor:s,tr:i,state:o,dispatch:a,chain:l,commands:c,can:u})=>{const{extensions:h,splittableMarks:f}=s.extensionManager,p=bt(n,o.schema),m=bt(e,o.schema),{selection:y,storedMarks:v}=o,{$from:T,$to:M}=y,P=T.blockRange(M),D=v||y.$to.parentOffset&&y.$from.marks();if(!P)return!1;const L=Fd(q=>vb(q.type.name,h))(y);if(P.depth>=1&&L&&P.depth-L.depth<=1){if(L.node.type===p)return c.liftListItem(m);if(vb(L.node.type.name,h)&&p.validContent(L.node.content)&&a)return l().command(()=>(i.setNodeMarkup(L.pos,p),!0)).command(()=>Qf(i,p)).command(()=>Yf(i,p)).run()}return!t||!D||!a?l().command(()=>u().wrapInList(p,r)?!0:c.clearNodes()).wrapInList(p,r).command(()=>Qf(i,p)).command(()=>Yf(i,p)).run():l().command(()=>{const q=u().wrapInList(p,r),S=D.filter(w=>f.includes(w.type.name));return i.ensureMarks(S),q?!0:c.clearNodes()}).wrapInList(p,r).command(()=>Qf(i,p)).command(()=>Yf(i,p)).run()},C9=(n,e={},t={})=>({state:r,commands:s})=>{const{extendEmptyMarkRange:i=!1}=t,o=ss(n,r.schema);return pm(r,o,e)?s.unsetMark(o,{extendEmptyMarkRange:i}):s.setMark(o,e)},A9=(n,e,t={})=>({state:r,commands:s})=>{const i=bt(n,r.schema),o=bt(e,r.schema),a=oi(r,i,t);let l;return r.selection.$anchor.sameParent(r.selection.$head)&&(l=r.selection.$anchor.parent.attrs),a?s.setNode(o,l):s.setNode(i,{...l,...t})},I9=(n,e={})=>({state:t,commands:r})=>{const s=bt(n,t.schema);return oi(t,s,e)?r.lift(s):r.wrapIn(s,e)},k9=()=>({state:n,dispatch:e})=>{const t=n.plugins;for(let r=0;r<t.length;r+=1){const s=t[r];let i;if(s.spec.isInputRules&&(i=s.getState(n))){if(e){const o=n.tr,a=i.transform;for(let l=a.steps.length-1;l>=0;l-=1)o.step(a.steps[l].invert(a.docs[l]));if(i.text){const l=o.doc.resolve(i.from).marks();o.replaceWith(i.from,i.to,n.schema.text(i.text,l))}else o.delete(i.from,i.to)}return!0}}return!1},R9=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,{empty:r,ranges:s}=t;return r||e&&s.forEach(i=>{n.removeMark(i.$from.pos,i.$to.pos)}),!0},x9=(n,e={})=>({tr:t,state:r,dispatch:s})=>{var i;const{extendEmptyMarkRange:o=!1}=e,{selection:a}=t,l=ss(n,r.schema),{$from:c,empty:u,ranges:h}=a;if(!s)return!0;if(u&&o){let{from:f,to:p}=a;const m=(i=c.marks().find(v=>v.type===l))==null?void 0:i.attrs,y=vy(c,l,m);y&&(f=y.from,p=y.to),t.removeMark(f,p,l)}else h.forEach(f=>{t.removeMark(f.$from.pos,f.$to.pos,l)});return t.removeStoredMark(l),!0},M9=n=>({tr:e,state:t,dispatch:r})=>{const{selection:s}=t;let i,o;return typeof n=="number"?(i=n,o=n):n&&"from"in n&&"to"in n?(i=n.from,o=n.to):(i=s.from,o=s.to),r&&e.doc.nodesBetween(i,o,(a,l)=>{if(a.isText)return;const c={...a.attrs};delete c.dir,e.setNodeMarkup(l,void 0,c)}),!0},P9=(n,e={})=>({tr:t,state:r,dispatch:s})=>{let i=null,o=null;const a=Vd(typeof n=="string"?n:n.name,r.schema);if(!a)return!1;a==="node"&&(i=bt(n,r.schema)),a==="mark"&&(o=ss(n,r.schema));let l=!1;return t.selection.ranges.forEach(c=>{const u=c.$from.pos,h=c.$to.pos;let f,p,m,y;t.selection.empty?r.doc.nodesBetween(u,h,(v,T)=>{i&&i===v.type&&(l=!0,m=Math.max(T,u),y=Math.min(T+v.nodeSize,h),f=T,p=v)}):r.doc.nodesBetween(u,h,(v,T)=>{T<u&&i&&i===v.type&&(l=!0,m=Math.max(T,u),y=Math.min(T+v.nodeSize,h),f=T,p=v),T>=u&&T<=h&&(i&&i===v.type&&(l=!0,s&&t.setNodeMarkup(T,void 0,{...v.attrs,...e})),o&&v.marks.length&&v.marks.forEach(M=>{if(o===M.type&&(l=!0,s)){const P=Math.max(T,u),D=Math.min(T+v.nodeSize,h);t.addMark(P,D,o.create({...M.attrs,...e}))}}))}),p&&(f!==void 0&&s&&t.setNodeMarkup(f,void 0,{...p.attrs,...e}),o&&p.marks.length&&p.marks.forEach(v=>{o===v.type&&s&&t.addMark(m,y,o.create({...v.attrs,...e}))}))}),l},N9=(n,e={})=>({state:t,dispatch:r})=>{const s=bt(n,t.schema);return cF(s,e)(t,r)},O9=(n,e={})=>({state:t,dispatch:r})=>{const s=bt(n,t.schema);return uF(s,e)(t,r)},D9=class{constructor(){this.callbacks={}}on(n,e){return this.callbacks[n]||(this.callbacks[n]=[]),this.callbacks[n].push(e),this}emit(n,...e){const t=this.callbacks[n];return t&&t.forEach(r=>r.apply(this,e)),this}off(n,e){const t=this.callbacks[n];return t&&(e?this.callbacks[n]=t.filter(r=>r!==e):delete this.callbacks[n]),this}once(n,e){const t=(...r)=>{this.off(n,t),e.apply(this,r)};return this.on(n,t)}removeAllListeners(){this.callbacks={}}},$d=class{constructor(n){var e;this.find=n.find,this.handler=n.handler,this.undoable=(e=n.undoable)!=null?e:!0}},L9=(n,e)=>{if(_y(e))return e.exec(n);const t=e(n);if(!t)return null;const r=[t.text];return r.index=t.index,r.input=n,r.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(t.replaceWith)),r};function Bc(n){var e;const{editor:t,from:r,to:s,text:i,rules:o,plugin:a}=n,{view:l}=t;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||(e=c.nodeBefore||c.nodeAfter)!=null&&e.marks.find(f=>f.type.spec.code))return!1;let u=!1;const h=l9(c)+i;return o.forEach(f=>{if(u)return;const p=L9(h,f.find);if(!p)return;const m=l.state.tr,y=Dd({state:l.state,transaction:m}),v={from:r-(p[0].length-i.length),to:s},{commands:T,chain:M,can:P}=new Ld({editor:t,state:y});f.handler({state:y,range:v,match:p,commands:T,chain:M,can:P})===null||!m.steps.length||(f.undoable&&m.setMeta(a,{transform:m,from:r,to:s,text:i}),l.dispatch(m),u=!0)}),u}function V9(n){const{editor:e,rules:t}=n,r=new st({state:{init(){return null},apply(s,i,o){const a=s.getMeta(r);if(a)return a;const l=s.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:u}=l;typeof u=="string"?u=u:u=Ey(H.from(u),o.schema);const{from:h}=l,f=h+u.length;Bc({editor:e,from:h,to:f,text:u,rules:t,plugin:r})}),s.selectionSet||s.docChanged?null:i}},props:{handleTextInput(s,i,o,a){return Bc({editor:e,from:i,to:o,text:a,rules:t,plugin:r})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{const{$cursor:i}=s.state.selection;i&&Bc({editor:e,from:i.pos,to:i.pos,text:"",rules:t,plugin:r})}),!1)},handleKeyDown(s,i){if(i.key!=="Enter")return!1;const{$cursor:o}=s.state.selection;return o?Bc({editor:e,from:o.pos,to:o.pos,text:`
`,rules:t,plugin:r}):!1}},isInputRules:!0});return r}function F9(n){return Object.prototype.toString.call(n).slice(8,-1)}function $c(n){return F9(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function iI(n,e){const t={...n};return $c(n)&&$c(e)&&Object.keys(e).forEach(r=>{$c(e[r])&&$c(n[r])?t[r]=iI(n[r],e[r]):t[r]=e[r]}),t}var Cy=class{constructor(n={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...n},this.name=this.config.name}get options(){return{...Ve(oe(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...Ve(oe(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(n={}){const e=this.extend({...this.config,addOptions:()=>iI(this.options,n)});return e.name=this.name,e.parent=this.parent,e}extend(n={}){const e=new this.constructor({...this.config,...n});return e.parent=this,this.child=e,e.name="name"in n?n.name:e.parent.name,e}},is=class oI extends Cy{constructor(){super(...arguments),this.type="mark"}static create(e={}){const t=typeof e=="function"?e():e;return new oI(t)}static handleExit({editor:e,mark:t}){const{tr:r}=e.state,s=e.state.selection.$from;if(s.pos===s.end()){const o=s.marks();if(!!!o.find(c=>c?.type.name===t.name))return!1;const l=o.find(c=>c?.type.name===t.name);return l&&r.removeStoredMark(l),r.insertText(" ",s.pos),e.view.dispatch(r),!0}return!1}configure(e){return super.configure(e)}extend(e){const t=typeof e=="function"?e():e;return super.extend(t)}};function B9(n){return typeof n=="number"}var $9=class{constructor(n){this.find=n.find,this.handler=n.handler}},U9=(n,e,t)=>{if(_y(e))return[...n.matchAll(e)];const r=e(n,t);return r?r.map(s=>{const i=[s.text];return i.index=s.index,i.input=n,i.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(s.replaceWith)),i}):[]};function z9(n){const{editor:e,state:t,from:r,to:s,rule:i,pasteEvent:o,dropEvent:a}=n,{commands:l,chain:c,can:u}=new Ld({editor:e,state:t}),h=[];return t.doc.nodesBetween(r,s,(p,m)=>{var y,v,T,M,P;if((v=(y=p.type)==null?void 0:y.spec)!=null&&v.code||!(p.isText||p.isTextblock||p.isInline))return;const D=(P=(M=(T=p.content)==null?void 0:T.size)!=null?M:p.nodeSize)!=null?P:0,L=Math.max(r,m),q=Math.min(s,m+D);if(L>=q)return;const S=p.isText?p.text||"":p.textBetween(L-m,q-m,void 0,"");U9(S,i.find,o).forEach(b=>{if(b.index===void 0)return;const I=L+b.index+1,R=I+b[0].length,k={from:t.tr.mapping.map(I),to:t.tr.mapping.map(R)},C=i.handler({state:t,range:k,match:b,commands:l,chain:c,can:u,pasteEvent:o,dropEvent:a});h.push(C)})}),h.every(p=>p!==null)}var Uc=null,H9=n=>{var e;const t=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=t.clipboardData)==null||e.setData("text/html",n),t};function j9(n){const{editor:e,rules:t}=n;let r=null,s=!1,i=!1,o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}const l=({state:u,from:h,to:f,rule:p,pasteEvt:m})=>{const y=u.tr,v=Dd({state:u,transaction:y});if(!(!z9({editor:e,state:v,from:Math.max(h-1,0),to:f.b-1,rule:p,pasteEvent:m,dropEvent:a})||!y.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,y}};return t.map(u=>new st({view(h){const f=m=>{var y;r=(y=h.dom.parentElement)!=null&&y.contains(m.target)?h.dom.parentElement:null,r&&(Uc=e)},p=()=>{Uc&&(Uc=null)};return window.addEventListener("dragstart",f),window.addEventListener("dragend",p),{destroy(){window.removeEventListener("dragstart",f),window.removeEventListener("dragend",p)}}},props:{handleDOMEvents:{drop:(h,f)=>{if(i=r===h.dom.parentElement,a=f,!i){const p=Uc;p?.isEditable&&setTimeout(()=>{const m=p.state.selection;m&&p.commands.deleteRange({from:m.from,to:m.to})},10)}return!1},paste:(h,f)=>{var p;const m=(p=f.clipboardData)==null?void 0:p.getData("text/html");return o=f,s=!!m?.includes("data-pm-slice"),!1}}},appendTransaction:(h,f,p)=>{const m=h[0],y=m.getMeta("uiEvent")==="paste"&&!s,v=m.getMeta("uiEvent")==="drop"&&!i,T=m.getMeta("applyPasteRules"),M=!!T;if(!y&&!v&&!M)return;if(M){let{text:L}=T;typeof L=="string"?L=L:L=Ey(H.from(L),p.schema);const{from:q}=T,S=q+L.length,w=H9(L);return l({rule:u,state:p,from:q,to:{b:S},pasteEvt:w})}const P=f.doc.content.findDiffStart(p.doc.content),D=f.doc.content.findDiffEnd(p.doc.content);if(!(!B9(P)||!D||P===D.b))return l({rule:u,state:p,from:P,to:D,pasteEvt:o})}}))}var Ud=class{constructor(n,e){this.splittableMarks=[],this.editor=e,this.baseExtensions=n,this.extensions=YA(n),this.schema=t9(this.extensions,e),this.setupExtensions()}get commands(){return this.extensions.reduce((n,e)=>{const t={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:Jf(e.name,this.schema)},r=oe(e,"addCommands",t);return r?{...n,...r()}:n},{})}get plugins(){const{editor:n}=this;return Ty([...this.extensions].reverse()).flatMap(r=>{const s={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:n,type:Jf(r.name,this.schema)},i=[],o=oe(r,"addKeyboardShortcuts",s);let a={};if(r.type==="mark"&&oe(r,"exitable",s)&&(a.ArrowRight=()=>is.handleExit({editor:n,mark:r})),o){const f=Object.fromEntries(Object.entries(o()).map(([p,m])=>[p,()=>m({editor:n})]));a={...a,...f}}const l=iB(a);i.push(l);const c=oe(r,"addInputRules",s);if(_b(r,n.options.enableInputRules)&&c){const f=c();if(f&&f.length){const p=V9({editor:n,rules:f}),m=Array.isArray(p)?p:[p];i.push(...m)}}const u=oe(r,"addPasteRules",s);if(_b(r,n.options.enablePasteRules)&&u){const f=u();if(f&&f.length){const p=j9({editor:n,rules:f});i.push(...p)}}const h=oe(r,"addProseMirrorPlugins",s);if(h){const f=h();i.push(...f)}return i})}get attributes(){return QA(this.extensions)}get nodeViews(){const{editor:n}=this,{nodeExtensions:e}=ea(this.extensions);return Object.fromEntries(e.filter(t=>!!oe(t,"addNodeView")).map(t=>{const r=this.attributes.filter(l=>l.type===t.name),s={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:n,type:bt(t.name,this.schema)},i=oe(t,"addNodeView",s);if(!i)return[];const o=i();if(!o)return[];const a=(l,c,u,h,f)=>{const p=ih(l,r);return o({node:l,view:c,getPos:u,decorations:h,innerDecorations:f,editor:n,extension:t,HTMLAttributes:p})};return[t.name,a]}))}get markViews(){const{editor:n}=this,{markExtensions:e}=ea(this.extensions);return Object.fromEntries(e.filter(t=>!!oe(t,"addMarkView")).map(t=>{const r=this.attributes.filter(a=>a.type===t.name),s={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:n,type:ss(t.name,this.schema)},i=oe(t,"addMarkView",s);if(!i)return[];const o=(a,l,c)=>{const u=ih(a,r);return i()({mark:a,view:l,inline:c,editor:n,extension:t,HTMLAttributes:u,updateAttributes:h=>{s$(a,n,h)}})};return[t.name,o]}))}setupExtensions(){const n=this.extensions;this.editor.extensionStorage=Object.fromEntries(n.map(e=>[e.name,e.storage])),n.forEach(e=>{var t;const r={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:Jf(e.name,this.schema)};e.type==="mark"&&((t=Ve(oe(e,"keepOnSplit",r)))==null||t)&&this.splittableMarks.push(e.name);const s=oe(e,"onBeforeCreate",r),i=oe(e,"onCreate",r),o=oe(e,"onUpdate",r),a=oe(e,"onSelectionUpdate",r),l=oe(e,"onTransaction",r),c=oe(e,"onFocus",r),u=oe(e,"onBlur",r),h=oe(e,"onDestroy",r);s&&this.editor.on("beforeCreate",s),i&&this.editor.on("create",i),o&&this.editor.on("update",o),a&&this.editor.on("selectionUpdate",a),l&&this.editor.on("transaction",l),c&&this.editor.on("focus",c),u&&this.editor.on("blur",u),h&&this.editor.on("destroy",h)})}};Ud.resolve=YA;Ud.sort=Ty;Ud.flatten=by;var W9={};yy(W9,{ClipboardTextSerializer:()=>lI,Commands:()=>cI,Delete:()=>uI,Drop:()=>hI,Editable:()=>dI,FocusEvents:()=>pI,Keymap:()=>mI,Paste:()=>gI,Tabindex:()=>yI,TextDirection:()=>_I,focusEventsPluginKey:()=>fI});var je=class aI extends Cy{constructor(){super(...arguments),this.type="extension"}static create(e={}){const t=typeof e=="function"?e():e;return new aI(t)}configure(e){return super.configure(e)}extend(e){const t=typeof e=="function"?e():e;return super.extend(t)}},lI=je.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new st({key:new dt("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:e,schema:t}=n,{doc:r,selection:s}=e,{ranges:i}=s,o=Math.min(...i.map(u=>u.$from.pos)),a=Math.max(...i.map(u=>u.$to.pos)),l=ZA(t);return XA(r,{from:o,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),cI=je.create({name:"commands",addCommands(){return{...$A}}}),uI=je.create({name:"delete",onUpdate({transaction:n,appendedTransactions:e}){var t,r,s;const i=()=>{var o,a,l,c;if((c=(l=(a=(o=this.editor.options.coreExtensionOptions)==null?void 0:o.delete)==null?void 0:a.filterTransaction)==null?void 0:l.call(a,n))!=null?c:n.getMeta("y-sync$"))return;const u=KA(n.before,[n,...e]);tI(u).forEach(p=>{u.mapping.mapResult(p.oldRange.from).deletedAfter&&u.mapping.mapResult(p.oldRange.to).deletedBefore&&u.before.nodesBetween(p.oldRange.from,p.oldRange.to,(m,y)=>{const v=y+m.nodeSize-2,T=p.oldRange.from<=y&&v<=p.oldRange.to;this.editor.emit("delete",{type:"node",node:m,from:y,to:v,newFrom:u.mapping.map(y),newTo:u.mapping.map(v),deletedRange:p.oldRange,newRange:p.newRange,partial:!T,editor:this.editor,transaction:n,combinedTransform:u})})});const f=u.mapping;u.steps.forEach((p,m)=>{var y,v;if(p instanceof Kn){const T=f.slice(m).map(p.from,-1),M=f.slice(m).map(p.to),P=f.invert().map(T,-1),D=f.invert().map(M),L=(y=u.doc.nodeAt(T-1))==null?void 0:y.marks.some(S=>S.eq(p.mark)),q=(v=u.doc.nodeAt(M))==null?void 0:v.marks.some(S=>S.eq(p.mark));this.editor.emit("delete",{type:"mark",mark:p.mark,from:p.from,to:p.to,deletedRange:{from:P,to:D},newRange:{from:T,to:M},partial:!!(q||L),editor:this.editor,transaction:n,combinedTransform:u})}})};(s=(r=(t=this.editor.options.coreExtensionOptions)==null?void 0:t.delete)==null?void 0:r.async)==null||s?setTimeout(i,0):i()}}),hI=je.create({name:"drop",addProseMirrorPlugins(){return[new st({key:new dt("tiptapDrop"),props:{handleDrop:(n,e,t,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:t,moved:r})}}})]}}),dI=je.create({name:"editable",addProseMirrorPlugins(){return[new st({key:new dt("editable"),props:{editable:()=>this.editor.options.editable}})]}}),fI=new dt("focusEvents"),pI=je.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new st({key:fI,props:{handleDOMEvents:{focus:(e,t)=>{n.isFocused=!0;const r=n.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,t)=>{n.isFocused=!1;const r=n.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),mI=je.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:u,$anchor:h}=l,{pos:f,parent:p}=h,m=h.parent.isTextblock&&f>0?a.doc.resolve(f-1):h,y=m.parent.type.spec.isolating,v=h.pos-h.parentOffset,T=y&&m.parent.childCount===1?v===h.pos:me.atStart(c).from===f;return!u||!p.type.isTextblock||p.textContent.length||!T||T&&h.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},s={...r},i={...r,"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return wy()||WA()?i:s},addProseMirrorPlugins(){return[new st({key:new dt("clearDocument"),appendTransaction:(n,e,t)=>{if(n.some(y=>y.getMeta("composition")))return;const r=n.some(y=>y.docChanged)&&!e.doc.eq(t.doc),s=n.some(y=>y.getMeta("preventClearDocument"));if(!r||s)return;const{empty:i,from:o,to:a}=e.selection,l=me.atStart(e.doc).from,c=me.atEnd(e.doc).to;if(i||!(o===l&&a===c)||!Bd(t.doc))return;const f=t.tr,p=Dd({state:t,transaction:f}),{commands:m}=new Ld({editor:this.editor,state:p});if(m.clearNodes(),!!f.steps.length)return f}})]}}),gI=je.create({name:"paste",addProseMirrorPlugins(){return[new st({key:new dt("tiptapPaste"),props:{handlePaste:(n,e,t)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:t})}}})]}}),yI=je.create({name:"tabindex",addProseMirrorPlugins(){return[new st({key:new dt("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),_I=je.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:n}=ea(this.extensions);return[{types:n.filter(e=>e.name!=="text").map(e=>e.name),attributes:{dir:{default:this.options.direction,parseHTML:e=>{const t=e.getAttribute("dir");return t&&(t==="ltr"||t==="rtl"||t==="auto")?t:this.options.direction},renderHTML:e=>e.dir?{dir:e.dir}:{}}}}]},addProseMirrorPlugins(){return[new st({key:new dt("textDirection"),props:{attributes:()=>{const n=this.options.direction;return n?{dir:n}:{}}}})]}}),q9=class Co{constructor(e,t,r=!1,s=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=t,this.currentNode=s}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!=null?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}t=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:t,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),t=this.resolvedPos.doc.resolve(e);return new Co(t,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Co(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Co(e,this.editor)}get children(){const e=[];return this.node.content.forEach((t,r)=>{const s=t.isBlock&&!t.isTextblock,i=t.isAtom&&!t.isText,o=this.pos+r+(i?0:1);if(o<0||o>this.resolvedPos.doc.nodeSize-2)return;const a=this.resolvedPos.doc.resolve(o);if(!s&&a.depth<=this.depth)return;const l=new Co(a,this.editor,s,s?t:null);s&&(l.actualDepth=this.depth+1),e.push(new Co(a,this.editor,s,s?t:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,t={}){let r=null,s=this.parent;for(;s&&!r;){if(s.node.type.name===e)if(Object.keys(t).length>0){const i=s.node.attrs,o=Object.keys(t);for(let a=0;a<o.length;a+=1){const l=o[a];if(i[l]!==t[l])break}}else r=s;s=s.parent}return r}querySelector(e,t={}){return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e,t={},r=!1){let s=[];if(!this.children||this.children.length===0)return s;const i=Object.keys(t);return this.children.forEach(o=>{r&&s.length>0||(o.node.type.name===e&&i.every(l=>t[l]===o.node.attrs[l])&&s.push(o),!(r&&s.length>0)&&(s=s.concat(o.querySelectorAll(e,t,r))))}),s}setAttribute(e){const{tr:t}=this.editor.state;t.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(t)}},K9=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function G9(n,e,t){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const s=document.createElement("style");return e&&s.setAttribute("nonce",e),s.setAttribute("data-tiptap-style",""),s.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(s),s}var J9=class extends D9{constructor(e={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:s})=>{throw s},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:d9,createMappablePosition:f9},this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:s,slice:i,moved:o})=>this.options.onDrop(s,i,o)),this.on("paste",({event:s,slice:i})=>this.options.onPaste(s,i)),this.on("delete",this.options.onDelete);const t=this.createDoc(),r=HA(t,this.options.autofocus);this.editorState=ko.create({doc:t,schema:this.schema,selection:r||void 0}),this.options.element&&this.mount(this.options.element)}mount(e){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(e),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const e=this.editorView.dom;e?.editor&&delete e.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(e){console.warn("Failed to remove CSS element:",e)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=G9(K9,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:e=>{this.editorState=e},dispatch:e=>{this.dispatchTransaction(e)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(e,t)=>{if(this.editorView)return this.editorView[t];if(t==="state")return this.editorState;if(t in e)return Reflect.get(e,t);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${t}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(e,t){const r=JA(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],s=this.state.reconfigure({plugins:r});return this.view.updateState(s),s}unregisterPlugin(e){if(this.isDestroyed)return;const t=this.state.plugins;let r=t;if([].concat(e).forEach(i=>{const o=typeof i=="string"?`${i}$`:i.key;r=r.filter(a=>!a.key.startsWith(o))}),t.length===r.length)return;const s=this.state.reconfigure({plugins:r});return this.view.updateState(s),s}createExtensionManager(){var e,t;const s=[...this.options.enableCoreExtensions?[dI,lI.configure({blockSeparator:(t=(e=this.options.coreExtensionOptions)==null?void 0:e.clipboardTextSerializer)==null?void 0:t.blockSeparator}),cI,pI,mI,yI,hI,gI,uI,_I.configure({direction:this.options.textDirection})].filter(i=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[i.name]!==!1:!0):[],...this.options.extensions].filter(i=>["extension","node","mark"].includes(i?.type));this.extensionManager=new Ud(s,this)}createCommandManager(){this.commandManager=new Ld({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let e;try{e=fm(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(t){if(!(t instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(t.message))throw t;this.emit("contentError",{editor:this,error:t,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(r=>r.name!=="collaboration"),this.createExtensionManager()}}),e=fm(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return e}createView(e){var t;this.editorView=new BA(e,{...this.options.editorProps,attributes:{role:"textbox",...(t=this.options.editorProps)==null?void 0:t.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.prependClass(),this.injectCSS();const s=this.view.dom;s.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(u=>{var h;return(h=this.capturedTransaction)==null?void 0:h.step(u)});return}const{state:t,transactions:r}=this.state.applyTransaction(e),s=!this.state.selection.eq(t.selection),i=r.includes(e),o=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),!i)return;this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e,appendedTransactions:r.slice(1)}),s&&this.emit("selectionUpdate",{editor:this,transaction:e});const a=r.findLast(u=>u.getMeta("focus")||u.getMeta("blur")),l=a?.getMeta("focus"),c=a?.getMeta("blur");l&&this.emit("focus",{editor:this,event:l.event,transaction:a}),c&&this.emit("blur",{editor:this,event:c.event,transaction:a}),!(e.getMeta("preventUpdate")||!r.some(u=>u.docChanged)||o.doc.eq(t.doc))&&this.emit("update",{editor:this,transaction:e,appendedTransactions:r.slice(1)})}getAttributes(e){return eI(this.state,e)}isActive(e,t){const r=typeof e=="string"?e:null,s=typeof e=="string"?t:e;return c9(this.state,r,s)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Ey(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t=`

`,textSerializers:r={}}=e||{};return r9(this.state.doc,{blockSeparator:t,textSerializers:{...ZA(this.schema),...r}})}get isEmpty(){return Bd(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var e,t;return(t=(e=this.editorView)==null?void 0:e.isDestroyed)!=null?t:!0}$node(e,t){var r;return((r=this.$doc)==null?void 0:r.querySelector(e,t))||null}$nodes(e,t){var r;return((r=this.$doc)==null?void 0:r.querySelectorAll(e,t))||null}$pos(e){const t=this.state.doc.resolve(e);return new q9(t,this)}get $doc(){return this.$pos(0)}};function Yi(n){return new $d({find:n.find,handler:({state:e,range:t,match:r})=>{const s=Ve(n.getAttributes,void 0,r);if(s===!1||s===null)return null;const{tr:i}=e,o=r[r.length-1],a=r[0];if(o){const l=a.search(/\S/),c=t.from+a.indexOf(o),u=c+o.length;if(Sy(t.from,t.to,e.doc).filter(p=>p.mark.type.excluded.find(y=>y===n.type&&y!==p.mark.type)).filter(p=>p.to>c).length)return null;u<t.to&&i.delete(u,t.to),c>t.from&&i.delete(t.from+l,c);const f=t.from+l+o.length;i.addMark(t.from+l,f,n.type.create(s||{})),i.removeStoredMark(n.type)}},undoable:n.undoable})}function Q9(n){return new $d({find:n.find,handler:({state:e,range:t,match:r})=>{const s=Ve(n.getAttributes,void 0,r)||{},{tr:i}=e,o=t.from;let a=t.to;const l=n.type.create(s);if(r[1]){const c=r[0].lastIndexOf(r[1]);let u=o+c;u>a?u=a:a=u+r[1].length;const h=r[0][r[0].length-1];i.insertText(h,o+r[0].length-1),i.replaceWith(u,a,l)}else if(r[0]){const c=n.type.isInline?o:o-1;i.insert(c,n.type.create(s)).delete(i.mapping.map(o),i.mapping.map(a))}i.scrollIntoView()},undoable:n.undoable})}function mm(n){return new $d({find:n.find,handler:({state:e,range:t,match:r})=>{const s=e.doc.resolve(t.from),i=Ve(n.getAttributes,void 0,r)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),n.type))return null;e.tr.delete(t.from,t.to).setBlockType(t.from,t.from,n.type,i)},undoable:n.undoable})}function ta(n){return new $d({find:n.find,handler:({state:e,range:t,match:r,chain:s})=>{const i=Ve(n.getAttributes,void 0,r)||{},o=e.tr.delete(t.from,t.to),l=o.doc.resolve(t.from).blockRange(),c=l&&Zg(l,n.type,i);if(!c)return null;if(o.wrap(l,c),n.keepMarks&&n.editor){const{selection:h,storedMarks:f}=e,{splittableMarks:p}=n.editor.extensionManager,m=f||h.$to.parentOffset&&h.$from.marks();if(m){const y=m.filter(v=>p.includes(v.type.name));o.ensureMarks(y)}}if(n.keepAttributes){const h=n.type.name==="bulletList"||n.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(h,i).run()}const u=o.doc.resolve(t.from-1).nodeBefore;u&&u.type===n.type&&di(o.doc,t.from-1)&&(!n.joinPredicate||n.joinPredicate(r,u))&&o.join(t.from-1)},undoable:n.undoable})}function Y9(n,e){const{selection:t}=n,{$from:r}=t;if(t instanceof le){const i=r.index();return r.parent.canReplaceWith(i,i+1,e)}let s=r.depth;for(;s>=0;){const i=r.index(s);if(r.node(s).contentMatchAt(i).matchType(e))return!0;s-=1}return!1}var X9={};yy(X9,{createAtomBlockMarkdownSpec:()=>Z9,createBlockMarkdownSpec:()=>e$,createInlineMarkdownSpec:()=>r$,parseAttributes:()=>Ay,parseIndentedBlocks:()=>gm,renderNestedMarkdownContent:()=>ky,serializeAttributes:()=>Iy});function Ay(n){if(!n?.trim())return{};const e={},t=[],r=n.replace(/["']([^"']*)["']/g,c=>(t.push(c),`__QUOTED_${t.length-1}__`)),s=r.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(s){const c=s.map(u=>u.trim().slice(1));e.class=c.join(" ")}const i=r.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);i&&(e.id=i[1]);const o=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(r.matchAll(o)).forEach(([,c,u])=>{var h;const f=parseInt(((h=u.match(/__QUOTED_(\d+)__/))==null?void 0:h[1])||"0",10),p=t[f];p&&(e[c]=p.slice(1,-1))});const l=r.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return l&&l.split(/\s+/).filter(Boolean).forEach(u=>{u.match(/^[a-zA-Z][\w-]*$/)&&(e[u]=!0)}),e}function Iy(n){if(!n||Object.keys(n).length===0)return"";const e=[];return n.class&&String(n.class).split(/\s+/).filter(Boolean).forEach(r=>e.push(`.${r}`)),n.id&&e.push(`#${n.id}`),Object.entries(n).forEach(([t,r])=>{t==="class"||t==="id"||(r===!0?e.push(t):r!==!1&&r!=null&&e.push(`${t}="${String(r)}"`))}),e.join(" ")}function Z9(n){const{nodeName:e,name:t,parseAttributes:r=Ay,serializeAttributes:s=Iy,defaultAttributes:i={},requiredAttributes:o=[],allowedAttributes:a}=n,l=t||e,c=u=>{if(!a)return u;const h={};return a.forEach(f=>{f in u&&(h[f]=u[f])}),h};return{parseMarkdown:(u,h)=>{const f={...i,...u.attributes};return h.createNode(e,f,[])},markdownTokenizer:{name:e,level:"block",start(u){var h;const f=new RegExp(`^:::${l}(?:\\s|$)`,"m"),p=(h=u.match(f))==null?void 0:h.index;return p!==void 0?p:-1},tokenize(u,h,f){const p=new RegExp(`^:::${l}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),m=u.match(p);if(!m)return;const y=m[1]||"",v=r(y);if(!o.find(M=>!(M in v)))return{type:e,raw:m[0],attributes:v}}},renderMarkdown:u=>{const h=c(u.attrs||{}),f=s(h),p=f?` {${f}}`:"";return`:::${l}${p} :::`}}}function e$(n){const{nodeName:e,name:t,getContent:r,parseAttributes:s=Ay,serializeAttributes:i=Iy,defaultAttributes:o={},content:a="block",allowedAttributes:l}=n,c=t||e,u=h=>{if(!l)return h;const f={};return l.forEach(p=>{p in h&&(f[p]=h[p])}),f};return{parseMarkdown:(h,f)=>{let p;if(r){const y=r(h);p=typeof y=="string"?[{type:"text",text:y}]:y}else a==="block"?p=f.parseChildren(h.tokens||[]):p=f.parseInline(h.tokens||[]);const m={...o,...h.attributes};return f.createNode(e,m,p)},markdownTokenizer:{name:e,level:"block",start(h){var f;const p=new RegExp(`^:::${c}`,"m"),m=(f=h.match(p))==null?void 0:f.index;return m!==void 0?m:-1},tokenize(h,f,p){var m;const y=new RegExp(`^:::${c}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),v=h.match(y);if(!v)return;const[T,M=""]=v,P=s(M);let D=1;const L=T.length;let q="";const S=/^:::([\w-]*)(\s.*)?/gm,w=h.slice(L);for(S.lastIndex=0;;){const b=S.exec(w);if(b===null)break;const I=b.index,R=b[1];if(!((m=b[2])!=null&&m.endsWith(":::"))){if(R)D+=1;else if(D-=1,D===0){const k=w.slice(0,I);q=k.trim();const C=h.slice(0,L+I+b[0].length);let _e=[];if(q)if(a==="block")for(_e=p.blockTokens(k),_e.forEach(Ae=>{Ae.text&&(!Ae.tokens||Ae.tokens.length===0)&&(Ae.tokens=p.inlineTokens(Ae.text))});_e.length>0;){const Ae=_e[_e.length-1];if(Ae.type==="paragraph"&&(!Ae.text||Ae.text.trim()===""))_e.pop();else break}else _e=p.inlineTokens(q);return{type:e,raw:C,attributes:P,content:q,tokens:_e}}}}}},renderMarkdown:(h,f)=>{const p=u(h.attrs||{}),m=i(p),y=m?` {${m}}`:"",v=f.renderChildren(h.content||[],`

`);return`:::${c}${y}

${v}

:::`}}}function t$(n){if(!n.trim())return{};const e={},t=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let r=t.exec(n);for(;r!==null;){const[,s,i,o]=r;e[s]=i||o,r=t.exec(n)}return e}function n$(n){return Object.entries(n).filter(([,e])=>e!=null).map(([e,t])=>`${e}="${t}"`).join(" ")}function r$(n){const{nodeName:e,name:t,getContent:r,parseAttributes:s=t$,serializeAttributes:i=n$,defaultAttributes:o={},selfClosing:a=!1,allowedAttributes:l}=n,c=t||e,u=f=>{if(!l)return f;const p={};return l.forEach(m=>{const y=typeof m=="string"?m:m.name,v=typeof m=="string"?void 0:m.skipIfDefault;if(y in f){const T=f[y];if(v!==void 0&&T===v)return;p[y]=T}}),p},h=c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(f,p)=>{const m={...o,...f.attributes};if(a)return p.createNode(e,m);const y=r?r(f):f.content||"";return y?p.createNode(e,m,[p.createTextNode(y)]):p.createNode(e,m,[])},markdownTokenizer:{name:e,level:"inline",start(f){const p=a?new RegExp(`\\[${h}\\s*[^\\]]*\\]`):new RegExp(`\\[${h}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${h}\\]`),m=f.match(p),y=m?.index;return y!==void 0?y:-1},tokenize(f,p,m){const y=a?new RegExp(`^\\[${h}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${h}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${h}\\]`),v=f.match(y);if(!v)return;let T="",M="";if(a){const[,D]=v;M=D}else{const[,D,L]=v;M=D,T=L||""}const P=s(M.trim());return{type:e,raw:v[0],content:T.trim(),attributes:P}}},renderMarkdown:f=>{let p="";r?p=r(f):f.content&&f.content.length>0&&(p=f.content.filter(T=>T.type==="text").map(T=>T.text).join(""));const m=u(f.attrs||{}),y=i(m),v=y?` ${y}`:"";return a?`[${c}${v}]`:`[${c}${v}]${p}[/${c}]`}}}function gm(n,e,t){var r,s,i,o;const a=n.split(`
`),l=[];let c="",u=0;const h=e.baseIndentSize||2;for(;u<a.length;){const f=a[u],p=f.match(e.itemPattern);if(!p){if(l.length>0)break;if(f.trim()===""){u+=1,c=`${c}${f}
`;continue}else return}const m=e.extractItemData(p),{indentLevel:y,mainContent:v}=m;c=`${c}${f}
`;const T=[v];for(u+=1;u<a.length;){const L=a[u];if(L.trim()===""){const S=a.slice(u+1).findIndex(I=>I.trim()!=="");if(S===-1)break;if((((s=(r=a[u+1+S].match(/^(\s*)/))==null?void 0:r[1])==null?void 0:s.length)||0)>y){T.push(L),c=`${c}${L}
`,u+=1;continue}else break}if((((o=(i=L.match(/^(\s*)/))==null?void 0:i[1])==null?void 0:o.length)||0)>y)T.push(L),c=`${c}${L}
`,u+=1;else break}let M;const P=T.slice(1);if(P.length>0){const L=P.map(q=>q.slice(y+h)).join(`
`);L.trim()&&(e.customNestedParser?M=e.customNestedParser(L):M=t.blockTokens(L))}const D=e.createToken(m,M);l.push(D)}if(l.length!==0)return{items:l,raw:c}}function ky(n,e,t,r){if(!n||!Array.isArray(n.content))return"";const s=typeof t=="function"?t(r):t,[i,...o]=n.content,a=e.renderChildren([i]),l=[`${s}${a}`];return o&&o.length>0&&o.forEach(c=>{const u=e.renderChildren([c]);if(u){const h=u.split(`
`).map(f=>f?e.indent(f):"").join(`
`);l.push(h)}}),l.join(`
`)}function s$(n,e,t={}){const{state:r}=e,{doc:s,tr:i}=r,o=n;s.descendants((a,l)=>{const c=i.mapping.map(l),u=i.mapping.map(l)+a.nodeSize;let h=null;if(a.marks.forEach(p=>{if(p!==o)return!1;h=p}),!h)return;let f=!1;if(Object.keys(t).forEach(p=>{t[p]!==h.attrs[p]&&(f=!0)}),f){const p=n.type.create({...n.attrs,...t});i.removeMark(c,u,n.type),i.addMark(c,u,p)}}),i.docChanged&&e.view.dispatch(i)}var Ht=class vI extends Cy{constructor(){super(...arguments),this.type="node"}static create(e={}){const t=typeof e=="function"?e():e;return new vI(t)}configure(e){return super.configure(e)}extend(e){const t=typeof e=="function"?e():e;return super.extend(t)}};function ai(n){return new $9({find:n.find,handler:({state:e,range:t,match:r,pasteEvent:s})=>{const i=Ve(n.getAttributes,void 0,r,s);if(i===!1||i===null)return null;const{tr:o}=e,a=r[r.length-1],l=r[0];let c=t.to;if(a){const u=l.search(/\S/),h=t.from+l.indexOf(a),f=h+a.length;if(Sy(t.from,t.to,e.doc).filter(m=>m.mark.type.excluded.find(v=>v===n.type&&v!==m.mark.type)).filter(m=>m.to>h).length)return null;f<t.to&&o.delete(f,t.to),h>t.from&&o.delete(t.from+u,h),c=t.from+u+a.length,o.addMark(t.from+u,c,n.type.create(i||{})),o.removeStoredMark(n.type)}}})}function bb(n){return uR((e,t)=>({get(){return e(),n},set(r){n=r,requestAnimationFrame(()=>{requestAnimationFrame(()=>{t()})})}}))}var i$=class extends J9{constructor(n={}){return super(n),this.contentComponent=null,this.appContext=null,this.reactiveState=bb(this.view.state),this.reactiveExtensionStorage=bb(this.extensionStorage),this.on("beforeTransaction",({nextState:e})=>{this.reactiveState.value=e,this.reactiveExtensionStorage.value=this.extensionStorage}),zh(this)}get state(){return this.reactiveState?this.reactiveState.value:this.view.state}get storage(){return this.reactiveExtensionStorage?this.reactiveExtensionStorage.value:super.storage}registerPlugin(n,e){const t=super.registerPlugin(n,e);return this.reactiveState&&(this.reactiveState.value=t),t}unregisterPlugin(n){const e=super.unregisterPlugin(n);return this.reactiveState&&e&&(this.reactiveState.value=e),e}},o$=Wm({name:"EditorContent",props:{editor:{default:null,type:Object}},setup(n){const e=$e(),t=Xh();return ix(()=>{const r=n.editor;r&&r.options.element&&e.value&&jh(()=>{var s;if(!e.value||!((s=r.view.dom)!=null&&s.firstChild))return;const i=qe(e.value);e.value.append(r.view.dom),r.contentComponent=t.ctx._,t&&(r.appContext={...t.appContext,provides:t.provides}),r.setOptions({element:i}),r.createNodeViews()})}),Kh(()=>{const r=n.editor;r&&(r.contentComponent=null,r.appContext=null)}),{rootEl:e}},render(){return ed("div",{ref:n=>{this.rootEl=n}})}}),a$=(n={})=>{const e=C1();return Ar(()=>{e.value=new i$(n)}),Kh(()=>{var t,r,s;const i=(t=e.value)==null?void 0:t.view.dom,o=i?.cloneNode(!0);(r=i?.parentNode)==null||r.replaceChild(o,i),(s=e.value)==null||s.destroy()}),e},oh=(n,e)=>{if(n==="slot")return 0;if(n instanceof Function)return n(e);const{children:t,...r}=e??{};if(n==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[n,r,t]},l$=/^\s*>\s$/,c$=Ht.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:n}){return oh("blockquote",{...Ze(this.options.HTMLAttributes,n),children:oh("slot",{})})},parseMarkdown:(n,e)=>e.createNode("blockquote",void 0,e.parseChildren(n.tokens||[])),renderMarkdown:(n,e)=>{if(!n.content)return"";const t=">",r=[];return n.content.forEach(s=>{const a=e.renderChildren([s]).split(`
`).map(l=>l.trim()===""?t:`${t} ${l}`);r.push(a.join(`
`))}),r.join(`
${t}
`)},addCommands(){return{setBlockquote:()=>({commands:n})=>n.wrapIn(this.name),toggleBlockquote:()=>({commands:n})=>n.toggleWrap(this.name),unsetBlockquote:()=>({commands:n})=>n.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[ta({find:l$,type:this.type})]}}),u$=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,h$=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,d$=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,f$=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,p$=is.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:n=>n.type.name===this.name},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}]},renderHTML({HTMLAttributes:n}){return oh("strong",{...Ze(this.options.HTMLAttributes,n),children:oh("slot",{})})},markdownTokenName:"strong",parseMarkdown:(n,e)=>e.applyMark("bold",e.parseInline(n.tokens||[])),renderMarkdown:(n,e)=>`**${e.renderChildren(n)}**`,addCommands(){return{setBold:()=>({commands:n})=>n.setMark(this.name),toggleBold:()=>({commands:n})=>n.toggleMark(this.name),unsetBold:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Yi({find:u$,type:this.type}),Yi({find:d$,type:this.type})]},addPasteRules(){return[ai({find:h$,type:this.type}),ai({find:f$,type:this.type})]}}),m$=/(^|[^`])`([^`]+)`(?!`)$/,g$=/(^|[^`])`([^`]+)`(?!`)/g,y$=is.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:n}){return["code",Ze(this.options.HTMLAttributes,n),0]},markdownTokenName:"codespan",parseMarkdown:(n,e)=>e.applyMark("code",[{type:"text",text:n.text||""}]),renderMarkdown:(n,e)=>n.content?`\`${e.renderChildren(n.content)}\``:"",addCommands(){return{setCode:()=>({commands:n})=>n.setMark(this.name),toggleCode:()=>({commands:n})=>n.toggleMark(this.name),unsetCode:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Yi({find:m$,type:this.type})]},addPasteRules(){return[ai({find:g$,type:this.type})]}}),Xf=4,_$=/^```([a-z]+)?[\s\n]$/,v$=/^~~~([a-z]+)?[\s\n]$/,w$=Ht.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:Xf,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:n=>{var e;const{languageClassPrefix:t}=this.options;if(!t)return null;const i=[...((e=n.firstElementChild)==null?void 0:e.classList)||[]].filter(o=>o.startsWith(t)).map(o=>o.replace(t,""))[0];return i||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:n,HTMLAttributes:e}){return["pre",Ze(this.options.HTMLAttributes,e),["code",{class:n.attrs.language?this.options.languageClassPrefix+n.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(n,e)=>{var t;return((t=n.raw)==null?void 0:t.startsWith("```"))===!1&&n.codeBlockStyle!=="indented"?[]:e.createNode("codeBlock",{language:n.lang||null},n.text?[e.createTextNode(n.text)]:[])},renderMarkdown:(n,e)=>{var t;let r="";const s=((t=n.attrs)==null?void 0:t.language)||"";return n.content?r=[`\`\`\`${s}`,e.renderChildren(n.content),"```"].join(`
`):r=`\`\`\`${s}

\`\`\``,r},addCommands(){return{setCodeBlock:n=>({commands:e})=>e.setNode(this.name,n),toggleCodeBlock:n=>({commands:e})=>e.toggleNode(this.name,"paragraph",n)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:n,$anchor:e}=this.editor.state.selection,t=e.pos===1;return!n||e.parent.type.name!==this.name?!1:t||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:n})=>{var e;if(!this.options.enableTabIndentation)return!1;const t=(e=this.options.tabSize)!=null?e:Xf,{state:r}=n,{selection:s}=r,{$from:i,empty:o}=s;if(i.parent.type!==this.type)return!1;const a=" ".repeat(t);return o?n.commands.insertContent(a):n.commands.command(({tr:l})=>{const{from:c,to:u}=s,p=r.doc.textBetween(c,u,`
`,`
`).split(`
`).map(m=>a+m).join(`
`);return l.replaceWith(c,u,r.schema.text(p)),!0})},"Shift-Tab":({editor:n})=>{var e;if(!this.options.enableTabIndentation)return!1;const t=(e=this.options.tabSize)!=null?e:Xf,{state:r}=n,{selection:s}=r,{$from:i,empty:o}=s;return i.parent.type!==this.type?!1:o?n.commands.command(({tr:a})=>{var l;const{pos:c}=i,u=i.start(),h=i.end(),p=r.doc.textBetween(u,h,`
`,`
`).split(`
`);let m=0,y=0;const v=c-u;for(let q=0;q<p.length;q+=1){if(y+p[q].length>=v){m=q;break}y+=p[q].length+1}const M=((l=p[m].match(/^ */))==null?void 0:l[0])||"",P=Math.min(M.length,t);if(P===0)return!0;let D=u;for(let q=0;q<m;q+=1)D+=p[q].length+1;return a.delete(D,D+P),c-D<=P&&a.setSelection(ue.create(a.doc,D)),!0}):n.commands.command(({tr:a})=>{const{from:l,to:c}=s,f=r.doc.textBetween(l,c,`
`,`
`).split(`
`).map(p=>{var m;const y=((m=p.match(/^ */))==null?void 0:m[0])||"",v=Math.min(y.length,t);return p.slice(v)}).join(`
`);return a.replaceWith(l,c,r.schema.text(f)),!0})},Enter:({editor:n})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=n,{selection:t}=e,{$from:r,empty:s}=t;if(!s||r.parent.type!==this.type)return!1;const i=r.parentOffset===r.parent.nodeSize-2,o=r.parent.textContent.endsWith(`

`);return!i||!o?!1:n.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:n})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=n,{selection:t,doc:r}=e,{$from:s,empty:i}=t;if(!i||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;const a=s.after();return a===void 0?!1:r.nodeAt(a)?n.commands.command(({tr:c})=>(c.setSelection(me.near(r.resolve(a))),!0)):n.commands.exitCode()}}},addInputRules(){return[mm({find:_$,type:this.type,getAttributes:n=>({language:n[1]})}),mm({find:v$,type:this.type,getAttributes:n=>({language:n[1]})})]},addProseMirrorPlugins(){return[new st({key:new dt("codeBlockVSCodeHandler"),props:{handlePaste:(n,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const t=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),s=r?JSON.parse(r):void 0,i=s?.mode;if(!t||!i)return!1;const{tr:o,schema:a}=n.state,l=a.text(t.replace(/\r\n?/g,`
`));return o.replaceSelectionWith(this.type.create({language:i},l)),o.selection.$from.parent.type!==this.type&&o.setSelection(ue.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),n.dispatch(o),!0}}})]}}),b$=Ht.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(n,e)=>n.content?e.renderChildren(n.content,`

`):""}),E$=Ht.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:n}){return["br",Ze(this.options.HTMLAttributes,n)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:n,chain:e,state:t,editor:r})=>n.first([()=>n.exitCode(),()=>n.command(()=>{const{selection:s,storedMarks:i}=t;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:a}=r.extensionManager,l=i||s.$to.parentOffset&&s.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&l&&o){const h=l.filter(f=>a.includes(f.type.name));c.ensureMarks(h)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),T$=Ht.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(n=>({tag:`h${n}`,attrs:{level:n}}))},renderHTML({node:n,HTMLAttributes:e}){return[`h${this.options.levels.includes(n.attrs.level)?n.attrs.level:this.options.levels[0]}`,Ze(this.options.HTMLAttributes,e),0]},parseMarkdown:(n,e)=>e.createNode("heading",{level:n.depth||1},e.parseInline(n.tokens||[])),renderMarkdown:(n,e)=>{var t;const r=(t=n.attrs)!=null&&t.level?parseInt(n.attrs.level,10):1,s="#".repeat(r);return n.content?`${s} ${e.renderChildren(n.content)}`:""},addCommands(){return{setHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.setNode(this.name,n):!1,toggleHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.toggleNode(this.name,"paragraph",n):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((n,e)=>({...n,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(n=>mm({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${n}})\\s$`),type:this.type,getAttributes:{level:n}}))}}),S$=Ht.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:n}){return["hr",Ze(this.options.HTMLAttributes,n)]},markdownTokenName:"hr",parseMarkdown:(n,e)=>e.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:n,state:e})=>{if(!Y9(e,e.schema.nodes[this.name]))return!1;const{selection:t}=e,{$to:r}=t,s=n();return nI(t)?s.insertContentAt(r.pos,{type:this.name}):s.insertContent({type:this.name}),s.command(({state:i,tr:o,dispatch:a})=>{if(a){const{$to:l}=o.selection,c=l.end();if(l.nodeAfter)l.nodeAfter.isTextblock?o.setSelection(ue.create(o.doc,l.pos+1)):l.nodeAfter.isBlock?o.setSelection(le.create(o.doc,l.pos)):o.setSelection(ue.create(o.doc,l.pos));else{const u=i.schema.nodes[this.options.nextNodeType]||l.parent.type.contentMatch.defaultType,h=u?.create();h&&(o.insert(c,h),o.setSelection(ue.create(o.doc,c+1)))}o.scrollIntoView()}return!0}).run()}}},addInputRules(){return[Q9({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),C$=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,A$=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,I$=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,k$=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,R$=is.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:n=>n.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:n=>n.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:n}){return["em",Ze(this.options.HTMLAttributes,n),0]},addCommands(){return{setItalic:()=>({commands:n})=>n.setMark(this.name),toggleItalic:()=>({commands:n})=>n.toggleMark(this.name),unsetItalic:()=>({commands:n})=>n.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(n,e)=>e.applyMark("italic",e.parseInline(n.tokens||[])),renderMarkdown:(n,e)=>`*${e.renderChildren(n)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Yi({find:C$,type:this.type}),Yi({find:I$,type:this.type})]},addPasteRules(){return[ai({find:A$,type:this.type}),ai({find:k$,type:this.type})]}});const x$="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",M$="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",ym="numeric",_m="ascii",vm="alpha",ul="asciinumeric",za="alphanumeric",wm="domain",wI="emoji",P$="scheme",N$="slashscheme",Zf="whitespace";function O$(n,e){return n in e||(e[n]=[]),e[n]}function Pi(n,e,t){e[ym]&&(e[ul]=!0,e[za]=!0),e[_m]&&(e[ul]=!0,e[vm]=!0),e[ul]&&(e[za]=!0),e[vm]&&(e[za]=!0),e[za]&&(e[wm]=!0),e[wI]&&(e[wm]=!0);for(const r in e){const s=O$(r,t);s.indexOf(n)<0&&s.push(n)}}function D$(n,e){const t={};for(const r in e)e[r].indexOf(n)>=0&&(t[r]=!0);return t}function mn(n=null){this.j={},this.jr=[],this.jd=null,this.t=n}mn.groups={};mn.prototype={accepts(){return!!this.t},go(n){const e=this,t=e.j[n];if(t)return t;for(let r=0;r<e.jr.length;r++){const s=e.jr[r][0],i=e.jr[r][1];if(i&&s.test(n))return i}return e.jd},has(n,e=!1){return e?n in this.j:!!this.go(n)},ta(n,e,t,r){for(let s=0;s<n.length;s++)this.tt(n[s],e,t,r)},tr(n,e,t,r){r=r||mn.groups;let s;return e&&e.j?s=e:(s=new mn(e),t&&r&&Pi(e,t,r)),this.jr.push([n,s]),s},ts(n,e,t,r){let s=this;const i=n.length;if(!i)return s;for(let o=0;o<i-1;o++)s=s.tt(n[o]);return s.tt(n[i-1],e,t,r)},tt(n,e,t,r){r=r||mn.groups;const s=this;if(e&&e.j)return s.j[n]=e,e;const i=e;let o,a=s.go(n);if(a?(o=new mn,Object.assign(o.j,a.j),o.jr.push.apply(o.jr,a.jr),o.jd=a.jd,o.t=a.t):o=new mn,i){if(r)if(o.t&&typeof o.t=="string"){const l=Object.assign(D$(o.t,r),t);Pi(i,l,r)}else t&&Pi(i,t,r);o.t=i}return s.j[n]=o,o}};const Se=(n,e,t,r,s)=>n.ta(e,t,r,s),ct=(n,e,t,r,s)=>n.tr(e,t,r,s),Eb=(n,e,t,r,s)=>n.ts(e,t,r,s),Q=(n,e,t,r,s)=>n.tt(e,t,r,s),Vr="WORD",bm="UWORD",bI="ASCIINUMERICAL",EI="ALPHANUMERICAL",Wl="LOCALHOST",Em="TLD",Tm="UTLD",pu="SCHEME",Ao="SLASH_SCHEME",Ry="NUM",Sm="WS",xy="NL",hl="OPENBRACE",dl="CLOSEBRACE",ah="OPENBRACKET",lh="CLOSEBRACKET",ch="OPENPAREN",uh="CLOSEPAREN",hh="OPENANGLEBRACKET",dh="CLOSEANGLEBRACKET",fh="FULLWIDTHLEFTPAREN",ph="FULLWIDTHRIGHTPAREN",mh="LEFTCORNERBRACKET",gh="RIGHTCORNERBRACKET",yh="LEFTWHITECORNERBRACKET",_h="RIGHTWHITECORNERBRACKET",vh="FULLWIDTHLESSTHAN",wh="FULLWIDTHGREATERTHAN",bh="AMPERSAND",Eh="APOSTROPHE",Th="ASTERISK",Ss="AT",Sh="BACKSLASH",Ch="BACKTICK",Ah="CARET",Ms="COLON",My="COMMA",Ih="DOLLAR",or="DOT",kh="EQUALS",Py="EXCLAMATION",Mn="HYPHEN",fl="PERCENT",Rh="PIPE",xh="PLUS",Mh="POUND",pl="QUERY",Ny="QUOTE",TI="FULLWIDTHMIDDLEDOT",Oy="SEMI",ar="SLASH",ml="TILDE",Ph="UNDERSCORE",SI="EMOJI",Nh="SYM";var CI=Object.freeze({__proto__:null,ALPHANUMERICAL:EI,AMPERSAND:bh,APOSTROPHE:Eh,ASCIINUMERICAL:bI,ASTERISK:Th,AT:Ss,BACKSLASH:Sh,BACKTICK:Ch,CARET:Ah,CLOSEANGLEBRACKET:dh,CLOSEBRACE:dl,CLOSEBRACKET:lh,CLOSEPAREN:uh,COLON:Ms,COMMA:My,DOLLAR:Ih,DOT:or,EMOJI:SI,EQUALS:kh,EXCLAMATION:Py,FULLWIDTHGREATERTHAN:wh,FULLWIDTHLEFTPAREN:fh,FULLWIDTHLESSTHAN:vh,FULLWIDTHMIDDLEDOT:TI,FULLWIDTHRIGHTPAREN:ph,HYPHEN:Mn,LEFTCORNERBRACKET:mh,LEFTWHITECORNERBRACKET:yh,LOCALHOST:Wl,NL:xy,NUM:Ry,OPENANGLEBRACKET:hh,OPENBRACE:hl,OPENBRACKET:ah,OPENPAREN:ch,PERCENT:fl,PIPE:Rh,PLUS:xh,POUND:Mh,QUERY:pl,QUOTE:Ny,RIGHTCORNERBRACKET:gh,RIGHTWHITECORNERBRACKET:_h,SCHEME:pu,SEMI:Oy,SLASH:ar,SLASH_SCHEME:Ao,SYM:Nh,TILDE:ml,TLD:Em,UNDERSCORE:Ph,UTLD:Tm,UWORD:bm,WORD:Vr,WS:Sm});const Dr=/[a-z]/,Ma=new RegExp("\\p{L}","u"),ep=new RegExp("\\p{Emoji}","u"),Lr=/\d/,tp=/\s/,Tb="\r",np=`
`,L$="",V$="",rp="";let zc=null,Hc=null;function F$(n=[]){const e={};mn.groups=e;const t=new mn;zc==null&&(zc=Sb(x$)),Hc==null&&(Hc=Sb(M$)),Q(t,"'",Eh),Q(t,"{",hl),Q(t,"}",dl),Q(t,"[",ah),Q(t,"]",lh),Q(t,"(",ch),Q(t,")",uh),Q(t,"<",hh),Q(t,">",dh),Q(t,"",fh),Q(t,"",ph),Q(t,"",mh),Q(t,"",gh),Q(t,"",yh),Q(t,"",_h),Q(t,"",vh),Q(t,"",wh),Q(t,"&",bh),Q(t,"*",Th),Q(t,"@",Ss),Q(t,"`",Ch),Q(t,"^",Ah),Q(t,":",Ms),Q(t,",",My),Q(t,"$",Ih),Q(t,".",or),Q(t,"=",kh),Q(t,"!",Py),Q(t,"-",Mn),Q(t,"%",fl),Q(t,"|",Rh),Q(t,"+",xh),Q(t,"#",Mh),Q(t,"?",pl),Q(t,'"',Ny),Q(t,"/",ar),Q(t,";",Oy),Q(t,"~",ml),Q(t,"_",Ph),Q(t,"\\",Sh),Q(t,"",TI);const r=ct(t,Lr,Ry,{[ym]:!0});ct(r,Lr,r);const s=ct(r,Dr,bI,{[ul]:!0}),i=ct(r,Ma,EI,{[za]:!0}),o=ct(t,Dr,Vr,{[_m]:!0});ct(o,Lr,s),ct(o,Dr,o),ct(s,Lr,s),ct(s,Dr,s);const a=ct(t,Ma,bm,{[vm]:!0});ct(a,Dr),ct(a,Lr,i),ct(a,Ma,a),ct(i,Lr,i),ct(i,Dr),ct(i,Ma,i);const l=Q(t,np,xy,{[Zf]:!0}),c=Q(t,Tb,Sm,{[Zf]:!0}),u=ct(t,tp,Sm,{[Zf]:!0});Q(t,rp,u),Q(c,np,l),Q(c,rp,u),ct(c,tp,u),Q(u,Tb),Q(u,np),ct(u,tp,u),Q(u,rp,u);const h=ct(t,ep,SI,{[wI]:!0});Q(h,"#"),ct(h,ep,h),Q(h,L$,h);const f=Q(h,V$);Q(f,"#"),ct(f,ep,h);const p=[[Dr,o],[Lr,s]],m=[[Dr,null],[Ma,a],[Lr,i]];for(let y=0;y<zc.length;y++)ys(t,zc[y],Em,Vr,p);for(let y=0;y<Hc.length;y++)ys(t,Hc[y],Tm,bm,m);Pi(Em,{tld:!0,ascii:!0},e),Pi(Tm,{utld:!0,alpha:!0},e),ys(t,"file",pu,Vr,p),ys(t,"mailto",pu,Vr,p),ys(t,"http",Ao,Vr,p),ys(t,"https",Ao,Vr,p),ys(t,"ftp",Ao,Vr,p),ys(t,"ftps",Ao,Vr,p),Pi(pu,{scheme:!0,ascii:!0},e),Pi(Ao,{slashscheme:!0,ascii:!0},e),n=n.sort((y,v)=>y[0]>v[0]?1:-1);for(let y=0;y<n.length;y++){const v=n[y][0],M=n[y][1]?{[P$]:!0}:{[N$]:!0};v.indexOf("-")>=0?M[wm]=!0:Dr.test(v)?Lr.test(v)?M[ul]=!0:M[_m]=!0:M[ym]=!0,Eb(t,v,v,M)}return Eb(t,"localhost",Wl,{ascii:!0}),t.jd=new mn(Nh),{start:t,tokens:Object.assign({groups:e},CI)}}function AI(n,e){const t=B$(e.replace(/[A-Z]/g,a=>a.toLowerCase())),r=t.length,s=[];let i=0,o=0;for(;o<r;){let a=n,l=null,c=0,u=null,h=-1,f=-1;for(;o<r&&(l=a.go(t[o]));)a=l,a.accepts()?(h=0,f=0,u=a):h>=0&&(h+=t[o].length,f++),c+=t[o].length,i+=t[o].length,o++;i-=h,o-=f,c-=h,s.push({t:u.t,v:e.slice(i-c,i),s:i-c,e:i})}return s}function B$(n){const e=[],t=n.length;let r=0;for(;r<t;){let s=n.charCodeAt(r),i,o=s<55296||s>56319||r+1===t||(i=n.charCodeAt(r+1))<56320||i>57343?n[r]:n.slice(r,r+2);e.push(o),r+=o.length}return e}function ys(n,e,t,r,s){let i;const o=e.length;for(let a=0;a<o-1;a++){const l=e[a];n.j[l]?i=n.j[l]:(i=new mn(r),i.jr=s.slice(),n.j[l]=i),n=i}return i=new mn(t),i.jr=s.slice(),n.j[e[o-1]]=i,i}function Sb(n){const e=[],t=[];let r=0,s="0123456789";for(;r<n.length;){let i=0;for(;s.indexOf(n[r+i])>=0;)i++;if(i>0){e.push(t.join(""));for(let o=parseInt(n.substring(r,r+i),10);o>0;o--)t.pop();r+=i}else t.push(n[r]),r++}return e}const ql={defaultProtocol:"http",events:null,format:Cb,formatHref:Cb,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function Dy(n,e=null){let t=Object.assign({},ql);n&&(t=Object.assign(t,n instanceof Dy?n.o:n));const r=t.ignoreTags,s=[];for(let i=0;i<r.length;i++)s.push(r[i].toUpperCase());this.o=t,e&&(this.defaultRender=e),this.ignoreTags=s}Dy.prototype={o:ql,ignoreTags:[],defaultRender(n){return n},check(n){return this.get("validate",n.toString(),n)},get(n,e,t){const r=e!=null;let s=this.o[n];return s&&(typeof s=="object"?(s=t.t in s?s[t.t]:ql[n],typeof s=="function"&&r&&(s=s(e,t))):typeof s=="function"&&r&&(s=s(e,t.t,t)),s)},getObj(n,e,t){let r=this.o[n];return typeof r=="function"&&e!=null&&(r=r(e,t.t,t)),r},render(n){const e=n.render(this);return(this.get("render",null,n)||this.defaultRender)(e,n.t,n)}};function Cb(n){return n}function II(n,e){this.t="token",this.v=n,this.tk=e}II.prototype={isLink:!1,toString(){return this.v},toHref(n){return this.toString()},toFormattedString(n){const e=this.toString(),t=n.get("truncate",e,this),r=n.get("format",e,this);return t&&r.length>t?r.substring(0,t)+"":r},toFormattedHref(n){return n.get("formatHref",this.toHref(n.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(n=ql.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(n),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(n){return{type:this.t,value:this.toFormattedString(n),isLink:this.isLink,href:this.toFormattedHref(n),start:this.startIndex(),end:this.endIndex()}},validate(n){return n.get("validate",this.toString(),this)},render(n){const e=this,t=this.toHref(n.get("defaultProtocol")),r=n.get("formatHref",t,this),s=n.get("tagName",t,e),i=this.toFormattedString(n),o={},a=n.get("className",t,e),l=n.get("target",t,e),c=n.get("rel",t,e),u=n.getObj("attributes",t,e),h=n.getObj("events",t,e);return o.href=r,a&&(o.class=a),l&&(o.target=l),c&&(o.rel=c),u&&Object.assign(o,u),{tagName:s,attributes:o,content:i,eventListeners:h}}};function zd(n,e){class t extends II{constructor(s,i){super(s,i),this.t=n}}for(const r in e)t.prototype[r]=e[r];return t.t=n,t}const Ab=zd("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),Ib=zd("text"),$$=zd("nl"),jc=zd("url",{isLink:!0,toHref(n=ql.defaultProtocol){return this.hasProtocol()?this.v:`${n}://${this.v}`},hasProtocol(){const n=this.tk;return n.length>=2&&n[0].t!==Wl&&n[1].t===Ms}}),xn=n=>new mn(n);function U$({groups:n}){const e=n.domain.concat([bh,Th,Ss,Sh,Ch,Ah,Ih,kh,Mn,Ry,fl,Rh,xh,Mh,ar,Nh,ml,Ph]),t=[Eh,Ms,My,or,Py,fl,pl,Ny,Oy,hh,dh,hl,dl,lh,ah,ch,uh,fh,ph,mh,gh,yh,_h,vh,wh],r=[bh,Eh,Th,Sh,Ch,Ah,Ih,kh,Mn,hl,dl,fl,Rh,xh,Mh,pl,ar,Nh,ml,Ph],s=xn(),i=Q(s,ml);Se(i,r,i),Se(i,n.domain,i);const o=xn(),a=xn(),l=xn();Se(s,n.domain,o),Se(s,n.scheme,a),Se(s,n.slashscheme,l),Se(o,r,i),Se(o,n.domain,o);const c=Q(o,Ss);Q(i,Ss,c),Q(a,Ss,c),Q(l,Ss,c);const u=Q(i,or);Se(u,r,i),Se(u,n.domain,i);const h=xn();Se(c,n.domain,h),Se(h,n.domain,h);const f=Q(h,or);Se(f,n.domain,h);const p=xn(Ab);Se(f,n.tld,p),Se(f,n.utld,p),Q(c,Wl,p);const m=Q(h,Mn);Q(m,Mn,m),Se(m,n.domain,h),Se(p,n.domain,h),Q(p,or,f),Q(p,Mn,m);const y=Q(p,Ms);Se(y,n.numeric,Ab);const v=Q(o,Mn),T=Q(o,or);Q(v,Mn,v),Se(v,n.domain,o),Se(T,r,i),Se(T,n.domain,o);const M=xn(jc);Se(T,n.tld,M),Se(T,n.utld,M),Se(M,n.domain,o),Se(M,r,i),Q(M,or,T),Q(M,Mn,v),Q(M,Ss,c);const P=Q(M,Ms),D=xn(jc);Se(P,n.numeric,D);const L=xn(jc),q=xn();Se(L,e,L),Se(L,t,q),Se(q,e,L),Se(q,t,q),Q(M,ar,L),Q(D,ar,L);const S=Q(a,Ms),w=Q(l,Ms),b=Q(w,ar),I=Q(b,ar);Se(a,n.domain,o),Q(a,or,T),Q(a,Mn,v),Se(l,n.domain,o),Q(l,or,T),Q(l,Mn,v),Se(S,n.domain,L),Q(S,ar,L),Q(S,pl,L),Se(I,n.domain,L),Se(I,e,L),Q(I,ar,L);const R=[[hl,dl],[ah,lh],[ch,uh],[hh,dh],[fh,ph],[mh,gh],[yh,_h],[vh,wh]];for(let k=0;k<R.length;k++){const[C,_e]=R[k],Ae=Q(L,C);Q(q,C,Ae),Q(Ae,_e,L);const Re=xn(jc);Se(Ae,e,Re);const fe=xn();Se(Ae,t),Se(Re,e,Re),Se(Re,t,fe),Se(fe,e,Re),Se(fe,t,fe),Q(Re,_e,L),Q(fe,_e,L)}return Q(s,Wl,M),Q(s,xy,$$),{start:s,tokens:CI}}function z$(n,e,t){let r=t.length,s=0,i=[],o=[];for(;s<r;){let a=n,l=null,c=null,u=0,h=null,f=-1;for(;s<r&&!(l=a.go(t[s].t));)o.push(t[s++]);for(;s<r&&(c=l||a.go(t[s].t));)l=null,a=c,a.accepts()?(f=0,h=a):f>=0&&f++,s++,u++;if(f<0)s-=u,s<r&&(o.push(t[s]),s++);else{o.length>0&&(i.push(sp(Ib,e,o)),o=[]),s-=f,u-=f;const p=h.t,m=t.slice(s-u,s);i.push(sp(p,e,m))}}return o.length>0&&i.push(sp(Ib,e,o)),i}function sp(n,e,t){const r=t[0].s,s=t[t.length-1].e,i=e.slice(r,s);return new n(i,t)}const H$=typeof console<"u"&&console&&console.warn||(()=>{}),j$="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",tt={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function W$(){return mn.groups={},tt.scanner=null,tt.parser=null,tt.tokenQueue=[],tt.pluginQueue=[],tt.customSchemes=[],tt.initialized=!1,tt}function kb(n,e=!1){if(tt.initialized&&H$(`linkifyjs: already initialized - will not register custom scheme "${n}" ${j$}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(n))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);tt.customSchemes.push([n,e])}function q$(){tt.scanner=F$(tt.customSchemes);for(let n=0;n<tt.tokenQueue.length;n++)tt.tokenQueue[n][1]({scanner:tt.scanner});tt.parser=U$(tt.scanner.tokens);for(let n=0;n<tt.pluginQueue.length;n++)tt.pluginQueue[n][1]({scanner:tt.scanner,parser:tt.parser});return tt.initialized=!0,tt}function Ly(n){return tt.initialized||q$(),z$(tt.parser.start,n,AI(tt.scanner.start,n))}Ly.scan=AI;function kI(n,e=null,t=null){if(e&&typeof e=="object"){if(t)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);t=e,e=null}const r=new Dy(t),s=Ly(n),i=[];for(let o=0;o<s.length;o++){const a=s[o];a.isLink&&(!e||a.t===e)&&r.check(a)&&i.push(a.toFormattedObject(r))}return i}var Vy="[\0- -\u2029]",K$=new RegExp(Vy),G$=new RegExp(`${Vy}$`),J$=new RegExp(Vy,"g");function Q$(n){return n.length===1?n[0].isLink:n.length===3&&n[1].isLink?["()","[]"].includes(n[0].value+n[2].value):!1}function Y$(n){return new st({key:new dt("autolink"),appendTransaction:(e,t,r)=>{const s=e.some(c=>c.docChanged)&&!t.doc.eq(r.doc),i=e.some(c=>c.getMeta("preventAutolink"));if(!s||i)return;const{tr:o}=r,a=KA(t.doc,[...e]);if(tI(a).forEach(({newRange:c})=>{const u=XB(r.doc,c,p=>p.isTextblock);let h,f;if(u.length>1)h=u[0],f=r.doc.textBetween(h.pos,h.pos+h.node.nodeSize,void 0," ");else if(u.length){const p=r.doc.textBetween(c.from,c.to," "," ");if(!G$.test(p))return;h=u[0],f=r.doc.textBetween(h.pos,c.to,void 0," ")}if(h&&f){const p=f.split(K$).filter(Boolean);if(p.length<=0)return!1;const m=p[p.length-1],y=h.pos+f.lastIndexOf(m);if(!m)return!1;const v=Ly(m).map(T=>T.toObject(n.defaultProtocol));if(!Q$(v))return!1;v.filter(T=>T.isLink).map(T=>({...T,from:y+T.start+1,to:y+T.end+1})).filter(T=>r.schema.marks.code?!r.doc.rangeHasMark(T.from,T.to,r.schema.marks.code):!0).filter(T=>n.validate(T.value)).filter(T=>n.shouldAutoLink(T.value)).forEach(T=>{Sy(T.from,T.to,r.doc).some(M=>M.mark.type===n.type)||o.addMark(T.from,T.to,n.type.create({href:T.href}))})}}),!!o.steps.length)return o}})}function X$(n){return new st({key:new dt("handleClickLink"),props:{handleClick:(e,t,r)=>{var s,i;if(r.button!==0||!e.editable)return!1;let o=!1;if(n.enableClickSelection&&(o=n.editor.commands.extendMarkRange(n.type.name)),n.openOnClick){let a=null;if(r.target instanceof HTMLAnchorElement)a=r.target;else{let h=r.target;const f=[];for(;h.nodeName!=="DIV";)f.push(h),h=h.parentNode;a=f.find(p=>p.nodeName==="A")}if(!a)return o;const l=eI(e.state,n.type.name),c=(s=a?.href)!=null?s:l.href,u=(i=a?.target)!=null?i:l.target;a&&c&&(window.open(c,u),o=!0)}return o}}})}function Z$(n){return new st({key:new dt("handlePasteLink"),props:{handlePaste:(e,t,r)=>{const{shouldAutoLink:s}=n,{state:i}=e,{selection:o}=i,{empty:a}=o;if(a)return!1;let l="";r.content.forEach(u=>{l+=u.textContent});const c=kI(l,{defaultProtocol:n.defaultProtocol}).find(u=>u.isLink&&u.value===l);return!l||!c||s!==void 0&&!s(c.href)?!1:n.editor.commands.setMark(n.type,{href:c.href})}}})}function Ti(n,e){const t=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(r=>{const s=typeof r=="string"?r:r.scheme;s&&t.push(s)}),!n||n.replace(J$,"").match(new RegExp(`^(?:(?:${t.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var eU=is.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(n=>{if(typeof n=="string"){kb(n);return}kb(n.scheme,n.optionalSlashes)})},onDestroy(){W$()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(n,e)=>!!Ti(n,e.protocols),validate:n=>!!n,shouldAutoLink:n=>!!n}},addAttributes(){return{href:{default:null,parseHTML(n){return n.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:n=>{const e=n.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:t=>!!Ti(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:n}){return this.options.isAllowedUri(n.href,{defaultValidate:e=>!!Ti(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",Ze(this.options.HTMLAttributes,n),0]:["a",Ze(this.options.HTMLAttributes,{...n,href:""}),0]},markdownTokenName:"link",parseMarkdown:(n,e)=>e.applyMark("link",e.parseInline(n.tokens||[]),{href:n.href,title:n.title||null}),renderMarkdown:(n,e)=>{var t;const r=((t=n.attrs)==null?void 0:t.href)||"";return`[${e.renderChildren(n)}](${r})`},addCommands(){return{setLink:n=>({chain:e})=>{const{href:t}=n;return this.options.isAllowedUri(t,{defaultValidate:r=>!!Ti(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,n).setMeta("preventAutolink",!0).run():!1},toggleLink:n=>({chain:e})=>{const{href:t}=n||{};return t&&!this.options.isAllowedUri(t,{defaultValidate:r=>!!Ti(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:e().toggleMark(this.name,n,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:n})=>n().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[ai({find:n=>{const e=[];if(n){const{protocols:t,defaultProtocol:r}=this.options,s=kI(n).filter(i=>i.isLink&&this.options.isAllowedUri(i.value,{defaultValidate:o=>!!Ti(o,t),protocols:t,defaultProtocol:r}));s.length&&s.forEach(i=>{this.options.shouldAutoLink(i.value)&&e.push({text:i.value,data:{href:i.href},index:i.start})})}return e},type:this.type,getAttributes:n=>{var e;return{href:(e=n.data)==null?void 0:e.href}}})]},addProseMirrorPlugins(){const n=[],{protocols:e,defaultProtocol:t}=this.options;return this.options.autolink&&n.push(Y$({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:r=>this.options.isAllowedUri(r,{defaultValidate:s=>!!Ti(s,e),protocols:e,defaultProtocol:t}),shouldAutoLink:this.options.shouldAutoLink})),n.push(X$({type:this.type,editor:this.editor,openOnClick:this.options.openOnClick==="whenNotEditable"?!0:this.options.openOnClick,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&n.push(Z$({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),n}}),tU=Object.defineProperty,nU=(n,e)=>{for(var t in e)tU(n,t,{get:e[t],enumerable:!0})},rU="listItem",Rb="textStyle",xb=/^\s*([-+*])\s$/,RI=Ht.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:n}){return["ul",Ze(this.options.HTMLAttributes,n),0]},markdownTokenName:"list",parseMarkdown:(n,e)=>n.type!=="list"||n.ordered?[]:{type:"bulletList",content:n.items?e.parseChildren(n.items):[]},renderMarkdown:(n,e)=>n.content?e.renderChildren(n.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(rU,this.editor.getAttributes(Rb)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let n=ta({find:xb,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(n=ta({find:xb,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Rb),editor:this.editor})),[n]}}),xI=Ht.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",Ze(this.options.HTMLAttributes,n),0]},markdownTokenName:"list_item",parseMarkdown:(n,e)=>{if(n.type!=="list_item")return[];let t=[];if(n.tokens&&n.tokens.length>0)if(n.tokens.some(s=>s.type==="paragraph"))t=e.parseChildren(n.tokens);else{const s=n.tokens[0];if(s&&s.type==="text"&&s.tokens&&s.tokens.length>0){if(t=[{type:"paragraph",content:e.parseInline(s.tokens)}],n.tokens.length>1){const o=n.tokens.slice(1),a=e.parseChildren(o);t.push(...a)}}else t=e.parseChildren(n.tokens)}return t.length===0&&(t=[{type:"paragraph",content:[]}]),{type:"listItem",content:t}},renderMarkdown:(n,e,t)=>ky(n,e,r=>r.parentType==="bulletList"?"- ":r.parentType==="orderedList"?`${r.index+1}. `:"- ",t),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),sU={};nU(sU,{findListItemPos:()=>fc,getNextListDepth:()=>Fy,handleBackspace:()=>Cm,handleDelete:()=>Am,hasListBefore:()=>MI,hasListItemAfter:()=>iU,hasListItemBefore:()=>PI,listItemHasSubList:()=>NI,nextListIsDeeper:()=>OI,nextListIsHigher:()=>DI});var fc=(n,e)=>{const{$from:t}=e.selection,r=bt(n,e.schema);let s=null,i=t.depth,o=t.pos,a=null;for(;i>0&&a===null;)s=t.node(i),s.type===r?a=i:(i-=1,o-=1);return a===null?null:{$pos:e.doc.resolve(o),depth:a}},Fy=(n,e)=>{const t=fc(n,e);if(!t)return!1;const[,r]=a9(e,n,t.$pos.pos+4);return r},MI=(n,e,t)=>{const{$anchor:r}=n.selection,s=Math.max(0,r.pos-2),i=n.doc.resolve(s).node();return!(!i||!t.includes(i.type.name))},PI=(n,e)=>{var t;const{$anchor:r}=e.selection,s=e.doc.resolve(r.pos-2);return!(s.index()===0||((t=s.nodeBefore)==null?void 0:t.type.name)!==n)},NI=(n,e,t)=>{if(!t)return!1;const r=bt(n,e.schema);let s=!1;return t.descendants(i=>{i.type===r&&(s=!0)}),s},Cm=(n,e,t)=>{if(n.commands.undoInputRule())return!0;if(n.state.selection.from!==n.state.selection.to)return!1;if(!oi(n.state,e)&&MI(n.state,e,t)){const{$anchor:a}=n.state.selection,l=n.state.doc.resolve(a.before()-1),c=[];l.node().descendants((f,p)=>{f.type.name===e&&c.push({node:f,pos:p})});const u=c.at(-1);if(!u)return!1;const h=n.state.doc.resolve(l.start()+u.pos+1);return n.chain().cut({from:a.start()-1,to:a.end()+1},h.end()).joinForward().run()}if(!oi(n.state,e)||!h9(n.state))return!1;const r=fc(e,n.state);if(!r)return!1;const i=n.state.doc.resolve(r.$pos.pos-2).node(r.depth),o=NI(e,n.state,i);return PI(e,n.state)&&!o?n.commands.joinItemBackward():n.chain().liftListItem(e).run()},OI=(n,e)=>{const t=Fy(n,e),r=fc(n,e);return!r||!t?!1:t>r.depth},DI=(n,e)=>{const t=Fy(n,e),r=fc(n,e);return!r||!t?!1:t<r.depth},Am=(n,e)=>{if(!oi(n.state,e)||!u9(n.state,e))return!1;const{selection:t}=n.state,{$from:r,$to:s}=t;return!t.empty&&r.sameParent(s)?!1:OI(e,n.state)?n.chain().focus(n.state.selection.from+4).lift(e).joinBackward().run():DI(e,n.state)?n.chain().joinForward().joinBackward().run():n.commands.joinItemForward()},iU=(n,e)=>{var t;const{$anchor:r}=e.selection,s=e.doc.resolve(r.pos-r.parentOffset-2);return!(s.index()===s.parent.childCount-1||((t=s.nodeAfter)==null?void 0:t.type.name)!==n)},LI=je.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:n})=>{let e=!1;return this.options.listTypes.forEach(({itemName:t})=>{n.state.schema.nodes[t]!==void 0&&Am(n,t)&&(e=!0)}),e},"Mod-Delete":({editor:n})=>{let e=!1;return this.options.listTypes.forEach(({itemName:t})=>{n.state.schema.nodes[t]!==void 0&&Am(n,t)&&(e=!0)}),e},Backspace:({editor:n})=>{let e=!1;return this.options.listTypes.forEach(({itemName:t,wrapperNames:r})=>{n.state.schema.nodes[t]!==void 0&&Cm(n,t,r)&&(e=!0)}),e},"Mod-Backspace":({editor:n})=>{let e=!1;return this.options.listTypes.forEach(({itemName:t,wrapperNames:r})=>{n.state.schema.nodes[t]!==void 0&&Cm(n,t,r)&&(e=!0)}),e}}}}),Mb=/^(\s*)(\d+)\.\s+(.*)$/,oU=/^\s/;function aU(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t],i=s.match(Mb);if(!i)break;const[,o,a,l]=i,c=o.length;let u=l,h=t+1;const f=[s];for(;h<n.length;){const p=n[h];if(p.match(Mb))break;if(p.trim()==="")f.push(p),u+=`
`,h+=1;else if(p.match(oU))f.push(p),u+=`
${p.slice(c+2)}`,h+=1;else break}e.push({indent:c,number:parseInt(a,10),content:u.trim(),raw:f.join(`
`)}),r=h,t=h}return[e,r]}function VI(n,e,t){var r;const s=[];let i=0;for(;i<n.length;){const o=n[i];if(o.indent===e){const a=o.content.split(`
`),l=((r=a[0])==null?void 0:r.trim())||"",c=[];l&&c.push({type:"paragraph",raw:l,tokens:t.inlineTokens(l)});const u=a.slice(1).join(`
`).trim();if(u){const p=t.blockTokens(u);c.push(...p)}let h=i+1;const f=[];for(;h<n.length&&n[h].indent>e;)f.push(n[h]),h+=1;if(f.length>0){const p=Math.min(...f.map(y=>y.indent)),m=VI(f,p,t);c.push({type:"list",ordered:!0,start:f[0].number,items:m,raw:f.map(y=>y.raw).join(`
`)})}s.push({type:"list_item",raw:o.raw,tokens:c}),i=h}else i+=1}return s}function lU(n,e){return n.map(t=>{if(t.type!=="list_item")return e.parseChildren([t])[0];const r=[];return t.tokens&&t.tokens.length>0&&t.tokens.forEach(s=>{if(s.type==="paragraph"||s.type==="list"||s.type==="blockquote"||s.type==="code")r.push(...e.parseChildren([s]));else if(s.type==="text"&&s.tokens){const i=e.parseChildren([s]);r.push({type:"paragraph",content:i})}else{const i=e.parseChildren([s]);i.length>0&&r.push(...i)}}),{type:"listItem",content:r}})}var cU="listItem",Pb="textStyle",Nb=/^(\d+)\.\s$/,FI=Ht.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:n=>n.hasAttribute("start")?parseInt(n.getAttribute("start")||"",10):1},type:{default:null,parseHTML:n=>n.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:n}){const{start:e,...t}=n;return e===1?["ol",Ze(this.options.HTMLAttributes,t),0]:["ol",Ze(this.options.HTMLAttributes,n),0]},markdownTokenName:"list",parseMarkdown:(n,e)=>{if(n.type!=="list"||!n.ordered)return[];const t=n.start||1,r=n.items?lU(n.items,e):[];return t!==1?{type:"orderedList",attrs:{start:t},content:r}:{type:"orderedList",content:r}},renderMarkdown:(n,e)=>n.content?e.renderChildren(n.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:n=>{const e=n.match(/^(\s*)(\d+)\.\s+/),t=e?.index;return t!==void 0?t:-1},tokenize:(n,e,t)=>{var r;const s=n.split(`
`),[i,o]=aU(s);if(i.length===0)return;const a=VI(i,0,t);return a.length===0?void 0:{type:"list",ordered:!0,start:((r=i[0])==null?void 0:r.number)||1,items:a,raw:s.slice(0,o).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(cU,this.editor.getAttributes(Pb)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let n=ta({find:Nb,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(n=ta({find:Nb,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(Pb)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[n]}}),uU=/^\s*(\[([( |x])?\])\s$/,hU=Ht.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:n=>{const e=n.getAttribute("data-checked");return e===""||e==="true"},renderHTML:n=>({"data-checked":n.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:n,HTMLAttributes:e}){return["li",Ze(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:n.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(n,e)=>{const t=[];if(n.tokens&&n.tokens.length>0?t.push(e.createNode("paragraph",{},e.parseInline(n.tokens))):n.text?t.push(e.createNode("paragraph",{},[e.createNode("text",{text:n.text})])):t.push(e.createNode("paragraph",{},[])),n.nestedTokens&&n.nestedTokens.length>0){const r=e.parseChildren(n.nestedTokens);t.push(...r)}return e.createNode("taskItem",{checked:n.checked||!1},t)},renderMarkdown:(n,e)=>{var t;const s=`- [${(t=n.attrs)!=null&&t.checked?"x":" "}] `;return ky(n,e,s)},addKeyboardShortcuts(){const n={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...n,Tab:()=>this.editor.commands.sinkListItem(this.name)}:n},addNodeView(){return({node:n,HTMLAttributes:e,getPos:t,editor:r})=>{const s=document.createElement("li"),i=document.createElement("label"),o=document.createElement("span"),a=document.createElement("input"),l=document.createElement("div"),c=u=>{var h,f;a.ariaLabel=((f=(h=this.options.a11y)==null?void 0:h.checkboxLabel)==null?void 0:f.call(h,u,a.checked))||`Task item checkbox for ${u.textContent||"empty task item"}`};return c(n),i.contentEditable="false",a.type="checkbox",a.addEventListener("mousedown",u=>u.preventDefault()),a.addEventListener("change",u=>{if(!r.isEditable&&!this.options.onReadOnlyChecked){a.checked=!a.checked;return}const{checked:h}=u.target;r.isEditable&&typeof t=="function"&&r.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:f})=>{const p=t();if(typeof p!="number")return!1;const m=f.doc.nodeAt(p);return f.setNodeMarkup(p,void 0,{...m?.attrs,checked:h}),!0}).run(),!r.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(n,h)||(a.checked=!a.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([u,h])=>{s.setAttribute(u,h)}),s.dataset.checked=n.attrs.checked,a.checked=n.attrs.checked,i.append(a,o),s.append(i,l),Object.entries(e).forEach(([u,h])=>{s.setAttribute(u,h)}),{dom:s,contentDOM:l,update:u=>u.type!==this.type?!1:(s.dataset.checked=u.attrs.checked,a.checked=u.attrs.checked,c(u),!0)}}},addInputRules(){return[ta({find:uU,type:this.type,getAttributes:n=>({checked:n[n.length-1]==="x"})})]}}),dU=Ht.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:n}){return["ul",Ze(this.options.HTMLAttributes,n,{"data-type":this.name}),0]},parseMarkdown:(n,e)=>e.createNode("taskList",{},e.parseChildren(n.items||[])),renderMarkdown:(n,e)=>n.content?e.renderChildren(n.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(n){var e;const t=(e=n.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:e.index;return t!==void 0?t:-1},tokenize(n,e,t){const r=i=>{const o=gm(i,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:a=>({indentLevel:a[1].length,mainContent:a[4],checked:a[3].toLowerCase()==="x"}),createToken:(a,l)=>({type:"taskItem",raw:"",mainContent:a.mainContent,indentLevel:a.indentLevel,checked:a.checked,text:a.mainContent,tokens:t.inlineTokens(a.mainContent),nestedTokens:l}),customNestedParser:r},t);return o?[{type:"taskList",raw:o.raw,items:o.items}]:t.blockTokens(i)},s=gm(n,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:i=>({indentLevel:i[1].length,mainContent:i[4],checked:i[3].toLowerCase()==="x"}),createToken:(i,o)=>({type:"taskItem",raw:"",mainContent:i.mainContent,indentLevel:i.indentLevel,checked:i.checked,text:i.mainContent,tokens:t.inlineTokens(i.mainContent),nestedTokens:o}),customNestedParser:r},t);if(s)return{type:"taskList",raw:s.raw,items:s.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:n})=>n.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});je.create({name:"listKit",addExtensions(){const n=[];return this.options.bulletList!==!1&&n.push(RI.configure(this.options.bulletList)),this.options.listItem!==!1&&n.push(xI.configure(this.options.listItem)),this.options.listKeymap!==!1&&n.push(LI.configure(this.options.listKeymap)),this.options.orderedList!==!1&&n.push(FI.configure(this.options.orderedList)),this.options.taskItem!==!1&&n.push(hU.configure(this.options.taskItem)),this.options.taskList!==!1&&n.push(dU.configure(this.options.taskList)),n}});var fU=Ht.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:n}){return["p",Ze(this.options.HTMLAttributes,n),0]},parseMarkdown:(n,e)=>{const t=n.tokens||[];return t.length===1&&t[0].type==="image"?e.parseChildren([t[0]]):e.createNode("paragraph",void 0,e.parseInline(t))},renderMarkdown:(n,e)=>!n||!Array.isArray(n.content)?"":e.renderChildren(n.content),addCommands(){return{setParagraph:()=>({commands:n})=>n.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),pU=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,mU=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,gU=is.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["s",Ze(this.options.HTMLAttributes,n),0]},markdownTokenName:"del",parseMarkdown:(n,e)=>e.applyMark("strike",e.parseInline(n.tokens||[])),renderMarkdown:(n,e)=>`~~${e.renderChildren(n)}~~`,addCommands(){return{setStrike:()=>({commands:n})=>n.setMark(this.name),toggleStrike:()=>({commands:n})=>n.toggleMark(this.name),unsetStrike:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Yi({find:pU,type:this.type})]},addPasteRules(){return[ai({find:mU,type:this.type})]}}),yU=Ht.create({name:"text",group:"inline",parseMarkdown:n=>({type:"text",text:n.text||""}),renderMarkdown:n=>n.text||""}),BI=is.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["u",Ze(this.options.HTMLAttributes,n),0]},parseMarkdown(n,e){return e.applyMark(this.name||"underline",e.parseInline(n.tokens||[]))},renderMarkdown(n,e){return`++${e.renderChildren(n)}++`},markdownTokenizer:{name:"underline",level:"inline",start(n){return n.indexOf("++")},tokenize(n,e,t){const s=/^(\+\+)([\s\S]+?)(\+\+)/.exec(n);if(!s)return;const i=s[2].trim();return{type:"underline",raw:s[0],text:i,tokens:t.inlineTokens(i)}}},addCommands(){return{setUnderline:()=>({commands:n})=>n.setMark(this.name),toggleUnderline:()=>({commands:n})=>n.toggleMark(this.name),unsetUnderline:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});function _U(n={}){return new st({view(e){return new vU(e,n)}})}class vU{constructor(e,t){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=t.width)!==null&&r!==void 0?r:1,this.color=t.color===!1?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(s=>{let i=o=>{this[s](o)};return e.dom.addEventListener(s,i),{name:s,handler:i}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){this.cursorPos!=null&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),t=!e.parent.inlineContent,r,s=this.editorView.dom,i=s.getBoundingClientRect(),o=i.width/s.offsetWidth,a=i.height/s.offsetHeight;if(t){let h=e.nodeBefore,f=e.nodeAfter;if(h||f){let p=this.editorView.nodeDOM(this.cursorPos-(h?h.nodeSize:0));if(p){let m=p.getBoundingClientRect(),y=h?m.bottom:m.top;h&&f&&(y=(y+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let v=this.width/2*a;r={left:m.left,right:m.right,top:y-v,bottom:y+v}}}}if(!r){let h=this.editorView.coordsAtPos(this.cursorPos),f=this.width/2*o;r={left:h.left-f,right:h.left+f,top:h.top,bottom:h.bottom}}let l=this.editorView.dom.offsetParent;this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",t),this.element.classList.toggle("prosemirror-dropcursor-inline",!t);let c,u;if(!l||l==document.body&&getComputedStyle(l).position=="static")c=-pageXOffset,u=-pageYOffset;else{let h=l.getBoundingClientRect(),f=h.width/l.offsetWidth,p=h.height/l.offsetHeight;c=h.left-l.scrollLeft*f,u=h.top-l.scrollTop*p}this.element.style.left=(r.left-c)/o+"px",this.element.style.top=(r.top-u)/a+"px",this.element.style.width=(r.right-r.left)/o+"px",this.element.style.height=(r.bottom-r.top)/a+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),s=r&&r.type.spec.disableDropCursor,i=typeof s=="function"?s(this.editorView,t,e):s;if(t&&!i){let o=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=BC(this.editorView.state.doc,o,this.editorView.dragging.slice);a!=null&&(o=a)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}class ut extends me{constructor(e){super(e,e)}map(e,t){let r=e.resolve(t.map(this.head));return ut.valid(r)?new ut(r):me.near(r)}content(){return X.empty}eq(e){return e instanceof ut&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new ut(e.resolve(t.pos))}getBookmark(){return new By(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!wU(e)||!bU(e))return!1;let r=t.type.spec.allowGapCursor;if(r!=null)return r;let s=t.contentMatchAt(e.index()).defaultType;return s&&s.isTextblock}static findGapCursorFrom(e,t,r=!1){e:for(;;){if(!r&&ut.valid(e))return e;let s=e.pos,i=null;for(let o=e.depth;;o--){let a=e.node(o);if(t>0?e.indexAfter(o)<a.childCount:e.index(o)>0){i=a.child(t>0?e.indexAfter(o):e.index(o)-1);break}else if(o==0)return null;s+=t;let l=e.doc.resolve(s);if(ut.valid(l))return l}for(;;){let o=t>0?i.firstChild:i.lastChild;if(!o){if(i.isAtom&&!i.isText&&!le.isSelectable(i)){e=e.doc.resolve(s+i.nodeSize*t),r=!1;continue e}break}i=o,s+=t;let a=e.doc.resolve(s);if(ut.valid(a))return a}return null}}}ut.prototype.visible=!1;ut.findFrom=ut.findGapCursorFrom;me.jsonID("gapcursor",ut);class By{constructor(e){this.pos=e}map(e){return new By(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return ut.valid(t)?new ut(t):me.near(t)}}function $I(n){return n.isAtom||n.spec.isolating||n.spec.createGapCursor}function wU(n){for(let e=n.depth;e>=0;e--){let t=n.index(e),r=n.node(e);if(t==0){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(t-1);;s=s.lastChild){if(s.childCount==0&&!s.inlineContent||$I(s.type))return!0;if(s.inlineContent)return!1}}return!0}function bU(n){for(let e=n.depth;e>=0;e--){let t=n.indexAfter(e),r=n.node(e);if(t==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(t);;s=s.firstChild){if(s.childCount==0&&!s.inlineContent||$I(s.type))return!0;if(s.inlineContent)return!1}}return!0}function EU(){return new st({props:{decorations:AU,createSelectionBetween(n,e,t){return e.pos==t.pos&&ut.valid(t)?new ut(t):null},handleClick:SU,handleKeyDown:TU,handleDOMEvents:{beforeinput:CU}}})}const TU=gy({ArrowLeft:Wc("horiz",-1),ArrowRight:Wc("horiz",1),ArrowUp:Wc("vert",-1),ArrowDown:Wc("vert",1)});function Wc(n,e){const t=n=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,s,i){let o=r.selection,a=e>0?o.$to:o.$from,l=o.empty;if(o instanceof ue){if(!i.endOfTextblock(t)||a.depth==0)return!1;l=!1,a=r.doc.resolve(e>0?a.after():a.before())}let c=ut.findGapCursorFrom(a,e,l);return c?(s&&s(r.tr.setSelection(new ut(c))),!0):!1}}function SU(n,e,t){if(!n||!n.editable)return!1;let r=n.state.doc.resolve(e);if(!ut.valid(r))return!1;let s=n.posAtCoords({left:t.clientX,top:t.clientY});return s&&s.inside>-1&&le.isSelectable(n.state.doc.nodeAt(s.inside))?!1:(n.dispatch(n.state.tr.setSelection(new ut(r))),!0)}function CU(n,e){if(e.inputType!="insertCompositionText"||!(n.state.selection instanceof ut))return!1;let{$from:t}=n.state.selection,r=t.parent.contentMatchAt(t.index()).findWrapping(n.state.schema.nodes.text);if(!r)return!1;let s=H.empty;for(let o=r.length-1;o>=0;o--)s=H.from(r[o].createAndFill(null,s));let i=n.state.tr.replace(t.pos,t.pos,new X(s,0,0));return i.setSelection(ue.near(i.doc.resolve(t.pos+1))),n.dispatch(i),!1}function AU(n){if(!(n.selection instanceof ut))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Qe.create(n.doc,[Rt.widget(n.selection.head,e,{key:"gapcursor"})])}var Oh=200,Mt=function(){};Mt.prototype.append=function(e){return e.length?(e=Mt.from(e),!this.length&&e||e.length<Oh&&this.leafAppend(e)||this.length<Oh&&e.leafPrepend(this)||this.appendInner(e)):this};Mt.prototype.prepend=function(e){return e.length?Mt.from(e).append(this):this};Mt.prototype.appendInner=function(e){return new IU(this,e)};Mt.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?Mt.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};Mt.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};Mt.prototype.forEach=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length),t<=r?this.forEachInner(e,t,r,0):this.forEachInvertedInner(e,t,r,0)};Mt.prototype.map=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length);var s=[];return this.forEach(function(i,o){return s.push(e(i,o))},t,r),s};Mt.from=function(e){return e instanceof Mt?e:e&&e.length?new UI(e):Mt.empty};var UI=(function(n){function e(r){n.call(this),this.values=r}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(s,i){return s==0&&i==this.length?this:new e(this.values.slice(s,i))},e.prototype.getInner=function(s){return this.values[s]},e.prototype.forEachInner=function(s,i,o,a){for(var l=i;l<o;l++)if(s(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(s,i,o,a){for(var l=i-1;l>=o;l--)if(s(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(s){if(this.length+s.length<=Oh)return new e(this.values.concat(s.flatten()))},e.prototype.leafPrepend=function(s){if(this.length+s.length<=Oh)return new e(s.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e})(Mt);Mt.empty=new UI([]);var IU=(function(n){function e(t,r){n.call(this),this.left=t,this.right=r,this.length=t.length+r.length,this.depth=Math.max(t.depth,r.depth)+1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,s,i,o){var a=this.left.length;if(s<a&&this.left.forEachInner(r,s,Math.min(i,a),o)===!1||i>a&&this.right.forEachInner(r,Math.max(s-a,0),Math.min(this.length,i)-a,o+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,s,i,o){var a=this.left.length;if(s>a&&this.right.forEachInvertedInner(r,s-a,Math.max(i,a)-a,o+a)===!1||i<a&&this.left.forEachInvertedInner(r,Math.min(s,a),i,o)===!1)return!1},e.prototype.sliceInner=function(r,s){if(r==0&&s==this.length)return this;var i=this.left.length;return s<=i?this.left.slice(r,s):r>=i?this.right.slice(r-i,s-i):this.left.slice(r,i).append(this.right.slice(0,s-i))},e.prototype.leafAppend=function(r){var s=this.right.leafAppend(r);if(s)return new e(this.left,s)},e.prototype.leafPrepend=function(r){var s=this.left.leafPrepend(r);if(s)return new e(s,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e})(Mt);const kU=500;class jn{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let s,i;t&&(s=this.remapping(r,this.items.length),i=s.maps.length);let o=e.tr,a,l,c=[],u=[];return this.items.forEach((h,f)=>{if(!h.step){s||(s=this.remapping(r,f+1),i=s.maps.length),i--,u.push(h);return}if(s){u.push(new lr(h.map));let p=h.step.map(s.slice(i)),m;p&&o.maybeStep(p).doc&&(m=o.mapping.maps[o.mapping.maps.length-1],c.push(new lr(m,void 0,void 0,c.length+u.length))),i--,m&&s.appendMap(m,i)}else o.maybeStep(h.step);if(h.selection)return a=s?h.selection.map(s.slice(i)):h.selection,l=new jn(this.items.slice(0,r).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:o,selection:a}}addTransform(e,t,r,s){let i=[],o=this.eventCount,a=this.items,l=!s&&a.length?a.get(a.length-1):null;for(let u=0;u<e.steps.length;u++){let h=e.steps[u].invert(e.docs[u]),f=new lr(e.mapping.maps[u],h,t),p;(p=l&&l.merge(f))&&(f=p,u?i.pop():a=a.slice(0,a.length-1)),i.push(f),t&&(o++,t=void 0),s||(l=f)}let c=o-r.depth;return c>xU&&(a=RU(a,c),o-=c),new jn(a.append(i),o)}remapping(e,t){let r=new Bl;return this.items.forEach((s,i)=>{let o=s.mirrorOffset!=null&&i-s.mirrorOffset>=e?r.maps.length-s.mirrorOffset:void 0;r.appendMap(s.map,o)},e,t),r}addMaps(e){return this.eventCount==0?this:new jn(this.items.append(e.map(t=>new lr(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let r=[],s=Math.max(0,this.items.length-t),i=e.mapping,o=e.steps.length,a=this.eventCount;this.items.forEach(f=>{f.selection&&a--},s);let l=t;this.items.forEach(f=>{let p=i.getMirror(--l);if(p==null)return;o=Math.min(o,p);let m=i.maps[p];if(f.step){let y=e.steps[p].invert(e.docs[p]),v=f.selection&&f.selection.map(i.slice(l+1,p));v&&a++,r.push(new lr(m,y,v))}else r.push(new lr(m))},s);let c=[];for(let f=t;f<o;f++)c.push(new lr(i.maps[f]));let u=this.items.slice(0,s).append(c).append(r),h=new jn(u,a);return h.emptyItemCount()>kU&&(h=h.compress(this.items.length-r.length)),h}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),r=t.maps.length,s=[],i=0;return this.items.forEach((o,a)=>{if(a>=e)s.push(o),o.selection&&i++;else if(o.step){let l=o.step.map(t.slice(r)),c=l&&l.getMap();if(r--,c&&t.appendMap(c,r),l){let u=o.selection&&o.selection.map(t.slice(r));u&&i++;let h=new lr(c.invert(),l,u),f,p=s.length-1;(f=s.length&&s[p].merge(h))?s[p]=f:s.push(h)}}else o.map&&r--},this.items.length,0),new jn(Mt.from(s.reverse()),i)}}jn.empty=new jn(Mt.empty,0);function RU(n,e){let t;return n.forEach((r,s)=>{if(r.selection&&e--==0)return t=s,!1}),n.slice(t)}class lr{constructor(e,t,r,s){this.map=e,this.step=t,this.selection=r,this.mirrorOffset=s}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new lr(t.getMap().invert(),t,this.selection)}}}class Cs{constructor(e,t,r,s,i){this.done=e,this.undone=t,this.prevRanges=r,this.prevTime=s,this.prevComposition=i}}const xU=20;function MU(n,e,t,r){let s=t.getMeta(Ui),i;if(s)return s.historyState;t.getMeta(OU)&&(n=new Cs(n.done,n.undone,null,0,-1));let o=t.getMeta("appendedTransaction");if(t.steps.length==0)return n;if(o&&o.getMeta(Ui))return o.getMeta(Ui).redo?new Cs(n.done.addTransform(t,void 0,r,mu(e)),n.undone,Ob(t.mapping.maps),n.prevTime,n.prevComposition):new Cs(n.done,n.undone.addTransform(t,void 0,r,mu(e)),null,n.prevTime,n.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let a=t.getMeta("composition"),l=n.prevTime==0||!o&&n.prevComposition!=a&&(n.prevTime<(t.time||0)-r.newGroupDelay||!PU(t,n.prevRanges)),c=o?ip(n.prevRanges,t.mapping):Ob(t.mapping.maps);return new Cs(n.done.addTransform(t,l?e.selection.getBookmark():void 0,r,mu(e)),jn.empty,c,t.time,a??n.prevComposition)}else return(i=t.getMeta("rebased"))?new Cs(n.done.rebased(t,i),n.undone.rebased(t,i),ip(n.prevRanges,t.mapping),n.prevTime,n.prevComposition):new Cs(n.done.addMaps(t.mapping.maps),n.undone.addMaps(t.mapping.maps),ip(n.prevRanges,t.mapping),n.prevTime,n.prevComposition)}function PU(n,e){if(!e)return!1;if(!n.docChanged)return!0;let t=!1;return n.mapping.maps[0].forEach((r,s)=>{for(let i=0;i<e.length;i+=2)r<=e[i+1]&&s>=e[i]&&(t=!0)}),t}function Ob(n){let e=[];for(let t=n.length-1;t>=0&&e.length==0;t--)n[t].forEach((r,s,i,o)=>e.push(i,o));return e}function ip(n,e){if(!n)return null;let t=[];for(let r=0;r<n.length;r+=2){let s=e.map(n[r],1),i=e.map(n[r+1],-1);s<=i&&t.push(s,i)}return t}function NU(n,e,t){let r=mu(e),s=Ui.get(e).spec.config,i=(t?n.undone:n.done).popEvent(e,r);if(!i)return null;let o=i.selection.resolve(i.transform.doc),a=(t?n.done:n.undone).addTransform(i.transform,e.selection.getBookmark(),s,r),l=new Cs(t?a:i.remaining,t?i.remaining:a,null,0,-1);return i.transform.setSelection(o).setMeta(Ui,{redo:t,historyState:l})}let op=!1,Db=null;function mu(n){let e=n.plugins;if(Db!=e){op=!1,Db=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){op=!0;break}}return op}const Ui=new dt("history"),OU=new dt("closeHistory");function DU(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new st({key:Ui,state:{init(){return new Cs(jn.empty,jn.empty,null,0,-1)},apply(e,t,r){return MU(t,r,e,n)}},config:n,props:{handleDOMEvents:{beforeinput(e,t){let r=t.inputType,s=r=="historyUndo"?HI:r=="historyRedo"?jI:null;return!s||!e.editable?!1:(t.preventDefault(),s(e.state,e.dispatch))}}}})}function zI(n,e){return(t,r)=>{let s=Ui.getState(t);if(!s||(n?s.undone:s.done).eventCount==0)return!1;if(r){let i=NU(s,t,n);i&&r(e?i.scrollIntoView():i)}return!0}}const HI=zI(!1,!0),jI=zI(!0,!0);je.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:n=>n.length,wordCounter:n=>n.split(" ").filter(e=>e!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=n=>{const e=n?.node||this.editor.state.doc;if((n?.mode||this.options.mode)==="textSize"){const r=e.textBetween(0,e.content.size,void 0," ");return this.options.textCounter(r)}return e.nodeSize},this.storage.words=n=>{const e=n?.node||this.editor.state.doc,t=e.textBetween(0,e.content.size," "," ");return this.options.wordCounter(t)}},addProseMirrorPlugins(){let n=!1;return[new st({key:new dt("characterCount"),appendTransaction:(e,t,r)=>{if(n)return;const s=this.options.limit;if(s==null||s===0){n=!0;return}const i=this.storage.characters({node:r.doc});if(i>s){const o=i-s,a=0,l=o;console.warn(`[CharacterCount] Initial content exceeded limit of ${s} characters. Content was automatically trimmed.`);const c=r.tr.deleteRange(a,l);return n=!0,c}n=!0},filterTransaction:(e,t)=>{const r=this.options.limit;if(!e.docChanged||r===0||r===null||r===void 0)return!0;const s=this.storage.characters({node:t.doc}),i=this.storage.characters({node:e.doc});if(i<=r||s>r&&i>r&&i<=s)return!0;if(s>r&&i>r&&i>s||!e.getMeta("paste"))return!1;const a=e.selection.$head.pos,l=i-r,c=a-l,u=a;return e.deleteRange(c,u),!(this.storage.characters({node:e.doc})>r)}})]}});var LU=je.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[_U(this.options)]}});je.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new st({key:new dt("focus"),props:{decorations:({doc:n,selection:e})=>{const{isEditable:t,isFocused:r}=this.editor,{anchor:s}=e,i=[];if(!t||!r)return Qe.create(n,[]);let o=0;this.options.mode==="deepest"&&n.descendants((l,c)=>{if(l.isText)return;if(!(s>=c&&s<=c+l.nodeSize-1))return!1;o+=1});let a=0;return n.descendants((l,c)=>{if(l.isText||!(s>=c&&s<=c+l.nodeSize-1))return!1;if(a+=1,this.options.mode==="deepest"&&o-a>0||this.options.mode==="shallowest"&&a>1)return this.options.mode==="deepest";i.push(Rt.node(c,c+l.nodeSize,{class:this.options.className}))}),Qe.create(n,i)}}})]}});var VU=je.create({name:"gapCursor",addProseMirrorPlugins(){return[EU()]},extendNodeSchema(n){var e;const t={name:n.name,options:n.options,storage:n.storage};return{allowGapCursor:(e=Ve(oe(n,"allowGapCursor",t)))!=null?e:null}}});je.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new st({key:new dt("placeholder"),props:{decorations:({doc:n,selection:e})=>{const t=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=e,s=[];if(!t)return null;const i=this.editor.isEmpty;return n.descendants((o,a)=>{const l=r>=a&&r<=a+o.nodeSize,c=!o.isLeaf&&Bd(o);if((l||!this.options.showOnlyCurrent)&&c){const u=[this.options.emptyNodeClass];i&&u.push(this.options.emptyEditorClass);const h=Rt.node(a,a+o.nodeSize,{class:u.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:o,pos:a,hasAnchor:l}):this.options.placeholder});s.push(h)}return this.options.includeChildren}),Qe.create(n,s)}}})]}});je.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:n,options:e}=this;return[new st({key:new dt("selection"),props:{decorations(t){return t.selection.empty||n.isFocused||!n.isEditable||nI(t.selection)||n.view.dragging?null:Qe.create(t.doc,[Rt.inline(t.selection.from,t.selection.to,{class:e.className})])}}})]}});function Lb({types:n,node:e}){return e&&Array.isArray(n)&&n.includes(e.type)||e?.type===n}var FU=je.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var n;const e=new dt(this.name),t=this.options.node||((n=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:n.name)||"paragraph",r=Object.entries(this.editor.schema.nodes).map(([,s])=>s).filter(s=>(this.options.notAfter||[]).concat(t).includes(s.name));return[new st({key:e,appendTransaction:(s,i,o)=>{const{doc:a,tr:l,schema:c}=o,u=e.getState(o),h=a.content.size,f=c.nodes[t];if(u)return l.insert(h,f.create())},state:{init:(s,i)=>{const o=i.tr.doc.lastChild;return!Lb({node:o,types:r})},apply:(s,i)=>{if(!s.docChanged||s.getMeta("__uniqueIDTransaction"))return i;const o=s.doc.lastChild;return!Lb({node:o,types:r})}}})]}}),BU=je.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:n,dispatch:e})=>HI(n,e),redo:()=>({state:n,dispatch:e})=>jI(n,e)}},addProseMirrorPlugins(){return[DU(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),$U=je.create({name:"starterKit",addExtensions(){var n,e,t,r;const s=[];return this.options.bold!==!1&&s.push(p$.configure(this.options.bold)),this.options.blockquote!==!1&&s.push(c$.configure(this.options.blockquote)),this.options.bulletList!==!1&&s.push(RI.configure(this.options.bulletList)),this.options.code!==!1&&s.push(y$.configure(this.options.code)),this.options.codeBlock!==!1&&s.push(w$.configure(this.options.codeBlock)),this.options.document!==!1&&s.push(b$.configure(this.options.document)),this.options.dropcursor!==!1&&s.push(LU.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&s.push(VU.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&s.push(E$.configure(this.options.hardBreak)),this.options.heading!==!1&&s.push(T$.configure(this.options.heading)),this.options.undoRedo!==!1&&s.push(BU.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&s.push(S$.configure(this.options.horizontalRule)),this.options.italic!==!1&&s.push(R$.configure(this.options.italic)),this.options.listItem!==!1&&s.push(xI.configure(this.options.listItem)),this.options.listKeymap!==!1&&s.push(LI.configure((n=this.options)==null?void 0:n.listKeymap)),this.options.link!==!1&&s.push(eU.configure((e=this.options)==null?void 0:e.link)),this.options.orderedList!==!1&&s.push(FI.configure(this.options.orderedList)),this.options.paragraph!==!1&&s.push(fU.configure(this.options.paragraph)),this.options.strike!==!1&&s.push(gU.configure(this.options.strike)),this.options.text!==!1&&s.push(yU.configure(this.options.text)),this.options.underline!==!1&&s.push(BI.configure((t=this.options)==null?void 0:t.underline)),this.options.trailingNode!==!1&&s.push(FU.configure((r=this.options)==null?void 0:r.trailingNode)),s}}),UU=$U,zU=20,WI=(n,e=0)=>{const t=[];return!n.children.length||e>zU||Array.from(n.children).forEach(r=>{r.tagName==="SPAN"?t.push(r):r.children.length&&t.push(...WI(r,e+1))}),t},HU=n=>{if(!n.children.length)return;const e=WI(n);e&&e.forEach(t=>{var r,s;const i=t.getAttribute("style"),o=(s=(r=t.parentElement)==null?void 0:r.closest("span"))==null?void 0:s.getAttribute("style");t.setAttribute("style",`${o};${i}`)})},qI=is.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{},mergeNestedSpanStyles:!0}},parseHTML(){return[{tag:"span",consuming:!1,getAttrs:n=>n.hasAttribute("style")?(this.options.mergeNestedSpanStyles&&HU(n),{}):!1}]},renderHTML({HTMLAttributes:n}){return["span",Ze(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleTextStyle:n=>({commands:e})=>e.toggleMark(this.name,n),removeEmptyTextStyle:()=>({tr:n})=>{const{selection:e}=n;return n.doc.nodesBetween(e.from,e.to,(t,r)=>{if(t.isTextblock)return!0;t.marks.filter(s=>s.type===this.type).some(s=>Object.values(s.attrs).some(i=>!!i))||n.removeMark(r,r+t.nodeSize,this.type)}),!0}}}}),jU=je.create({name:"backgroundColor",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{backgroundColor:{default:null,parseHTML:n=>{var e;const t=n.getAttribute("style");if(t){const r=t.split(";").map(s=>s.trim()).filter(Boolean);for(let s=r.length-1;s>=0;s-=1){const i=r[s].split(":");if(i.length>=2){const o=i[0].trim().toLowerCase(),a=i.slice(1).join(":").trim();if(o==="background-color")return a.replace(/['"]+/g,"")}}}return(e=n.style.backgroundColor)==null?void 0:e.replace(/['"]+/g,"")},renderHTML:n=>n.backgroundColor?{style:`background-color: ${n.backgroundColor}`}:{}}}}]},addCommands(){return{setBackgroundColor:n=>({chain:e})=>e().setMark("textStyle",{backgroundColor:n}).run(),unsetBackgroundColor:()=>({chain:n})=>n().setMark("textStyle",{backgroundColor:null}).removeEmptyTextStyle().run()}}}),KI=je.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:n=>{var e;const t=n.getAttribute("style");if(t){const r=t.split(";").map(s=>s.trim()).filter(Boolean);for(let s=r.length-1;s>=0;s-=1){const i=r[s].split(":");if(i.length>=2){const o=i[0].trim().toLowerCase(),a=i.slice(1).join(":").trim();if(o==="color")return a.replace(/['"]+/g,"")}}}return(e=n.style.color)==null?void 0:e.replace(/['"]+/g,"")},renderHTML:n=>n.color?{style:`color: ${n.color}`}:{}}}}]},addCommands(){return{setColor:n=>({chain:e})=>e().setMark("textStyle",{color:n}).run(),unsetColor:()=>({chain:n})=>n().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),WU=je.create({name:"fontFamily",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontFamily:{default:null,parseHTML:n=>n.style.fontFamily,renderHTML:n=>n.fontFamily?{style:`font-family: ${n.fontFamily}`}:{}}}}]},addCommands(){return{setFontFamily:n=>({chain:e})=>e().setMark("textStyle",{fontFamily:n}).run(),unsetFontFamily:()=>({chain:n})=>n().setMark("textStyle",{fontFamily:null}).removeEmptyTextStyle().run()}}}),qU=je.create({name:"fontSize",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontSize:{default:null,parseHTML:n=>n.style.fontSize,renderHTML:n=>n.fontSize?{style:`font-size: ${n.fontSize}`}:{}}}}]},addCommands(){return{setFontSize:n=>({chain:e})=>e().setMark("textStyle",{fontSize:n}).run(),unsetFontSize:()=>({chain:n})=>n().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()}}}),KU=je.create({name:"lineHeight",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{lineHeight:{default:null,parseHTML:n=>n.style.lineHeight,renderHTML:n=>n.lineHeight?{style:`line-height: ${n.lineHeight}`}:{}}}}]},addCommands(){return{setLineHeight:n=>({chain:e})=>e().setMark("textStyle",{lineHeight:n}).run(),unsetLineHeight:()=>({chain:n})=>n().setMark("textStyle",{lineHeight:null}).removeEmptyTextStyle().run()}}});je.create({name:"textStyleKit",addExtensions(){const n=[];return this.options.backgroundColor!==!1&&n.push(jU.configure(this.options.backgroundColor)),this.options.color!==!1&&n.push(KI.configure(this.options.color)),this.options.fontFamily!==!1&&n.push(WU.configure(this.options.fontFamily)),this.options.fontSize!==!1&&n.push(qU.configure(this.options.fontSize)),this.options.lineHeight!==!1&&n.push(KU.configure(this.options.lineHeight)),this.options.textStyle!==!1&&n.push(qI.configure(this.options.textStyle)),n}});var GU=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))$/,JU=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))/g,QU=is.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:n=>n.getAttribute("data-color")||n.style.backgroundColor,renderHTML:n=>n.color?{"data-color":n.color,style:`background-color: ${n.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:n}){return["mark",Ze(this.options.HTMLAttributes,n),0]},renderMarkdown:(n,e)=>`==${e.renderChildren(n)}==`,parseMarkdown:(n,e)=>e.applyMark("highlight",e.parseInline(n.tokens||[])),markdownTokenizer:{name:"highlight",level:"inline",start:n=>n.indexOf("=="),tokenize(n,e,t){const s=/^(==)([^=]+)(==)/.exec(n);if(s){const i=s[2].trim(),o=t.inlineTokens(i);return{type:"highlight",raw:s[0],text:i,tokens:o}}}},addCommands(){return{setHighlight:n=>({commands:e})=>e.setMark(this.name,n),toggleHighlight:n=>({commands:e})=>e.toggleMark(this.name,n),unsetHighlight:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[Yi({find:GU,type:this.type})]},addPasteRules(){return[ai({find:JU,type:this.type})]}}),YU=je.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:null}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:n=>{const e=n.style.textAlign;return this.options.alignments.includes(e)?e:this.options.defaultAlignment},renderHTML:n=>n.textAlign?{style:`text-align: ${n.textAlign}`}:{}}}}]},addCommands(){return{setTextAlign:n=>({commands:e})=>this.options.alignments.includes(n)?this.options.types.map(t=>e.updateAttributes(t,{textAlign:n})).some(t=>t):!1,unsetTextAlign:()=>({commands:n})=>this.options.types.map(e=>n.resetAttributes(e,"textAlign")).some(e=>e),toggleTextAlign:n=>({editor:e,commands:t})=>this.options.alignments.includes(n)?e.isActive({textAlign:n})?t.unsetTextAlign():t.setTextAlign(n):!1}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}});let Im,km;if(typeof WeakMap<"u"){let n=new WeakMap;Im=e=>n.get(e),km=(e,t)=>(n.set(e,t),t)}else{const n=[];let t=0;Im=r=>{for(let s=0;s<n.length;s+=2)if(n[s]==r)return n[s+1]},km=(r,s)=>(t==10&&(t=0),n[t++]=r,n[t++]=s)}var ht=class{constructor(n,e,t,r){this.width=n,this.height=e,this.map=t,this.problems=r}findCell(n){for(let e=0;e<this.map.length;e++){const t=this.map[e];if(t!=n)continue;const r=e%this.width,s=e/this.width|0;let i=r+1,o=s+1;for(let a=1;i<this.width&&this.map[e+a]==t;a++)i++;for(let a=1;o<this.height&&this.map[e+this.width*a]==t;a++)o++;return{left:r,top:s,right:i,bottom:o}}throw new RangeError(`No cell with offset ${n} found`)}colCount(n){for(let e=0;e<this.map.length;e++)if(this.map[e]==n)return e%this.width;throw new RangeError(`No cell with offset ${n} found`)}nextCell(n,e,t){const{left:r,right:s,top:i,bottom:o}=this.findCell(n);return e=="horiz"?(t<0?r==0:s==this.width)?null:this.map[i*this.width+(t<0?r-1:s)]:(t<0?i==0:o==this.height)?null:this.map[r+this.width*(t<0?i-1:o)]}rectBetween(n,e){const{left:t,right:r,top:s,bottom:i}=this.findCell(n),{left:o,right:a,top:l,bottom:c}=this.findCell(e);return{left:Math.min(t,o),top:Math.min(s,l),right:Math.max(r,a),bottom:Math.max(i,c)}}cellsInRect(n){const e=[],t={};for(let r=n.top;r<n.bottom;r++)for(let s=n.left;s<n.right;s++){const i=r*this.width+s,o=this.map[i];t[o]||(t[o]=!0,!(s==n.left&&s&&this.map[i-1]==o||r==n.top&&r&&this.map[i-this.width]==o)&&e.push(o))}return e}positionAt(n,e,t){for(let r=0,s=0;;r++){const i=s+t.child(r).nodeSize;if(r==n){let o=e+n*this.width;const a=(n+1)*this.width;for(;o<a&&this.map[o]<s;)o++;return o==a?i-1:this.map[o]}s=i}}static get(n){return Im(n)||km(n,XU(n))}};function XU(n){if(n.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+n.type.name);const e=ZU(n),t=n.childCount,r=[];let s=0,i=null;const o=[];for(let c=0,u=e*t;c<u;c++)r[c]=0;for(let c=0,u=0;c<t;c++){const h=n.child(c);u++;for(let m=0;;m++){for(;s<r.length&&r[s]!=0;)s++;if(m==h.childCount)break;const y=h.child(m),{colspan:v,rowspan:T,colwidth:M}=y.attrs;for(let P=0;P<T;P++){if(P+c>=t){(i||(i=[])).push({type:"overlong_rowspan",pos:u,n:T-P});break}const D=s+P*e;for(let L=0;L<v;L++){r[D+L]==0?r[D+L]=u:(i||(i=[])).push({type:"collision",row:c,pos:u,n:v-L});const q=M&&M[L];if(q){const S=(D+L)%e*2,w=o[S];w==null||w!=q&&o[S+1]==1?(o[S]=q,o[S+1]=1):w==q&&o[S+1]++}}}s+=v,u+=y.nodeSize}const f=(c+1)*e;let p=0;for(;s<f;)r[s++]==0&&p++;p&&(i||(i=[])).push({type:"missing",row:c,n:p}),u++}(e===0||t===0)&&(i||(i=[])).push({type:"zero_sized"});const a=new ht(e,t,r,i);let l=!1;for(let c=0;!l&&c<o.length;c+=2)o[c]!=null&&o[c+1]<t&&(l=!0);return l&&ez(a,o,n),a}function ZU(n){let e=-1,t=!1;for(let r=0;r<n.childCount;r++){const s=n.child(r);let i=0;if(t)for(let o=0;o<r;o++){const a=n.child(o);for(let l=0;l<a.childCount;l++){const c=a.child(l);o+c.attrs.rowspan>r&&(i+=c.attrs.colspan)}}for(let o=0;o<s.childCount;o++){const a=s.child(o);i+=a.attrs.colspan,a.attrs.rowspan>1&&(t=!0)}e==-1?e=i:e!=i&&(e=Math.max(e,i))}return e}function ez(n,e,t){n.problems||(n.problems=[]);const r={};for(let s=0;s<n.map.length;s++){const i=n.map[s];if(r[i])continue;r[i]=!0;const o=t.nodeAt(i);if(!o)throw new RangeError(`No cell with offset ${i} found`);let a=null;const l=o.attrs;for(let c=0;c<l.colspan;c++){const u=e[(s+c)%n.width*2];u!=null&&(!l.colwidth||l.colwidth[c]!=u)&&((a||(a=tz(l)))[c]=u)}a&&n.problems.unshift({type:"colwidth mismatch",pos:i,colwidth:a})}}function tz(n){if(n.colwidth)return n.colwidth.slice();const e=[];for(let t=0;t<n.colspan;t++)e.push(0);return e}function rn(n){let e=n.cached.tableNodeTypes;if(!e){e=n.cached.tableNodeTypes={};for(const t in n.nodes){const r=n.nodes[t],s=r.spec.tableRole;s&&(e[s]=r)}}return e}const Ps=new dt("selectingCells");function ua(n){for(let e=n.depth-1;e>0;e--)if(n.node(e).type.spec.tableRole=="row")return n.node(0).resolve(n.before(e+1));return null}function nz(n){for(let e=n.depth;e>0;e--){const t=n.node(e).type.spec.tableRole;if(t==="cell"||t==="header_cell")return n.node(e)}return null}function er(n){const e=n.selection.$head;for(let t=e.depth;t>0;t--)if(e.node(t).type.spec.tableRole=="row")return!0;return!1}function Hd(n){const e=n.selection;if("$anchorCell"in e&&e.$anchorCell)return e.$anchorCell.pos>e.$headCell.pos?e.$anchorCell:e.$headCell;if("node"in e&&e.node&&e.node.type.spec.tableRole=="cell")return e.$anchor;const t=ua(e.$head)||rz(e.$head);if(t)return t;throw new RangeError(`No cell found around position ${e.head}`)}function rz(n){for(let e=n.nodeAfter,t=n.pos;e;e=e.firstChild,t++){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return n.doc.resolve(t)}for(let e=n.nodeBefore,t=n.pos;e;e=e.lastChild,t--){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return n.doc.resolve(t-e.nodeSize)}}function Rm(n){return n.parent.type.spec.tableRole=="row"&&!!n.nodeAfter}function sz(n){return n.node(0).resolve(n.pos+n.nodeAfter.nodeSize)}function $y(n,e){return n.depth==e.depth&&n.pos>=e.start(-1)&&n.pos<=e.end(-1)}function GI(n,e,t){const r=n.node(-1),s=ht.get(r),i=n.start(-1),o=s.nextCell(n.pos-i,e,t);return o==null?null:n.node(0).resolve(i+o)}function Xi(n,e,t=1){const r={...n,colspan:n.colspan-t};return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(e,t),r.colwidth.some(s=>s>0)||(r.colwidth=null)),r}function JI(n,e,t=1){const r={...n,colspan:n.colspan+t};if(r.colwidth){r.colwidth=r.colwidth.slice();for(let s=0;s<t;s++)r.colwidth.splice(e,0,0)}return r}function iz(n,e,t){const r=rn(e.type.schema).header_cell;for(let s=0;s<n.height;s++)if(e.nodeAt(n.map[t+s*n.width]).type!=r)return!1;return!0}var Xe=class Fr extends me{constructor(e,t=e){const r=e.node(-1),s=ht.get(r),i=e.start(-1),o=s.rectBetween(e.pos-i,t.pos-i),a=e.node(0),l=s.cellsInRect(o).filter(u=>u!=t.pos-i);l.unshift(t.pos-i);const c=l.map(u=>{const h=r.nodeAt(u);if(!h)throw new RangeError(`No cell with offset ${u} found`);const f=i+u+1;return new jC(a.resolve(f),a.resolve(f+h.content.size))});super(c[0].$from,c[0].$to,c),this.$anchorCell=e,this.$headCell=t}map(e,t){const r=e.resolve(t.map(this.$anchorCell.pos)),s=e.resolve(t.map(this.$headCell.pos));if(Rm(r)&&Rm(s)&&$y(r,s)){const i=this.$anchorCell.node(-1)!=r.node(-1);return i&&this.isRowSelection()?Fr.rowSelection(r,s):i&&this.isColSelection()?Fr.colSelection(r,s):new Fr(r,s)}return ue.between(r,s)}content(){const e=this.$anchorCell.node(-1),t=ht.get(e),r=this.$anchorCell.start(-1),s=t.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r),i={},o=[];for(let l=s.top;l<s.bottom;l++){const c=[];for(let u=l*t.width+s.left,h=s.left;h<s.right;h++,u++){const f=t.map[u];if(i[f])continue;i[f]=!0;const p=t.findCell(f);let m=e.nodeAt(f);if(!m)throw new RangeError(`No cell with offset ${f} found`);const y=s.left-p.left,v=p.right-s.right;if(y>0||v>0){let T=m.attrs;if(y>0&&(T=Xi(T,0,y)),v>0&&(T=Xi(T,T.colspan-v,v)),p.left<s.left){if(m=m.type.createAndFill(T),!m)throw new RangeError(`Could not create cell with attrs ${JSON.stringify(T)}`)}else m=m.type.create(T,m.content)}if(p.top<s.top||p.bottom>s.bottom){const T={...m.attrs,rowspan:Math.min(p.bottom,s.bottom)-Math.max(p.top,s.top)};p.top<s.top?m=m.type.createAndFill(T):m=m.type.create(T,m.content)}c.push(m)}o.push(e.child(l).copy(H.from(c)))}const a=this.isColSelection()&&this.isRowSelection()?e:o;return new X(H.from(a),1,1)}replace(e,t=X.empty){const r=e.steps.length,s=this.ranges;for(let o=0;o<s.length;o++){const{$from:a,$to:l}=s[o],c=e.mapping.slice(r);e.replace(c.map(a.pos),c.map(l.pos),o?X.empty:t)}const i=me.findFrom(e.doc.resolve(e.mapping.slice(r).map(this.to)),-1);i&&e.setSelection(i)}replaceWith(e,t){this.replace(e,new X(H.from(t),0,0))}forEachCell(e){const t=this.$anchorCell.node(-1),r=ht.get(t),s=this.$anchorCell.start(-1),i=r.cellsInRect(r.rectBetween(this.$anchorCell.pos-s,this.$headCell.pos-s));for(let o=0;o<i.length;o++)e(t.nodeAt(i[o]),s+i[o])}isColSelection(){const e=this.$anchorCell.index(-1),t=this.$headCell.index(-1);if(Math.min(e,t)>0)return!1;const r=e+this.$anchorCell.nodeAfter.attrs.rowspan,s=t+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(r,s)==this.$headCell.node(-1).childCount}static colSelection(e,t=e){const r=e.node(-1),s=ht.get(r),i=e.start(-1),o=s.findCell(e.pos-i),a=s.findCell(t.pos-i),l=e.node(0);return o.top<=a.top?(o.top>0&&(e=l.resolve(i+s.map[o.left])),a.bottom<s.height&&(t=l.resolve(i+s.map[s.width*(s.height-1)+a.right-1]))):(a.top>0&&(t=l.resolve(i+s.map[a.left])),o.bottom<s.height&&(e=l.resolve(i+s.map[s.width*(s.height-1)+o.right-1]))),new Fr(e,t)}isRowSelection(){const e=this.$anchorCell.node(-1),t=ht.get(e),r=this.$anchorCell.start(-1),s=t.colCount(this.$anchorCell.pos-r),i=t.colCount(this.$headCell.pos-r);if(Math.min(s,i)>0)return!1;const o=s+this.$anchorCell.nodeAfter.attrs.colspan,a=i+this.$headCell.nodeAfter.attrs.colspan;return Math.max(o,a)==t.width}eq(e){return e instanceof Fr&&e.$anchorCell.pos==this.$anchorCell.pos&&e.$headCell.pos==this.$headCell.pos}static rowSelection(e,t=e){const r=e.node(-1),s=ht.get(r),i=e.start(-1),o=s.findCell(e.pos-i),a=s.findCell(t.pos-i),l=e.node(0);return o.left<=a.left?(o.left>0&&(e=l.resolve(i+s.map[o.top*s.width])),a.right<s.width&&(t=l.resolve(i+s.map[s.width*(a.top+1)-1]))):(a.left>0&&(t=l.resolve(i+s.map[a.top*s.width])),o.right<s.width&&(e=l.resolve(i+s.map[s.width*(o.top+1)-1]))),new Fr(e,t)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(e,t){return new Fr(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){return new Fr(e.resolve(t),e.resolve(r))}getBookmark(){return new oz(this.$anchorCell.pos,this.$headCell.pos)}};Xe.prototype.visible=!1;me.jsonID("cell",Xe);var oz=class QI{constructor(e,t){this.anchor=e,this.head=t}map(e){return new QI(e.map(this.anchor),e.map(this.head))}resolve(e){const t=e.resolve(this.anchor),r=e.resolve(this.head);return t.parent.type.spec.tableRole=="row"&&r.parent.type.spec.tableRole=="row"&&t.index()<t.parent.childCount&&r.index()<r.parent.childCount&&$y(t,r)?new Xe(t,r):me.near(r,1)}};function az(n){if(!(n.selection instanceof Xe))return null;const e=[];return n.selection.forEachCell((t,r)=>{e.push(Rt.node(r,r+t.nodeSize,{class:"selectedCell"}))}),Qe.create(n.doc,e)}function lz({$from:n,$to:e}){if(n.pos==e.pos||n.pos<e.pos-6)return!1;let t=n.pos,r=e.pos,s=n.depth;for(;s>=0&&!(n.after(s+1)<n.end(s));s--,t++);for(let i=e.depth;i>=0&&!(e.before(i+1)>e.start(i));i--,r--);return t==r&&/row|table/.test(n.node(s).type.spec.tableRole)}function cz({$from:n,$to:e}){let t,r;for(let s=n.depth;s>0;s--){const i=n.node(s);if(i.type.spec.tableRole==="cell"||i.type.spec.tableRole==="header_cell"){t=i;break}}for(let s=e.depth;s>0;s--){const i=e.node(s);if(i.type.spec.tableRole==="cell"||i.type.spec.tableRole==="header_cell"){r=i;break}}return t!==r&&e.parentOffset===0}function uz(n,e,t){const r=(e||n).selection,s=(e||n).doc;let i,o;if(r instanceof le&&(o=r.node.type.spec.tableRole)){if(o=="cell"||o=="header_cell")i=Xe.create(s,r.from);else if(o=="row"){const a=s.resolve(r.from+1);i=Xe.rowSelection(a,a)}else if(!t){const a=ht.get(r.node),l=r.from+1,c=l+a.map[a.width*a.height-1];i=Xe.create(s,l+1,c)}}else r instanceof ue&&lz(r)?i=ue.create(s,r.from):r instanceof ue&&cz(r)&&(i=ue.create(s,r.$from.start(),r.$from.end()));return i&&(e||(e=n.tr)).setSelection(i),e}const hz=new dt("fix-tables");function YI(n,e,t,r){const s=n.childCount,i=e.childCount;e:for(let o=0,a=0;o<i;o++){const l=e.child(o);for(let c=a,u=Math.min(s,o+3);c<u;c++)if(n.child(c)==l){a=c+1,t+=l.nodeSize;continue e}r(l,t),a<s&&n.child(a).sameMarkup(l)?YI(n.child(a),l,t+1,r):l.nodesBetween(0,l.content.size,r,t+1),t+=l.nodeSize}}function XI(n,e){let t;const r=(s,i)=>{s.type.spec.tableRole=="table"&&(t=dz(n,s,i,t))};return e?e.doc!=n.doc&&YI(e.doc,n.doc,0,r):n.doc.descendants(r),t}function dz(n,e,t,r){const s=ht.get(e);if(!s.problems)return r;r||(r=n.tr);const i=[];for(let l=0;l<s.height;l++)i.push(0);for(let l=0;l<s.problems.length;l++){const c=s.problems[l];if(c.type=="collision"){const u=e.nodeAt(c.pos);if(!u)continue;const h=u.attrs;for(let f=0;f<h.rowspan;f++)i[c.row+f]+=c.n;r.setNodeMarkup(r.mapping.map(t+1+c.pos),null,Xi(h,h.colspan-c.n,c.n))}else if(c.type=="missing")i[c.row]+=c.n;else if(c.type=="overlong_rowspan"){const u=e.nodeAt(c.pos);if(!u)continue;r.setNodeMarkup(r.mapping.map(t+1+c.pos),null,{...u.attrs,rowspan:u.attrs.rowspan-c.n})}else if(c.type=="colwidth mismatch"){const u=e.nodeAt(c.pos);if(!u)continue;r.setNodeMarkup(r.mapping.map(t+1+c.pos),null,{...u.attrs,colwidth:c.colwidth})}else if(c.type=="zero_sized"){const u=r.mapping.map(t);r.delete(u,u+e.nodeSize)}}let o,a;for(let l=0;l<i.length;l++)i[l]&&(o==null&&(o=l),a=l);for(let l=0,c=t+1;l<s.height;l++){const u=e.child(l),h=c+u.nodeSize,f=i[l];if(f>0){let p="cell";u.firstChild&&(p=u.firstChild.type.spec.tableRole);const m=[];for(let v=0;v<f;v++){const T=rn(n.schema)[p].createAndFill();T&&m.push(T)}const y=(l==0||o==l-1)&&a==l?c+1:h-1;r.insert(r.mapping.map(y),m)}c=h}return r.setMeta(hz,{fixTables:!0})}function Rr(n){const e=n.selection,t=Hd(n),r=t.node(-1),s=t.start(-1),i=ht.get(r);return{...e instanceof Xe?i.rectBetween(e.$anchorCell.pos-s,e.$headCell.pos-s):i.findCell(t.pos-s),tableStart:s,map:i,table:r}}function ZI(n,{map:e,tableStart:t,table:r},s){let i=s>0?-1:0;iz(e,r,s+i)&&(i=s==0||s==e.width?null:0);for(let o=0;o<e.height;o++){const a=o*e.width+s;if(s>0&&s<e.width&&e.map[a-1]==e.map[a]){const l=e.map[a],c=r.nodeAt(l);n.setNodeMarkup(n.mapping.map(t+l),null,JI(c.attrs,s-e.colCount(l))),o+=c.attrs.rowspan-1}else{const l=i==null?rn(r.type.schema).cell:r.nodeAt(e.map[a+i]).type,c=e.positionAt(o,s,r);n.insert(n.mapping.map(t+c),l.createAndFill())}}return n}function fz(n,e){if(!er(n))return!1;if(e){const t=Rr(n);e(ZI(n.tr,t,t.left))}return!0}function pz(n,e){if(!er(n))return!1;if(e){const t=Rr(n);e(ZI(n.tr,t,t.right))}return!0}function mz(n,{map:e,table:t,tableStart:r},s){const i=n.mapping.maps.length;for(let o=0;o<e.height;){const a=o*e.width+s,l=e.map[a],c=t.nodeAt(l),u=c.attrs;if(s>0&&e.map[a-1]==l||s<e.width-1&&e.map[a+1]==l)n.setNodeMarkup(n.mapping.slice(i).map(r+l),null,Xi(u,s-e.colCount(l)));else{const h=n.mapping.slice(i).map(r+l);n.delete(h,h+c.nodeSize)}o+=u.rowspan}}function gz(n,e){if(!er(n))return!1;if(e){const t=Rr(n),r=n.tr;if(t.left==0&&t.right==t.map.width)return!1;for(let s=t.right-1;mz(r,t,s),s!=t.left;s--){const i=t.tableStart?r.doc.nodeAt(t.tableStart-1):r.doc;if(!i)throw new RangeError("No table found");t.table=i,t.map=ht.get(i)}e(r)}return!0}function yz(n,e,t){var r;const s=rn(e.type.schema).header_cell;for(let i=0;i<n.width;i++)if(((r=e.nodeAt(n.map[i+t*n.width]))===null||r===void 0?void 0:r.type)!=s)return!1;return!0}function ek(n,{map:e,tableStart:t,table:r},s){let i=t;for(let c=0;c<s;c++)i+=r.child(c).nodeSize;const o=[];let a=s>0?-1:0;yz(e,r,s+a)&&(a=s==0||s==e.height?null:0);for(let c=0,u=e.width*s;c<e.width;c++,u++)if(s>0&&s<e.height&&e.map[u]==e.map[u-e.width]){const h=e.map[u],f=r.nodeAt(h).attrs;n.setNodeMarkup(t+h,null,{...f,rowspan:f.rowspan+1}),c+=f.colspan-1}else{var l;const h=a==null?rn(r.type.schema).cell:(l=r.nodeAt(e.map[u+a*e.width]))===null||l===void 0?void 0:l.type,f=h?.createAndFill();f&&o.push(f)}return n.insert(i,rn(r.type.schema).row.create(null,o)),n}function _z(n,e){if(!er(n))return!1;if(e){const t=Rr(n);e(ek(n.tr,t,t.top))}return!0}function vz(n,e){if(!er(n))return!1;if(e){const t=Rr(n);e(ek(n.tr,t,t.bottom))}return!0}function wz(n,{map:e,table:t,tableStart:r},s){let i=0;for(let c=0;c<s;c++)i+=t.child(c).nodeSize;const o=i+t.child(s).nodeSize,a=n.mapping.maps.length;n.delete(i+r,o+r);const l=new Set;for(let c=0,u=s*e.width;c<e.width;c++,u++){const h=e.map[u];if(!l.has(h)){if(l.add(h),s>0&&h==e.map[u-e.width]){const f=t.nodeAt(h).attrs;n.setNodeMarkup(n.mapping.slice(a).map(h+r),null,{...f,rowspan:f.rowspan-1}),c+=f.colspan-1}else if(s<e.height&&h==e.map[u+e.width]){const f=t.nodeAt(h),p=f.attrs,m=f.type.create({...p,rowspan:f.attrs.rowspan-1},f.content),y=e.positionAt(s+1,c,t);n.insert(n.mapping.slice(a).map(r+y),m),c+=p.colspan-1}}}}function bz(n,e){if(!er(n))return!1;if(e){const t=Rr(n),r=n.tr;if(t.top==0&&t.bottom==t.map.height)return!1;for(let s=t.bottom-1;wz(r,t,s),s!=t.top;s--){const i=t.tableStart?r.doc.nodeAt(t.tableStart-1):r.doc;if(!i)throw new RangeError("No table found");t.table=i,t.map=ht.get(t.table)}e(r)}return!0}function Vb(n){const e=n.content;return e.childCount==1&&e.child(0).isTextblock&&e.child(0).childCount==0}function Ez({width:n,height:e,map:t},r){let s=r.top*n+r.left,i=s,o=(r.bottom-1)*n+r.left,a=s+(r.right-r.left-1);for(let l=r.top;l<r.bottom;l++){if(r.left>0&&t[i]==t[i-1]||r.right<n&&t[a]==t[a+1])return!0;i+=n,a+=n}for(let l=r.left;l<r.right;l++){if(r.top>0&&t[s]==t[s-n]||r.bottom<e&&t[o]==t[o+n])return!0;s++,o++}return!1}function Fb(n,e){const t=n.selection;if(!(t instanceof Xe)||t.$anchorCell.pos==t.$headCell.pos)return!1;const r=Rr(n),{map:s}=r;if(Ez(s,r))return!1;if(e){const i=n.tr,o={};let a=H.empty,l,c;for(let u=r.top;u<r.bottom;u++)for(let h=r.left;h<r.right;h++){const f=s.map[u*s.width+h],p=r.table.nodeAt(f);if(!(o[f]||!p))if(o[f]=!0,l==null)l=f,c=p;else{Vb(p)||(a=a.append(p.content));const m=i.mapping.map(f+r.tableStart);i.delete(m,m+p.nodeSize)}}if(l==null||c==null)return!0;if(i.setNodeMarkup(l+r.tableStart,null,{...JI(c.attrs,c.attrs.colspan,r.right-r.left-c.attrs.colspan),rowspan:r.bottom-r.top}),a.size>0){const u=l+1+c.content.size,h=Vb(c)?l+1:u;i.replaceWith(h+r.tableStart,u+r.tableStart,a)}i.setSelection(new Xe(i.doc.resolve(l+r.tableStart))),e(i)}return!0}function Bb(n,e){const t=rn(n.schema);return Tz(({node:r})=>t[r.type.spec.tableRole])(n,e)}function Tz(n){return(e,t)=>{const r=e.selection;let s,i;if(r instanceof Xe){if(r.$anchorCell.pos!=r.$headCell.pos)return!1;s=r.$anchorCell.nodeAfter,i=r.$anchorCell.pos}else{var o;if(s=nz(r.$from),!s)return!1;i=(o=ua(r.$from))===null||o===void 0?void 0:o.pos}if(s==null||i==null||s.attrs.colspan==1&&s.attrs.rowspan==1)return!1;if(t){let a=s.attrs;const l=[],c=a.colwidth;a.rowspan>1&&(a={...a,rowspan:1}),a.colspan>1&&(a={...a,colspan:1});const u=Rr(e),h=e.tr;for(let p=0;p<u.right-u.left;p++)l.push(c?{...a,colwidth:c&&c[p]?[c[p]]:null}:a);let f;for(let p=u.top;p<u.bottom;p++){let m=u.map.positionAt(p,u.left,u.table);p==u.top&&(m+=s.nodeSize);for(let y=u.left,v=0;y<u.right;y++,v++)y==u.left&&p==u.top||h.insert(f=h.mapping.map(m+u.tableStart,1),n({node:s,row:p,col:y}).createAndFill(l[v]))}h.setNodeMarkup(i,n({node:s,row:u.top,col:u.left}),l[0]),r instanceof Xe&&h.setSelection(new Xe(h.doc.resolve(r.$anchorCell.pos),f?h.doc.resolve(f):void 0)),t(h)}return!0}}function Sz(n,e){return function(t,r){if(!er(t))return!1;const s=Hd(t);if(s.nodeAfter.attrs[n]===e)return!1;if(r){const i=t.tr;t.selection instanceof Xe?t.selection.forEachCell((o,a)=>{o.attrs[n]!==e&&i.setNodeMarkup(a,null,{...o.attrs,[n]:e})}):i.setNodeMarkup(s.pos,null,{...s.nodeAfter.attrs,[n]:e}),r(i)}return!0}}function Cz(n){return function(e,t){if(!er(e))return!1;if(t){const r=rn(e.schema),s=Rr(e),i=e.tr,o=s.map.cellsInRect(n=="column"?{left:s.left,top:0,right:s.right,bottom:s.map.height}:n=="row"?{left:0,top:s.top,right:s.map.width,bottom:s.bottom}:s),a=o.map(l=>s.table.nodeAt(l));for(let l=0;l<o.length;l++)a[l].type==r.header_cell&&i.setNodeMarkup(s.tableStart+o[l],r.cell,a[l].attrs);if(i.steps.length===0)for(let l=0;l<o.length;l++)i.setNodeMarkup(s.tableStart+o[l],r.header_cell,a[l].attrs);t(i)}return!0}}function $b(n,e,t){const r=e.map.cellsInRect({left:0,top:0,right:n=="row"?e.map.width:1,bottom:n=="column"?e.map.height:1});for(let s=0;s<r.length;s++){const i=e.table.nodeAt(r[s]);if(i&&i.type!==t.header_cell)return!1}return!0}function Kl(n,e){return e=e||{useDeprecatedLogic:!1},e.useDeprecatedLogic?Cz(n):function(t,r){if(!er(t))return!1;if(r){const s=rn(t.schema),i=Rr(t),o=t.tr,a=$b("row",i,s),l=$b("column",i,s),c=(n==="column"?a:n==="row"&&l)?1:0,u=n=="column"?{left:0,top:c,right:1,bottom:i.map.height}:n=="row"?{left:c,top:0,right:i.map.width,bottom:1}:i,h=n=="column"?l?s.cell:s.header_cell:n=="row"?a?s.cell:s.header_cell:s.cell;i.map.cellsInRect(u).forEach(f=>{const p=f+i.tableStart,m=o.doc.nodeAt(p);m&&o.setNodeMarkup(p,h,m.attrs)}),r(o)}return!0}}Kl("row",{useDeprecatedLogic:!0});Kl("column",{useDeprecatedLogic:!0});const Az=Kl("cell",{useDeprecatedLogic:!0});function Iz(n,e){if(e<0){const t=n.nodeBefore;if(t)return n.pos-t.nodeSize;for(let r=n.index(-1)-1,s=n.before();r>=0;r--){const i=n.node(-1).child(r),o=i.lastChild;if(o)return s-1-o.nodeSize;s-=i.nodeSize}}else{if(n.index()<n.parent.childCount-1)return n.pos+n.nodeAfter.nodeSize;const t=n.node(-1);for(let r=n.indexAfter(-1),s=n.after();r<t.childCount;r++){const i=t.child(r);if(i.childCount)return s+1;s+=i.nodeSize}}return null}function Ub(n){return function(e,t){if(!er(e))return!1;const r=Iz(Hd(e),n);if(r==null)return!1;if(t){const s=e.doc.resolve(r);t(e.tr.setSelection(ue.between(s,sz(s))).scrollIntoView())}return!0}}function kz(n,e){const t=n.selection.$anchor;for(let r=t.depth;r>0;r--)if(t.node(r).type.spec.tableRole=="table")return e&&e(n.tr.delete(t.before(r),t.after(r)).scrollIntoView()),!0;return!1}function qc(n,e){const t=n.selection;if(!(t instanceof Xe))return!1;if(e){const r=n.tr,s=rn(n.schema).cell.createAndFill().content;t.forEachCell((i,o)=>{i.content.eq(s)||r.replace(r.mapping.map(o+1),r.mapping.map(o+i.nodeSize-1),new X(s,0,0))}),r.docChanged&&e(r)}return!0}function Rz(n){if(n.size===0)return null;let{content:e,openStart:t,openEnd:r}=n;for(;e.childCount==1&&(t>0&&r>0||e.child(0).type.spec.tableRole=="table");)t--,r--,e=e.child(0).content;const s=e.child(0),i=s.type.spec.tableRole,o=s.type.schema,a=[];if(i=="row")for(let l=0;l<e.childCount;l++){let c=e.child(l).content;const u=l?0:Math.max(0,t-1),h=l<e.childCount-1?0:Math.max(0,r-1);(u||h)&&(c=xm(rn(o).row,new X(c,u,h)).content),a.push(c)}else if(i=="cell"||i=="header_cell")a.push(t||r?xm(rn(o).row,new X(e,t,r)).content:e);else return null;return xz(o,a)}function xz(n,e){const t=[];for(let s=0;s<e.length;s++){const i=e[s];for(let o=i.childCount-1;o>=0;o--){const{rowspan:a,colspan:l}=i.child(o).attrs;for(let c=s;c<s+a;c++)t[c]=(t[c]||0)+l}}let r=0;for(let s=0;s<t.length;s++)r=Math.max(r,t[s]);for(let s=0;s<t.length;s++)if(s>=e.length&&e.push(H.empty),t[s]<r){const i=rn(n).cell.createAndFill(),o=[];for(let a=t[s];a<r;a++)o.push(i);e[s]=e[s].append(H.from(o))}return{height:e.length,width:r,rows:e}}function xm(n,e){const t=n.createAndFill();return new ey(t).replace(0,t.content.size,e).doc}function Mz({width:n,height:e,rows:t},r,s){if(n!=r){const i=[],o=[];for(let a=0;a<t.length;a++){const l=t[a],c=[];for(let u=i[a]||0,h=0;u<r;h++){let f=l.child(h%l.childCount);u+f.attrs.colspan>r&&(f=f.type.createChecked(Xi(f.attrs,f.attrs.colspan,u+f.attrs.colspan-r),f.content)),c.push(f),u+=f.attrs.colspan;for(let p=1;p<f.attrs.rowspan;p++)i[a+p]=(i[a+p]||0)+f.attrs.colspan}o.push(H.from(c))}t=o,n=r}if(e!=s){const i=[];for(let o=0,a=0;o<s;o++,a++){const l=[],c=t[a%e];for(let u=0;u<c.childCount;u++){let h=c.child(u);o+h.attrs.rowspan>s&&(h=h.type.create({...h.attrs,rowspan:Math.max(1,s-h.attrs.rowspan)},h.content)),l.push(h)}i.push(H.from(l))}t=i,e=s}return{width:n,height:e,rows:t}}function Pz(n,e,t,r,s,i,o){const a=n.doc.type.schema,l=rn(a);let c,u;if(s>e.width)for(let h=0,f=0;h<e.height;h++){const p=t.child(h);f+=p.nodeSize;const m=[];let y;p.lastChild==null||p.lastChild.type==l.cell?y=c||(c=l.cell.createAndFill()):y=u||(u=l.header_cell.createAndFill());for(let v=e.width;v<s;v++)m.push(y);n.insert(n.mapping.slice(o).map(f-1+r),m)}if(i>e.height){const h=[];for(let m=0,y=(e.height-1)*e.width;m<Math.max(e.width,s);m++){const v=m>=e.width?!1:t.nodeAt(e.map[y+m]).type==l.header_cell;h.push(v?u||(u=l.header_cell.createAndFill()):c||(c=l.cell.createAndFill()))}const f=l.row.create(null,H.from(h)),p=[];for(let m=e.height;m<i;m++)p.push(f);n.insert(n.mapping.slice(o).map(r+t.nodeSize-2),p)}return!!(c||u)}function zb(n,e,t,r,s,i,o,a){if(o==0||o==e.height)return!1;let l=!1;for(let c=s;c<i;c++){const u=o*e.width+c,h=e.map[u];if(e.map[u-e.width]==h){l=!0;const f=t.nodeAt(h),{top:p,left:m}=e.findCell(h);n.setNodeMarkup(n.mapping.slice(a).map(h+r),null,{...f.attrs,rowspan:o-p}),n.insert(n.mapping.slice(a).map(e.positionAt(o,m,t)),f.type.createAndFill({...f.attrs,rowspan:p+f.attrs.rowspan-o})),c+=f.attrs.colspan-1}}return l}function Hb(n,e,t,r,s,i,o,a){if(o==0||o==e.width)return!1;let l=!1;for(let c=s;c<i;c++){const u=c*e.width+o,h=e.map[u];if(e.map[u-1]==h){l=!0;const f=t.nodeAt(h),p=e.colCount(h),m=n.mapping.slice(a).map(h+r);n.setNodeMarkup(m,null,Xi(f.attrs,o-p,f.attrs.colspan-(o-p))),n.insert(m+f.nodeSize,f.type.createAndFill(Xi(f.attrs,0,o-p))),c+=f.attrs.rowspan-1}}return l}function jb(n,e,t,r,s){let i=t?n.doc.nodeAt(t-1):n.doc;if(!i)throw new Error("No table found");let o=ht.get(i);const{top:a,left:l}=r,c=l+s.width,u=a+s.height,h=n.tr;let f=0;function p(){if(i=t?h.doc.nodeAt(t-1):h.doc,!i)throw new Error("No table found");o=ht.get(i),f=h.mapping.maps.length}Pz(h,o,i,t,c,u,f)&&p(),zb(h,o,i,t,l,c,a,f)&&p(),zb(h,o,i,t,l,c,u,f)&&p(),Hb(h,o,i,t,a,u,l,f)&&p(),Hb(h,o,i,t,a,u,c,f)&&p();for(let m=a;m<u;m++){const y=o.positionAt(m,l,i),v=o.positionAt(m,c,i);h.replace(h.mapping.slice(f).map(y+t),h.mapping.slice(f).map(v+t),new X(s.rows[m-a],0,0))}p(),h.setSelection(new Xe(h.doc.resolve(t+o.positionAt(a,l,i)),h.doc.resolve(t+o.positionAt(u-1,c-1,i)))),e(h)}const Nz=gy({ArrowLeft:Kc("horiz",-1),ArrowRight:Kc("horiz",1),ArrowUp:Kc("vert",-1),ArrowDown:Kc("vert",1),"Shift-ArrowLeft":Gc("horiz",-1),"Shift-ArrowRight":Gc("horiz",1),"Shift-ArrowUp":Gc("vert",-1),"Shift-ArrowDown":Gc("vert",1),Backspace:qc,"Mod-Backspace":qc,Delete:qc,"Mod-Delete":qc});function gu(n,e,t){return t.eq(n.selection)?!1:(e&&e(n.tr.setSelection(t).scrollIntoView()),!0)}function Kc(n,e){return(t,r,s)=>{if(!s)return!1;const i=t.selection;if(i instanceof Xe)return gu(t,r,me.near(i.$headCell,e));if(n!="horiz"&&!i.empty)return!1;const o=tk(s,n,e);if(o==null)return!1;if(n=="horiz")return gu(t,r,me.near(t.doc.resolve(i.head+e),e));{const a=t.doc.resolve(o),l=GI(a,n,e);let c;return l?c=me.near(l,1):e<0?c=me.near(t.doc.resolve(a.before(-1)),-1):c=me.near(t.doc.resolve(a.after(-1)),1),gu(t,r,c)}}}function Gc(n,e){return(t,r,s)=>{if(!s)return!1;const i=t.selection;let o;if(i instanceof Xe)o=i;else{const l=tk(s,n,e);if(l==null)return!1;o=new Xe(t.doc.resolve(l))}const a=GI(o.$headCell,n,e);return a?gu(t,r,new Xe(o.$anchorCell,a)):!1}}function Oz(n,e){const t=n.state.doc,r=ua(t.resolve(e));return r?(n.dispatch(n.state.tr.setSelection(new Xe(r))),!0):!1}function Dz(n,e,t){if(!er(n.state))return!1;let r=Rz(t);const s=n.state.selection;if(s instanceof Xe){r||(r={width:1,height:1,rows:[H.from(xm(rn(n.state.schema).cell,t))]});const i=s.$anchorCell.node(-1),o=s.$anchorCell.start(-1),a=ht.get(i).rectBetween(s.$anchorCell.pos-o,s.$headCell.pos-o);return r=Mz(r,a.right-a.left,a.bottom-a.top),jb(n.state,n.dispatch,o,a,r),!0}else if(r){const i=Hd(n.state),o=i.start(-1);return jb(n.state,n.dispatch,o,ht.get(i.node(-1)).findCell(i.pos-o),r),!0}else return!1}function Lz(n,e){var t;if(e.ctrlKey||e.metaKey)return;const r=Wb(n,e.target);let s;if(e.shiftKey&&n.state.selection instanceof Xe)i(n.state.selection.$anchorCell,e),e.preventDefault();else if(e.shiftKey&&r&&(s=ua(n.state.selection.$anchor))!=null&&((t=ap(n,e))===null||t===void 0?void 0:t.pos)!=s.pos)i(s,e),e.preventDefault();else if(!r)return;function i(l,c){let u=ap(n,c);const h=Ps.getState(n.state)==null;if(!u||!$y(l,u))if(h)u=l;else return;const f=new Xe(l,u);if(h||!n.state.selection.eq(f)){const p=n.state.tr.setSelection(f);h&&p.setMeta(Ps,l.pos),n.dispatch(p)}}function o(){n.root.removeEventListener("mouseup",o),n.root.removeEventListener("dragstart",o),n.root.removeEventListener("mousemove",a),Ps.getState(n.state)!=null&&n.dispatch(n.state.tr.setMeta(Ps,-1))}function a(l){const c=l,u=Ps.getState(n.state);let h;if(u!=null)h=n.state.doc.resolve(u);else if(Wb(n,c.target)!=r&&(h=ap(n,e),!h))return o();h&&i(h,c)}n.root.addEventListener("mouseup",o),n.root.addEventListener("dragstart",o),n.root.addEventListener("mousemove",a)}function tk(n,e,t){if(!(n.state.selection instanceof ue))return null;const{$head:r}=n.state.selection;for(let s=r.depth-1;s>=0;s--){const i=r.node(s);if((t<0?r.index(s):r.indexAfter(s))!=(t<0?0:i.childCount))return null;if(i.type.spec.tableRole=="cell"||i.type.spec.tableRole=="header_cell"){const o=r.before(s),a=e=="vert"?t>0?"down":"up":t>0?"right":"left";return n.endOfTextblock(a)?o:null}}return null}function Wb(n,e){for(;e&&e!=n.dom;e=e.parentNode)if(e.nodeName=="TD"||e.nodeName=="TH")return e;return null}function ap(n,e){const t=n.posAtCoords({left:e.clientX,top:e.clientY});if(!t)return null;const r=t.inside>=0?t.inside:t.pos;return ua(n.state.doc.resolve(r))}var Vz=class{constructor(e,t){this.node=e,this.defaultCellMinWidth=t,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.table.style.setProperty("--default-cell-min-width",`${t}px`),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Mm(e,this.colgroup,this.table,t),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type!=this.node.type?!1:(this.node=e,Mm(e,this.colgroup,this.table,this.defaultCellMinWidth),!0)}ignoreMutation(e){return e.type=="attributes"&&(e.target==this.table||this.colgroup.contains(e.target))}};function Mm(n,e,t,r,s,i){let o=0,a=!0,l=e.firstChild;const c=n.firstChild;if(c){for(let h=0,f=0;h<c.childCount;h++){const{colspan:p,colwidth:m}=c.child(h).attrs;for(let y=0;y<p;y++,f++){const v=s==f?i:m&&m[y],T=v?v+"px":"";if(o+=v||r,v||(a=!1),l)l.style.width!=T&&(l.style.width=T),l=l.nextSibling;else{const M=document.createElement("col");M.style.width=T,e.appendChild(M)}}}for(;l;){var u;const h=l.nextSibling;(u=l.parentNode)===null||u===void 0||u.removeChild(l),l=h}a?(t.style.width=o+"px",t.style.minWidth=""):(t.style.width="",t.style.minWidth=o+"px")}}const Sn=new dt("tableColumnResizing");function Fz({handleWidth:n=5,cellMinWidth:e=25,defaultCellMinWidth:t=100,View:r=Vz,lastColumnResizable:s=!0}={}){const i=new st({key:Sn,state:{init(o,a){var l;const c=(l=i.spec)===null||l===void 0||(l=l.props)===null||l===void 0?void 0:l.nodeViews,u=rn(a.schema).table.name;return r&&c&&(c[u]=(h,f)=>new r(h,t,f)),new Bz(-1,!1)},apply(o,a){return a.apply(o)}},props:{attributes:o=>{const a=Sn.getState(o);return a&&a.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(o,a)=>{$z(o,a,n,s)},mouseleave:o=>{Uz(o)},mousedown:(o,a)=>{zz(o,a,e,t)}},decorations:o=>{const a=Sn.getState(o);if(a&&a.activeHandle>-1)return Kz(o,a.activeHandle)},nodeViews:{}}});return i}var Bz=class yu{constructor(e,t){this.activeHandle=e,this.dragging=t}apply(e){const t=this,r=e.getMeta(Sn);if(r&&r.setHandle!=null)return new yu(r.setHandle,!1);if(r&&r.setDragging!==void 0)return new yu(t.activeHandle,r.setDragging);if(t.activeHandle>-1&&e.docChanged){let s=e.mapping.map(t.activeHandle,-1);return Rm(e.doc.resolve(s))||(s=-1),new yu(s,t.dragging)}return t}};function $z(n,e,t,r){if(!n.editable)return;const s=Sn.getState(n.state);if(s&&!s.dragging){const i=jz(e.target);let o=-1;if(i){const{left:a,right:l}=i.getBoundingClientRect();e.clientX-a<=t?o=qb(n,e,"left",t):l-e.clientX<=t&&(o=qb(n,e,"right",t))}if(o!=s.activeHandle){if(!r&&o!==-1){const a=n.state.doc.resolve(o),l=a.node(-1),c=ht.get(l),u=a.start(-1);if(c.colCount(a.pos-u)+a.nodeAfter.attrs.colspan-1==c.width-1)return}nk(n,o)}}}function Uz(n){if(!n.editable)return;const e=Sn.getState(n.state);e&&e.activeHandle>-1&&!e.dragging&&nk(n,-1)}function zz(n,e,t,r){var s;if(!n.editable)return!1;const i=(s=n.dom.ownerDocument.defaultView)!==null&&s!==void 0?s:window,o=Sn.getState(n.state);if(!o||o.activeHandle==-1||o.dragging)return!1;const a=n.state.doc.nodeAt(o.activeHandle),l=Hz(n,o.activeHandle,a.attrs);n.dispatch(n.state.tr.setMeta(Sn,{setDragging:{startX:e.clientX,startWidth:l}}));function c(h){i.removeEventListener("mouseup",c),i.removeEventListener("mousemove",u);const f=Sn.getState(n.state);f?.dragging&&(Wz(n,f.activeHandle,Kb(f.dragging,h,t)),n.dispatch(n.state.tr.setMeta(Sn,{setDragging:null})))}function u(h){if(!h.which)return c(h);const f=Sn.getState(n.state);if(f&&f.dragging){const p=Kb(f.dragging,h,t);Gb(n,f.activeHandle,p,r)}}return Gb(n,o.activeHandle,l,r),i.addEventListener("mouseup",c),i.addEventListener("mousemove",u),e.preventDefault(),!0}function Hz(n,e,{colspan:t,colwidth:r}){const s=r&&r[r.length-1];if(s)return s;const i=n.domAtPos(e);let o=i.node.childNodes[i.offset].offsetWidth,a=t;if(r)for(let l=0;l<t;l++)r[l]&&(o-=r[l],a--);return o/a}function jz(n){for(;n&&n.nodeName!="TD"&&n.nodeName!="TH";)n=n.classList&&n.classList.contains("ProseMirror")?null:n.parentNode;return n}function qb(n,e,t,r){const s=t=="right"?-r:r,i=n.posAtCoords({left:e.clientX+s,top:e.clientY});if(!i)return-1;const{pos:o}=i,a=ua(n.state.doc.resolve(o));if(!a)return-1;if(t=="right")return a.pos;const l=ht.get(a.node(-1)),c=a.start(-1),u=l.map.indexOf(a.pos-c);return u%l.width==0?-1:c+l.map[u-1]}function Kb(n,e,t){const r=e.clientX-n.startX;return Math.max(t,n.startWidth+r)}function nk(n,e){n.dispatch(n.state.tr.setMeta(Sn,{setHandle:e}))}function Wz(n,e,t){const r=n.state.doc.resolve(e),s=r.node(-1),i=ht.get(s),o=r.start(-1),a=i.colCount(r.pos-o)+r.nodeAfter.attrs.colspan-1,l=n.state.tr;for(let c=0;c<i.height;c++){const u=c*i.width+a;if(c&&i.map[u]==i.map[u-i.width])continue;const h=i.map[u],f=s.nodeAt(h).attrs,p=f.colspan==1?0:a-i.colCount(h);if(f.colwidth&&f.colwidth[p]==t)continue;const m=f.colwidth?f.colwidth.slice():qz(f.colspan);m[p]=t,l.setNodeMarkup(o+h,null,{...f,colwidth:m})}l.docChanged&&n.dispatch(l)}function Gb(n,e,t,r){const s=n.state.doc.resolve(e),i=s.node(-1),o=s.start(-1),a=ht.get(i).colCount(s.pos-o)+s.nodeAfter.attrs.colspan-1;let l=n.domAtPos(s.start(-1)).node;for(;l&&l.nodeName!="TABLE";)l=l.parentNode;l&&Mm(i,l.firstChild,l,r,a,t)}function qz(n){return Array(n).fill(0)}function Kz(n,e){const t=[],r=n.doc.resolve(e),s=r.node(-1);if(!s)return Qe.empty;const i=ht.get(s),o=r.start(-1),a=i.colCount(r.pos-o)+r.nodeAfter.attrs.colspan-1;for(let c=0;c<i.height;c++){const u=a+c*i.width;if((a==i.width-1||i.map[u]!=i.map[u+1])&&(c==0||i.map[u]!=i.map[u-i.width])){var l;const h=i.map[u],f=o+h+s.nodeAt(h).nodeSize-1,p=document.createElement("div");p.className="column-resize-handle",!((l=Sn.getState(n))===null||l===void 0)&&l.dragging&&t.push(Rt.node(o+h,o+h+s.nodeAt(h).nodeSize,{class:"column-resize-dragging"})),t.push(Rt.widget(f,p))}}return Qe.create(n.doc,t)}function Gz({allowTableNodeSelection:n=!1}={}){return new st({key:Ps,state:{init(){return null},apply(e,t){const r=e.getMeta(Ps);if(r!=null)return r==-1?null:r;if(t==null||!e.docChanged)return t;const{deleted:s,pos:i}=e.mapping.mapResult(t);return s?null:i}},props:{decorations:az,handleDOMEvents:{mousedown:Lz},createSelectionBetween(e){return Ps.getState(e.state)!=null?e.state.selection:null},handleTripleClick:Oz,handleKeyDown:Nz,handlePaste:Dz},appendTransaction(e,t,r){return uz(r,XI(r,t),n)}})}var rk=Ht.create({name:"tableCell",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:n=>{var e,t;const r=n.getAttribute("colwidth"),s=r?r.split(",").map(i=>parseInt(i,10)):null;if(!s){const i=(e=n.closest("table"))==null?void 0:e.querySelectorAll("colgroup > col"),o=Array.from(((t=n.parentElement)==null?void 0:t.children)||[]).indexOf(n);if(o&&o>-1&&i&&i[o]){const a=i[o].getAttribute("width");return a?[parseInt(a,10)]:null}}return s}}}},tableRole:"cell",isolating:!0,parseHTML(){return[{tag:"td"}]},renderHTML({HTMLAttributes:n}){return["td",Ze(this.options.HTMLAttributes,n),0]}}),sk=Ht.create({name:"tableHeader",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:n=>{const e=n.getAttribute("colwidth");return e?e.split(",").map(r=>parseInt(r,10)):null}}}},tableRole:"header_cell",isolating:!0,parseHTML(){return[{tag:"th"}]},renderHTML({HTMLAttributes:n}){return["th",Ze(this.options.HTMLAttributes,n),0]}}),ik=Ht.create({name:"tableRow",addOptions(){return{HTMLAttributes:{}}},content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML(){return[{tag:"tr"}]},renderHTML({HTMLAttributes:n}){return["tr",Ze(this.options.HTMLAttributes,n),0]}});function Pm(n,e){return e?["width",`${Math.max(e,n)}px`]:["min-width",`${n}px`]}function Jb(n,e,t,r,s,i){var o;let a=0,l=!0,c=e.firstChild;const u=n.firstChild;if(u!==null)for(let f=0,p=0;f<u.childCount;f+=1){const{colspan:m,colwidth:y}=u.child(f).attrs;for(let v=0;v<m;v+=1,p+=1){const T=s===p?i:y&&y[v],M=T?`${T}px`:"";if(a+=T||r,T||(l=!1),c){if(c.style.width!==M){const[P,D]=Pm(r,T);c.style.setProperty(P,D)}c=c.nextSibling}else{const P=document.createElement("col"),[D,L]=Pm(r,T);P.style.setProperty(D,L),e.appendChild(P)}}}for(;c;){const f=c.nextSibling;(o=c.parentNode)==null||o.removeChild(c),c=f}const h=n.attrs.style&&typeof n.attrs.style=="string"&&/\bwidth\s*:/i.test(n.attrs.style);l&&!h?(t.style.width=`${a}px`,t.style.minWidth=""):(t.style.width="",t.style.minWidth=`${a}px`)}var Jz=class{constructor(n,e){this.node=n,this.cellMinWidth=e,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),n.attrs.style&&(this.table.style.cssText=n.attrs.style),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Jb(n,this.colgroup,this.table,e),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(n){return n.type!==this.node.type?!1:(this.node=n,Jb(n,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(n){const e=n.target,t=this.dom.contains(e),r=this.contentDOM.contains(e);return!!(t&&!r&&(n.type==="attributes"||n.type==="childList"||n.type==="characterData"))}};function Qz(n,e,t,r){let s=0,i=!0;const o=[],a=n.firstChild;if(!a)return{};for(let h=0,f=0;h<a.childCount;h+=1){const{colspan:p,colwidth:m}=a.child(h).attrs;for(let y=0;y<p;y+=1,f+=1){const v=t===f?r:m&&m[y];s+=v||e,v||(i=!1);const[T,M]=Pm(e,v);o.push(["col",{style:`${T}: ${M}`}])}}const l=i?`${s}px`:"",c=i?"":`${s}px`;return{colgroup:["colgroup",{},...o],tableWidth:l,tableMinWidth:c}}function Qb(n,e){return n.createAndFill()}function Yz(n){if(n.cached.tableNodeTypes)return n.cached.tableNodeTypes;const e={};return Object.keys(n.nodes).forEach(t=>{const r=n.nodes[t];r.spec.tableRole&&(e[r.spec.tableRole]=r)}),n.cached.tableNodeTypes=e,e}function Xz(n,e,t,r,s){const i=Yz(n),o=[],a=[];for(let c=0;c<t;c+=1){const u=Qb(i.cell);if(u&&a.push(u),r){const h=Qb(i.header_cell);h&&o.push(h)}}const l=[];for(let c=0;c<e;c+=1)l.push(i.row.createChecked(null,r&&c===0?o:a));return i.table.createChecked(null,l)}function Zz(n){return n instanceof Xe}var Jc=({editor:n})=>{const{selection:e}=n.state;if(!Zz(e))return!1;let t=0;const r=GA(e.ranges[0].$from,i=>i.type.name==="table");return r?.node.descendants(i=>{if(i.type.name==="table")return!1;["tableCell","tableHeader"].includes(i.type.name)&&(t+=1)}),t===e.ranges.length?(n.commands.deleteTable(),!0):!1},eH="";function tH(n){return(n||"").replace(/\s+/g," ").trim()}function nH(n,e,t={}){var r;const s=(r=t.cellLineSeparator)!=null?r:eH;if(!n||!n.content||n.content.length===0)return"";const i=[];n.content.forEach(m=>{const y=[];m.content&&m.content.forEach(v=>{let T="";v.content&&Array.isArray(v.content)&&v.content.length>1?T=v.content.map(L=>e.renderChildren(L)).join(s):T=v.content?e.renderChildren(v.content):"";const M=tH(T),P=v.type==="tableHeader";y.push({text:M,isHeader:P})}),i.push(y)});const o=i.reduce((m,y)=>Math.max(m,y.length),0);if(o===0)return"";const a=new Array(o).fill(0);i.forEach(m=>{var y;for(let v=0;v<o;v+=1){const M=(((y=m[v])==null?void 0:y.text)||"").length;M>a[v]&&(a[v]=M),a[v]<3&&(a[v]=3)}});const l=(m,y)=>m+" ".repeat(Math.max(0,y-m.length)),c=i[0],u=c.some(m=>m.isHeader);let h=`
`;const f=new Array(o).fill(0).map((m,y)=>u&&c[y]&&c[y].text||"");return h+=`| ${f.map((m,y)=>l(m,a[y])).join(" | ")} |
`,h+=`| ${a.map(m=>"-".repeat(Math.max(3,m))).join(" | ")} |
`,(u?i.slice(1):i).forEach(m=>{h+=`| ${new Array(o).fill(0).map((y,v)=>l(m[v]&&m[v].text||"",a[v])).join(" | ")} |
`}),h}var rH=nH,ok=Ht.create({name:"table",addOptions(){return{HTMLAttributes:{},resizable:!1,renderWrapper:!1,handleWidth:5,cellMinWidth:25,View:Jz,lastColumnResizable:!0,allowTableNodeSelection:!1}},content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML(){return[{tag:"table"}]},renderHTML({node:n,HTMLAttributes:e}){const{colgroup:t,tableWidth:r,tableMinWidth:s}=Qz(n,this.options.cellMinWidth),i=e.style;function o(){return i||(r?`width: ${r}`:`min-width: ${s}`)}const a=["table",Ze(this.options.HTMLAttributes,e,{style:o()}),t,["tbody",0]];return this.options.renderWrapper?["div",{class:"tableWrapper"},a]:a},parseMarkdown:(n,e)=>{const t=[];if(n.header){const r=[];n.header.forEach(s=>{r.push(e.createNode("tableHeader",{},[{type:"paragraph",content:e.parseInline(s.tokens)}]))}),t.push(e.createNode("tableRow",{},r))}return n.rows&&n.rows.forEach(r=>{const s=[];r.forEach(i=>{s.push(e.createNode("tableCell",{},[{type:"paragraph",content:e.parseInline(i.tokens)}]))}),t.push(e.createNode("tableRow",{},s))}),e.createNode("table",void 0,t)},renderMarkdown:(n,e)=>rH(n,e),addCommands(){return{insertTable:({rows:n=3,cols:e=3,withHeaderRow:t=!0}={})=>({tr:r,dispatch:s,editor:i})=>{const o=Xz(i.schema,n,e,t);if(s){const a=r.selection.from+1;r.replaceSelectionWith(o).scrollIntoView().setSelection(ue.near(r.doc.resolve(a)))}return!0},addColumnBefore:()=>({state:n,dispatch:e})=>fz(n,e),addColumnAfter:()=>({state:n,dispatch:e})=>pz(n,e),deleteColumn:()=>({state:n,dispatch:e})=>gz(n,e),addRowBefore:()=>({state:n,dispatch:e})=>_z(n,e),addRowAfter:()=>({state:n,dispatch:e})=>vz(n,e),deleteRow:()=>({state:n,dispatch:e})=>bz(n,e),deleteTable:()=>({state:n,dispatch:e})=>kz(n,e),mergeCells:()=>({state:n,dispatch:e})=>Fb(n,e),splitCell:()=>({state:n,dispatch:e})=>Bb(n,e),toggleHeaderColumn:()=>({state:n,dispatch:e})=>Kl("column")(n,e),toggleHeaderRow:()=>({state:n,dispatch:e})=>Kl("row")(n,e),toggleHeaderCell:()=>({state:n,dispatch:e})=>Az(n,e),mergeOrSplit:()=>({state:n,dispatch:e})=>Fb(n,e)?!0:Bb(n,e),setCellAttribute:(n,e)=>({state:t,dispatch:r})=>Sz(n,e)(t,r),goToNextCell:()=>({state:n,dispatch:e})=>Ub(1)(n,e),goToPreviousCell:()=>({state:n,dispatch:e})=>Ub(-1)(n,e),fixTables:()=>({state:n,dispatch:e})=>(e&&XI(n),!0),setCellSelection:n=>({tr:e,dispatch:t})=>{if(t){const r=Xe.create(e.doc,n.anchorCell,n.headCell);e.setSelection(r)}return!0}}},addKeyboardShortcuts(){return{Tab:()=>this.editor.commands.goToNextCell()?!0:this.editor.can().addRowAfter()?this.editor.chain().addRowAfter().goToNextCell().run():!1,"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:Jc,"Mod-Backspace":Jc,Delete:Jc,"Mod-Delete":Jc}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[Fz({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,defaultCellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],Gz({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema(n){const e={name:n.name,options:n.options,storage:n.storage};return{tableRole:Ve(oe(n,"tableRole",e))}}});je.create({name:"tableKit",addExtensions(){const n=[];return this.options.table!==!1&&n.push(ok.configure(this.options.table)),this.options.tableCell!==!1&&n.push(rk.configure(this.options.tableCell)),this.options.tableHeader!==!1&&n.push(sk.configure(this.options.tableHeader)),this.options.tableRow!==!1&&n.push(ik.configure(this.options.tableRow)),n}});const sH={class:"editor-wrapper"},iH={class:"toolbar"},oH={class:"tip"},aH={__name:"TipTap",setup(n,{expose:e}){const t=a$({extensions:[UU,BI,qI,KI,QU.configure({multicolor:!0}),YU.configure({types:["heading","paragraph"]}),ok.configure({resizable:!0}),ik,sk,rk],content:""}),r=un(()=>t.value?.isEmpty===!0);e({getHTML:()=>t.value.getHTML(),getText:()=>t.value.getText(),clearContent:()=>t.value.commands.clearContent()});const s=u=>{t.value.chain().focus()[u]().run()},i=u=>t.value?.isActive(u),o=$e(),a=$e(),l=()=>{const u=o.value,h=a.value;!u||!h||t.value.chain().focus().insertTable({rows:u,cols:h,withHeaderRow:!0}).run()},c=u=>{const h=u.target.value;h==="paragraph"?t.value.chain().focus().setParagraph().run():t.value.chain().focus().toggleHeading({level:Number(h.replace("h",""))}).run()};return(u,h)=>(we(),Ce("div",sH,[W("div",iH,[W("button",{onClick:h[0]||(h[0]=f=>s("toggleBold")),class:Ni({active:i("bold")})},"B",2),W("button",{onClick:h[1]||(h[1]=f=>s("toggleItalic")),class:Ni({active:i("italic")})},"I",2),W("button",{onClick:h[2]||(h[2]=f=>s("toggleUnderline")),class:Ni({active:i("underline")})},"U",2),W("input",{type:"color",title:"",onInput:h[3]||(h[3]=f=>qe(t).chain().focus().setColor(f.target.value).run())},null,32),W("input",{type:"color",title:"",onInput:h[4]||(h[4]=f=>qe(t).chain().focus().toggleHighlight({color:f.target.value}).run())},null,32),W("button",{onClick:h[5]||(h[5]=f=>qe(t).chain().focus().setTextAlign("left").run())},""),W("button",{onClick:h[6]||(h[6]=f=>qe(t).chain().focus().setTextAlign("center").run())},""),W("button",{onClick:h[7]||(h[7]=f=>qe(t).chain().focus().setTextAlign("right").run())},""),W("select",{onChange:h[8]||(h[8]=f=>c(f))},[...h[11]||(h[11]=[W("option",{value:"h1"},"",-1),W("option",{value:"h2"},"",-1),W("option",{value:"h3"},"",-1),W("option",{value:"paragraph"},"",-1)])],32),Hn(W("input",{type:"number","onUpdate:modelValue":h[9]||(h[9]=f=>ot(o)?o.value=f:null),placeholder:"",min:"1",max:"10"},null,512),[[jr,qe(o),void 0,{number:!0}]]),Hn(W("input",{type:"number","onUpdate:modelValue":h[10]||(h[10]=f=>ot(a)?a.value=f:null),placeholder:"",min:"1",max:"10"},null,512),[[jr,qe(a),void 0,{number:!0}]]),W("button",{onClick:l},"")]),ke(qe(o$),{editor:qe(t),class:"editor"},null,8,["editor"]),Hn(W("span",oH,"...",512),[[dE,qe(r)]])]))}},lH=zt(aH,[["__scopeId","data-v-42da2523"]]),cH={class:"upload"},uH={key:0,class:"msg"},hH={class:"form-card"},dH=["src"],fH="0c60c52ce46382fde56330eba5f303b2",pH={__name:"UploadArticle",setup(n){const e=$e(!1),t=$e(""),r=m=>{t.value=m,e.value=!0},s=$e(null),i=$e(""),o=$e(""),a=$e(""),l=$e(null),c=$e(""),u=$e(""),h=$e(""),f=async m=>{const y=m.target.files[0];if(!y)return;h.value="...";const v=new FormData;v.append("image",y);const M=await(await fetch(`https://api.imgbb.com/1/upload?key=${fH}`,{method:"POST",body:v})).json();M.success?(c.value=M.data.url,h.value=""):h.value=""},p=async()=>{const m=s.value.getHTML(),y=s.value.getText();if(!i.value||!u.value||!y.trim()){r("");return}try{await PL(hS(Ad,"articles"),{title:i.value,subTitle:o.value,videoLink:a.value,imgUrl:c.value,date:u.value,content:m,createdAt:NL()}),r(""),i.value="",o.value="",a.value="",l.value.value="",c.value="",u.value="",h.value="",s.value.clearContent()}catch(v){r(v.message)}};return(m,y)=>(we(),Ce("div",cH,[ke(cc),y[6]||(y[6]=W("h2",{class:"form-title"},"",-1)),h.value?(we(),Ce("p",uH,it(h.value),1)):br("",!0),W("div",hH,[Hn(W("input",{"onUpdate:modelValue":y[0]||(y[0]=v=>i.value=v),placeholder:""},null,512),[[jr,i.value]]),Hn(W("input",{"onUpdate:modelValue":y[1]||(y[1]=v=>o.value=v),placeholder:"()"},null,512),[[jr,o.value]]),Hn(W("input",{"onUpdate:modelValue":y[2]||(y[2]=v=>a.value=v),placeholder:"()"},null,512),[[jr,a.value]]),W("input",{type:"file",accept:"image/*",onChange:f,ref_key:"fileInput",ref:l},null,544),Hn(W("input",{"onUpdate:modelValue":y[3]||(y[3]=v=>c.value=v),placeholder:"",readonly:""},null,512),[[jr,c.value]]),Hn(W("input",{"onUpdate:modelValue":y[4]||(y[4]=v=>u.value=v),type:"date",min:"2025-01-01"},null,512),[[jr,u.value]]),ke(lH,{ref_key:"editorRef",ref:s},null,512),W("button",{onClick:p},"")]),c.value?(we(),Ce("img",{key:1,src:c.value,class:"previewImg",alt:""},null,8,dH)):br("",!0),ke(dC,{visible:e.value,"onUpdate:visible":y[5]||(y[5]=v=>e.value=v),message:t.value},null,8,["visible","message"])]))}},mH=zt(pH,[["__scopeId","data-v-2a344763"]]),gH={class:"login"},yH={class:"card"},_H={key:0},vH={class:"form-group"},wH={class:"form-group"},bH={key:1,class:"logged-in"},EH={__name:"Login",setup(n){const e=Xm(),t=rd(),r=$e(!1),s=$e(""),i=f=>{s.value=f,r.value=!0},o=Jg(),a=$e(null),l=$e(""),c=$e("");Ar(()=>{KS(o,f=>{a.value=f})});const u=async()=>{if(console.log(l.value),!l.value||!c.value){i("");return}if(l.value!=="hedecpa@gmail.com"&&l.value!=="jameschunchin@gmail.com"){i("");return}try{await OV(o,l.value,c.value);const f=e.query.redirect||"/";t.replace(f)}catch(f){f.code==="auth/invalid-credential"||f.code==="auth/wrong-password"?i(""):i(""+f.message)}},h=async()=>{await VV(o)};return(f,p)=>{const m=Tu("router-link");return we(),Ce("div",gH,[W("div",yH,[p[7]||(p[7]=W("h2",{class:"title"},"",-1)),a.value?(we(),Ce("div",bH,[W("p",null,[p[5]||(p[5]=hr("",-1)),W("strong",null,it(a.value.email),1)]),W("button",{onClick:h,class:"btn danger"},""),ke(m,{to:"/uploadarticle",class:"btn link-btn"},{default:Ns(()=>[...p[6]||(p[6]=[hr("",-1)])]),_:1})])):(we(),Ce("div",_H,[W("div",vH,[p[3]||(p[3]=W("label",null,"",-1)),Hn(W("input",{"onUpdate:modelValue":p[0]||(p[0]=y=>l.value=y),placeholder:""},null,512),[[jr,l.value]])]),W("div",wH,[p[4]||(p[4]=W("label",null,"",-1)),Hn(W("input",{"onUpdate:modelValue":p[1]||(p[1]=y=>c.value=y),type:"password",placeholder:""},null,512),[[jr,c.value]])]),W("button",{onClick:u,class:"btn primary"},"")]))]),ke(dC,{visible:r.value,"onUpdate:visible":p[2]||(p[2]=y=>r.value=y),message:s.value},null,8,["visible","message"])])}}},TH=zt(EH,[["__scopeId","data-v-fabe80bf"]]),SH={class:"page-list"},CH={key:0,class:"no-articles"},AH={key:1,class:"articles"},IH=["onClick"],kH={class:"title"},RH={class:"subtitle"},xH={class:"time"},MH=["src","alt"],PH={key:2,class:"pagination"},NH=["disabled"],OH=["disabled"],lp=5,DH={__name:"ArticleList",setup(n){const e=rd(),t=$e([]),r=$e(1),s=$e(1),i=un(()=>{const c=(r.value-1)*lp,u=c+lp;return t.value.slice(c,u)}),o=()=>{r.value<s.value&&r.value++},a=()=>{r.value>1&&r.value--},l=c=>{e.push(`/articles/${c}`)};return Ar(async()=>{const c=AL(hS(Ad,"articles"),Fv("date","desc"),Fv("createdAt","desc"));bS(c,u=>{t.value=u.docs.map(h=>({id:h.id,...h.data()})),s.value=Math.ceil(t.value.length/lp)})}),(c,u)=>(we(),Ce("div",SH,[ke(cc),u[0]||(u[0]=W("h2",{class:"page-title"},"",-1)),t.value.length===0?(we(),Ce("div",CH,"  ")):(we(),Ce("div",AH,[(we(!0),Ce(Xt,null,Ga(i.value,h=>(we(),Ce("div",{key:h.id,class:"article-card",onClick:f=>l(h.id)},[W("div",null,[W("h3",kH,it(h.title),1),W("p",RH,it(h.subTitle),1),W("small",xH,it(h.date||""),1)]),W("div",null,[h.imgUrl?(we(),Ce("img",{key:0,src:h.imgUrl,alt:h.title},null,8,MH)):br("",!0)])],8,IH))),128))])),s.value!==1&&s.value!==0?(we(),Ce("div",PH,[W("button",{onClick:a,disabled:r.value===1},"",8,NH),W("span",null," "+it(r.value)+" / "+it(s.value)+" ",1),W("button",{onClick:o,disabled:r.value===s.value},"  ",8,OH)])):br("",!0)]))}},LH=zt(DH,[["__scopeId","data-v-4de25385"]]),VH={key:0,class:"container"},FH={class:"title"},BH={class:"subtitle"},$H={class:"time"},UH=["innerHTML"],zH=["innerHTML"],HH=["src"],jH={key:1,class:"loading"},WH={__name:"ArticleDetail",setup(n){const e=Xm(),t=rd(),r=$e(null),s=()=>{t.back()};return Ar(async()=>{const i=e.params.id;if(!i)return;const o=kg(Ad,"articles",i),a=await xL(o);a.exists()?r.value={id:a.id,...a.data()}:(console.warn(""),t.replace("/articles"))}),(i,o)=>r.value?(we(),Ce("div",VH,[ke(cc),W("h2",FH,it(r.value.title),1),W("p",BH,it(r.value.subTitle),1),W("small",$H,it(r.value.date||""),1),W("div",{class:"content",innerHTML:r.value.content},null,8,UH),W("div",{class:"video",innerHTML:r.value.videoLink},null,8,zH),r.value.imgUrl?(we(),Ce("img",{key:0,src:r.value.imgUrl,class:"image"},null,8,HH)):br("",!0),W("button",{class:"back-btn",onClick:s},"")])):(we(),Ce("div",jH,[...o[0]||(o[0]=[W("div",{class:"spinner"},null,-1),W("p",null,"...",-1)])]))}},qH=zt(WH,[["__scopeId","data-v-05832317"]]),KH=[{path:"/",component:k4},{path:"/news",component:j4},{path:"/news/:id",component:Z4},{path:"/uploadArticle",component:mH,meta:{requiresAuth:!0}},{path:"/login",component:TH},{path:"/articleList",component:LH},{path:"/articles/:id",component:qH}],ak=uP({history:BM(),routes:KH}),GH=Jg(),JH=()=>new Promise(n=>{const e=KS(GH,t=>{e(),n(t)})});ak.beforeEach(async n=>{if(n.meta.requiresAuth&&!await JH())return{path:"/login",query:{redirect:n.fullPath}}});eM(aM).use(ak).use(D4()).mount("#app");
